(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    166775,       4312]
NotebookOptionsPosition[    162855,       4261]
NotebookOutlinePosition[    163248,       4277]
CellTagsIndexPosition[    163205,       4274]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", "Title", ":", " ", 
    RowBox[{"TuGamesAux", ".", "m"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Release", " ", 
    RowBox[{"Date", ":", " ", 
     RowBox[{"13.03", ".2024"}]}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Version", ":", " ", 
    RowBox[{"3.1", ".4"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Context", ":", " ", "TuGamesAux`"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Summary", ":", "\t", "\n", "    ", 
    RowBox[{
    "This", " ", "package", " ", "provides", " ", "some", " ", "auxiliary", 
     " ", "functions", " ", "to", " ", "the", " ", "package", " ", 
     RowBox[{"TuGames", ".", "m", "."}]}]}], "\n", "*)"}], "\t\t\t", "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Author", ":", "\t\t", "\n", "    ", 
    RowBox[{
     RowBox[{
     "Holger", " ", "Ingmar", " ", "Meinhardt", "\n", "    ", "Department", 
      " ", "of", " ", "Economics", "\n", "    ", "University", " ", "of", " ",
       "Karlsruhe", " ", 
      RowBox[{"(", "KIT", ")"}], " ", "\n", "    ", "E"}], "-", 
     RowBox[{"Mail", ":", " ", 
      RowBox[{
       RowBox[{"Holger", ".", 
        RowBox[{"Meinhardt", "@", "wiwi"}], ".", "uni"}], "-", 
       RowBox[{"karlsruhe", ".", "de"}]}]}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", "Version"}], ":", " ", 
    RowBox[{"3.1", ".4"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", "   ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"Mathematica", " ", "Version"}], ":", " ", 
     RowBox[{"12.", "x"}]}], ",", " ", 
    RowBox[{"13.", "x"}], ",", " ", 
    RowBox[{"14.", "x"}]}], "\n", "\n", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", "Sources", ":", "\n", "   ", 
     RowBox[{"Maschler", " ", "JET"}]}], ",", " ", "13", ",", " ", 
    RowBox[{
     RowBox[{"pp", ".", " ", "184"}], "-", "192."}]}], "\n", "\n", "*)"}], 
  "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{":", "Keywords", ":", "\n", " ", 
    RowBox[{
    "Extracting", " ", "the", " ", "coefficient", " ", "from", " ", "an", " ", 
     RowBox[{"LP", ".", " ", "Solving"}], " ", "the", " ", "primal", " ", 
     "and", " ", "dual", " ", 
     RowBox[{"problem", "."}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", "History", ":", "\n", "\n", "   ", 
     RowBox[{
     "Version", " ", "1.1", "\n", "    ", "\n", "    ", "The", " ", 
      "following", " ", "functions", " ", "have", " ", "been", " ", 
      RowBox[{"added", ":", "\n", "\n", "     ", 
       RowBox[{"ContestedGarment", "[", "]"}]}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"TalmudicRule", "[", "]"}], ".", "\n", "\n", "   ", "Version"}],
      " ", "1.3", "\n", "    ", "\n", "    ", "The", " ", "following", " ", 
     "functions", " ", "have", " ", "been", " ", 
     RowBox[{"added", ":", "\n", "\n", "      ", 
      RowBox[{"Angle", "[", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"LieBracket", "[", "]"}], "\n", "\n", "   ", "Version", " ", 
     "1.5", "\n", "    ", "\n", "    ", "The", " ", "following", " ", 
     "functions", " ", "have", " ", "been", " ", 
     RowBox[{"added", ":", "\n", " ", "\n", "      ", 
      RowBox[{"AssignmentProblem", "[", "]"}]}]}], ",", 
    RowBox[{"GenProfitMatrix", "[", "]"}], ",", 
    RowBox[{"AdjointMatrix", "[", "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"HermitianMatrixQ", "[", "]"}], ".", "\n", "    ", "\n", "    ",
       "Some"}], " ", "code", " ", "adjustment", " ", "and", " ", "clean", 
     " ", 
     RowBox[{"up", ".", "\n", "\n", "   ", "Version"}], " ", "1.6", "\n", 
     "\n", "    ", "The", " ", "following", " ", "functions", " ", "have", 
     " ", "been", " ", 
     RowBox[{"added", ":", "\n", "\n", "    ", 
      RowBox[{"GetCardinalityGame", "[", "]"}]}]}], ",", 
    RowBox[{"SymGameType2", "[", "]"}], ",", 
    RowBox[{"SymGameType3", "[", "]"}], ",", 
    RowBox[{"SymGameType4", "[", "]"}], ",", 
    RowBox[{"SymGameSizeK", "[", "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Coal2Dec", "[", "]"}], ".", "\n", "\n", "    ", 
      RowBox[{"HermitianMatrixQ", "[", "]"}]}], "  ", "-", " ", 
     RowBox[{
     "has", " ", "been", " ", "renamed", " ", "due", " ", "to", " ", "a", " ",
       "name", " ", "conflict", " ", "to", " ", 
      RowBox[{
       RowBox[{"IsHermitianMatrixQ", "[", "]"}], ".", " ", "\n", "    ", 
       RowBox[{"ModestBankruptcy", "[", "]"}]}]}], "  ", "-", " ", 
     RowBox[{"has", " ", "changed", " ", "its", " ", "behavior"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "only", " ", "two", " ", "input", " ", "arguments", " ", "are", " ", 
      RowBox[{"allowed", ".", " ", "\n", "    ", 
       RowBox[{"GreedyBankruptcy", "[", "]"}]}]}], "  ", "-", " ", 
     RowBox[{"has", " ", "changed", " ", "its", " ", "behavior"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "only", " ", "two", " ", "input", " ", "arguments", " ", "are", " ", 
      RowBox[{"allowed", ".", " ", "\n", "    ", 
       RowBox[{"TalmudicRule", "[", "]"}]}]}], "      ", "-", " ", 
     RowBox[{"has", " ", "changed", " ", "its", " ", "behavior"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "only", " ", "two", " ", "input", " ", "arguments", " ", "are", " ", 
      RowBox[{"allowed", ".", " ", "\n", "   ", "\n", "   ", "Version"}], " ",
       "1.7", "\n", "\n", "    ", 
      RowBox[{"SelectPart", "[", "]"}]}], "        ", "-", " ", 
     "Superfluous"}], ",", " ", 
    RowBox[{
     RowBox[{"has", " ", "been", " ", 
      RowBox[{"removed", ".", "  ", "\n", "    ", 
       RowBox[{"AssignSymVal", "[", "]"}]}]}], "      ", "-", " ", 
     "Superfluous"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"has", " ", "been", " ", 
       RowBox[{"removed", ".", " ", "\n", "    ", 
        RowBox[{"LPtoMatrix", "[", "]"}]}]}], "        ", "-", " ", 
      RowBox[{
      "has", " ", "been", " ", "modified", " ", "to", " ", "clean", " ", "up",
        " ", "and", " ", "to", " ", "simplify", " ", "the", " ", 
       RowBox[{"code", ".", "\n", "\n", "   ", "Version"}], " ", "1.8", "\n", 
       "    ", 
       RowBox[{"LPtoMatrix", "[", "]"}]}], "        ", "-", " ", 
      RowBox[{
      "fixes", " ", "incorrect", " ", "computation", " ", "due", " ", "to", 
       " ", "wrong", " ", "order", " ", "into", " ", "the", " ", "boundary", 
       " ", 
       RowBox[{"vector", ".", "\n", "\n", "   ", "Version"}], " ", "2.2", 
       "\n", "       ", "Transcription", " ", "of", " ", "the", " ", "old", 
       " ", "option", " ", "rules", " ", "to", " ", "the", " ", "new", " ", 
       "ones", " ", "invented", " ", "by", " ", "Mathematica", " ", "8.", 
       RowBox[{"x", ".", "\n", "       ", "This"}], " ", "package", " ", "is",
        " ", "now", " ", "exclusively", " ", "dedicated", " ", "to", " ", 
       "Mathematica", " ", "version", " ", "8.", "x", " ", "and", " ", 
       RowBox[{"higher", ".", "  ", "\n", "\n", "    ", "Version"}], " ", 
       "2.3"}]}], ":", "\n", "       ", 
     RowBox[{"Change", " ", "protected", " ", "command", " ", 
      RowBox[{"SubsetQ", "[", "]"}], " ", "to", " ", 
      RowBox[{"SubSetQ", "[", "]"}], " ", "from", " ", "the", " ", 
      "VertexEnum", " ", 
      RowBox[{"package", ".", " ", "Order"}], " ", "is", "\n", "       ", 
      "reversed", " ", "to", " ", 
      RowBox[{"SubsetQ", "[", "]"}], " ", "which", " ", "is", " ", "new", " ",
       "in", " ", "Mathematica", " ", "version", " ", "10.", 
      RowBox[{"x", ".", "\n", "\n", "    ", "Version"}], " ", "2.5", ".4"}], 
     ":", "\n", "       ", 
     RowBox[{"Adding", " ", "the", " ", "function", " ", 
      RowBox[{"Sets2Dec", "[", "]"}], " ", "that", " ", "transcribes", " ", 
      "a", " ", "set", " ", "of", " ", "coalitions", " ", "into", " ", "its", 
      " ", "unique", " ", "integer", "\n", "       ", 
      RowBox[{"representations", ".", " ", "Moreover"}]}]}], ",", " ", 
    RowBox[{"we", " ", "add", " ", "the", " ", "function", " ", 
     RowBox[{"BalancedSystemQ", "[", "]"}], " ", "that", " ", "should", " ", 
     "check", " ", "if", " ", "a", " ", "collection", "\n", "       ", "of", 
     " ", "sets", " ", "is", " ", 
     RowBox[{"balanced", ".", " ", "However"}]}], ",", " ", 
    RowBox[{"use", " ", "it", " ", "with", " ", "care"}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "returns", " ", "for", " ", "n"}], "=", 
     RowBox[{
      RowBox[{">", 
       RowBox[{
       "4", " ", "incorrect", " ", "results", " ", "probably", " ", "due", 
        " ", "to", " ", "\n", "       ", "a", " ", "bug", " ", "within", " ", 
        "the", " ", 
        RowBox[{"DualLinearProgramming", ".", " ", "For"}], " ", "an", " ", 
        "example", " ", "see", " ", 
        RowBox[{"ChangeLog", ".", "\n", "\n", "\n", "    ", "Version"}], " ", 
        "2.6", ".0"}]}], ":", "\n", "       ", 
      RowBox[{"Performing", " ", "some", " ", "code", " ", 
       RowBox[{"maintenance", ".", "\n", "\n", "    ", "Version"}], " ", 
       "3.0", ".0"}], ":", "\n", "       ", 
      RowBox[{
      "Not", " ", "anymore", " ", "backward", " ", "compatible", " ", "to", 
       " ", "Mathematica", " ", "versions", " ", "smaller", " ", "than", " ", 
       "12", " ", "due", " ", "to", " ", "the", " ", "port", "\n", "       ", 
       "to", " ", "the", " ", "new", " ", "collection", " ", "of", " ", 
       "algorithms", " ", "for", " ", "solving", " ", "convex", " ", 
       "problems", " ", "introduced", " ", "in", " ", "version", " ", "12.", 
       "\n", "\n", "    ", "Version", " ", "3.0", ".1"}], ":", "\n", 
      "        ", 
      RowBox[{"Some", " ", "minor", " ", "bug", " ", 
       RowBox[{"fixes", ".", " ", "Improving"}], " ", "performance", " ", 
       "of", " ", "functions", " ", "revised", " ", "in", " ", "Version", " ",
        "3.", "\n", "\n", "    ", "Version", " ", "3.0", ".2", " ", "and", 
       " ", "later"}], ":", "\n", "        ", 
      RowBox[{"See", " ", 
       RowBox[{"ChangeLog", "."}]}]}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<TUG`TuGamesAux`\>\"", "]"}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Angle", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Angle[x_vec,y_vec] computes the angle of the two vectors x and y.\>\
\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AssignmentProblem", "::", "usage"}], " ", "=", "\n", 
     "\"\<AssignmentProblem[buyers, sellers, profitmat] determines the \
characteristic values from an \n assignment problem. These values can be used \
to define the corresponding assignment game.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AirportProblem", "::", "usage"}], " ", "=", "\n", 
     "\"\<AirportProblem[cost,nj] computes the associated airport cost game \
from (cost,nj). \n The sum of nj should not exceed 48 players.\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedSystemQ", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<{bcQ,cfs}=BalancedSystemQ[coll,T] checks whether the collection of \
sets 'coll' is balanced.\n It returns a True or False on the first return \
value, at the second position the weights of\n the balanced collection are \
returned.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeaklyBalancedSystemQ", "::", "usage"}], " ", "=", "\n", 
     "\"\<bcQ=WeaklyBalancedSystemQ[coll,b0,T] checks whether the collection \
of sets 'coll' in connection with \n a set of single coalitions b0 -- could \
be empty -- is weakly balanced. It returns a True or False.\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenProfitMatrix", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<GenProfitMatrix[valuation_buyers,valuation_sellers] generates a \
profit matrix for an assignment \n problem by the list of valuation of buyers \
and sellers.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplementaryMarket", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<ComplementaryMarket[Tlist,Plist_,Qlist,opts] computes the \
coalitional values of a market situation with complementary goods. See \
Maschler JET, 13, pp. 184-192. The set P can be understood as manufactures \
and Q as workers. The set T is the player set with P union Q.\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CostLocationGame", "::", "usage"}], " ", "=", "\n", 
     "\"\<CostLocationGame[dmpts,refvc,p,q,fixedCost,opts] computes from a \
facility location situation constituted by a list of demand points, a \
symbolic reference vector like (x1,x2,...,xn), a pq-norm, and a fixed cost \
value of the associated cost location game. For the PQ-norm, the default \
values are p=2 and q=1 (Euclidean norm), and for the fixed cost, the default \
value is set to zero. These input arguments are optional. Mandatory, are the \
demand points, and a reference point. Demand points must be selected from \
positive orthant. Return values are the coalitional cost values, and for each \
coalition larger than 2, the barycenter of the associated polyhedron in which \
the new facility built up by this coalition is located. Permissible Methods \
are: {Automatic, NelderMead, DifferentialEvolution,SimulatedAnnealing} passed \
as string characters. Selecting a Method invokes the function NMinArg. As its \
third output argument the savings game of the cost location game is returned.\
\>\""}], ";"}], " ", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProductGame", "::", "usage"}], " ", "=", "\n", 
     "\"\<ProductGame[wghs] computes from weights vector the characteristic \
values and Harsanyi dividends of a product game.\>\""}], ";"}], " ", "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProbabilityGame", "::", "usage"}], " ", "=", "\n", 
     "\"\<ProbabilityGame[wghs] computes from weights vector the \
characteristic values of a probability game.\>\""}], ";"}], " ", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualProbabilityGame", "::", "usage"}], " ", "=", "\n", 
     "\"\<DualProbabilityGame[wghs] computes from weights vector the \
characteristic values of a dual probability game.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ContestedGarment", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<ContestGarment[Estate,{d1,d2}] computes a solution for a contested \
garment or two-creditor modest \n bankruptcy problem.\>\""}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TalmudicRule", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<TalmudicRule[Estate,{d1,d2,d3,...,dn}] computes a solution for a \
contested garment or n-creditor modest \n bankruptcy problem. The solution \
coincides with the nucleolus of the corresponding bankruptcy game.\>\""}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GreedyBankruptcy", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<GreedyBankruptcy[Estate,claims] computes the coalitional values for \
a greedy bankruptcy game.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPtoMatrix", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<LPtoMatrix[zf, const, var] extracts the coefficient from an LP. \
Where 'zf' is the objective function,\n 'const' is the linear constraint set \
and 'var' is set of variables.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjointMatrix", "::", "usage"}], "=", "\n", 
     "\"\<AdjointMatrix[mat_List] computes the conjugate transpose of the \
matrix 'mat'.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsHermitianMatrixQ", "::", "usage"}], ":=", "\n", 
     "\"\<IsHermitianMatrixQ[mat_List] checks whether a square matrix is self \
adjoint.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModestBankruptcy", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<ModestBankruptcy[Estate,claims] computes the coalitional values for \
a modest bankruptcy game.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GetCardinalityGame", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<GetCardinalityGame[T,k] assigns a worth of zero to a coalition of \
size=<k<Length[T].\n Larger coalition will be assigned according to its \
cardinality. The resultant vector can be \n used to define a game.\>\""}], 
    ";"}], "\n", " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameSizeK", "::", "usage"}], " ", "=", "\n", 
     "\"\<SymGameSize2[T,k,val] constructs a symmetric game where a cycle of \
coalitions of size k getting\n a worth of 'val' and the grand coalition gets \
2*val. The value k must be an integer between\n 2 and Length[T]. Remind that \
T is the player set.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType2", "::", "usage"}], " ", "=", "\n", 
     "\"\<SymGameType2[T,S,val] constructs a game where all coalitions of \
size 2 satisfying \n Intersection[S,Complement[T,S]] getting a worth of \
'val', the grand coalition gets 2*val,\n and otherwise zero. Coalition S must \
have size not less than 2.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType3", "::", "usage"}], " ", "=", "\n", 
     "\"\<SymGameType3[T,S,val] constructs a game where all coalitions of \
size 3 satisfying \n Intersection[S,Complement[T,S]] getting a worth of \
'val', the grand coalition gets 2*val,\n and otherwise zero. Coalition S must \
have size not less than 3.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType4", "::", "usage"}], " ", "=", "\n", 
     "\"\<SymGameType4[T,S,val] constructs a game where all coalitions of \
size 4 satisfying \n Intersection[S,Complement[T,S]] getting a worth of \
'val', the grand coalition gets 2*val,\n and otherwise zero. Coalition S must \
have size not less than 4.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SolvePrimal", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<SolvePrimal[zf, const, var] solves a primal problem.\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SolveDual", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<SolveDual[zf, const, var] solves the corresponding dual \
problem.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EuclidianDistance", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<EuclidianDistance[liste,refliste] computes the Euclidian distance \
of the vector 'liste' w.r.t. \n the vector 'refliste'.\>\""}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PQNorm", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<PQNorm[liste,refliste,p,q] computes the PQ-norm of the vector \
'liste' w.r.t. \n the vector 'refliste'. The default is p=2, q=1, i.e., the \
Euclidean norm.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NearRingQ", "::", "usage"}], " ", "=", "\n", 
     "\"\<NearRingQ[list,T] checks if the collection of sets is a near \
ring.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<LieBracket[mat01,mat02] computes the commutator of the \
(nXn)-matrices mat01 and mat02.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Coal2Dec", "::", "usage"}], " ", "=", "\n", 
     "\"\<Coal2Dec[n_Integer] converts the set of proper coalitions to its \
unique integer representations.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Sets2Dec", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Sets2Dec[list] converts a collection of coalitions to its unique \
integer representations.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RStirlingNumber", "::", "usage"}], "=", "\n", 
     "\"\<RStirlingNumber[r,n,k] computes the r-associated Stirling number of \
the second kind.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SortVecDecOrder", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<SortVecDecOrder[vec] order vec into a non-increasing order. See Eq. \
(5.11) page 82 Peleg and Sudhoelter (2007).\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", "Options", ":"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "AssignmentProblem", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"Verbose", " ", "->", " ", "False"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "BalancedSystemQ", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ComplementaryMarket", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"MarketParameter", " ", "->", " ", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "WeaklyBalancedSystemQ", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "CostLocationGame", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"Error", " ", "Messages"}], ":"}], " ", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"One", " ", "Argument"}], ":"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjointMatrix", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Coal2Dec", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsHermitianMatrixQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Sets2Dec", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SortVecDecOrder", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProductGame", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProbabilityGame", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualProbabilityGame", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"Two", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Angle", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AirportProblem", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedSystemQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ContestedGarment", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CostLocationGame", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EuclidianDistance", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenProfitMatrix", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GreedyBankruptcy", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GetCardinalityGame", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModestBankruptcy", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NearRingQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PQNorm", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TalmudicRule", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}]}]}]], "Code",ExpressionUU\
ID->"397c30dc-1e4d-4f68-9fea-c06d28012fc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Three", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AssignmentProblem", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplementaryMarket", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LPtoMatrix", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RStirlingNumber", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SolveDual", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SolvePrimal", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameSizeK", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType2", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType3", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymGameType4", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeaklyBalancedSystemQ", "::", "argerr"}], "=", 
     "\"\<Three arguments were expected.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"$OperatingSystem", " ", "===", " ", "\"\<Unix\>\""}], ",", " ", 
      RowBox[{"Needs", "[", "\"\<TUG`vertex`VertexEnum`\>\"", "]"}], ",", 
      "\n", "      ", 
      RowBox[{"$OperatingSystem", " ", "===", " ", "\"\<Windows\>\""}], ",", 
      " ", 
      RowBox[{"Needs", "[", "\"\<TUG`vertex`VertexEnum`\>\"", "]"}], ",", 
      "\n", "      ", 
      RowBox[{"$OperatingSystem", " ", "===", " ", "\"\<MacOSX\>\""}], ",", 
      " ", 
      RowBox[{"Needs", "[", "\"\<TUG`vertex`VertexEnum`\>\"", "]"}], ",", 
      "\n", "      ", "True", ",", " ", 
      RowBox[{"Needs", "[", "\"\<VertexEnum`\>\"", "]"}]}], "\n", "]"}], 
    ";"}]}]}]], "Code",ExpressionUUID->"a039ca63-9a43-41c2-9717-f877be99421f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Angle", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Angle", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"y_", "?", "VectorQ"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"ArcCos", "[", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"x", ".", "y"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"x", ",", " ", "2"}], "]"}], " ", 
           RowBox[{"Norm", "[", 
            RowBox[{"y", ",", " ", "2"}], "]"}]}], ")"}]}], "]"}], "]"}], "/",
       "Degree"}], " ", "//", " ", "N"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Extracting", " ", "the", " ", "coefficients", " ", "from", " ", "an", " ",
     "LP"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LPtoMatrix", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LPtoMatrix", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LPtoMatrix", "[", 
    RowBox[{"obf_", ",", " ", "const_List", ",", " ", "var_List"}], "]"}], ":=",
    "\n", "    ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "zf", ",", " ", "coemat", ",", " ", "coebv", ",", " ", "greq", ",", " ",
        "lseq", ",", " ", "eqeq", ",", " ", "grout", ",", " ", "lsout", ",", 
       " ", "eqout", ",", " ", "ext1", ",", "\n", "       ", "ext2", ",", " ",
        "ext3", ",", " ", "bv01", ",", " ", "bv02", ",", " ", "bv03", ",", 
       " ", "nbv01", ",", " ", "bvec", ",", "ar", ",", "ps", ",", "rl"}], 
      "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"zf", " ", "=", " ", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"obf", ",", " ", "var"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "    ", 
       RowBox[{
        RowBox[{"ineq", " ", "=", " ", 
         RowBox[{"Simplify", "[", "const", "]"}]}], ";"}], " ", "*)"}], "\n", 
      "    ", 
      RowBox[{"coemat", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "var"}], "]"}], " ", 
         "&"}], " ", "/@", " ", "const"}]}], ";", "\n", "    ", 
      RowBox[{"coebv", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "const"}]}], ";", "\n", "    ", 
      RowBox[{"greq", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"const", ",", " ", "GreaterEqual"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"eqeq", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"const", ",", " ", "Equal"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lseq", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"const", ",", " ", "LessEqual"}], "]"}]}], ";", "\n", "    ", 
      
      RowBox[{"grout", " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "greq"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"eqout", " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "eqeq"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lsout", " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "lseq"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ext1", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"grout", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "grout", ",", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"coebv", ",", " ", "grout"}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"ext2", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"eqout", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "eqout", ",", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"coebv", ",", " ", "eqout"}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"ext3", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"lsout", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "lsout", ",", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"coebv", ",", " ", "lsout"}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"bv01", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ext1", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "ext1", ",", "\n", 
         "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", " ", 
                RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], "]"}], " ", "&"}], 
          " ", "/@", " ", "ext1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bv02", " ", "=", " ", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ext2", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "ext2", ",", " ", "\n", 
         "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", " ", 
                RowBox[{"{", "0", "}"}]}], "}"}]}], "]"}], "]"}], " ", "&"}], 
          " ", "/@", " ", "ext2"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bv03", " ", "=", " ", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ext3", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "ext3", ",", " ", "\n", 
         "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "]"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "ext3"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bv01", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bv01", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", "bv01", "}"}], ",", " ", "bv01"}], " ", "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"nbv01", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bv02", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "bv01", ",", " ", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"bv01", ",", " ", "bv02"}], "]"}], ";", " ", 
          RowBox[{"FlattenAt", "[", 
           RowBox[{"bv01", ",", 
            RowBox[{"Length", "[", "bv01", "]"}]}], "]"}]}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"nbv01", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bv03", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", "nbv01", ",", " ", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"nbv01", ",", " ", "bv03"}], "]"}], ";", " ", 
          RowBox[{"FlattenAt", "[", 
           RowBox[{"nbv01", ",", 
            RowBox[{"Length", "[", "nbv01", "]"}]}], "]"}]}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"bvec", " ", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"nbv01", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ar", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], " ", "&"}], ",", 
         RowBox[{"Length", "[", "bvec", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"grout", ",", "eqout", ",", "lsout"}], "}"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"rl", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps", ",", "bvec"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bvec", " ", "=", " ", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"ar", ",", "rl"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{"zf", ",", " ", "coemat", ",", " ", "bvec"}], "}"}]}]}], "\n", 
    "    ", "]"}]}], ";"}]}], "Code",ExpressionUUID->"48940638-ca66-490e-a723-\
253c67347d11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SolvePrimal", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SolvePrimal", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SolvePrimal", "[", 
    RowBox[{"zf_", ",", "eq_List", ",", "var_List", ",", " ", 
     RowBox[{"bd_", ":", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "LinearOptimization", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "obf", ",", " ", "cmat", ",", " ", "bvect", ",", " ", "res", ",", " ", 
       "nzf", ",", " ", "rl"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect"}], "}"}], " ", "=",
        " ", 
       RowBox[{"LPtoMatrix", "[", 
        RowBox[{"zf", ",", " ", "eq", ",", " ", "var"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"cmat", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "cmat", "]"}]}], ";", "\n", 
      RowBox[{"(*", "    ", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"LinearProgramming", "[", 
          RowBox[{
          "obf", ",", " ", "cmat", ",", " ", "bvect", ",", " ", "bd", ",", 
           "opts"}], "]"}]}], ";"}], " ", "*)"}], " ", 
      RowBox[{"(*", 
       RowBox[{"second", " ", "solution", 
        RowBox[{"??", "?"}]}], " ", "*)"}], "\n", "    ", 
      RowBox[{"bv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"First", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
        "bvect"}]}], ";", "\n", "    ", 
      RowBox[{"eqm", "=", 
       RowBox[{"cmat", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"beq", "=", 
       RowBox[{"bv", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "nzf"}], "}"}], "=", 
       RowBox[{"LinearOptimization", "[", 
        RowBox[{"obf", ",", 
         RowBox[{"{", 
          RowBox[{"cmat", ",", "bv"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "eqm", "}"}], ",", 
           RowBox[{"{", "beq", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<PrimalMinimizer\>\"", ",", " ", "\"\<PrimalMinimumValue\>\""}],
           "}"}], ",", 
         RowBox[{"Method", "->", "\"\<Automatic\>\""}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"rl", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"var", ",", " ", "res"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"{", "rl", "}"}], ",", " ", "nzf"}], "]"}]}]}], "\n", "    ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"78b82487-8562-4635-b210-\
6764e1dba5b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SolveDual", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SolveDual", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveDual", "[", 
    RowBox[{"zf_", ",", " ", "eq_List", ",", " ", "var_List", ",", " ", 
     RowBox[{"bd_", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "LinearOptimization", "]"}]}]}], "]"}], ":=",
    "\n", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "obf", ",", " ", "cmat", ",", " ", "bvect", ",", " ", "tobf", ",", " ", 
       "eqm", ",", " ", "beq", ",", " ", "res", ",", " ", "nzf", ",", " ", 
       "yvar", ",", " ", "dim", ",", "rl"}], "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect"}], "}"}], " ", "=",
        " ", 
       RowBox[{"LPtoMatrix", "[", 
        RowBox[{"zf", ",", "eq", ",", " ", "var"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"tobf", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "bvect"}]}], ";", "\n", "   ", 
      RowBox[{"eqm", "=", 
       RowBox[{"cmat", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"beq", "=", 
       RowBox[{"tobf", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"cmat", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "cmat", "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "nzf"}], "}"}], "=", 
       RowBox[{"LinearOptimization", "[", 
        RowBox[{"obf", ",", 
         RowBox[{"{", 
          RowBox[{"cmat", ",", 
           RowBox[{"-", "tobf"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "eqm", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "beq"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DualMaximizer\>\"", ",", " ", "\"\<DualMaximumValue\>\""}], 
          "}"}], ",", 
         RowBox[{"Method", "->", "\"\<Automatic\>\""}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"dim", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "cmat", "]"}]}], ";", "\n", "   ", 
      RowBox[{"yvar", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Global`y", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"First", "[", "dim", "]"}]}], "}"}]}], "]"}]}]}], ";", 
      "\n", "   ", 
      RowBox[{"rl", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"yvar", ",", " ", 
           RowBox[{"First", "[", "res", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"{", "rl", "}"}], ",", " ", "nzf"}], "]"}]}]}], "\n", "  ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"23827754-6faa-41f1-bead-\
a85b71f4c124"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Near", " ", "Ring"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NearRingQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"NearRingQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NearRingQ", "[", 
      RowBox[{"set_List", ",", "T1_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "boolval", "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"boolval", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Depth", "[", "set", "]"}], " ", "===", " ", "3"}], ",", 
           "  ", 
           RowBox[{"CheckNearRing", "[", 
            RowBox[{"set", ",", "set", ",", "T1"}], "]"}], ",", "\n", 
           "                    ", 
           RowBox[{
            RowBox[{"Depth", "[", "set", "]"}], " ", "===", " ", "4"}], ",", 
           "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"CheckNearRing", "[", 
              RowBox[{"#", ",", "#", ",", "T1"}], "]"}], " ", "&"}], " ", "/@",
             " ", "set"}], ",", "\n", "                    ", "True", ",", 
           " ", 
           RowBox[{"DisplayMessNearRing", "[", "set", "]"}]}], "]"}]}], ";", 
        "\n", "   ", 
        RowBox[{"Return", "[", "boolval", "]"}]}]}], "\n", "    ", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"1a6a18c5-7495-43eb-b55e-f5c308fcde35"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckNearRing", "[", 
    RowBox[{
    "Univers_List", ",", " ", "RestSet_List", ",", " ", "T2_", ",", " ", 
     RowBox[{"prevres_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fi", ",", " ", "restuni", ",", " ", "res", ",", " ", "allres"}], "}"}],
      ",", "\n", "    ", 
     RowBox[{
      RowBox[{"fi", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"RestSet", ",", " ", "1"}], "]"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"NearRingDef", "[", 
          RowBox[{"fi", ",", " ", "#", ",", " ", "T2", ",", " ", "Univers"}], 
          "]"}], " ", "&"}], " ", "/@", " ", "RestSet"}]}], ";", "\n", "    ", 
      RowBox[{"restuni", " ", "=", " ", 
       RowBox[{"Delete", "[", 
        RowBox[{"RestSet", ",", " ", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"allres", " ", "=", " ", 
       RowBox[{"FlattenAt", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", " ", "prevres"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Length", "[", "res", "]"}], " ", "+", " ", "1"}]}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "restuni", "]"}], " ", "===", " ", "0"}], ",",
         " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "allres"}], "]"}], ",", " ", "True", ",", 
        " ", "\n", "      ", 
        RowBox[{"CheckNearRing", "[", 
         RowBox[{
         "Univers", ",", " ", "restuni", ",", " ", "T2", ",", " ", "allres"}],
          "]"}]}], "]"}]}]}], "\n", "    ", "]"}]}], ";"}]], "Code",Expression\
UUID->"f44aac3a-051e-4ada-bc42-79f91d932b5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NearRingDef", "[", 
    RowBox[{"A_", ",", " ", "B_", ",", " ", "R1_", ",", "Univers_List"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"A", ",", " ", "B"}], "]"}], ",", "R1"}], "]"}], " ", "||", 
      " ", 
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"A", ",", " ", "B"}], "]"}], ",", " ", 
        RowBox[{"{", "}"}]}], "]"}], " ", "||", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"Univers", ",", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"A", ",", " ", "B"}], "]"}]}], "]"}], "]"}], " ", "!=", 
         " ", "0"}], " ", "&&", " ", "\n", "          ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"Univers", ",", " ", 
            RowBox[{"Intersection", "[", 
             RowBox[{"A", ",", " ", "B"}], "]"}]}], "]"}], "]"}], " ", "!=", 
         " ", "0"}]}], ")"}]}]}], "\n", "    ", "]"}]}], ";"}]], "Code",Expres\
sionUUID->"5425a80f-325e-404f-b298-3800f4459257"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DisplayMessNearRing", "[", "set_List", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Depth is equal to \>\"", ",", " ", 
       RowBox[{"Depth", "[", "set", "]"}]}], "]"}], ";", "\n", "      ", 
     RowBox[{
     "Print", "[", "\"\<The collection of sets must be of depth 3 or 4.\>\"", 
      "]"}], ";", "\n", "      ", 
     RowBox[{"Print", "[", "\"\<Usage: NearRi[set]\>\"", "]"}]}], ")"}]}], 
  ";"}]], "Code",ExpressionUUID->"3d967347-29a3-43af-b0f1-b0f91423f540"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Airport", " ", "Cost", " ", "Allocation", " ", "Problem"}], " ", 
   "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AirportProblem", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AirportProblem", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AirportProblem", "[", 
      RowBox[{"cost_List", ",", "nj_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmv", ",", "evc", ",", "clv"}], "}"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{"tmv", "=", 
         RowBox[{"Total", "[", "nj", "]"}]}], ";", " ", "\n", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Checking", " ", "if", " ", "the", " ", "game", " ", "is", " ", 
          "not", " ", "too", " ", 
          RowBox[{"large", "."}]}], " ", "*)"}], "\n", "   ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"LessEqual", "[", 
             RowBox[{
              RowBox[{"Total", "[", "nj", "]"}], ",", "48"}], "]"}], ",", 
            "True"}], "]"}], ",", "\t", "\n", "      ", 
          RowBox[{
           RowBox[{"evc", "=", 
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Array", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"cost", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "&"}], " ", ",", 
                  RowBox[{"nj", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "nj", "]"}]}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], ";", "\n", "      ", 
           RowBox[{"clv", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Subsets", "[", "evc", "]"}]}]}], ";", "\n", "      ", 
           RowBox[{"clv", " ", "/.", " ", 
            RowBox[{
             RowBox[{"clv", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", "0"}]}]}], ",", "\n", 
          "          ", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Game is too large! Should not exceed 48 Players!\>\"", "]"}],
            ";", "\n", "          ", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}], ";"}]}], "\n", "   ", "]"}]}]}], "\n", 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Market", " ", "Situation"}], "  ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"teilm", "[", "T_List", "]"}], ":=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", " ", "/@", " ", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", " ", 
              RowBox[{"{", "#1", "}"}]}], "}"}], " ", "&"}], ")"}], " ", "/@",
           " ", "T"}], ",", " ", "List"}], "]"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplementaryMarket", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ComplementaryMarket", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplementaryMarket", "[", 
      RowBox[{"T_List", ",", "P_List", ",", "Q_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "ComplementaryMarket", "]"}]}]}], 
      "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"em", ",", "param", ",", "coal", ",", "val"}], "}"}], ",", 
       "\n", "    ", 
       RowBox[{
        RowBox[{"em", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{"P", ",", "Q"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "em", "]"}], " ", "!=", " ", "0"}], ",", 
          " ", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<The sets P and Q are not disjoint.\>\"", "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "]"}]}], ",", "\n", "          ", "True", 
          ",", " ", "\n", "              ", 
          RowBox[{
           RowBox[{"param", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "MarketParameter", "]"}]}], ";", "  ",
            "\n", "              ", 
           RowBox[{"coal", " ", "=", " ", 
            RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "              ", 
           RowBox[{"val", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{"#", ",", " ", "P"}], "]"}], "]"}], ",", " ", 
                RowBox[{"a", " ", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{"#", ",", " ", "Q"}], "]"}], "]"}]}]}], "]"}], " ",
               "&"}], " ", "/@", " ", "coal"}]}], ";", "\n", "              ", 
           RowBox[{"val", " ", "/.", " ", 
            RowBox[{"a", " ", "->", " ", "param"}]}]}]}], "\n", "          ", 
         "]"}]}]}], "\n", "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->\
"1319daf4-5a88-4def-96ca-d40bb6b3aa3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Cost", " ", "Location", " ", "Game"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PQNorm", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PQNorm", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PQNorm", "[", 
      RowBox[{"liste_", ",", " ", "refliste_", ",", 
       RowBox[{"p_", ":", "2"}], ",", 
       RowBox[{"q_", ":", "1"}]}], "]"}], ":=", "\n", "          ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "liste", "]"}], " ", "==", " ", "3"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"PQNormDist", "[", 
          RowBox[{"#", ",", " ", "refliste", ",", "p", ",", "q"}], "]"}], " ",
          "&"}], " ", "/@", " ", "liste"}], ",", "\n", "                ", 
       RowBox[{
        RowBox[{"Depth", "[", "liste", "]"}], " ", "==", " ", "2"}], ",", " ", 
       RowBox[{"PQNormDist", "[", 
        RowBox[{"liste", ",", " ", "refliste", ",", "p", ",", "q"}], "]"}], 
       ",", "\n", "                ", "True", ",", 
       RowBox[{"DisplayPQNrm", "[", "liste", "]"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PQNormDist", "[", 
      RowBox[{"liste_", ",", " ", "refliste_", ",", 
       RowBox[{"p_", ":", "2"}], ",", 
       RowBox[{"q_", ":", "1"}]}], "]"}], ":=", " ", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"Total", "[", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"#1", " ", "-", " ", "#2"}], ",", " ", "p"}], "]"}], " ",
            "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"liste", ",", " ", "refliste"}], "}"}]}], "]"}], "]"}], 
       ",", " ", 
       RowBox[{"(", 
        RowBox[{"q", "/", "p"}], ")"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayPQNrm", "[", "liste_", "]"}], ":=", 
     RowBox[{"(", "\n", "       ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Depth is equal to \>\"", ",", 
         RowBox[{"Depth", "[", "liste", "]"}]}], "]"}], ";", "\n", "       ", 
       
       RowBox[{
       "Print", "[", "\"\<Usage: PQNorm[liste,refliste,p,q]\>\"", "]"}], ";", 
       "\n", "       ", 
       RowBox[{
       "Print", "[", 
        "\"\<Input format of the variable 'liste' is not correct.\>\"", "]"}],
        ";", "\n", "       ", 
       RowBox[{
       "Print", "[", "\"\<The variable 'liste' must be a list.\>\"", "]"}]}], 
      "\n", ")"}]}], ";"}]}]}]], "Code",ExpressionUUID->"b3755669-ca6b-4ff0-\
af72-1aa4d5b42bcb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CostLocationGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CostLocationGame", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CostLocationGame", "[", 
     RowBox[{"dmpts_", ",", " ", "refvc_", ",", 
      RowBox[{"p_", ":", "2"}], ",", 
      RowBox[{"q_", ":", "1"}], ",", 
      RowBox[{"fixed_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "st", ",", "nb", ",", "pos", ",", "smvc", ",", "cdco", ",", "tvc", ",",
         "avvc", ",", "objvl"}], "}"}], ",", "\n", "                 ", 
      RowBox[{
       RowBox[{"st", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"First", "[", 
          RowBox[{"Dimensions", "[", "dmpts", "]"}], "]"}], "]"}]}], ";", 
       "\n", "\t\t ", 
       RowBox[{"nb", "=", 
        RowBox[{"1", "+", 
         RowBox[{"Length", "[", "st", "]"}]}]}], ";", "\n", "\t\t ", 
       RowBox[{"pos", "=", 
        RowBox[{"Outer", "[", 
         RowBox[{"List", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", "st", "]"}], ",", "nb"}], "]"}]}], 
         "]"}]}], ";", "\n", "\t\t ", 
       RowBox[{"cdco", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", "pos"}]}],
        ";", "\n", "\t\t ", 
       RowBox[{"smvc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Extract", "[", 
            RowBox[{"dmpts", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", " ", 
         "pos"}]}], ";", "\n", "\t\t ", 
       RowBox[{"avvc", "=", 
        RowBox[{"smvc", "/", "cdco"}]}], ";", "\n", "\t\t ", 
       RowBox[{"tvc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"dmpts", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
         "pos"}]}], ";", "\n", "\t\t ", 
       RowBox[{"objvl", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PQNorm", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"tvc", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"avvc", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "p", ",", "q"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "avvc", "]"}]}], "}"}]}], "]"}]}]}], ";", 
       "\n", "\t\t ", 
       RowBox[{"PrependTo", "[", 
        RowBox[{"objvl", ",", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{"0", " ", "&"}], ",", 
           RowBox[{"nb", "-", "1"}]}], "]"}]}], "]"}], ";", "\n", "\t\t ", 
       RowBox[{"objvl", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", "objvl", "]"}], "+", "fixed"}]}], ";", "\n", 
       "\t\t ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PrependTo", "[", 
          RowBox[{"objvl", ",", "0"}], "]"}], ",", " ", "avvc", ",", " ", 
         RowBox[{"CostSavings", "[", 
          RowBox[{"objvl", ",", "st"}], "]"}]}], "}"}]}]}], "\n", 
     "\t\t\t\t  ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CostLocationGame", "[", 
    RowBox[{"dmpts_", ",", " ", "refvc_", ",", 
     RowBox[{"p_", ":", "2"}], ",", 
     RowBox[{"q_", ":", "1"}], ",", 
     RowBox[{"fixed_", ":", "0"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "CostLocationGame", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mthd", ",", "st", ",", "refpt", ",", "nrmlist", ",", "nb", ",", "pos", 
       ",", "objli", ",", "zeros", ",", "nonneg", ",", "slvprb", ",", 
       "optsol", ",", "objvl"}], "}"}], ",", "\n", "                ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", 
      "\t\t\t\t\t\t\t     ", "\n", "\t\t", 
      RowBox[{"st", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Dimensions", "[", "dmpts", "]"}], "]"}], "]"}]}], ";", "\n",
       "\t\t", 
      RowBox[{"refpt", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "refvc", "]"}], "]"}]}]}], ";", "\n", 
      "                ", 
      RowBox[{"nrmlist", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"PQNorm", "[", 
          RowBox[{"#", ",", "refpt", ",", "p", ",", "q"}], "]"}], " ", "&"}], 
        "/@", " ", 
        RowBox[{"N", "[", "dmpts", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"nb", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Length", "[", "st", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"pos", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "st", "]"}], ",", "nb"}], "]"}]}], "]"}]}],
       ";", "\n", "\t\t", 
      RowBox[{"objli", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{"nrmlist", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", " ",
         "pos"}]}], ";", "\n", "\t\t", 
      RowBox[{"zeros", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", " ", 
         RowBox[{"Length", "[", "refpt", "]"}]}], "]"}]}], ";", "\n", 
      "                ", 
      RowBox[{"nonneg", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"GreaterEqual", ",", 
           RowBox[{"{", 
            RowBox[{"refpt", ",", "zeros"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\n", "                ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"slvprb", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"NMinimize", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"{", "nonneg", "}"}], ",", "#"}], "]"}], ",", "refpt", 
             ",", 
             RowBox[{"Method", "->", "mthd"}]}], "]"}], " ", "&"}], "/@", " ",
           "objli"}]}], ";"}], "*)"}], "\n", "\t\t", 
      RowBox[{"slvprb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NArgMin", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"{", "nonneg", "}"}], ",", "#"}], "]"}], ",", "refpt", 
           ",", 
           RowBox[{"Method", "->", "mthd"}]}], "]"}], " ", "&"}], "/@", " ", 
        "objli"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"optsol", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          "slvprb"}]}], ";"}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{"optsol", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"refpt", ",", "#"}], "}"}]}], "]"}], " ", "&"}], "/@", 
        " ", "slvprb"}]}], ";", "\n", "\t\t", 
      RowBox[{"objvl", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"ReplaceAll", ",", 
         RowBox[{"{", 
          RowBox[{"objli", ",", "optsol"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"objvl", ",", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", " ", "&"}], ",", 
          RowBox[{"nb", "-", "1"}]}], "]"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"objvl", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", "objvl", "]"}], "+", "fixed"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PrependTo", "[", 
         RowBox[{"objvl", ",", "0"}], "]"}], ",", " ", 
        RowBox[{"refpt", " ", "/.", " ", "optsol"}], ",", " ", 
        RowBox[{"CostSavings", "[", 
         RowBox[{"objvl", ",", "st"}], "]"}]}], "}"}]}]}], "\n", "\t\t    ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"bc577c5b-a6d6-439b-8434-\
bcadda5a672a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CostSavings", "[", 
     RowBox[{"costvec_List", ",", "T_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "cs", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SetDelayed", "[", 
           RowBox[{
            RowBox[{"c", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], " ", 
          "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "costvec"}], "}"}]}],
         "]"}], ";", "\n", "  ", 
       RowBox[{"cs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
              "#"}], "]"}], " ", "-", " ", 
            RowBox[{"c", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "  ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"cs", ",", "1"}], "]"}]}], "}"}], "]"}]}]}], "\n", "  ", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "for", " ", "calling", " ", "different", " ", 
      RowBox[{"solvers", ".", "\n", "\n", "a1"}]}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\n", 
    RowBox[{"a2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], ";", "\n", 
    RowBox[{"a3", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], ";", "\n", 
    RowBox[{"xx", "=", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}]}], ";", "\n", 
    RowBox[{"dmpts", "=", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], ";", "\n", "\n", 
    RowBox[{"cval2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"CostLocationGame", "[", 
        RowBox[{"dmpts", ",", "xx", ",", "2", ",", "4", ",", 
         RowBox[{"5", "/", "24"}], ",", 
         RowBox[{"Method", "->", "#"}]}], "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Automatic\>\"", ",", " ", "\"\<NelderMead\>\"", ",", " ", 
        "\"\<DifferentialEvolution\>\"", ",", " ", 
        "\"\<SimulatedAnnealing\>\""}], "}"}]}]}]}], "\n", "\n", " ", "*)"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Product", " ", "Game"}], "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProductGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ProductGame", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProductGame", "[", "wghs_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlis", ",", "pval", ",", "chval", ",", "ylis", ",", "hdval"}],
        "}"}], ",", "\n", "\t   ", 
      RowBox[{
       RowBox[{"xlis", " ", "=", " ", 
        RowBox[{"Subsets", "[", "wghs", "]"}]}], ";", "\t\t      ", "\n", 
       "           ", 
       RowBox[{"pval", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
         "xlis"}]}], ";", " ", "\n", "           ", 
       RowBox[{"chval", "=", 
        RowBox[{"pval", "-", "1"}]}], ";", "\n", "\t   ", 
       RowBox[{"ylis", " ", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"wghs", "-", "1"}], "]"}]}], ";", "\n", "\t   ", 
       RowBox[{"hdval", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
         "ylis"}]}], ";", "\n", "\t   ", 
       RowBox[{"{", 
        RowBox[{"chval", ",", "hdval"}], "}"}]}]}], " ", 
     RowBox[{"(*", 
      RowBox[{
      "characteristic", " ", "values", " ", "and", " ", "Harsanyi", " ", 
       RowBox[{"dividends", "."}]}], "  ", "*)"}], "\n", "\t\t       ", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Probability", " ", "Game"}], "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbabilityGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ProbabilityGame", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProbabilityGame", "[", "wghs_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xlis", ",", "pval", ",", "chval"}], "}"}], ",", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"GreaterEqual", "[", 
              RowBox[{"#", ",", "0"}], "]"}], " ", "&"}], "/@", " ", 
            "wghs"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"LessEqual", "[", 
              RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], "/@", " ", 
            "wghs"}]}], "]"}]}], ",", "\n", "           ", 
        RowBox[{
         RowBox[{"xlis", " ", "=", " ", 
          RowBox[{"Subsets", "[", "wghs", "]"}]}], ";", "\n", "           ", 
         RowBox[{"pval", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"1", "-", "#"}]}], "]"}], " ", "&"}], "/@", " ", 
           "xlis"}]}], ";", "\n", "           ", 
         RowBox[{"chval", "=", 
          RowBox[{"1", "-", "pval"}]}]}], ",", 
        RowBox[{
        "Print", "[", "\"\<The weights must lie between zero and one.\>\"", 
         "]"}]}], "]"}]}], "\n", "\t\t       ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DualProbabilityGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DualProbabilityGame", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DualProbabilityGame", "[", "wghs_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xlis", ",", "pval", ",", "dpval", ",", "chval"}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GreaterEqual", "[", 
             RowBox[{"#", ",", "0"}], "]"}], " ", "&"}], "/@", " ", 
           "wghs"}]}], "]"}], " ", "&&", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"LessEqual", "[", 
             RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], "/@", " ", 
           "wghs"}]}], "]"}]}], ",", "\n", "           ", 
       RowBox[{
        RowBox[{"xlis", " ", "=", " ", 
         RowBox[{"Subsets", "[", "wghs", "]"}]}], ";", "\n", "           ", 
        RowBox[{"pval", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"1", "-", "#"}]}], "]"}], " ", "&"}], "/@", " ", 
          "xlis"}]}], ";", "\n", "\t   ", 
        RowBox[{"dpval", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"1", "-", "#"}]}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"Reverse", "[", "xlis", "]"}]}]}], ";", "\n", "           ", 
        RowBox[{"chval", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pval"}], ")"}], "*", "dpval"}]}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<The weights must lie between zero and one.\>\"", 
        "]"}]}], "]"}]}], "\n", "\t\t       ", "]"}]}], ";"}]}], "Code",Expres\
sionUUID->"ca7b0a0b-9209-469d-b29f-3e1aa36e6e98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Bankruptcy", " ", "Situation"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "S_List", "]"}], ":=", " ", 
     RowBox[{"Plus", " ", "@@", " ", 
      RowBox[{"x", " ", "/@", " ", "S"}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModestBankruptcy", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ModestBankruptcy", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModestBankruptcy", "[", 
      RowBox[{
       RowBox[{"E_", "?", "NumberQ"}], ",", "claims_List"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lc", ",", "T", ",", "asscl", ",", "compset", ",", "vecval"}],
         "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"lc", "=", 
         RowBox[{"Length", "[", "claims", "]"}]}], ";", "\n", "    ", 
        RowBox[{"T", "=", 
         RowBox[{"Range", "[", "lc", "]"}]}], ";", "\n", "    ", 
        RowBox[{"asscl", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "/@", " ", "T"}], ",", "claims"}], "}"}]}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"compset", " ", "=", " ", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Subsets", "[", "T", "]"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"vecval", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", " ", 
             RowBox[{"E", " ", "-", "  ", 
              RowBox[{"x", "[", "#", "]"}]}]}], "]"}], " ", "&"}], "/@", " ", 
          "compset"}]}], ";", " ", "\n", "    ", 
        RowBox[{"vecval", " ", "/.", "asscl"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GreedyBankruptcy", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GreedyBankruptcy", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GreedyBankruptcy", "[", 
      RowBox[{
       RowBox[{"E_", "?", "NumberQ"}], ",", "claims_List"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lc", ",", "T", ",", "asscl", ",", "vecval"}], "}"}], ",", 
       "\n", "    ", 
       RowBox[{
        RowBox[{"lc", "=", 
         RowBox[{"Length", "[", "claims", "]"}]}], ";", "\n", "    ", 
        RowBox[{"T", "=", 
         RowBox[{"Range", "[", "lc", "]"}]}], ";", "\n", "    ", 
        RowBox[{"asscl", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "/@", " ", "T"}], ",", "claims"}], "}"}]}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"vecval", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"E", ",", " ", 
             RowBox[{"x", "[", "#", "]"}]}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "    ", 
        RowBox[{"vecval", " ", "/.", "asscl"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ContestedGarment", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ContestedGarment", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ContestedGarment", "[", 
      RowBox[{
       RowBox[{"Estate_", "?", "NumberQ"}], ",", " ", "Claims_List"}], "]"}], 
     " ", ":=", " ", "\n", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "clset", ",", " ", "extdset", ",", " ", "award", ",", " ", "param"}], 
        "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"clset", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Claims", "]"}], " ", "===", " ", "2"}], 
           ",", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "#", "]"}], " ", "&"}], ",", " ", 
             RowBox[{"Range", "[", "2", "]"}]}], "]"}], ",", " ", 
           RowBox[{"ErrorMessage", ";", " ", 
            RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"extdset", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"clset", ",", " ", 
           RowBox[{"Reverse", "[", "clset", "]"}]}], "}"}]}], ";", "\n", 
        "    ", 
        RowBox[{"award", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"E", " ", "-", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"0", ",", " ", 
                  RowBox[{"E", " ", "-", " ", "#1"}]}], "]"}], " ", "-", " ", 
                
                RowBox[{"Max", "[", 
                 RowBox[{"0", ",", " ", 
                  RowBox[{"E", " ", "-", " ", "#2"}]}], "]"}]}], ")"}], "/", 
              "2"}], "  ", "+", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", " ", 
               RowBox[{"E", " ", "-", " ", "#2"}]}], "]"}]}], " ", "&"}], ",",
            " ", "extdset"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"param", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"E", ",", " ", 
               RowBox[{"clset", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"clset", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"Estate", ",", " ", 
               RowBox[{"Claims", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"Claims", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
        ";", "\n", "    ", 
        RowBox[{"award", " ", "/.", " ", "param"}]}]}], "\n", "    ", "]"}]}],
     ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ErrorMessage", " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<The Contested Garment Problem is a two-Creditor Bankruptcy \
Problem.\>\"", "]"}], ";", "\n", "      ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<A Claims List of the Length of two is expexted like: \>\"", ",", 
         " ", "\"\<{d1,d2}\>\""}], "]"}], ";"}], ")"}]}], ";"}]}]}]], "Code",E\
xpressionUUID->"3976d590-2857-4eea-96f4-74922db24463"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TalmudicRule", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"TalmudicRule", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TalmudicRule", "[", 
    RowBox[{
     RowBox[{"Estate_", "?", "NumberQ"}], ",", " ", "Claims_List"}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "clvar", ",", " ", "sumcl", ",", " ", "param", ",", " ", "eqsys", ",", 
       " ", "nclsum", ",", "sol", ",", " ", "sol01"}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"clvar", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], ",", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "Claims", "]"}], "]"}]}], "]"}]}], ";", "\n",
       "    ", 
      RowBox[{"sumcl", " ", "=", " ", 
       RowBox[{"Total", "[", " ", "clvar", "]"}]}], ";", "\n", "    ", 
      RowBox[{"param", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"clvar", ",", " ", "Claims"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"nclsum", " ", "=", " ", 
       RowBox[{"sumcl", " ", "/.", " ", "param"}]}], ";", "\n", "    ", 
      RowBox[{"eqsys", " ", "=", " ", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Greater", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", "nclsum"}], ",", " ", 
           "Estate"}], "]"}], ",", " ", "\n", "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"\[Lambda]", ",", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "#"}]}], "]"}], " ", 
           "&"}], " ", "/@", " ", "Claims"}], ",", " ", "\n", "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", " ", "-", " ", "\[Lambda]"}], ")"}], ",", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "#"}]}], "]"}], " ", 
           "&"}], " ", "/@", " ", "Claims"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"Reduce", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", " ", "eqsys", "]"}], " ", "==", " ", 
          "Estate"}], ",", " ", "\[Lambda]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"sol01", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "\[Lambda]", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"eqsys", " ", "/.", " ", "sol01"}]}]}], "\n", "    ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"a8a1daf2-de42-484f-97f3-0041a529afc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Assignment", " ", "Problem"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"User", " ", "interface"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GenProfitMatrix", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GenProfitMatrix", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenProfitMatrix", "[", 
      RowBox[{"valOfbuyers_List", ",", " ", "valOfsellers_List"}], "]"}], " ",
      ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prfij", ",", "valmat"}], "}"}], ",", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Dimensions", "[", "valOfsellers", "]"}], "]"}], ",", 
           RowBox[{"First", "[", 
            RowBox[{"Dimensions", "[", "valOfbuyers", "]"}], "]"}]}], "]"}], 
         ",", "\n", "    ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"VectorQ", "[", "valOfbuyers", "]"}], ",", "True"}], 
            "]"}], ",", "\n", "                   ", 
           RowBox[{
            RowBox[{"valmat", " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"valOfbuyers", " ", "-", " ", "#"}], " ", "&"}], ",", 
               " ", "valOfsellers"}], "]"}]}], ";", "\n", 
            "                   ", 
            RowBox[{"prfij", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"0", ",", "#"}], "]"}], "&"}], ",", "#"}], "]"}], 
               " ", "&"}], " ", "/@", " ", "valmat"}]}], ";", " ", "\n", 
            "                   ", 
            RowBox[{"Transpose", "[", "prfij", "]"}]}], ",", "\n", 
           "                 ", 
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"MatrixQ", "[", "valOfbuyers", "]"}], ",", "True"}], 
            "]"}], ",", "\n", "                    ", 
           RowBox[{
            RowBox[{"valmat", "=", 
             RowBox[{"valOfbuyers", " ", "-", " ", "valOfsellers"}]}], ";", 
            "\n", "                    ", 
            RowBox[{"prfij", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"0", ",", "#"}], "]"}], "&"}], ",", "#"}], "]"}], 
               " ", "&"}], " ", "/@", " ", "valmat"}]}]}], ",", " ", "\n", 
           "                 ", "True", ",", "  ", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<Valuation of buyers is neither a vector nor a matrix.\>\"", 
             "]"}], ";"}]}], "\n", "       ", "]"}], ",", " ", "\n", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Input data format is not correct. It must be symmetric.\>\"", 
           "]"}], ";", "\n", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Valuation of buyers must be a vector or a matrix of \
dimension: \>\"", ",", " ", 
            RowBox[{"First", "[", 
             RowBox[{"Dimensions", "[", "valOfsellers", "]"}], "]"}]}], " ", 
           "]"}], ";"}]}], "\n", "    ", "]"}]}], "\n", "  ", "]"}]}], ";"}], 
   "\n"}]}]], "Code",ExpressionUUID->"4b0d062f-e62c-4074-a089-410e3ae3360b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AssignmentProblem", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AssignmentProblem", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssignmentProblem", "[", 
     RowBox[{
     "buyers_List", ",", " ", "sellers_List", ",", " ", "profmat_List", ",", 
      " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AssignmentProblem", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bplayer", ",", " ", "splayer", ",", " ", "extprofmat"}], 
       "}"}], ",", " ", "\n", "     ", 
      RowBox[{
       RowBox[{"vrb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Verbose", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "buyers", "]"}], " ", ">=", " ", 
          RowBox[{"First", "[", "sellers", "]"}]}], ",", " ", 
         RowBox[{"MessIdenticalPlayerSet", ";"}], ",", "\n", 
         "                       ", "True", ",", " ", "\n", 
         "                       ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"bplayer", ",", " ", "splayer", ",", " ", "extprofmat"}], 
            "}"}], " ", "=", "  ", "\n", "                             ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "buyers", "]"}], " ", "!=", " ", 
              RowBox[{"Length", "[", "sellers", "]"}]}], ",", " ", "\n", 
             "                                    ", 
             RowBox[{
             "MessInsertDummy", ";", "\n", 
              "                                    ", 
              RowBox[{"ExtAssProb", "[", 
               RowBox[{"buyers", ",", " ", "sellers", ",", " ", "profmat"}], 
               "]"}]}], ",", " ", "\n", "                              ", 
             RowBox[{"{", 
              RowBox[{"buyers", ",", " ", "sellers", ",", " ", "profmat"}], 
              "}"}]}], "]"}]}], ";", "\n", "                       ", 
          RowBox[{"AssignmentVal", "[", 
           RowBox[{
           "bplayer", ",", " ", "splayer", ",", " ", "extprofmat", ",", " ", 
            "opts"}], "]"}]}]}], "\n", "                                 ", 
        "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MessIdenticalPlayerSet", " ", ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", " ", 
       "\"\<The set of buyers and sellers is identical.\>\"", "]"}], ";", 
      "\n", "      ", 
      RowBox[{
      "Print", "[", "\"\<Or the set of buyers and sellers is mixed up.\>\"", 
       "]"}], ";", "\n", "      ", 
      RowBox[{
      "Print", "[", "\"\<Rename at least the set of sellers\>\"", "]"}], ";", 
      "\n", "      ", 
      RowBox[{
      "Print", "[", 
       "\"\<Or put the set of buyers and sellers in correct order.\>\"", 
       "]"}]}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MessInsertDummy", ":=", 
    RowBox[{
    "Print", "[", 
     "\"\<Inserting dummy buyers/sellers to extend the asymmetric assignment \
problem into a symmetric one. \>\"", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtAssProb", "[", 
     RowBox[{
     "buyers_List", ",", " ", "sellers_List", ",", " ", "profmat_List"}], 
     "]"}], " ", ":=", " ", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newby", ",", " ", "newsel", ",", " ", "extmat"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newby", ",", " ", "newsel"}], "}"}], " ", "=", " ", 
        RowBox[{"NewPlayerSet", "[", 
         RowBox[{"buyers", ",", " ", "sellers"}], "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"extmat", " ", "=", " ", 
        RowBox[{"FillMatrix", "[", "profmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"{", 
        RowBox[{"newby", ",", " ", "newsel", ",", " ", "extmat"}], "}"}]}]}], 
     "\n", "   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NewPlayerSet", "[", 
    RowBox[{"buyers_List", ",", " ", "sellers_List"}], "]"}], " ", ":=", " ", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bplayer", ",", " ", "splayer"}], "}"}], ",", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "buyers", "]"}], " ", ">", " ", 
        RowBox[{"Length", "[", "sellers", "]"}]}], ",", 
       "                                                      ", 
       RowBox[{
        RowBox[{
         RowBox[{"\\\n", "                         ", "splayer"}], " ", "=", 
         " ", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "buyers", "]"}], " ", "+", " ", "1"}], ",",
            " ", 
           RowBox[{"2", 
            RowBox[{"Length", "[", "buyers", "]"}]}]}], "]"}]}], ";", " ", 
        RowBox[{"{", 
         RowBox[{"buyers", ",", " ", "splayer"}], "}"}]}], ",", "\n", 
       "                  ", 
       RowBox[{
        RowBox[{"Length", "[", "buyers", "]"}], " ", "<", " ", 
        RowBox[{"Length", "[", "sellers", "]"}]}], ",", " ", "\n", 
       "                        ", 
       RowBox[{
        RowBox[{"bplayer", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "[", "sellers", "]"}]}], "]"}]}], ";", "  ", 
        "\n", "                        ", 
        RowBox[{"splayer", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "bplayer", "]"}], " ", "+", " ", "1"}], 
           ",", " ", 
           RowBox[{"2", 
            RowBox[{"Length", "[", "bplayer", "]"}]}]}], "]"}]}], ";", " ", 
        "\n", "                       ", 
        RowBox[{"{", 
         RowBox[{"bplayer", ",", " ", "splayer"}], "}"}]}], ",", " ", "\n", 
       "                 ", "True", ",", " ", 
       RowBox[{"{", 
        RowBox[{"buyers", ",", " ", "sellers"}], "}"}]}], "\n", 
      "            ", "]"}]}], "\n", "    ", "]"}]}], ";"}]}], "Code",Expressi\
onUUID->"e8425e8f-952c-4628-aa97-7154b830a919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FillMatrix", "[", "profmat_List", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dm", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dm", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "profmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dm", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
          RowBox[{"dm", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"ClmsFillZeros", "[", 
          RowBox[{"profmat", ",", " ", 
           RowBox[{"dm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"dm", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
         "                 ", 
         RowBox[{
          RowBox[{"dm", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
          RowBox[{"dm", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"RwsFillZeros", "[", 
          RowBox[{"profmat", ",", " ", 
           RowBox[{"dm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"dm", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
         "                 ", "True", ",", " ", "profmat"}], "\n", "      ", 
        "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ClmsFillZeros", "[", 
     RowBox[{"profmat_List", ",", " ", "rws_", ",", " ", "clms_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zromat", ",", " ", "nwmat"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"zromat", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "rws"}], "}"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"rws", " ", "-", " ", "clms"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"nwmat", " ", "=", " ", 
        RowBox[{"FlattenAt", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "profmat", "]"}], ",", " ", "zromat"}], 
           "]"}], ",", " ", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Transpose", "[", "nwmat", "]"}]}]}], "\n", "    ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RwsFillZeros", "[", 
    RowBox[{"profmat_List", ",", " ", "rws_", ",", " ", "clms_"}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zromat", ",", " ", "nwmat"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"zromat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "clms"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"clms", " ", "-", " ", "rws"}]}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"nwmat", " ", "=", " ", 
       RowBox[{"FlattenAt", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"profmat", ",", " ", "zromat"}], "]"}], ",", " ", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", "nwmat"}]}], "\n", 
    "    ", "]"}]}], ";"}]}], "Code",ExpressionUUID->"ae17d0a7-7fe8-46e0-98a0-\
95f59281edfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssignmentVal", "[", 
     RowBox[{
     "bplayer_List", ",", " ", "splayer_List", ",", " ", "assmat_List", ",", 
      " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AssignmentProblem", "]"}]}]}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cmg", ",", "matchpl", ",", "T1"}], "}"}], ",", "\n", "     ", 
      
      RowBox[{
       RowBox[{"vrb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Verbose", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Clear", "[", "T1", "]"}], ";", "\n", "    ", 
       RowBox[{"T1", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"bplayer", ",", " ", "splayer"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"cmg", " ", "=", " ", 
        RowBox[{"Teilmg", "[", "T1", "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SubSetQ", "[", 
            RowBox[{"#", ",", " ", "bplayer"}], "]"}], ",", " ", 
           RowBox[{"Set", "[", 
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], ",", " ", "0"}], "]"}], ",", "\n", 
           "                  ", 
           RowBox[{"SubSetQ", "[", 
            RowBox[{"#", ",", " ", "splayer"}], "]"}], ",", " ", 
           RowBox[{"Set", "[", 
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], ",", " ", "0"}], "]"}], ",", "\n", 
           "                  ", "True", ",", " ", 
           RowBox[{
            RowBox[{"matchpl", " ", "=", " ", 
             RowBox[{"MatchPairs", "[", 
              RowBox[{
              "bplayer", ",", " ", "splayer", ",", "#", ",", " ", "opts"}], 
              "]"}]}], ";", "\n", "                        ", 
            RowBox[{"MaxProfit", "[", 
             RowBox[{
             "matchpl", ",", " ", "assmat", ",", " ", "bplayer", ",", " ", 
              "splayer", ",", " ", "opts"}], "]"}]}]}], "]"}], " ", "&"}], 
        " ", "/@", " ", "cmg"}]}]}], " ", "\n", "    ", "]"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Borrowed", " ", "from", " ", 
    RowBox[{"M", ".", " ", "Carter"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Teilmg", "[", "T_List", "]"}], " ", ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", " ", "/@", " ", 
      RowBox[{"Distribute", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "#", "}"}]}], "}"}], " ", "&"}], " ", "/@", " ", 
         "T"}], ",", " ", "List"}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Main", " ", "functions", " ", "to", " ", "compute", " ", "the", " ", 
    "characteristic", " ", "function", " ", "values", " ", "for", " ", "an", 
    " ", "Assignment", " ", 
    RowBox[{"game", "."}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MatchPairs", "[", " ", 
    RowBox[{
    "bplayer_List", ",", " ", "splayer_List", ",", " ", "subst_List", ",", 
     " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AssignmentProblem", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vrb", ",", "intcob", ",", " ", "intcos", ",", " ", "permcb", ",", " ", 
       "extcob", ",", " ", "extcos", ",", " ", "mptprs", ",", "rvmp"}], "}"}],
      ",", "\n", "  ", 
     RowBox[{
      RowBox[{"vrb", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Verbose", "]"}]}], ";", "\n", "  ", 
      RowBox[{"intcob", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{"subst", ",", " ", "bplayer"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"intcos", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{"subst", ",", " ", "splayer"}], "]"}]}], ";", "\n", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", "\n", "  ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<intcob=\>\"", ",", "intcob"}], "]"}], ";", "  ", "\n", 
         "  ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<intcos=\>\"", ",", "intcos"}], "]"}], ";"}], ",", "\n",
         "  ", "True"}], "]"}], ";", "\n", "  ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "intcob", "]"}], " ", ">", " ", 
         RowBox[{"Length", "[", "intcos", "]"}]}], ",", " ", "\n", "      ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "intcos", "]"}], " ", "===", " ", "1"}], 
          ",", " ", "\n", "                    ", 
          RowBox[{
           RowBox[{"extcos", " ", "=", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{"intcos", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"Length", "[", "intcob", "]"}]}], "}"}]}], "]"}], 
             "]"}]}], ";", " ", "\n", "                    ", 
           RowBox[{"mptprs", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"{", 
               RowBox[{"intcob", ",", " ", "extcos"}], "}"}]}], "]"}]}], ";", 
           "\n", "                     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"vrb", " ", "===", " ", "True"}], ",", "  ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<mptprs=\>\"", ",", " ", "mptprs"}], "]"}], ";"}], 
             ",", "True"}], "]"}], ";", "\n", "                    ", 
           RowBox[{"Split", "[", 
            RowBox[{"mptprs", ",", " ", 
             RowBox[{"Length", "[", "mptprs", "]"}]}], "]"}]}], ",", "\n", 
          "             ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"extcob", ",", "extcos"}], "}"}], " ", "=", "  ", 
            RowBox[{"ExtPlayerSet", "[", 
             RowBox[{"intcob", ",", " ", "intcos"}], "]"}]}], ";", "\n", 
           "     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcob=\>\"", ",", " ", "extcob"}], "]"}], ";", 
              "  ", "\n", "         ", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcos=\>\"", ",", " ", "extcos"}], "]"}], ";"}], 
             ",", "\n", "         ", "True"}], "]"}], ";", "\n", "        ", 
           RowBox[{"mptprs", " ", "=", " ", 
            RowBox[{"MatchingPairs", "[", 
             RowBox[{"extcos", ",", " ", "extcob"}], "]"}]}], ";", "\n", 
           "       ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"vrb", ",", "True"}], "]"}], ",", "  ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<mptprs=\>\"", ",", " ", "mptprs"}], "]"}], ";"}], 
             ",", "True"}], "]"}], ";", "\n", "       ", 
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], ",", "#"}], 
              "]"}], " ", "&"}], " ", "/@", " ", "mptprs"}]}]}], " ", "]"}], 
        ",", "\n", "    ", 
        RowBox[{
         RowBox[{"Length", "[", "intcob", "]"}], " ", "<", " ", 
         RowBox[{"Length", "[", "intcos", "]"}]}], ",", " ", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "intcob", "]"}], " ", "===", " ", "1"}], 
          ",", " ", "\n", "               ", 
          RowBox[{
           RowBox[{"extcob", " ", "=", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{"intcob", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"Length", "[", "intcos", "]"}]}], "}"}]}], "]"}], 
             "]"}]}], ";", " ", "\n", "               ", 
           RowBox[{"mptprs", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"{", 
               RowBox[{"intcos", ",", " ", "extcob"}], "}"}]}], "]"}]}], ";", 
           " ", "\n", "               ", 
           RowBox[{"rvmp", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
             "mptprs"}]}], ";", "\n", "              ", 
           RowBox[{"Split", "[", 
            RowBox[{"rvmp", ",", " ", 
             RowBox[{"Length", "[", "rvmp", "]"}]}], "]"}]}], ",", "\n", 
          "         ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"extcob", ",", "extcos"}], "}"}], " ", "=", "  ", 
            RowBox[{"ExtPlayerSet", "[", 
             RowBox[{"intcob", ",", " ", "intcos"}], "]"}]}], ";", "\n", 
           "     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcob=\>\"", ",", " ", "extcob"}], "]"}], ";", 
              "  ", "\n", "         ", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcos=\>\"", ",", " ", "extcos"}], "]"}], ";"}], 
             ",", "\n", "         ", "True"}], "]"}], ";", "\n", "        ", 
           RowBox[{"MatchingPairs", "[", 
            RowBox[{"extcob", ",", " ", "extcos"}], "]"}]}]}], "]"}], ",", 
        "\n", "    ", 
        RowBox[{
         RowBox[{"Length", "[", "intcob", "]"}], " ", "==", " ", 
         RowBox[{"Length", "[", "intcos", "]"}]}], ",", " ", "\n", "        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "intcob", "]"}], " ", "===", " ", "1"}], 
          ",", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"intcob", ",", " ", "intcos"}], "}"}], "]"}], ",", "\n", 
          "                      ", 
          RowBox[{
           RowBox[{"Length", "[", "intcob", "]"}], " ", "===", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Union", "[", 
               RowBox[{"bplayer", ",", " ", "splayer"}], "]"}], "]"}], "/", 
             "2"}], ")"}]}], ",", "  ", "\n", "                           ", 
          RowBox[{
           RowBox[{"permcb", " ", "=", " ", 
            RowBox[{"Permutations", "[", "intcob", "]"}]}], ";", "\n", 
           "                          ", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"List", ",", " ", 
               RowBox[{"{", 
                RowBox[{"#", ",", " ", "intcos"}], "}"}]}], "]"}], " ", "&"}],
             " ", "/@", " ", "permcb"}]}], ",", "\n", "                    ", 
          "True", ",", "\n", "                        ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"extcob", ",", "extcos"}], "}"}], " ", "=", "  ", 
            RowBox[{"ExtPlayerSet", "[", 
             RowBox[{"intcob", ",", " ", "intcos"}], "]"}]}], ";", "\n", 
           "                     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", "\n", 
             "                        ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcob=\>\"", ",", " ", "extcob"}], "]"}], ";", 
              "  ", "\n", "                        ", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<extcos=\>\"", ",", " ", "extcos"}], "]"}], ";"}], 
             ",", "\n", "                         ", "True"}], "]"}], ";", 
           "\n", "                       ", 
           RowBox[{"mptprs", " ", "=", " ", 
            RowBox[{"MatchingPairs", "[", 
             RowBox[{"extcos", ",", " ", "extcob"}], "]"}]}], ";", "\n", 
           "                     ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"vrb", ",", "True"}], "]"}], ",", "  ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<mptprs=\>\"", ",", " ", "mptprs"}], "]"}], ";"}], 
             ",", "True"}], "]"}], ";", "\n", "                            ", 
           
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], ",", "#"}], 
              "]"}], " ", "&"}], " ", "/@", " ", "mptprs"}]}]}], " ", "]"}]}],
        "\n", "    ", "]"}]}]}], "\n", "  ", "]"}]}], ";"}]}], "Code",Expressi\
onUUID->"f6d760df-284b-4751-9340-0097aea69674"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtPlayerSet", "[", 
     RowBox[{"intcob_List", ",", "intcos_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"extcob", ",", "extcos"}], "}"}], ",", "\n", "              ", 
      
      RowBox[{
       RowBox[{"extcob", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"intcob", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "2"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
       "              ", 
       RowBox[{"extcos", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"intcos", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "2"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
       "              ", 
       RowBox[{"{", 
        RowBox[{"extcob", ",", "extcos"}], "}"}]}]}], "\n", "             ", 
     "\n", "]"}]}], ";"}], "\n"}]], "Code",ExpressionUUID->"c488f98a-37ba-\
4171-9fdd-b373d1e4d0d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatchingPairs", "[", 
    RowBox[{"extbuyer_List", ",", " ", "extseller_List"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tkmin", ",", " ", "nwsl", ",", " ", "nwbuy", ",", "mptab"}], 
      "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"tkmin", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Length", "[", "extbuyer", "]"}], ",", " ", 
         RowBox[{"Length", "[", "extseller", "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"nwsl", " ", "=", "  ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"extseller", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "  ", 
             RowBox[{"i", " ", "+", " ", 
              RowBox[{"(", 
               RowBox[{"tkmin", "/", "2"}], ")"}], " ", "-", " ", "1"}]}], 
            "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "extseller", "]"}], "/", "2"}], ")"}]}], 
          "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"nwbuy", " ", "=", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OddQ", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "extbuyer", "]"}], "/", "2"}], ")"}], 
           "]"}], " ", "===", " ", "True"}], ",", " ", "\n", "        ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"extbuyer", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "  ", 
               RowBox[{"i", " ", "+", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "[", "extbuyer", "]"}], "/", "2"}], ")"}],
                 " ", "-", " ", "1"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "extbuyer", "]"}], "/", "2"}], ")"}]}], 
            "}"}]}], "]"}], ",", " ", "\n", "        ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"extbuyer", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"i", " ", "+", " ", 
                RowBox[{"(", 
                 RowBox[{"tkmin", "/", "2"}], ")"}], "-", "1"}]}], "}"}]}], 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "extbuyer", "]"}], "/", "2"}], ")"}]}], 
            "}"}]}], "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"mptab", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"List", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nwbuy", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "}"}]}], 
            "]"}], " ", "&"}], " ", "/@", " ", "nwsl"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "nwbuy", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"Apply", "[", 
       RowBox[{"Join", ",", " ", "mptab"}], "]"}]}]}], "\n", "    ", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"8af8fab2-631a-449e-a708-8e87c2d10958"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxProfit", "[", 
     RowBox[{
     "matchli_List", ",", " ", "assmat_List", ",", " ", "bplayer_List", ",", 
      " ", "splayer_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AssignmentProblem", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vrb", ",", "matchmat", ",", " ", "profitmat", ",", " ", "profitli"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"vrb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Verbose", "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<matpl=\>\"", ",", " ", "matchli"}], "]"}], ";"}], ",",
          " ", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"Clear", "[", "Global`beta", "]"}], ";", "\n", "    ", 
       RowBox[{"matchmat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"List", "[", 
            RowBox[{"#", ",", "splayer"}], "]"}], "]"}], " ", "&"}], " ", "/@",
          " ", "bplayer"}]}], ";", " ", "\n", "    ", 
       RowBox[{"profitmat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Global`beta", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@",
          " ", "matchmat"}]}], ";", "\n", "    ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Set", "[", 
           RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"profitmat", ",", " ", "assmat"}], "}"}]}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"profitli", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "matchli", "]"}], " ", "===", " ", "2"}], 
          ",", " ", 
          RowBox[{"Global`beta", "[", "matchli", "]"}], " ", ",", "\n", 
          "                                    ", 
          RowBox[{
           RowBox[{"Depth", "[", "matchli", "]"}], " ", "===", " ", "3"}], 
          ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Global`beta", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", 
           RowBox[{"{", "matchli", "}"}]}], ",", "\n", 
          "                                    ", 
          RowBox[{
           RowBox[{"Depth", "[", "matchli", "]"}], " ", "===", " ", "5"}], 
          ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Global`beta", "[", "#", "]"}], " ", "&"}], " ", "/@",
                " ", 
               RowBox[{"matchli", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"Length", "[", 
                 RowBox[{"matchli", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", 
              RowBox[{"Length", "[", "matchli", "]"}]}], "}"}]}], "]"}], ",", 
          "\n", "                                    ", "True", ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Global`beta", "[", "#", "]"}], " ", "&"}], " ", "/@", 
             " ", 
             RowBox[{"matchli", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Length", "[", "matchli", "]"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"vrb", ",", "True"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<prfli=\>\"", ",", " ", "profitli"}], "]"}], ";"}], 
         ",", " ", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "matchli", "]"}], " ", "<=", " ", "3"}], ",", 
         " ", 
         RowBox[{"Max", "[", 
          RowBox[{"Total", "[", " ", "profitli", "]"}], "]"}], ",", " ", "\n",
          "                 ", 
         RowBox[{
          RowBox[{"Depth", "[", "matchli", "]"}], " ", "===", " ", "5"}], ",",
          " ", 
         RowBox[{"Max", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", " ", "#", "]"}], " ", "&"}], " ", "/@", 
             " ", 
             RowBox[{"profitli", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Length", "[", "profitli", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", " ", "\n", "                 ", "True", ",", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", " ", "#", "]"}], " ", "&"}], " ", "/@", " ",
            "profitli"}], "]"}]}], "]"}]}]}], "\n", "    ", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Euclidean", " ", "Distance"}], ",", " ", 
    RowBox[{"Spelling", " ", "Euclidian", " ", "is", " ", "not", " ", 
     RowBox[{"protected", "!"}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EuclidianDistance", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"EuclidianDistance", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EuclidianDistance", "[", 
     RowBox[{"liste_", ",", "refliste_"}], "]"}], ":=", "\n", "          ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Depth", "[", "liste", "]"}], " ", "==", " ", "3"}], ",", " ", 
      
      RowBox[{
       RowBox[{
        RowBox[{"EuclidianDist", "[", 
         RowBox[{"#", ",", " ", "refliste"}], "]"}], " ", "&"}], " ", "/@", 
       " ", "liste"}], ",", "\n", "                ", 
      RowBox[{
       RowBox[{"Depth", "[", "liste", "]"}], " ", "==", " ", "2"}], ",", " ", 
      
      RowBox[{"EuclidianDist", "[", 
       RowBox[{"liste", ",", " ", "refliste"}], "]"}], ",", "\n", 
      "                ", "True", ",", 
      RowBox[{"DisplayEuk", "[", "liste", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EuclidianDist", "[", 
     RowBox[{"liste_", ",", " ", "refliste_"}], "]"}], " ", ":=", " ", 
    RowBox[{"N", "[", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"Total", "[", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"#1", " ", "-", " ", "#2"}], ",", " ", "2"}], "]"}], " ",
            "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"liste", ",", " ", "refliste"}], "}"}]}], "]"}], "]"}], 
       ",", " ", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}], "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayEuk", "[", "liste_", "]"}], ":=", 
   RowBox[{"(", "\n", "       ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Depth is equal to \>\"", ",", 
       RowBox[{"Depth", "[", "liste", "]"}]}], "]"}], ";", "\n", "       ", 
     RowBox[{
     "Print", "[", "\"\<Usage: EuclidianDistance[liste,refliste]\>\"", "]"}], 
     ";", "\n", "       ", 
     RowBox[{
     "Print", "[", 
      "\"\<Input format of the variable 'liste' is not correct.\>\"", "]"}], 
     ";", "\n", "       ", 
     RowBox[{
     "Print", "[", "\"\<The variable 'liste' must be a list.\>\"", "]"}]}], 
    "\n", ")"}]}], ";"}]}], "Code",ExpressionUUID->"11687734-ae14-4ee1-b10f-4c259efb7e5b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Assigning", " ", "symmetric", " ", "values"}], " ", "*)"}]], "Code",\
ExpressionUUID->"e3d6382a-d55b-454f-aa15-a9002c2c83b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AssignValues", "[", 
    RowBox[{"univers_List", ",", " ", "alp_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "      ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "alp", "]"}], " ", "!=", " ", "0"}], ",", "\n",
        "        ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "univers", "]"}], " ", "===", " ", 
          RowBox[{"First", "[", "alp", "]"}]}], ",", " ", "Global`\[Alpha]", 
         ",", " ", "\n", "          ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "univers", "]"}], "]"}], " ", "<=", " ", 
          "4"}], ",", " ", "Global`\[Lambda]", ",", " ", "True", ",", " ", 
         "Global`\[Sigma]"}], "]"}], ",", "\n", "                          ", 
       "True", ",", "\n", "        ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "univers", "]"}], "]"}], " ", "==", "  ", 
          "5"}], ",", "Global`\[Theta]", ",", "\n", "          ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "univers", "]"}], "]"}], " ", "==", "  ", 
          "6"}], ",", " ", "Global`\[Phi]", ",", "\n", "          ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"First", "[", "univers", "]"}], "]"}], " ", ">=", " ", 
          "7"}], ",", " ", "\n", "          ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"First", "[", "univers", "]"}], "]"}], " ", "===", " ", 
            "7"}], ",", " ", "Global`\[Beta]", ",", " ", "\n", "            ", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"First", "[", "univers", "]"}], "]"}], " ", "=", " ", 
            "Global`\[Gamma]"}]}], "]"}], ",", " ", "True", ",", " ", 
         "Global`\[Sigma]"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Code",Expres\
sionUUID->"a07c02ed-0d74-4c4a-bb83-f5242a9ec5e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Coal2Dec", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Coal2Dec", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Coal2Dec", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "ps", ",", "prs", ",", "xp", ",", "sxp"}], "}"}], ",",
      "\n", "   ", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"Range", "[", "n", "]"}]}], ";", "\n", "   ", 
      RowBox[{"ps", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "   ", 
      RowBox[{"prs", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"ps", ",", "1"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"xp", "=", 
       RowBox[{"prs", "-", "1"}]}], ";", "\n", "   ", 
      RowBox[{"sxp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "^", "#"}], ")"}], "&"}], "/@", "xp"}]}], ";", "\n", 
      "   ", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", "#", "]"}], "&"}], "/@", " ", "sxp"}]}]}], "\n",
     "]"}]}], ";"}]}], "Code",ExpressionUUID->"02d21ee7-63e7-4f3d-8235-\
ad38720e0c4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sets2Dec", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Sets2Dec", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sets2Dec", "[", "sets_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xp", ",", "sxp"}], "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"xp", "=", 
        RowBox[{"sets", "-", "1"}]}], ";", "\n", "   ", 
       RowBox[{"sxp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "^", "#"}], ")"}], "&"}], "/@", "xp"}]}], ";", "\n", 
       "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "#", "]"}], "&"}], "/@", " ", "sxp"}]}]}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BalancedSystemQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BalancedSystemQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BalancedSystemQ", "[", 
     RowBox[{"coll_List", ",", " ", "T_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BalancedSystemQ", "]"}]}]}], "]"}], 
    " ", ":=", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mthd", ",", "zvec", ",", " ", "ovec", ",", " ", "pos", ",", " ", 
        "mat", ",", " ", "tmat", ",", " ", "smat", ",", " ", "d1", ",", " ", 
        "d2", ",", " ", "veco", ",", " ", "zf", ",", " ", "bv", ",", " ", 
        "yineq", ",", " ", "yeq", ",", " ", "cf", ",", " ", "rs", ",", " ", 
        "bq", ",", " ", "bcQ"}], "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "   ", "\n", 
       "   ", 
       RowBox[{"zvec", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"ovec", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"1", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ",
          "coll"}]}], ";", "\n", "   ", 
       RowBox[{"mat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zvec", ",", " ", "1", ",", " ", "#"}], "]"}], " ", "&"}], 
         " ", "/@", " ", "pos"}]}], ";", "\n", "   ", 
       RowBox[{"tmat", " ", "=", " ", 
        RowBox[{"Transpose", "[", "mat", "]"}]}], ";", "\n", "   ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d1", ",", " ", "d2"}], "}"}], " ", "=", " ", 
        RowBox[{"Dimensions", "[", "tmat", "]"}]}], ";", "\n", "   ", 
       RowBox[{"veco", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "d2"}], "}"}]}], "]"}]}], ";", "\n", "   ", 
       
       RowBox[{"(*", 
        RowBox[{"max", " ", "Problem"}], "*)"}], "\n", "   ", 
       RowBox[{"zf", " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{"tmat", ".", "veco"}]}]}], ";", "\n", "   ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"mat", ",", " ", "ovec"}], "]"}], ";", "\n", "   ", 
       RowBox[{"bv", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", " ", "&"}], ",", " ", 
          RowBox[{"d2", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"smat", " ", "=", " ", 
        RowBox[{"SparseArray", "[", "mat", "]"}]}], ";", "\n", "   ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"yineq", ",", "yeq"}], "}"}], ",", "res"}], "}"}], "=", 
        RowBox[{"LinearOptimization", "[", 
         RowBox[{"zf", ",", 
          RowBox[{"{", 
           RowBox[{"smat", ",", "bv"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "ovec", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ConstraintSensitivity\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"cf", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"-", "yineq"}], ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], " ", "+", " ", "1"}], ")"}]}], ";", 
       "\n", "   ", 
       RowBox[{"rs", " ", "=", " ", 
        RowBox[{"tmat", ".", "cf"}]}], ";", "\n", "   ", 
       RowBox[{"bq", " ", "=", " ", 
        RowBox[{"Round", "[", "res", "]"}]}], ";", " ", "\n", 
       RowBox[{"(*", "\n", "   ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<bq=\>\"", ",", "bq"}], "]"}], ";", "\n", "   ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<cf=\>\"", ",", 
           RowBox[{"cf", "/", 
            RowBox[{"First", "[", "rs", "]"}]}]}], "]"}], ";"}], "\n", "*)"}],
        "\n", "   ", 
       RowBox[{"bcQ", " ", "=", " ", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"bq", ",", " ", 
           RowBox[{"_", "?", "Positive"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"bq", ",", " ", 
           RowBox[{"_", "?", "Negative"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberQ", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "bq"}]}], "]"}]}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bcQ", ",", " ", "True"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"bcQ", ",", " ", 
           RowBox[{"cf", "/", 
            RowBox[{"First", "[", "rs", "]"}]}]}], "}"}], ",", "\n", "      ", 
         RowBox[{"{", 
          RowBox[{"bcQ", ",", " ", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{"Indeterminate", " ", "&"}], ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "}"}]}], "]"}]}]}],
      "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedSystemQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"WeaklyBalancedSystemQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedSystemQ", "[", 
    RowBox[{"coll_List", ",", " ", "b0_List", ",", "T_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedSystemQ", "]"}]}]}], "]"}], " ",
    ":=", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mthd", ",", "zvec", ",", " ", "ovec", ",", " ", "coll0", ",", "pos0", 
       ",", " ", "pos", ",", " ", "mat", ",", "tmat", ",", " ", "smat", ",", 
       " ", "d1", ",", " ", "d2", ",", " ", "veco", ",", " ", "zf", ",", " ", 
       "bv", ",", " ", "yineq", ",", " ", "yeq", ",", " ", "bq"}], "}"}], ",",
      "\n", "   ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "   ", 
      RowBox[{"zvec", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"ovec", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"1", " ", "&"}], ",", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"coll0", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"coll", ",", "b0"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"pos0", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "coll0"}]}], ";", "\n", "   ", 
      RowBox[{"mat0", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"zvec", ",", " ", "1", ",", " ", "#"}], "]"}], " ", "&"}], 
        " ", "/@", " ", "pos0"}]}], ";", "\n", "   ", 
      RowBox[{"tmat", " ", "=", " ", 
       RowBox[{"Transpose", "[", "mat0", "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", " ", "d2"}], "}"}], " ", "=", " ", 
       RowBox[{"Dimensions", "[", "tmat", "]"}]}], ";", "\n", "   ", 
      RowBox[{"veco", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "d2"}], "}"}]}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{"max", " ", "Problem"}], "*)"}], "\n", "   ", 
      RowBox[{"zf", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"tmat", ".", "veco"}]}]}], ";", "\n", "   ", 
      RowBox[{"pos", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "coll"}]}], ";", "\n", "   ", 
      RowBox[{"mat", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"zvec", ",", " ", "1", ",", " ", "#"}], "]"}], " ", "&"}], 
        " ", "/@", " ", "pos"}]}], ";", "\n", "   ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"mat", ",", " ", "ovec"}], "]"}], ";", "\n", "   ", 
      RowBox[{"tmat", " ", "=", " ", 
       RowBox[{"Transpose", "[", "mat", "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", " ", "d2"}], "}"}], " ", "=", " ", 
       RowBox[{"Dimensions", "[", "tmat", "]"}]}], ";", "\n", "   ", 
      RowBox[{"bv", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", " ", "d2"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"smat", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "mat", "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"yineq", ",", "yeq"}], "}"}], ",", "res"}], "}"}], "=", 
       RowBox[{"LinearOptimization", "[", 
        RowBox[{"zf", ",", 
         RowBox[{"{", 
          RowBox[{"smat", ",", "bv"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "ovec", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<ConstraintSensitivity\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
          "}"}], ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"bq", " ", "=", " ", 
       RowBox[{"Round", "[", "res", "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"bq", ",", " ", 
         RowBox[{"_", "?", "Positive"}]}], "]"}], " ", "&&", " ", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"bq", ",", " ", 
         RowBox[{"_", "?", "Negative"}]}], "]"}], " ", "&&", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberQ", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "bq"}]}], "]"}]}]}]}], "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID\
->"805aba61-420b-496d-8721-acb8db30d41c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetCardinalityGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"GetCardinalityGame", "::", "argerr"}], "]"}], ";", "$Failed"}],
     ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCardinalityGame", "[", 
     RowBox[{"T_List", ",", "k_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cos", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"cos", " ", "=", " ", 
        RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"LessEqual", "[", 
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ",", " ", "k"}], "]"}], ",", 
           "0", ",", 
           RowBox[{"Length", "[", "#", "]"}]}], "]"}], " ", "&"}], " ", "/@", 
        " ", "cos"}]}]}], " ", "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGameSizeK", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SymGameSizeK", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGameSizeK", "[", 
    RowBox[{"T_List", ",", "k_Integer", ",", "val_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lt2", ",", "sbs", ",", "rl", ",", "tkr", ",", "srl"}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{
      RowBox[{"lt2", "=", 
       RowBox[{
        RowBox[{"Length", "[", "T", "]"}], "/", "2"}]}], ";", "\n", "  ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", "0"}], "]"}], "&"}], " ", "/@", 
       " ", "sbs"}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{"v", "[", "T", "]"}], "=", 
       RowBox[{"lt2", "*", "val"}]}], ";", "\n", "  ", 
      RowBox[{"rl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RotateLeft", "[", 
          RowBox[{"T", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", "T"}]}],
       ";", "\n", "  ", 
      RowBox[{"tkr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "k"}]}], "]"}], " ", "&"}], " ", "/@", " ", "rl"}]}], 
      ";", "\n", "  ", 
      RowBox[{"srl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "tkr"}]}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", "val"}], "]"}], "&"}], " ", "/@",
        " ", "srl"}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}]}],
     "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->"5eda3e9d-362c-4b1f-b071-\
148924ec1dcd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType2", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SymGameType2", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType2", "[", 
    RowBox[{"T_List", ",", "S_List", ",", "val_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "S2", ",", "sbs", ",", "csb", ",", "asv", ",", "cl2", ",", "cw"}], 
      "}"}], ",", "\n", " ", 
     RowBox[{
      RowBox[{"S2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"T", ",", "S"}], "]"}]}], ";", "\n", " ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", " ", 
      RowBox[{"cl2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ",", "2"}], "]"}], ",", "#", 
           ",", 
           RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}],
       ";", "\n", " ", 
      RowBox[{"cl2", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"cl2", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", " ", 
      RowBox[{"csb", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"sbs", ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "cl2"}], "]"}]}], ";", "\n", " ", 
      RowBox[{
       RowBox[{"v", "[", "T", "]"}], "=", 
       RowBox[{"2", "*", "val"}]}], ";", "\n", " ", 
      RowBox[{"asv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"AssValToCoal2", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "val", ",", "S", ",", 
            "S2"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ", "cl2"}]}], ";", 
      "\n", " ", 
      RowBox[{"cw", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", "sbs"}]}], ";", 
      "\n", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Set", "[", 
          RowBox[{
           RowBox[{"v", "[", "#1", "]"}], ",", "#2"}], "]"}], " ", "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"cl2", ",", "asv"}], "}"}]}], "]"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", "0"}], "]"}], "&"}], " ", "/@", 
       " ", "csb"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}]}],
     "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->"3749817e-5958-4f7c-a7d4-\
371cae65fbf4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType3", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SymGameType3", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType3", "[", 
    RowBox[{"T_List", ",", "S_List", ",", "val_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "S2", ",", "sbs", ",", "csb", ",", "asv", ",", "cl3", ",", "cw"}], 
      "}"}], ",", "\n", " ", 
     RowBox[{
      RowBox[{"S2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"T", ",", "S"}], "]"}]}], ";", "\n", " ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", " ", 
      RowBox[{"cl3", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ",", "3"}], "]"}], ",", "#", 
           ",", 
           RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}],
       ";", "\n", " ", 
      RowBox[{"cl3", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"cl3", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", " ", 
      RowBox[{"csb", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"sbs", ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "cl3"}], "]"}]}], ";", "\n", " ", 
      RowBox[{
       RowBox[{"v", "[", "T", "]"}], "=", 
       RowBox[{"2", "*", "val"}]}], ";", "\n", " ", 
      RowBox[{"asv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"AssValToCoal3", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "val", ",", "S", ",", 
            "S2"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ", "cl3"}]}], ";", 
      "\n", " ", 
      RowBox[{"cw", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", "sbs"}]}], ";", 
      "\n", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Set", "[", 
          RowBox[{
           RowBox[{"v", "[", "#1", "]"}], ",", "#2"}], "]"}], " ", "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"cl3", ",", "asv"}], "}"}]}], "]"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", "0"}], "]"}], "&"}], " ", "/@", 
       " ", "csb"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}]}],
     "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->"a562b3b7-d5ac-446f-b9b6-\
b73b216fd4ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType4", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SymGameType4", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGameType4", "[", 
    RowBox[{"T_List", ",", "S_List", ",", "val_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "S2", ",", "sbs", ",", "csb", ",", "asv", ",", "cl4", ",", "cw"}], 
      "}"}], ",", "\n", " ", 
     RowBox[{
      RowBox[{"S2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"T", ",", "S"}], "]"}]}], ";", "\n", " ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", " ", 
      RowBox[{"cl4", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ",", "4"}], "]"}], ",", "#", 
           ",", 
           RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}],
       ";", "\n", " ", 
      RowBox[{"cl4", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"cl4", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", " ", 
      RowBox[{"csb", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"sbs", ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "cl4"}], "]"}]}], ";", "\n", " ", 
      RowBox[{
       RowBox[{"v", "[", "T", "]"}], "=", 
       RowBox[{"2", "*", "val"}]}], ";", "\n", " ", 
      RowBox[{"asv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"AssValToCoal4", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "val", ",", "S", ",", 
            "S2"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ", "cl4"}]}], ";", 
      "\n", " ", 
      RowBox[{"cw", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", "sbs"}]}], ";", 
      "\n", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Set", "[", 
          RowBox[{
           RowBox[{"v", "[", "#1", "]"}], ",", "#2"}], "]"}], " ", "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"cl4", ",", "asv"}], "}"}]}], "]"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", "0"}], "]"}], "&"}], " ", "/@", 
       " ", "csb"}], ";", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "sbs"}]}]}],
     "\n", "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"7edd48a8-275c-4cde-\
8062-5c79332b9642"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AssValToCoal2", "[", 
    RowBox[{
    "i_Integer", ",", "j_Integer", ",", "val_Integer", ",", "S1_List", ",", 
     "S2_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "        ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "!=", "j"}], ")"}], ",", "True"}], "]"}], ",", "\n", 
       "                   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "i"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "j"}], "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "]"}], "=", "val"}], ",", "0"}], 
        "]"}], ",", "\n", "             ", "True", ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<NAN\>\"", "]"}], ";"}]}], "\n", "        ",
       "]"}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->"f2c6c4fe-33e8-\
48b7-8e86-b74f23b5e8b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AssValToCoal3", "[", 
    RowBox[{
    "i_Integer", ",", "j_Integer", ",", "k_Integer", ",", "val_Integer", ",", 
     "S1_List", ",", "S2_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "        ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "!=", "j", "!=", "k"}], ")"}], ",", "True"}], "]"}], 
       ",", "\n", "                   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "i"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "j"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S2", ",", "k"}], "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "=", "val"}], 
         ",", "0"}], "]"}], ",", "\n", "             ", "True", ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<NAN\>\"", "]"}], ";"}]}], "\n", "        ",
       "]"}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->"56cbcd5c-19f6-\
4a1d-a8c2-9ad3a169ba13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AssValToCoal4", "[", 
    RowBox[{
    "i_Integer", ",", "j_Integer", ",", "k_Integer", ",", "l_Integer", ",", 
     "val_Integer", ",", "S1_List", ",", "S2_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "        ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "!=", "j", "!=", "k", "!=", "l"}], ")"}], ",", 
         "True"}], "]"}], ",", "\n", "                   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "i"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S1", ",", "j"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S2", ",", "k"}], "]"}], " ", "&&", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"S2", ",", "l"}], "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "]"}], "=", 
          "val"}], ",", "0"}], "]"}], ",", "\n", "             ", "True", ",",
        " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<NAN\>\"", "]"}], ";"}]}], "\n", "        ",
       "]"}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->"66bf9882-29e4-\
4114-af93-d249b5fadc22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lie", " ", "Groups"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"LieBracket", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "[", 
      RowBox[{
       RowBox[{"mat01_", "?", "ListQ"}], ",", 
       RowBox[{"mat02_", "?", "ListQ"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"mat01", ".", "mat02"}], " ", "-", " ", 
      RowBox[{"mat02", ".", "mat01"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Linear", " ", "Algebra"}], " ", "*)"}]}]}]], "Code",ExpressionUUI\
D->"800888a2-6142-4649-921f-bf22c76de50b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Inspired", " ", "by", " ", 
     RowBox[{"StackExchange", ":", " ", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"math", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "4266981"}], "/", "a"}], "-", "simple", "-", 
     "case", "-", "of", "-", "euclidean", "-", "space", "-", "vector"}]}], 
   "  ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SortVecDecOrder", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SortVecDecOrder", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SortVecDecOrder", "[", "vec_List", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lv", ",", "T1", ",", "pws", ",", "szp", ",", "it", ",", "pos"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"lv", "=", 
         RowBox[{"Length", "[", "vec", "]"}]}], ";", "\n", "  ", 
        RowBox[{"T1", "=", 
         RowBox[{"Range", "[", "lv", "]"}]}], ";", "\n", "  ", 
        RowBox[{"pws", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T1", "]"}], ",", "1"}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"szp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          "pws"}]}], ";", "\n", "  ", 
        RowBox[{"it", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"pws", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"szp", ",", "#"}], "]"}]}], "]"}], " ", "&"}], "/@", 
          " ", "T1"}]}], ";", "\n", "  ", 
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
          "it"}]}], ";", "\n", "  ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"Extract", "[", 
                RowBox[{"vec", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", 
             " ", "#"}], "]"}], " ", "&"}], ",", " ", "pos"}], "]"}]}]}], 
      "\n", "]"}]}], ";"}], "\n"}]}]], "Code",ExpressionUUID->"207760b2-a030-\
45b2-a080-1ae97a178bbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Borrowed", " ", "from", " ", "WolframMathWorld"}], " ", "*)"}], 
  "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AdjointMatrix", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AdjointMatrix", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjointMatrix", "[", "mat_List", "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{"Conjugate", "@", 
       RowBox[{"Transpose", "@", "mat"}]}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsHermitianMatrixQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"IsHermitianMatrixQ", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsHermitianMatrixQ", "[", "mat_List", "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{"mat", " ", "===", " ", 
       RowBox[{"Conjugate", "@", 
        RowBox[{"Transpose", "@", "mat"}]}]}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Borrowed", " ", "from", " ", "StackExchange"}], " ", "*)"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RStirlingNumber", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"RStirlingNumber", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RStirlingNumber", "[", 
      RowBox[{"_", ",", " ", "0", ",", " ", "0"}], "]"}], " ", "=", " ", 
     "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RStirlingNumber", "[", 
       RowBox[{"r_", ",", " ", "n_", ",", " ", "1"}], "]"}], " ", "/;", " ", 
      RowBox[{"n", " ", ">=", " ", "r"}]}], " ", "=", " ", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RStirlingNumber", "[", 
       RowBox[{"r_", ",", " ", "n_", ",", " ", "k_"}], "]"}], " ", "/;", " ", 
      
      RowBox[{
       RowBox[{"r", " ", ">", " ", "0"}], " ", "&&", " ", 
       RowBox[{"n", " ", ">", " ", "0"}], " ", "&&", " ", 
       RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
       RowBox[{"n", " ", ">=", " ", 
        RowBox[{"k", " ", "r"}]}]}]}], " ", ":=", " ", "\n", "   ", 
     RowBox[{
      RowBox[{"RStirlingNumber", "[", 
       RowBox[{"r", ",", " ", "n", ",", " ", "k"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"k", " ", 
        RowBox[{"RStirlingNumber", "[", 
         RowBox[{"r", ",", " ", 
          RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "k"}], "]"}]}], " ", 
       "+", " ", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"n", " ", "-", " ", "1"}], ",", " ", 
          RowBox[{"r", " ", "-", " ", "1"}]}], "]"}], " ", 
        RowBox[{"RStirlingNumber", "[", 
         RowBox[{"r", ",", " ", 
          RowBox[{"n", " ", "-", " ", "r"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RStirlingNumber", "[", "___", "]"}], " ", "=", " ", "0"}], 
    ";"}], "\n"}]}]], "Code",ExpressionUUID->"5f040fbe-33de-4443-8f42-\
f2138a9e30ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], "\n"}]], "Code",ExpressionUUID->\
"b7e84e3a-0901-4c61-b8e5-478f2e1ffc81"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Code",ExpressionUUID->"9f7faea0-46d2-42eb-b90f-2e74566e76bf"]
},
WindowSize->{606, 552},
WindowMargins->{{Automatic, 78}, {29.25, Automatic}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3e8d484b-8a42-4076-8da0-9f220fcbcd74"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 24754, 542, 5258, "Code",ExpressionUUID->"397c30dc-1e4d-4f68-9fea-c06d28012fc7"],
Cell[25315, 564, 2573, 67, 400, "Code",ExpressionUUID->"a039ca63-9a43-41c2-9717-f877be99421f"],
Cell[27891, 633, 9470, 250, 868, "Code",ExpressionUUID->"48940638-ca66-490e-a723-253c67347d11"],
Cell[37364, 885, 3023, 83, 70, "Code",ExpressionUUID->"78b82487-8562-4635-b210-6764e1dba5b1"],
Cell[40390, 970, 3243, 87, 70, "Code",ExpressionUUID->"23827754-6faa-41f1-bead-a85b71f4c124"],
Cell[43636, 1059, 1593, 42, 70, "Code",ExpressionUUID->"1a6a18c5-7495-43eb-b55e-f5c308fcde35"],
Cell[45232, 1103, 1916, 49, 70, "Code",ExpressionUUID->"f44aac3a-051e-4ada-bc42-79f91d932b5b"],
Cell[47151, 1154, 1339, 36, 70, "Code",ExpressionUUID->"5425a80f-325e-404f-b298-3800f4459257"],
Cell[48493, 1192, 573, 13, 70, "Code",ExpressionUUID->"3d967347-29a3-43af-b0f1-b0f91423f540"],
Cell[49069, 1207, 5752, 148, 70, "Code",ExpressionUUID->"1319daf4-5a88-4def-96ca-d40bb6b3aa3c"],
Cell[54824, 1357, 2792, 75, 70, "Code",ExpressionUUID->"b3755669-ca6b-4ff0-af72-1aa4d5b42bcb"],
Cell[57619, 1434, 8343, 227, 70, "Code",ExpressionUUID->"bc577c5b-a6d6-439b-8434-bcadda5a672a"],
Cell[65965, 1663, 8252, 230, 70, "Code",ExpressionUUID->"ca7b0a0b-9209-469d-b29f-3e1aa36e6e98"],
Cell[74220, 1895, 6959, 183, 70, "Code",ExpressionUUID->"3976d590-2857-4eea-96f4-74922db24463"],
Cell[81182, 2080, 3222, 85, 70, "Code",ExpressionUUID->"a8a1daf2-de42-484f-97f3-0041a529afc5"],
Cell[84407, 2167, 3761, 94, 70, "Code",ExpressionUUID->"4b0d062f-e62c-4074-a089-410e3ae3360b"],
Cell[88171, 2263, 6434, 164, 70, "Code",ExpressionUUID->"e8425e8f-952c-4628-aa97-7154b830a919"],
Cell[94608, 2429, 3681, 98, 70, "Code",ExpressionUUID->"ae17d0a7-7fe8-46e0-98a0-95f59281edfd"],
Cell[98292, 2529, 13301, 315, 70, "Code",ExpressionUUID->"f6d760df-284b-4751-9340-0097aea69674"],
Cell[111596, 2846, 1057, 29, 70, "Code",ExpressionUUID->"c488f98a-37ba-4171-9fdd-b373d1e4d0d6"],
Cell[112656, 2877, 3613, 95, 70, "Code",ExpressionUUID->"8af8fab2-631a-449e-a708-8e87c2d10958"],
Cell[116272, 2974, 8220, 215, 70, "Code",ExpressionUUID->"11687734-ae14-4ee1-b10f-4c259efb7e5b"],
Cell[124495, 3191, 171, 3, 70, "Code",ExpressionUUID->"e3d6382a-d55b-454f-aa15-a9002c2c83b1"],
Cell[124669, 3196, 2166, 50, 70, "Code",ExpressionUUID->"a07c02ed-0d74-4c4a-bb83-f5242a9ec5e0"],
Cell[126838, 3248, 1241, 37, 70, "Code",ExpressionUUID->"02d21ee7-63e7-4f3d-8235-ad38720e0c4a"],
Cell[128082, 3287, 11802, 302, 70, "Code",ExpressionUUID->"805aba61-420b-496d-8721-acb8db30d41c"],
Cell[139887, 3591, 3044, 90, 70, "Code",ExpressionUUID->"5eda3e9d-362c-4b1f-b071-148924ec1dcd"],
Cell[142934, 3683, 2902, 84, 70, "Code",ExpressionUUID->"3749817e-5958-4f7c-a7d4-371cae65fbf4"],
Cell[145839, 3769, 2984, 86, 70, "Code",ExpressionUUID->"a562b3b7-d5ac-446f-b9b6-b73b216fd4ba"],
Cell[148826, 3857, 3072, 88, 70, "Code",ExpressionUUID->"7edd48a8-275c-4cde-8062-5c79332b9642"],
Cell[151901, 3947, 1191, 33, 70, "Code",ExpressionUUID->"f2c6c4fe-33e8-48b7-8e86-b74f23b5e8b2"],
Cell[153095, 3982, 1329, 35, 70, "Code",ExpressionUUID->"56cbcd5c-19f6-4a1d-a8c2-9ad3a169ba13"],
Cell[154427, 4019, 1477, 38, 70, "Code",ExpressionUUID->"66bf9882-29e4-4114-af93-d249b5fadc22"],
Cell[155907, 4059, 828, 24, 70, "Code",ExpressionUUID->"800888a2-6142-4649-921f-bf22c76de50b"],
Cell[156738, 4085, 2534, 72, 70, "Code",ExpressionUUID->"207760b2-a030-45b2-a080-1ae97a178bbf"],
Cell[159275, 4159, 3313, 91, 70, "Code",ExpressionUUID->"5f040fbe-33de-4443-8f42-f2138a9e30ef"],
Cell[162591, 4252, 145, 4, 70, "Code",ExpressionUUID->"b7e84e3a-0901-4c61-b8e5-478f2e1ffc81"],
Cell[162739, 4258, 112, 1, 70, "Code",ExpressionUUID->"9f7faea0-46d2-42eb-b90f-2e74566e76bf"]
}
]
*)

(* End of internal cache information *)

