(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1250314,      31359]
NotebookOptionsPosition[   1228950,      31131]
NotebookOutlinePosition[   1229416,      31148]
CellTagsIndexPosition[   1229373,      31145]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", "Title", ":", " ", 
    RowBox[{"TuGames", ".", "m"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Syntax", "::", "stresc"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"General", "::", "obspkg"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", "Context", ":", " ", "TuGames`"}], " ", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", "Summary", ":", "\t", "\n", "    ", 
     RowBox[{
     "This", " ", "package", " ", "is", " ", "an", " ", "extension", " ", 
      "to", " ", "the", " ", "package", " ", "written", " ", "by", " ", 
      "Michael", " ", "Carter", " ", "for", " ", "\n", "    ", "modeling", 
      " ", "and", " ", "calculating", " ", "solutions", " ", "and", " ", 
      "properties", " ", "for", " ", "cooperative", " ", "games", " ", "with",
       " ", "\n", "    ", "transferable", " ", 
      RowBox[{"utilities", "."}]}]}], " ", "\n", "*)"}], "\t\t\t", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", "Author", ":", "\t\t", "\n", "    ", 
     RowBox[{
      RowBox[{
      "Holger", " ", "Ingmar", " ", "Meinhardt", "\n", "    ", "Department", 
       " ", "of", " ", "Economics", "\n", "    ", "University", " ", "of", 
       " ", "Karlsruhe", " ", 
       RowBox[{"(", "KIT", ")"}], "\n", "    ", 
       RowBox[{"holger", ".", 
        RowBox[{"meinhardt", "@", "wiwi"}], ".", "uni"}]}], "-", 
      RowBox[{"karlsruhe", ".", "de"}]}]}], "\n", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"Package", " ", "Version"}], ":", " ", 
     RowBox[{"3.1", ".2"}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", "\n", "   ", 
    RowBox[{
     RowBox[{":", 
      RowBox[{"Mathematica", " ", "Version"}], ":", " ", 
      RowBox[{"12.", "x", "\n", "\n", "   ", "The", " ", "function", " ", 
       RowBox[{"ConstrainedMax", "/", "ConstrainedMin"}], " ", "or", " ", 
       RowBox[{"Linear", "/", "DualLinearProgramming"}], " ", "have", " ", 
       "been", " ", "deprecated", "\n", "   ", "in", " ", "Version", " ", "3",
        " ", "and", " ", "are", " ", "replaced", " ", "by", " ", 
       RowBox[{"LinearOptimization", ".", " ", "Thus"}]}]}], ",", " ", 
     RowBox[{
     "this", " ", "version", " ", "is", " ", "not", " ", "anymore", " ", 
      "compatible", "\n", "   ", "with", " ", "Mathematica", " ", "versions", 
      " ", "smaller", " ", "than", " ", "12.", " ", "This", " ", 
      "replacement", " ", "allows", " ", "to", " ", "supply", " ", "the", " ",
       "Method", " ", "options", "\n", "   ", "of", " ", 
      RowBox[{"LinearOptimization", ".", " ", "In"}], " ", "this", " ", 
      "context"}], ",", " ", 
     RowBox[{
     "we", " ", "strongly", " ", "recommend", " ", "to", " ", "apply", " ", 
      "for", " ", "a", " ", "MOSEK", " ", "license"}], ",", " ", 
     RowBox[{
      RowBox[{
      "which", "   ", "\n", "   ", "is", " ", "in", " ", "according", " ", 
       "to", " ", "our", " ", "experience", " ", "up", " ", "to", " ", "50", 
       " ", "times", " ", "faster", " ", "than", " ", "the", " ", "other", 
       " ", 
       RowBox[{"methods", ".", " ", "To"}], " ", "change", " ", "the", " ", 
       "method", " ", "\n", "   ", "one", " ", "needs", " ", "just", " ", 
       "to", " ", "set", " ", "Method"}], " ", "->", " ", 
      RowBox[{
       RowBox[{"MOSEK", ".", " ", "For"}], " ", "changing", " ", "the", " ", 
       "solver"}]}], ",", " ", 
     RowBox[{
      RowBox[{"one", " ", "has", " ", "to", " ", "set", " ", "CallMinimize"}],
       " ", "->", " ", 
      RowBox[{
       RowBox[{"True", "\n", "   ", "or", " ", "CallMaximize"}], " ", "->", 
       " ", "True"}]}], ",", " ", 
     RowBox[{"for", " ", 
      RowBox[{"instance", ".", " ", "One"}], " ", "shall", " ", "check", " ", 
      "first", " ", "with", " ", 
      RowBox[{"Options", "[", "command", "]"}], " ", "if", " ", "the", " ", 
      "solver", "\n", "   ", "is", " ", 
      RowBox[{"available", "."}]}]}], " ", "\n", "\n", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{":", "Package", ":", " ", 
      RowBox[{"Tested", " ", "under", " ", "RHEL", " ", "8.2"}]}], ",", " ", 
     RowBox[{"Lustre", " ", "2.12", ".6", "_ddn40"}]}], " ", "*)"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{":", "Keywords", ":", "\n", "   ", 
      RowBox[{"Dual", " ", "Game"}]}], ",", " ", 
     RowBox[{"Superadditive", " ", "Game"}], ",", " ", 
     RowBox[{"Convex", " ", "Game"}], ",", " ", 
     RowBox[{"Strong", " ", "Convex", " ", "Game"}], ",", " ", 
     RowBox[{"Average", "-", 
      RowBox[{"Convex", " ", "Game"}]}], ",", "\n", "   ", "Kernel", ",", " ", 
     RowBox[{"balancing", " ", "Maximum", " ", 
      RowBox[{"Excesses", "."}]}]}], "\n", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{":", "Sources", ":", "\n", "   ", 
        RowBox[{"G", ".", " ", "Bergantinos"}]}], " ", "&"}], " ", 
      RowBox[{"J", ".", " ", "Masso"}]}], ",", " ", 
     RowBox[{"Notes", " ", "on", " ", "a", " ", "new", " ", "compromise", " ", 
      RowBox[{"value", ":", " ", 
       RowBox[{
        RowBox[{"The", " ", "Chi"}], "-", "Value"}]}]}], ",", "\n", "   ", 
     RowBox[{"Optimization", " ", "1996"}], ",", " ", 
     RowBox[{"Vol", ".", " ", "38"}], ",", " ", 
     RowBox[{
      RowBox[{"pp", ".", " ", "277"}], "-", 
      RowBox[{
      "286.", "\n", "   ", "\n", "   ", "Chih", " ", "Chang", " ", "and", " ",
        "Theo", " ", "Driessen"}]}], ",", " ", 
     RowBox[{
      RowBox[{"(", "Pre", ")"}], "Kernel", " ", "Catchers", " ", "for", " ", 
      "Cooperative", " ", "Games"}], ",", "\n", "   ", 
     RowBox[{"OR", " ", "Spectrum"}], ",", " ", 
     RowBox[{"Vol", ".", " ", "17"}], ",", " ", 
     RowBox[{
     "1995", "\n", "\n", "   ", "Chih", " ", "Chang", " ", "and", " ", 
      "Ching", " ", "Yu", " ", "Kan"}], ",", " ", 
     RowBox[{"The", " ", "Bound", " ", "of", " ", "the", " ", "Kernel"}], ",",
      " ", 
     RowBox[{"Mathematical", " ", "Social", "\n", "   ", "Sciences"}], ",", 
     " ", 
     RowBox[{"Vol", ".", " ", "25"}], ",", " ", 
     RowBox[{"87", "-", "93"}], ",", " ", 
     RowBox[{
      RowBox[{
      "1992.", "\n", "\n", "   ", "Chih", " ", "Chang", " ", "and", " ", 
       "Chrong"}], "-", 
      RowBox[{"Hisan", " ", "Lian"}]}], ",", " ", 
     RowBox[{"Some", " ", "Results", " ", "on", " ", 
      RowBox[{"(", "Pre", ")"}], "Kernel", " ", "Catchers", " ", "and", "\n", 
      "   ", "the", " ", "Coincidence", " ", "of", " ", "the", " ", "Kernel", 
      " ", "and", " ", "Prekernel"}], ",", " ", 
     RowBox[{"International", " ", "Game", " ", "Theory", " ", "Review"}], 
     ",", "\n", "   ", 
     RowBox[{"Vol", ".", " ", "4"}], ",", " ", 
     RowBox[{"No", ".", " ", "3"}], ",", " ", 
     RowBox[{"201", "-", "211"}], ",", " ", 
     RowBox[{"2002.", " ", "\n", "\n", "   ", "Pierre", " ", "Dehez", " ", 
      RowBox[{"(", "2023", ")"}]}], ",", " ", 
     RowBox[{"COOPERATIVE", " ", "PRODUCT", " ", "GAMES"}], ",", " ", 
     RowBox[{"LIDAM", " ", "Discussion", " ", "Paper", " ", "CORE", " ", 
      RowBox[{"2023", " ", "/", " ", "10."}], "\n", "\n", "   ", "Pierre", 
      " ", "Dehez", " ", 
      RowBox[{"(", "2023", ")"}]}], ",", " ", 
     RowBox[{
     "Sharing", " ", "a", " ", "collective", " ", "probability", " ", "of", 
      " ", "success"}], ",", " ", 
     RowBox[{
     "Mathematical", " ", "Social", "\n", "   ", "Sciences", " ", "123"}], 
     ",", " ", 
     RowBox[{"122", "-", 
      RowBox[{"127.", "\n", "\n", "   ", "Theo", " ", "Driessen"}]}], ",", 
     " ", 
     RowBox[{"Cooperative", " ", "Games"}], ",", " ", 
     RowBox[{"Solutions", " ", "and", " ", "Applications"}], ",", " ", 
     RowBox[{"Kluwer", " ", "Academic", "\n", "   ", "Publishers"}], ",", " ",
      "Dordrecht", ",", " ", 
     RowBox[{"1988.", "\n", "\n", "   ", "Theo", " ", 
      RowBox[{"Driessen", ".", " ", "The"}], " ", "Greedy", " ", "Bankruptcy",
       " ", 
      RowBox[{"Game", ":", " ", 
       RowBox[{
       "An", " ", "Alternative", " ", "Game", " ", "Theoretic", " ", 
        "Analysis", " ", "of", " ", "a", "\n", "   ", "Bankruptcy", " ", 
        RowBox[{"Problem", ".", " ", "In"}], " ", 
        RowBox[{"L", ".", "A", ".", " ", "Petrosjan"}], " ", "and", " ", 
        RowBox[{"V", ".", "V", ".", " ", "Mazalov"}]}]}]}], ",", " ", 
     "editors", ",", " ", 
     RowBox[{"Game", " ", "Theory", " ", "and", " ", "Applications"}], ",", 
     "\n", "   ", 
     RowBox[{"volume", " ", "IV"}], ",", " ", 
     RowBox[{"pages", " ", "45"}], "\[Dash]", "61", ",", " ", "Commack", ",", 
     " ", 
     RowBox[{"New", " ", "York"}], ",", " ", 
     RowBox[{"1998.", " ", "Nova", " ", "Science", " ", "Publishers", " ", 
      RowBox[{"Inc", ".", "\n", "\n", "\n", "   ", "E", ".", " ", "Inarra"}], 
      " ", "and", " ", 
      RowBox[{"J", ".", " ", "Usategui"}]}], ",", " ", 
     RowBox[{
     "The", " ", "Shapley", " ", "value", " ", "and", " ", "average", " ", 
      "convex", " ", "games"}], ",", " ", "\n", "   ", "IJGT", ",", " ", "22",
      ",", " ", 
     RowBox[{"13", "-", "29"}], ",", " ", 
     RowBox[{"1993.", "\n", "\n", "   ", 
      RowBox[{"U", ".", " ", "Faigle"}]}], ",", " ", 
     RowBox[{
      RowBox[{"W", ".", " ", "Kern"}], " ", "and", " ", 
      RowBox[{"J", ".", " ", "Kuipers"}]}], ",", " ", 
     RowBox[{
     "An", " ", "efficient", " ", "algorithm", " ", "for", " ", "nucleolus", 
      " ", "and", "\n", "   ", "prekernel", " ", "computation", " ", "in", 
      " ", "some", " ", "classes", " ", "of", " ", "Tu", " ", 
      RowBox[{"Games", ".", " ", "Memorandum"}], " ", 
      RowBox[{"No", ".", " ", "1464"}]}], ",", "\n", "   ", 
     RowBox[{"Faculty", " ", "of", " ", "Mathematical", " ", "Sciences"}], 
     ",", " ", 
     RowBox[{"University", " ", "of", " ", "Twente"}], ",", " ", 
     RowBox[{"1998.", "\n", "\n", "   ", 
      RowBox[{"Y", ".", " ", "Funaki"}]}], ",", " ", 
     RowBox[{
     "Upper", " ", "and", " ", "Lower", " ", "Bounds", " ", "of", " ", "the", 
      " ", "Kernel", " ", "and", " ", "Nucleolus"}], ",", " ", "\n", "   ", 
     "IJGT", ",", " ", 
     RowBox[{"121", "-", "129"}], ",", " ", 
     RowBox[{"1986.", "\n", "\n", "   ", 
      RowBox[{"Y", ".", " ", "Funaki"}], " ", "and", " ", 
      RowBox[{"H", ".", " ", "I", ".", " ", "Meinhardt"}]}], ",", " ", 
     RowBox[{
      RowBox[{"A", " ", "Note", " ", "on", " ", "the", " ", "Pre"}], "-", 
      RowBox[{"Kernel", " ", "and", " ", "Pre"}], "-", 
      RowBox[{
      "Nucleolus", " ", "\n", "   ", "for", " ", "Bankruptcy", " ", 
       "Game"}]}], ",", " ", 
     RowBox[{
     "The", " ", "Waseda", " ", "Journal", " ", "of", " ", "Political", " ", 
      "Science", " ", "and", " ", "Economics"}], ",", "\n", "   ", "Waseda", 
     ",", " ", "Japan", ",", " ", 
     RowBox[{"2006.", "\n", "\n", "   ", 
      RowBox[{"J", ".", " ", "Getan"}]}], ",", " ", 
     RowBox[{"J", ".", " ", "M", ".", " ", "Izquierdo"}], ",", " ", 
     RowBox[{"J", ".", " ", "Montes"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"C", ".", " ", "Rafels", ".", " ", "The"}], " ", "bargaining", 
       " ", "set", " ", "and", " ", "the", " ", "kernel", "\n", "   ", "for", 
       " ", "almost"}], "-", 
      RowBox[{"convex", " ", "games"}]}], ",", " ", 
     RowBox[{
      RowBox[{"(", "2012", ")"}], ".", " ", "mimeo", ".", "\n", "\n", "   ", 
      "Hou"}], ",", " ", 
     RowBox[{"D", "."}], ",", " ", "Xu", ",", " ", 
     RowBox[{"G", "."}], ",", " ", "Sun", ",", " ", 
     RowBox[{"P", "."}], ",", " ", "Driessen", ",", " ", 
     RowBox[{"T", "."}], ",", " ", 
     RowBox[{
     "2018.", " ", "The", " ", "Shapley", " ", "value", " ", "for", " ", 
      "the", " ", "probability", " ", 
      RowBox[{
      "game", ".", "\n", "   ", "Oper", ".", " ", "Res", ".", " ", "Lett", 
       ".", " ", "46"}]}], ",", " ", 
     RowBox[{"457", "-", 
      RowBox[{"461.", "\n", "\n", "   ", 
       RowBox[{"I", ".", " ", "Katsev"}], " ", "and", " ", 
       RowBox[{"E", ".", " ", "Yanovskaya"}]}]}], ",", " ", 
     RowBox[{
     "Between", " ", "the", " ", "Prekernel", " ", "and", " ", "the", " ", 
      "Prenucleolus"}], ",", " ", "mimeo", ",", " ", 
     RowBox[{"2009.", " ", "\n", "\n", "   ", 
      RowBox[{"K", ".", " ", "Kido", ".", " ", "A"}], " ", "nonlinear", " ", 
      "Approximation", " ", "of", " ", "the", " ", 
      RowBox[{"Nucleolus", ".", " ", "In"}], " ", 
      RowBox[{"W", ".", " ", "Takahashi"}], " ", "and", " ", 
      RowBox[{"T", ".", " ", "Tanaka"}]}], ",", "\n", "   ", "editors", ",", 
     " ", 
     RowBox[{
     "Proceedings", " ", "of", " ", "the", " ", "International", " ", 
      "Conference", " ", "on", " ", "Nonlinear", " ", "Analysis", " ", "and", 
      "\n", "   ", "Convex", " ", "Analysis"}], ",", " ", 
     RowBox[{"pages", " ", "307"}], "\[Dash]", "317", ",", " ", "Tokyo", ",", 
     " ", 
     RowBox[{"2004.", " ", "Yokohama", " ", "Publishers"}], ",", " ", 
     "Yokohama", ",", " ", 
     RowBox[{
      RowBox[{"Japan", "\n", "   ", "\n", "   ", 
       RowBox[{"K", ".", " ", "Kido", ".", " ", "Convergence"}], " ", 
       "Theorems", " ", "for", " ", "lp"}], "-", 
      RowBox[{
      "Norm", " ", "Minimizers", " ", "with", " ", "respect", " ", "to", " ", 
       
       RowBox[{"p", ".", " ", "Journal"}], " ", "of", "\n", "   ", 
       "Optimization", " ", "Theory", " ", "and", " ", "Applications"}]}], 
     ",", " ", 
     RowBox[{"125", ":", "577"}], "\[Dash]", "589", ",", " ", 
     RowBox[{"2005.", "\n", "   ", "\n", "   ", 
      RowBox[{"K", ".", " ", "Kido", ".", " ", "A"}], " ", "Modified", " ", 
      "Kohlberg", " ", "Criterion", " ", "and", " ", "a", " ", "Nonlinear", 
      " ", "Method", " ", "to", " ", "compute", " ", "the", " ", "Nucleolus", 
      "\n", "   ", "of", " ", "a", " ", "Cooperative", " ", 
      RowBox[{"Game", ".", " ", "Taiwanese"}], " ", "Journal", " ", "of", " ",
       "Mathematics"}], ",", " ", 
     RowBox[{"12", ":", "1581"}], "\[Dash]", "1590", ",", " ", 
     RowBox[{
      RowBox[{"2008.", "\n", "\n", "   ", 
       RowBox[{"M", ".", " ", "Leng"}], " ", "and", " ", 
       RowBox[{"M", ".", " ", "Parlar", ".", " ", "Analytic"}], " ", 
       "solution", " ", "for", " ", "the", " ", "nucleolus", " ", "of", " ", 
       "a", " ", "three"}], "-", 
      RowBox[{"player", " ", "cooperative", "\n", "   ", 
       RowBox[{"game", ".", " ", "Naval"}], " ", "Research", " ", "Logistics",
        " ", 
       RowBox[{"(", "NRL", ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"57", 
       RowBox[{"(", "7", ")"}]}], ":", "667"}], "\[Dash]", "672", ",", " ", 
     RowBox[{
      RowBox[{"2010.", " ", 
       RowBox[{"doi", ":", " ", 
        RowBox[{
         RowBox[{"10.1002", "/", "nav"}], 
         RowBox[{".20429", ".", "\n", "   ", "URL"}], " ", "https"}], ":"}]}],
       "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"onlinelibrary", ".", "wiley", ".", "com"}], "/", "doi"}], 
          "/", "abs"}], "/", "10.1002"}], "/", "nav"}], 
       RowBox[{".20429", ".", "\n", "\n", "   ", "M", ".", " ", "Leng"}]}]}], 
     ",", " ", 
     RowBox[{"Ch", ".", " ", "Luo"}], ",", " ", 
     RowBox[{
      RowBox[{"L", ".", " ", "Liang", ".", " ", "Multi"}], "-", 
      RowBox[{
      "Player", " ", "Allocations", " ", "in", " ", "the", " ", "Presence", 
       " ", "of", " ", "Diminishing", " ", "Marginal", "\n", "   ", 
       RowBox[{"Contributions", ":", " ", 
        RowBox[{
        "Cooperative", " ", "Game", " ", "Analysis", " ", "and", " ", 
         "Applications", " ", "in", " ", "Management", " ", "Science"}]}]}]}],
      ",", " ", "2020", ",", "\n", "   ", 
     RowBox[{
     "to", " ", "appear", " ", "in", " ", "Management", " ", "Science", "\n", 
      "\n", "   ", 
      RowBox[{"S", ".", " ", "C", ".", " ", "Littlechild", ".", " ", "A"}], 
      " ", "simple", " ", "expression", " ", "for", " ", "the", " ", 
      "nucleolus", " ", "in", " ", "a", " ", "special", " ", 
      RowBox[{"case", ".", " ", "International"}], "\n", "   ", "Journal", 
      " ", "of", " ", "Game", " ", "Theory"}], ",", " ", 
     RowBox[{"3", ":", 
      RowBox[{"21", "-", "29"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1974.", " ", "URL", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"doi", ".", "org"}], "/", "10.1007"}], "/", 
        RowBox[{
        "BF01766216", ".", "\n", "\n", "   ", "S", ".", " ", "C", ".", " ", 
         "Littlechild"}]}], " ", "and", " ", 
       RowBox[{"G", ".", " ", "Owen", ".", " ", "A"}], " ", "simple", " ", 
       "expression", " ", "for", " ", "the", " ", "shapely", " ", "value", 
       " ", "in", " ", "a", " ", "special", " ", 
       RowBox[{"case", ".", "\n", "   ", "Management"}], " ", "Science"}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{"20", 
       RowBox[{"(", "3", ")"}]}], ":", 
      RowBox[{"370", "-", "372"}]}], ",", " ", 
     RowBox[{"1973.", " ", "ISSN", " ", "00251909"}], ",", " ", 
     RowBox[{
      RowBox[{"15265501.", "\n", "   ", "URL", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"www", ".", "jstor", ".", "org"}], "/", "stable"}], "/", 
        "2629727."}], "\n", "\n", "   ", 
       RowBox[{"S", ".", " ", "C", ".", " ", "Littlechild"}], " ", "and", " ", 
       RowBox[{"G", ".", " ", "Owen", ".", " ", "A"}], " ", "further", " ", 
       "note", " ", "on", " ", "the", " ", "nucleolus", " ", "of", " ", "the",
        " ", "airport", " ", 
       RowBox[{"game", ".", "\n", "   ", "International"}], " ", "Journal", 
       " ", "of", " ", "Game", " ", "Theory"}]}], ",", " ", 
     RowBox[{
      RowBox[{"5", 
       RowBox[{"(", "2", ")"}]}], ":", 
      RowBox[{"91", "-", "95"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1976.", " ", "URL", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"doi", ".", "org"}], "/", "10.1007"}], "/", 
        RowBox[{
        "BF01753311", ".", "\n", "\n", "   ", "S", ".", " ", "C", ".", " ", 
         "Littlechild"}]}], " ", "and", " ", 
       RowBox[{
       "G", ".", " ", "F", ".", " ", "Thompson", ".", " ", "Aircraft"}], " ", 
       "landing", " ", 
       RowBox[{"fees", ":", " ", 
        RowBox[{"A", " ", "game", " ", "theory", " ", 
         RowBox[{"approach", ".", "\n", "   ", "The"}], " ", "Bell", " ", 
         "Journal", " ", "of", " ", "Economics"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"8", 
       RowBox[{"(", "1", ")"}]}], ":", 
      RowBox[{"186", "-", "204"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1977.", " ", "ISSN", " ", "0361915", 
       RowBox[{"X", ".", "\n", "   ", "URL"}], " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"www", ".", "jstor", ".", "org"}], "/", "stable"}], "/", 
        "3003493."}], "\n", "\n", "   ", 
       RowBox[{"S", ".", " ", "C", ".", " ", "Littlechild"}], " ", "and", " ", 
       RowBox[{"KG", ".", " ", "Vaidya"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "propensity", " ", "to", " ", "disrupt", " ", "and", " ", 
       "the", " ", "disruption", " ", "nucleolus", "\n", "   ", "of", " ", 
       "a", " ", "characteristic", " ", "function", " ", 
       RowBox[{"game", ".", " ", "International"}], " ", "Journal", " ", "of",
        " ", "Game", " ", "Theory", " ", "5", 
       RowBox[{"(", "2", ")"}]}], ":", 
      RowBox[{"151", "-", "161"}]}], ",", "\n", "   ", 
     RowBox[{"1976.", "\n", "\n", "   ", 
      RowBox[{"M", ".", " ", "Maschler"}]}], ",", " ", 
     RowBox[{"The", " ", "Bargaining", " ", "Set"}], ",", " ", 
     RowBox[{"Kernel", " ", "and", " ", "Nucleolus"}], ",", " ", 
     RowBox[{"Handbook", " ", "of", " ", "Game", "\n", "   ", "Theory"}], ",",
      " ", 
     RowBox[{"Chapter", " ", "18"}], ",", " ", 
     RowBox[{"591", "-", "647"}], ",", " ", 
     RowBox[{"1992.", "\n", "\n", "   ", 
      RowBox[{"M", ".", " ", "Maschler"}]}], ",", " ", 
     RowBox[{
      RowBox[{"B", ".", " ", "Peleg"}], " ", "and", " ", 
      RowBox[{"L", ".", "S", ".", " ", "Shapley"}]}], ",", " ", 
     RowBox[{"Geometric", " ", "Properties", " ", "of", " ", "Kernel"}], ",", 
     "  ", "\n", "   ", 
     RowBox[{"Nucleolus", " ", "and", " ", "related", " ", "Concepts"}], ",", 
     " ", 
     RowBox[{
     "in", " ", "Mathematics", " ", "of", " ", "Operations", " ", 
      "Research"}], ",", " ", "\n", "   ", 
     RowBox[{"Vol4", " ", 
      RowBox[{"Nov", ".", " ", "1979"}]}], ",", " ", 
     RowBox[{
      RowBox[{"p", ".", " ", "303"}], "-", 
      RowBox[{"338.", "\n", "\n", "   ", "J"}], "-", 
      RowBox[{"E", ".", " ", "Martinez"}], "-", "Legaz"}], ",", " ", 
     RowBox[{
      RowBox[{
      "Dual", " ", "Representation", " ", "of", " ", "Cooperative", " ", 
       "Games", " ", "based", " ", "on", " ", "\n", "   ", "Fenchel"}], "-", 
      RowBox[{"Moreau", " ", "Conjugation"}]}], ",", " ", "Optimization", ",",
      " ", 
     RowBox[{
      RowBox[{"pp", ".", " ", "291"}], "-", "319"}], ",", " ", 
     RowBox[{"Vol", ".", " ", "36"}], ",", " ", 
     RowBox[{"1996.", "\n", "\n", "   ", 
      RowBox[{"H", ".", " ", "I", ".", " ", "Meinhardt"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "LP", " ", "approach", " ", "to", " ", "compute", " ", "the",
        " ", "pre"}], "-", 
      RowBox[{"kernel", " ", "for", " ", "cooperative", " ", "games"}]}], ",",
      " ", "\n", "   ", 
     RowBox[{"Computers", " ", "and", " ", "Operation", " ", "Research"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"Vol", " ", 
       RowBox[{"33", "/", "2"}], " ", 
       RowBox[{"pp", ".", " ", "535"}]}], "-", "557"}], ",", 
     RowBox[{"2006.", "\n", "\n", "   ", 
      RowBox[{"H", ".", " ", "I", ".", " ", "Meinhardt"}]}], ",", " ", 
     RowBox[{
      RowBox[{"The", " ", "Pre"}], "-", 
      RowBox[{
      "Kernel", " ", "as", " ", "a", " ", "Tractable", " ", "Solution", " ", 
       "for", " ", "Cooperative", " ", 
       RowBox[{"Games", ":", "\n", "   ", 
        RowBox[{
        "An", " ", "Exercise", " ", "in", " ", "Algorithmic", " ", "Game", 
         " ", "Theory"}]}]}]}], ",", " ", 
     RowBox[{
     "Theory", " ", "and", " ", "Decision", " ", "Library", " ", "C"}], ",", 
     "\n", "   ", 
     RowBox[{"Springer", " ", "Publisher"}], ",", " ", 
     RowBox[{
      RowBox[{"Heidelberg", ".", " ", "pp", ".", " ", "1"}], "-", "247"}], 
     ",", " ", 
     RowBox[{"2013.", "  ", "\n", "\n", "   ", 
      RowBox[{"H", ".", " ", "I", ".", " ", "Meinhardt"}]}], ",", " ", 
     RowBox[{
      RowBox[{"A", " ", "Characterization", " ", "of", " ", "Average"}], "-", 
      
      RowBox[{
      "Convexity", " ", "based", " ", "on", " ", "Unanimity", " ", 
       "Coordinates"}]}], ",", "  ", "\n", "    ", "mimeo", ",", " ", 
     RowBox[{"2009.", "  ", "\n", "\n", "   ", 
      RowBox[{"H", ".", " ", "I", ".", " ", "Meinhardt", ".", " ", "The"}], 
      " ", "Modiclus", " ", 
      RowBox[{"Reconsidered", ".", " ", "Technical"}], " ", "report"}], ",", 
     " ", 
     RowBox[{
     "Karlsruhe", " ", "Institute", " ", "of", " ", "Technology", "\n", "   ", 
      RowBox[{"(", "KIT", ")"}]}], ",", " ", "Karlsruhe", ",", " ", "Germany",
      ",", " ", 
     RowBox[{
      RowBox[{"2018", 
       RowBox[{"b", ".", " ", "URL"}], " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dx", ".", "doi", ".", "org"}], "/", "10.13140"}], "/", 
        "RG"}], ".2", ".2", ".32651", 
       RowBox[{
       ".75043", ".", "\n", "\n", "   ", "H", ".", " ", "I", ".", " ", 
        "Meinhardt", ".", " ", "Reconsidering"}], " ", "Related", " ", 
       "Solutions", " ", "of", " ", "the", " ", 
       RowBox[{"Modiclus", ".", " ", "Technical"}], " ", "report"}]}], ",", 
     "\n", "   ", 
     RowBox[{"Karlsruhe", " ", "Institute", " ", "of", " ", "Technology", " ", 
      RowBox[{"(", "KIT", ")"}]}], ",", " ", "Karlsruhe", ",", " ", "Germany",
      ",", " ", 
     RowBox[{
      RowBox[{"2018", 
       RowBox[{"c", ".", "\n", "   ", "URL"}], " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dx", ".", "doi", ".", "org"}], "/", "10.13140"}], "/", 
         "RG"}], ".2", ".2", ".27739", ".82729", "\n", "   ", "\n", "   ", 
        RowBox[{"A", ".", " ", "Meseguer"}]}], "-", "Artola"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "Using", " ", "the", " ", "Indirect", " ", "Function", " ", "to", " ", 
       "characterize", " ", "the", " ", "Kernel", " ", "of", " ", "a", " ", 
       "TU"}], "-", "Game"}], ",", "\n", "   ", 
     RowBox[{"Departament", " ", 
      RowBox[{"d", "'"}], "Economia", " ", "i", " ", 
      RowBox[{"d", "'"}], "Historia", " ", "Economica"}], ",", " ", 
     RowBox[{"1997.", " ", "\n", "   ", "\n", "   ", 
      RowBox[{"G", ".", " ", "Owen"}]}], ",", " ", 
     RowBox[{"A", " ", "Note", " ", "on", " ", "the", " ", "Nucleolus"}], ",",
      " ", 
     RowBox[{
     "International", " ", "Journal", " ", "of", " ", "Game", " ", "Theory"}],
      ",", " ", "\n", "   ", 
     RowBox[{"Vol", ".", " ", "3."}], ",", " ", 
     RowBox[{
      RowBox[{"pp", ".", " ", "101"}], "-", "103"}], ",", " ", 
     RowBox[{"1974.", " ", "\n", "   ", "\n", "   ", 
      RowBox[{"G", ".", " ", "Owen"}]}], ",", " ", 
     RowBox[{"Game", " ", "Theory"}], ",", " ", 
     RowBox[{"Third", " ", "Edition"}], ",", " ", 
     RowBox[{"Academic", " ", "Press"}], ",", " ", 
     RowBox[{"1995.", "\n", "\n", "   ", 
      RowBox[{"C", ".", " ", "Rafels"}], " ", "and", " ", 
      RowBox[{"N", ".", " ", "Ybern"}]}], ",", " ", 
     RowBox[{
     "Even", " ", "and", " ", "Odd", " ", "Marginal", " ", "Worth", " ", 
      "Vectors"}], ",", " ", 
     RowBox[{
      RowBox[{"Owen", "'"}], "s", " ", "\n", "   ", "Multilinear", " ", 
      "Extension", " ", "and", " ", "Convex", " ", "Games"}], ",", " ", 
     "IJGT", ",", " ", 
     RowBox[{"113", "-", "126"}], ",", " ", 
     RowBox[{"1995.", " ", "\n", "\n", "   ", 
      RowBox[{"L", ".", " ", "M", ".", " ", "Ruiz"}]}], ",", " ", 
     RowBox[{"F", ".", " ", "Valenciano"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", 
       RowBox[{"J", ".", " ", "M", ".", " ", "Zarzuelo", ".", " ", "The"}], 
       " ", "Least", " ", "Square", " ", "Pre"}], "-", 
      RowBox[{
      "Nucleolus", " ", "and", " ", "the", "\n", "   ", "Least", " ", 
       "Square", " ", 
       RowBox[{"Nucleolus", ".", " ", "Two"}], " ", "Values", " ", "for", " ",
        "TU", " ", "Games", " ", "based", " ", "on", " ", "the", " ", 
       "Excess", " ", 
       RowBox[{"Vector", ".", "\n", "   ", "International"}], " ", "Journal", 
       " ", "of", " ", "Game", " ", "Theory"}]}], ",", " ", 
     RowBox[{"25", ":", "113"}], "\[Dash]", "134", ",", " ", 
     RowBox[{"1996.", "\n", "   ", "\n", "   ", 
      RowBox[{"R", ".", " ", "T", ".", " ", "Rockafellar"}]}], ",", " ", 
     RowBox[{"Convex", " ", "Analysis"}], ",", " ", 
     RowBox[{"Princeton", " ", "University", " ", "Press"}], ",", " ", 
     RowBox[{"1970.", "\n", "\n", "   ", "Rosales"}], ",", " ", 
     RowBox[{"D", ".", " ", 
      RowBox[{"(", "2014", ")"}]}], ",", " ", 
     RowBox[{"Cooperative", " ", "product", " ", "games", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"www", ".", "academia", ".", "edu"}], "/", "401764"}], ")"}], 
      "\n", "\n", "   ", 
      RowBox[{"J", ".", " ", "M", ".", " ", "Solano"}], " ", "and", " ", 
      RowBox[{"C", ".", " ", "Rafels"}]}], ",", " ", 
     RowBox[{"Convexity", " ", "versus", " ", "average", " ", 
      RowBox[{"convexity", ":", " ", "potential"}]}], ",", " ", "\n", "   ", 
     "pmas", ",", " ", 
     RowBox[{
     "the", " ", "shapley", " ", "value", " ", "and", " ", "simple", " ", 
      "games"}], ",", " ", 
     RowBox[{"Documents", " ", "de", " ", "Treball"}], ",", " ", 
     RowBox[{"No", ".", " ", "3"}], ",", " ", "\n", "   ", 
     RowBox[{"Universitat", " ", "de", " ", "Barcelona"}], ",", " ", 
     RowBox[{"1996.", "\n", "\n", "   ", 
      RowBox[{"R", ".", "E", ".", " ", "Stearns"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "Convergent", " ", "Transfer", " ", "Schemes", " ", "for", " ", "N"}], 
      "-", 
      RowBox[{"Person", " ", "Games"}]}], ",", "\n", "   ", 
     RowBox[{
     "Transaction", " ", "American", " ", "Mathematical", " ", "Society"}], 
     ",", " ", 
     RowBox[{"449", "-", "459"}], ",", " ", 
     RowBox[{"1968.", "\n", "\n", "   ", "Sudhoelter", " ", 
      RowBox[{"(", "1997", ")"}]}], ",", " ", 
     RowBox[{"The", " ", "modified", " ", 
      RowBox[{"nucleolus", ":", " ", 
       RowBox[{"Properties", " ", "and", " ", 
        RowBox[{"axiomatizations", ".", "\n", "   ", "International"}], " ", 
        "Journal", " ", "of", " ", "Game", " ", "Theory"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"26", " ", 
       RowBox[{"(", "2", ")"}]}], ":", "147"}], "\[Dash]", "182", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Jun", " ", "1997.", " ", "ISSN", " ", "1432"}], "-", 
       RowBox[{"1270.", "\n", "   ", 
        RowBox[{"doi", ":", " ", 
         RowBox[{
          RowBox[{"10.1007", "/", 
           RowBox[{"BF01295846", ".", " ", "URL"}]}], " ", "https"}], 
         ":"}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"doi", ".", "org"}], "/", "10.1007"}], "/", 
        RowBox[{"BF01295846", ".", "\n", "   ", "\n", "   ", "Hal"}]}], " ", 
       "Varian", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ed", "."}], ")"}], ".", " ", "Economics"}], " ", "and", " ",
        "Financial", " ", "Modeling", " ", "with", " ", "Mathematica"}]}], 
     ",", " ", "\n", "   ", "Springer", ",", " ", "1992."}], " ", "\n", 
    "*)"}]}]}]], "Code",ExpressionUUID->"e2e3f6e7-c21a-429e-8df6-\
96e60704b36d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\n", "    ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "See", " ", "ChangeLog", " ", "file", " ", "for", " ", "a", " ", 
      "complete", " ", "list", " ", "of", " ", 
      RowBox[{"revisions", ".", "\n", "   ", "\n", "    ", "Version"}], " ", 
      "2.2"}], ":", "\n", "       ", 
     RowBox[{
     "Transcription", " ", "of", " ", "the", " ", "old", " ", "option", " ", 
      "rules", " ", "to", " ", "the", " ", "new", " ", "ones", " ", 
      "invented", " ", "by", " ", "Mathematica", " ", "8.", 
      RowBox[{"x", ".", "\n", "       ", "This"}], " ", "package", " ", "is", 
      " ", "now", " ", "exclusively", " ", "dedicated", " ", "to", " ", 
      "Mathematica", " ", "version", " ", "8.", "x", " ", "and", " ", 
      RowBox[{"higher", ".", "\n", "\n", "       ", 
       RowBox[{"FilledCore", "[", "]"}]}], " ", "is", " ", "deprecated", " ", 
      
      RowBox[{"now", ".", " ", "Using"}], " ", "the", " ", "old", " ", 
      "graphic", " ", "concept", " ", "Version", " ", "1.8", " ", "is", " ", 
      RowBox[{"required", ".", " ", "\n", "\n", "    ", "Version"}], " ", 
      "2.3"}], ":", "\n", "       ", "Modification", ":", "      ", "\n", 
     "       ", 
     RowBox[{"Change", " ", "protected", " ", "command", " ", 
      RowBox[{"SubsetQ", "[", "]"}], " ", "to", " ", 
      RowBox[{"SubSetQ", "[", "]"}], " ", "from", " ", "the", " ", 
      "VertexEnum", " ", 
      RowBox[{"package", ".", " ", "Order"}], " ", "is", "\n", "       ", 
      "reversed", " ", "to", " ", 
      RowBox[{"SubsetQ", "[", "]"}], " ", "which", " ", "is", " ", "new", " ",
       "in", " ", "Mathematica", " ", "version", " ", "10.", 
      RowBox[{"x", ".", "\n", "     ", "\n", "       ", "Some"}], " ", 
      "minor", " ", "code", " ", 
      RowBox[{"revision", ".", " ", "\n", "   ", "\n", "       ", "New"}], 
      " ", "Functions"}], ":", "\n", "        ", 
     RowBox[{
      RowBox[{"MLExtension", "[", "]"}], "           ", "-", " ", 
      RowBox[{"Computes", " ", "the", " ", "multi"}], "-", 
      RowBox[{"linear", " ", "extension", " ", "of", " ", "the", " ", 
       RowBox[{"game", ".", "\n", "        ", 
        RowBox[{"ShapleyValueML", "[", "]"}]}]}], "        ", "-", " ", 
      RowBox[{
      "Computes", " ", "the", " ", "Shapley", " ", "value", " ", "from", " ", 
       "the", " ", "multi"}], "-", 
      RowBox[{"linear", " ", "extension", " ", "of", " ", "the", " ", 
       RowBox[{"game", ".", "\n", "        ", 
        RowBox[{"PreKernel", "[", "]"}]}]}], "             ", "-", " ", 
      RowBox[{"Computes", " ", "a", " ", "pre"}], "-", 
      RowBox[{
      "kernel", " ", "point", " ", "by", " ", "Algorithm", " ", "8.2", ".1", 
       " ", "of", " ", "Meinhardt", " ", 
       RowBox[{
        RowBox[{"(", "2013", ")"}], ".", "\n", "\n", "       ", "Bug"}], " ", 
       
       RowBox[{"fixes", ":", "\n", "        ", 
        RowBox[{
         RowBox[{
          RowBox[{"FindKernelSolution", "[", "]"}], " ", "convergence", " ", 
          "process", " ", "to", " ", "the", " ", "kernel", " ", "should", " ",
           "be", " ", "now", " ", "more", " ", 
          RowBox[{"robust", ".", " ", "\n", "\n", "    ", "Version"}], " ", 
          "2.4", "\n", "\n", "       ", "Some", " ", "minor", " ", "code", 
          " ", 
          RowBox[{"revision", ".", "\n", "   ", "\n", "    ", "Version"}], 
          " ", "2.5", "\n", "\n", "       ", "Adding", " ", "the", " ", 
          "function", " ", 
          RowBox[{"ApproxNuc", "[", "]"}], " ", "to", " ", "compute", " ", 
          "the", " ", 
          RowBox[{"(", 
           RowBox[{"p", ",", "k"}], ")"}]}], "-", 
         RowBox[{
         "nucleolus", " ", "which", " ", "is", " ", "an", " ", 
          "approximation", " ", "of", "\n", "       ", "the", " ", 
          "nucleolus", " ", "by", " ", "a", " ", "non"}], "-", 
         RowBox[{"linear", " ", "optimization", " ", "approach"}]}]}]}]}]}], 
    ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
     RowBox[{"minimizes", " ", "a", " ", "p"}], "-", 
     RowBox[{
      RowBox[{"norm", ".", " ", "The"}], " ", "function", "\n", "       ", 
      RowBox[{"NonLinNuc", "[", "]"}], " ", "is", " ", "based", " ", "on", 
      " ", "this", " ", "function", " ", "to", " ", "compute", " ", "the", 
      " ", 
      RowBox[{"nucleolus", ".", " ", "We"}], " ", "extended", " ", "this", 
      " ", "idea", " ", "to", " ", "the", "\n", "       ", "pre"}], "-", 
     RowBox[{"nucleolus", " ", "through", " ", "the", " ", "commands", " ", 
      RowBox[{"ApproxPreNuc", "[", "]"}], " ", "and", " ", 
      RowBox[{
       RowBox[{"NonLinPreNuc", "[", "]"}], ".", " ", "In"}], " ", 
      "addition"}]}], ",", " ", 
    RowBox[{
    "we", " ", "added", "\n", "       ", "the", " ", "least", " ", "square", 
     " ", "computation", " ", "of", " ", "the", " ", 
     RowBox[{"(", 
      RowBox[{"pre", "-"}], ")"}], "nucleolus", " ", "by", " ", "the", " ", 
     "functions", " ", 
     RowBox[{"LSNuc", "[", "]"}], " ", "and", " ", 
     RowBox[{
      RowBox[{"LSPreNuc", "[", "]"}], ".", "\n", "\n", "       ", 
      "Functions"}], " ", "to", " ", "compute", " ", "the", " ", "barycenter",
      " ", "of", " ", "the", " ", "extreme", " ", "points", " ", "of", " ", 
     "the", " ", "core"}], ",", " ", 
    RowBox[{"dual", " ", "cover", " ", "game"}], ",", "\n", "       ", 
    RowBox[{"dual", " ", "extension"}], ",", " ", 
    RowBox[{"primal", " ", "extension"}], ",", " ", "modiclus", ",", " ", 
    RowBox[{
     RowBox[{"a", " ", "proper", " ", "modified", " ", "pre"}], "-", 
     RowBox[{"kernel", " ", "element"}]}], ",", "\n", "       ", 
    RowBox[{"potential", " ", "of", " ", "a", " ", "game"}], ",", " ", 
    RowBox[{"the", " ", "Lorenz", " ", "solution"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "Dutta"}], "-", 
     RowBox[{
     "Ray", " ", "solution", " ", "for", " ", "convex", " ", "games", "\n", 
      "       ", "have", " ", "been", " ", 
      RowBox[{"added", ".", "\n", "\n", "       ", "Bug"}], " ", 
      RowBox[{"fixes", ":", "\n", "        ", 
       RowBox[{
        RowBox[{
        "An", " ", "insufficient", " ", "coloring", " ", "of", " ", "the", 
         " ", "function", " ", 
         RowBox[{"FilledCoreV6", "[", "]"}], " ", "caused", " ", "by", " ", 
         "an", " ", "incomplete", " ", "delaunay", "\n", "        ", 
         "triangulation", " ", "of", " ", "the", " ", "Mathematica", " ", 
         "built"}], "-", 
        RowBox[{"in", " ", "function", " ", 
         RowBox[{"DelaunayTriangulation", "[", "]"}], " ", "has", " ", "been",
          " ", 
         RowBox[{"fixed", ".", "\n", "\n", "    ", "Version"}], " ", "2.5", 
         ".1", " ", "\n", "        ", "Installation", " ", "procedure", " ", 
         "has", " ", 
         RowBox[{"changed", ".", " ", "The"}], " ", "package", " ", "is", " ",
          "now", " ", "distributed", " ", "by", " ", 
         RowBox[{"Paclet", ".", " ", "The"}], " ", "documentation", "\n", 
         "        ", "was", " ", "revised", " ", "and", " ", 
         RowBox[{"extended", ".", " ", "About"}], " ", "230", " ", "pages", 
         " ", "were", " ", "added", " ", "to", " ", "the", " ", 
         RowBox[{"documentation", ".", " ", "The"}], " ", "error", " ", "\n", 
         "        ", "handling", " ", "of", " ", "functions", " ", "was", " ", 
         RowBox[{
         "improved", ".", "\n", "        ", "\n", "        ", "Some"}], " ", 
         "minor", " ", "code", " ", "revision", " ", "and", " ", "bug", " ", 
         RowBox[{"fixes", ".", "\n", "\n", "    ", "Version"}], " ", "2.5", 
         ".2", "\n", "\n", "        ", "We", " ", "have", " ", "revised", " ",
          "the", " ", "Install", " ", "procedure", " ", "of", " ", "the", " ",
          "Cddmathlink", " ", "library"}]}]}]}]}], ",", " ", 
    RowBox[{
    "which", " ", "makes", " ", "it", " ", "not", " ", "anymore", " ", 
     "necessary", "\n", "        ", "to", " ", "explicitly", " ", "formulate",
      " ", "some", " ", "conditions", " ", "for", " ", "all", " ", 
     "operating", " ", 
     RowBox[{"systems", ".", " ", "Moreover"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "some", " ", "binaries", " ", "for", " ", "RHEL", " ", "7.5", "\n", 
      "        ", "ships", " ", "now", " ", "with", " ", "the", " ", 
      RowBox[{"package", ".", "\n", "\n", "        ", "Some"}], " ", "minor", 
      " ", "code", " ", "revision", " ", "and", " ", "bug", " ", 
      RowBox[{"fixes", ".", "\t", "\n", "\n", "    ", "Version"}], " ", "2.5",
       ".3", "\n", "\n", "        ", "Adding", " ", "some", " ", "binaries", 
      " ", "for", " ", "Mathematica", " ", "10.0", " ", "or", " ", "later", 
      " ", "on", " ", "OS", " ", "X", " ", "10.9", " ", "or", " ", 
      RowBox[{"later", ".", " ", "We"}], " ", "are", " ", "very", " ", 
      "grateful", "\n", "        ", "to", " ", "Szabolcs", " ", 
      "Horv\[AAcute]t", " ", "for", " ", "providing", " ", "these", " ", "to",
       " ", "the", " ", 
      RowBox[{"community", ".", "\n", "\n", "        ", "Change"}], " ", "of",
       " ", "the", " ", "License", " ", "to", " ", "the", " ", "MIT", " ", 
      "License", " ", 
      RowBox[{"terms", ".", "\n", "\n", "    ", "Version"}], " ", "2.5", ".4",
       " ", "\n", "\n", "        ", "Functions", " ", "to", " ", "compute", 
      " ", "and", " ", "to", " ", "verify", " ", "the", " ", "simplified", 
      " ", "modified", " ", "pre"}], "-", 
     RowBox[{
      RowBox[{"kernel", "/", "nucleolus"}], " ", "are", " ", 
      RowBox[{"added", ".", " ", "They"}], " ", "are", " ", "called", "\n", 
      "        ", 
      RowBox[{"SMPrenucleolus", "[", "]"}]}]}], ",", 
    RowBox[{"IsSMPrenucleolusQ", "[", "]"}], ",", 
    RowBox[{"SMPreKernel", "[", "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"IsSMPreKernelQ", "[", "]"}], ".", " ", "For"}], " ", "the", 
     " ", "last", " ", "two", " ", "commands", " ", "we", " ", "implemented", 
     "\n", "        ", "parallel", " ", "counterparts", " ", "called", " ", 
     RowBox[{"ParaSMPreKernel", "[", "]"}]}], ",", 
    RowBox[{
     RowBox[{"and", " ", 
      RowBox[{"ParaIsSMPreKernelQ", "[", "]"}], " ", 
      RowBox[{"respectively", ".", "\n", "\n", "        ", "Adding"}], " ", 
      "the", " ", "function", " ", 
      RowBox[{"BalancedCollectionQ", "[", "]"}], " ", "that", " ", "should", 
      " ", "replace", " ", "in", " ", "the", " ", "future", " ", "the", " ", 
      "function", " ", 
      RowBox[{
       RowBox[{"BalancedSelectionQ", "[", "]"}], ".", "\n", "        ", 
       "For"}], " ", "n"}], "=", 
     RowBox[{">", 
      RowBox[{
      "4", " ", "the", " ", "function", " ", "returns", " ", "incorrect", " ",
        "results"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "probably", " ", "caused", " ", "by", " ", "a", " ", "bug", " ", "of", 
       " ", "the", " ", 
       RowBox[{"DualLinearProgramming", "[", "]"}], " ", 
       RowBox[{"function", ".", "\n", "\n", "        ", "Example"}], " ", 
       "of", " ", "incorrect", " ", 
       RowBox[{"results", ":", "\n", "\n", "        ", 
        RowBox[{
        "Consider", " ", "the", " ", "collection", " ", "of", " ", "sets", 
         " ", "given", " ", "by", " ", "\n", "\n", "        ", "cS4"}]}]}], 
      "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", " ", 
        RowBox[{"{", "2", "}"}], ",", " ", 
        RowBox[{"{", "3", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", " ", "4"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"3", ",", " ", "4"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", " ", "3", ",", " ", "4"}], "}"}]}], "}"}]}], ";", 
     "\n", "\n", "        ", 
     RowBox[{
      RowBox[{
      "then", " ", "the", " ", "return", " ", "value", " ", "is", " ", 
       "false", " ", "\n", "\n", "         ", 
       RowBox[{"In", "[", "29", "]"}]}], ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"BalancedSystemQ", "[", 
          RowBox[{"cS4", ",", " ", 
           RowBox[{"Range", "[", "4", "]"}]}], "]"}], "]"}], "\n", "\n", 
        "         ", 
        RowBox[{"Out", "[", "29", "]"}]}], "=", " ", 
       RowBox[{"False", "\n", "  ", "\n", "        ", "However"}]}]}]}], ",", 
    " ", 
    RowBox[{"the", " ", "system", " ", "is", " ", "balanced"}], ",", " ", 
    RowBox[{
     RowBox[{
     "since", " ", "the", " ", "balancing", " ", "weights", " ", "are", " ", 
      "given", " ", "by", " ", "\n", "\n", "        ", "whgs"}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "3", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", 
           ",", "1"}], "}"}], "/", "5"}], "\n", "       ", "\n", "        ", 
        "Related", " ", "to", " ", "this", " ", "context", " ", "we", " ", 
        "provide", " ", "the", " ", "function", " ", 
        RowBox[{"BalancedInequalityQ", "[", "]"}], " ", "to", " ", "check", 
        " ", "whether", " ", "a", " ", "balanced", " ", "system", "\n", 
        "        ", "satisfies", " ", "a", " ", "balanced", " ", "inequality",
         " ", "of", " ", "a", " ", "TU"}], "-", 
       RowBox[{
        RowBox[{"game", ".", " ", "Notice"}], " ", "that", " ", "if", " ", 
        "all", " ", "balanced", " ", "systems", " ", "satisfying", " ", 
        "this", " ", "property", "\n", "        ", "non"}], "-", 
       RowBox[{
       "emptiness", " ", "of", " ", "the", " ", "core", " ", "is", " ", 
        RowBox[{"guaranteed", ".", " ", "Recall"}], " ", "that", " ", "for", 
        " ", "n"}]}], "=", 
      RowBox[{
      "4", " ", "we", " ", "need", " ", "to", " ", "check", " ", "9", " ", 
       "equivalence", " ", "classes"}]}]}], ",", " ", "however", ",", "\n", 
    "        ", 
    RowBox[{
     RowBox[{"for", " ", "n"}], "=", 
     RowBox[{
      RowBox[{
      "6", " ", "we", " ", "have", " ", "to", " ", "check", " ", "158", " ", 
       RowBox[{"classes", ".", "\n", "\n", "    ", "Version"}], " ", "2.6", 
       ".0", "\n", "\n", "       ", "Adding", " ", "functions", " ", "to", 
       " ", "compute", " ", "the", " ", "EPSD"}], "-", "Value"}]}], ",", " ", 
    
    RowBox[{"Chi", "-", "Value"}], ",", " ", 
    RowBox[{"PD", "-", 
     RowBox[{
     "Value", " ", "and", " ", "the", " ", "nucleolus", " ", "by", " ", "the",
       " ", "Leng", " ", "and", " ", "Parlar", " ", 
      RowBox[{"(", "2010", ")"}], " ", "formulae", " ", "for", " ", "three", 
      " ", "person", "\n", "       ", "zero"}], "-", 
     RowBox[{"normalized", " ", "and", " ", "super"}], "-", 
     RowBox[{"additive", " ", 
      RowBox[{"games", ".", " ", "Changing"}], " ", "the", " ", "package", 
      " ", "extension", " ", "from", " ", "*", 
      RowBox[{".", "m"}], " ", "to", " ", "*", 
      RowBox[{".", "wl", ".", "\n", "\n", "       ", "Performing"}], " ", 
      "some", " ", "code", " ", "maintenance", " ", "and", " ", "minor", " ", 
      "bug", " ", 
      RowBox[{"fixes", ".", "\n", "\n", "    ", "Version"}], " ", "2.6", ".1",
       "\n", "\n", "       ", "Code", " ", "revision", " ", "and", " ", 
      RowBox[{"optimization", ".", " ", "The"}], " ", 
      RowBox[{"(", 
       RowBox[{"anti", "-"}], ")"}], "pre"}], "-", 
     RowBox[{
     "kernel", " ", "computation", " ", "is", " ", "now", " ", "faster", " ", 
      "up", " ", "to", " ", "a", " ", "factor", " ", "3", " ", "in", " ", 
      "serial", " ", "as", " ", "well", " ", "as", " ", "in", " ", 
      RowBox[{"parallel", ".", "\n", "\n", "    ", "Version"}], " ", "2.6", 
      ".2", "\n", "\n", "       ", "Adding", " ", 
      RowBox[{"functions", ":", "\n", "            ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "  ", 
          RowBox[{"AlmostConvexQ", "[", "]"}]}], " ", "to", " ", "check", " ",
          "if", " ", "the", " ", "game", " ", "is", " ", "almost", " ", 
         RowBox[{"convex", ".", " ", "\n", "            ", 
          RowBox[{"-", "  ", 
           RowBox[{"AlmostConcaveQ", "[", "]"}]}]}], " ", "to", " ", "check", 
         " ", "if", " ", "the", " ", "game", " ", "is", " ", "almost", " ", 
         RowBox[{"concave", ".", "\n", "            ", 
          RowBox[{"-", "  ", 
           RowBox[{"ADMCGameQ", "[", "]"}]}]}], " ", "to", " ", "check", " ", 
         "the", " ", "property", " ", "if", " ", "the", " ", "game", " ", 
         "satisfies", " ", "almost", " ", "diminishing", " ", "marginal", " ", 
         RowBox[{"contributions", ".", "\n", "            ", 
          RowBox[{"-", "  ", 
           RowBox[{"AIMCGameQ", "[", "]"}]}]}], " ", "to", " ", "check", " ", 
         "the", " ", "property", " ", "if", " ", "the", " ", "game", " ", 
         "satisfies", " ", "almost", " ", "increasing", " ", "marginal", " ", 
         
         RowBox[{"contributions", ".", "\n", "            ", 
          RowBox[{"-", "  ", 
           RowBox[{"kConvexity", "[", "]"}]}]}], " ", "to", " ", "check", " ",
          "if", " ", "the", " ", "game", " ", "is", " ", "k"}], "-", 
        RowBox[{
         RowBox[{"convex", ".", " ", "\n", "            ", 
          RowBox[{"-", "  ", 
           RowBox[{"EANSCValue", "[", "]"}]}]}], " ", "to", " ", "compute", 
         " ", "the", " ", "Equal", " ", "Allocation", " ", "of", " ", "Non"}],
         "-", 
        RowBox[{"Separable", " ", 
         RowBox[{"Contribution", "/", "Cost"}], " ", 
         RowBox[{"value", ".", "\n", "\n", "       ", "Revised"}], " ", "the",
          " ", "functions"}]}], ":", "\n", "              ", 
       RowBox[{"ConvexQ", "[", "]"}]}]}]}], ",", " ", 
    RowBox[{"ConcaveQ", "[", "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Nuc1convex", "[", "]"}], ".", "\n", "\n", "       ", "Minor"}],
      " ", "Bug", " ", "fixes", " ", "and", " ", "code", " ", 
     RowBox[{"revision", ".", "\n", "\n", "    ", "Version"}], " ", "3.0", 
     ".0", "\n", "\n", "       ", "Not", " ", "anymore", " ", "backward", " ",
      "compatible", " ", "to", " ", "Mathematica", " ", "versions", " ", 
     "smaller", " ", "than", " ", "12", " ", "due", " ", "to", " ", "the", 
     " ", "port", "\n", "       ", "to", " ", "the", " ", "new", " ", 
     "collection", " ", "of", " ", "algorithms", " ", "for", " ", "solving", 
     " ", "convex", " ", "problems", " ", "introduced", " ", "in", " ", 
     "version", " ", "12.", "\n", "\n", "       ", 
     RowBox[{"ConstrainedMax", "/", "ConstrainedMin"}], " ", "and", " ", 
     RowBox[{"LinearProgramming", "/", "DualLinearProgramming"}], " ", "are", 
     " ", "replaced", " ", "by", " ", 
     RowBox[{"LinearOptimization", ".", "\n", "\n", "       ", "This"}], " ", 
     "replacement", " ", "has", " ", "been", " ", "conducted", " ", "for", 
     " ", "the", " ", "following", " ", 
     RowBox[{"functions", ":", "\n", "\n", "       ", 
      RowBox[{
       RowBox[{"Nucleolus", "                  ", "--"}], " ", "Part", " ", 
       "of", " ", 
       RowBox[{"CooperativeGames", ".", " ", "Function"}], " ", "originally", 
       " ", "written", " ", "by", " ", 
       RowBox[{"M", ".", " ", "Carter", ".", "\n", "       ", 
        RowBox[{"LeastCoreAux", "               ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"CooperativeGames", ".", " ", "Function"}], " ", "originally", 
       " ", "written", " ", "by", " ", 
       RowBox[{"M", ".", " ", "Carter", ".", "\n", "       ", 
        RowBox[{"ModifiedNucleolus", "          ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"ModifiedKernel", "             ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"PreNucleolus", "               ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"LexiCenter", "                 ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"Modiclus", "                   ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"IsModiclusQ", "                ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"Kernel", "                     ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"KernelCalculation", "          ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"BalancedInequalityQ", "        ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"BalancedCollectionQ", "        ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"EpsCore", "                    ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"FirstCriticalVal", "           ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"DeltaLP", "                    ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"FeasibleConstraints", "        ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"KernelVertices", "             ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGames", ".", "\n", "       ", 
        RowBox[{"SolvePrimal", "                ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGamesAux", ".", "\n", "       ", 
        RowBox[{"SolveDual", "                  ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGamesAux", ".", "\n", "       ", 
        RowBox[{"BalancedSystemQ", "            ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"TuGamesAux", ".", "\n", "       ", 
        RowBox[{"ParaModiclus", "               ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"ParaTuGames", ".", "\n", "       ", 
        RowBox[{"ParaIsModiclus", "             ", "--"}]}], " ", "Part", " ",
        "of", " ", 
       RowBox[{"ParaTuGames", ".", "\n", "       ", "\n", "      ", "New"}], 
       " ", "added", " ", "functions", " ", "are"}], ":", "\n", "      ", 
      RowBox[{
       RowBox[{"WeaklyBalancedCollectionQ", "   ", "--"}], " ", "Part", " ", 
       "of", " ", 
       RowBox[{"TuGames", ".", "\n", "      ", 
        RowBox[{"WeaklyBalancedSystemQ", "       ", "--"}]}], " ", "Part", 
       " ", "of", " ", 
       RowBox[{
       "TuGamesAux", ".", "       ", "\n", "\n", "\n", "     ", "The"}], " ", 
       "function", " ", "WeaklyBalancedCollectionQ", " ", "replaces", " ", 
       "WeaklyBalancedSelectionQ"}]}]}], ",", " ", 
    RowBox[{
    "the", " ", "latter", " ", "will", " ", "be", " ", "deprecated", " ", 
     "in", " ", "a", " ", "future", " ", 
     RowBox[{"version", ".", "\n", "\n", "     ", "Version"}], " ", "3.0", 
     ".1", "\n", "\n", "     ", "Improved", " ", "exception", " ", "handling",
      " ", "for", " ", "functions", " ", "using", " ", 
     RowBox[{"LinearOptimization", ".", " ", "Performance"}], " ", 
     "improving", " ", "of", " ", "revised", " ", "functions", " ", "in", " ",
      "Version", " ", "3.", "\n", "\n", "     ", "Some", " ", "minor", " ", 
     "bug", " ", 
     RowBox[{"fixes", ".", "\n", "\n", "     ", "Version"}], " ", "3.0", ".2",
      "\n", "\n", "     ", "Adjusting", " ", "the", " ", "functions", "\n", 
     "     ", "\n", "       ", 
     RowBox[{"ApproxPreNuc", "                ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "\n", "       ", 
    RowBox[{
     RowBox[{"ApproxNuc", "                   ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "\n", "       ", 
    RowBox[{
     RowBox[{"DuttaRay", "                    ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "  ", "\n", "       ", 
    RowBox[{
     RowBox[{"LorenzSolution", "              ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "\n", "       ", 
    RowBox[{
     RowBox[{"NonLinPreNuc", "                ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "\n", "       ", 
    RowBox[{
     RowBox[{"NonLinNuc", "                   ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames"}], ",", "\n", "       ", 
    RowBox[{
     RowBox[{"PreKernelSolution", "           ", "--"}], " ", "Part", " ", 
     "of", " ", "TuGames", "\n", "\n", "    ", "to", " ", "the", " ", "new", 
     " ", "set", " ", "of", " ", "optimization", " ", 
     RowBox[{"algorithms", ".", "\n", "\n", "    ", "Adding"}], " ", 
     "options", " ", "to", " ", "the", " ", "functions", " ", "PreKernelQ"}], 
    ",", " ", "MaxExcessBalanced", ",", " ", "AntiPreKernelQ", ",", " ", 
    "MinExcessBalanced", ",", " ", "ParaPreKernelQ", ",", " ", 
    "ParaMaxExcessBalanced", ",", " ", "ParaAntiPreKernelQ", ",", " ", 
    RowBox[{
     RowBox[{
     "ParaMinExcessBalanced", ".", "\n", "    ", "\n", "    ", "Improving"}], 
     " ", "the", " ", "performance", " ", "of", " ", 
     RowBox[{"PreKernelSolution", ".", "\n", "\n", "    ", "Some"}], " ", 
     "minor", " ", "bug", " ", "fixes", " ", "and", " ", "code", " ", 
     RowBox[{"revision", ".", " ", "\n", "\n", "    ", "Version"}], " ", 
     "3.0", ".3", "\n", "\n", "    ", "Adding", " ", "the", " ", "new", " ", 
     RowBox[{"functions", ":", "\n", "\n", "      ", "VetoRichPlayers"}]}], 
    ",", " ", "DecomposeInPositiveGames", ",", " ", "AverageConcaveQ", ",", 
    " ", "AlmostAverageConvexQ", ",", " ", "AlmostAverageConcaveQ", ",", " ", 
    "PositiveGameQ", ",", " ", 
    RowBox[{
     RowBox[{"SemiConvexQ", ".", "\n", "\n", "    ", "Fixing"}], " ", "Bug", 
     " ", "in", " ", "AnimationKernelProperty2d", " ", "with", " ", "the", 
     " ", "FigureSize", " ", "option", " ", "in", " ", 
     RowBox[{
     "Manipulate", ".", " ", "\n", "       ", "\n", "    ", "Fixing"}], " ", 
     "an", " ", "issue", " ", "in", " ", "ModifiedNucleolus", " ", "and", " ",
      "ModifiedKernel", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "boundary", " ",
      "Infinity"}], ",", " ", 
    RowBox[{"which", " ", "was", " ", "replaced", " ", "by", " ", "1000", "*", 
     RowBox[{
      RowBox[{"v", "[", "T", "]"}], ".", "\n", "\n", "    ", "Some"}], " ", 
     "minor", " ", "bug", " ", "fixes", " ", "and", " ", "code", " ", 
     RowBox[{"revision", ".", "   ", "\n", "\n", "    ", "Version"}], " ", 
     "3.1", ".0", "\n", "\n", "    ", "Update", " ", "of", " ", "the", " ", 
     "Documentation", " ", "references", " ", "pages", " ", "and", " ", 
     "adjustment", " ", "to", " ", "Mathematica", " ", "Version", " ", 
     RowBox[{"13.0", ".", "\n", "\n", "    ", "Version"}], " ", "3.1", ".1", 
     "\n", "\n", "    ", "Adding", " ", "the", " ", "new", " ", 
     RowBox[{"functions", ":", "\n", "\n", "    ", "ProductGame"}]}], ",", 
    " ", "ProbabilityGame", ",", " ", "HarsanyiValue", ",", " ", 
    "ShapAirProb", ",", " ", "TauValAirProb", ",", " ", 
    RowBox[{"NucAirProb", "."}]}], "\n", "\n", "\n", "*)"}], "\n", " ", "\n", 
  "\n", 
  RowBox[{"(*", " ", "\n", "    ", 
   RowBox[{":", "Limitations", ":", " ", "\n", "    ", 
    RowBox[{"see", " ", 
     RowBox[{
      RowBox[{"TUG", "/", "Guides"}], "/", "ManualTuGames"}], " ", "from", 
     " ", "the", " ", "Documentation", " ", 
     RowBox[{"Center", "."}]}]}], " ", "\n", "*)"}]}]], "Code",ExpressionUUID->\
"75831a7b-c20e-4707-97e5-4c0fe20aa269"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\n", "   ", 
   RowBox[{
    RowBox[{":", 
     RowBox[{"General", " ", "Remarks"}], ":", "\n", " ", "\n", "     ", 
     RowBox[{"Since", " ", "version", " ", "2.5", ".3"}]}], ",", " ", 
    RowBox[{
    "this", " ", "project", " ", "is", " ", "licensed", " ", "under", " ", 
     "the", " ", "MIT", " ", "License", " ", 
     RowBox[{"terms", "."}]}]}], "\n", "    ", "\n", "*)"}], "\n"}]], "Code",E\
xpressionUUID->"3c085f4e-36ef-4b6d-9ce6-27d846de35c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{":", "Requirements", ":", " ", "\n", " ", "\n", "   ", 
     RowBox[{"The", " ", "Package", " ", 
      RowBox[{"Cooperat", ".", "m"}], " ", "by", " ", "Michael", " ", 
      "Carter", " ", "and", " ", 
      RowBox[{"VertexEnum", ".", "m"}], " ", "\n", "   ", "by", " ", "Komei", 
      " ", "Fukuda", " ", "and", " ", "Ichiro", " ", 
      RowBox[{"Mizukoshi", ".", " ", "The"}], " ", 
      RowBox[{"program", " ", "'"}], 
      RowBox[{"cddmathlink", "'"}], " ", "by", " ", "Komei", "\n", "   ", 
      "Fukuda", " ", "is", " ", "highly", " ", "recommended", " ", "for", " ",
       "calculating", " ", "all", " ", "extreme", "\n", "   ", "points", " ", 
      "of", " ", "the", " ", 
      RowBox[{"core", ".", " ", "Nevertheless"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "it", " ", "is", " ", "not", " ", "necessary", " ", "to", " ", "have", 
       " ", "installed", "\n", "   ", "the", " ", "C"}], "-", 
      RowBox[{
      "library", " ", "on", " ", "your", " ", "computer", " ", "to", " ", 
       "run", " ", "properly", " ", "the", " ", 
       RowBox[{"package", " ", "'"}], 
       RowBox[{"TuGames", ".", 
        RowBox[{"m", "'"}], ".", " ", "\n", "   ", "Some"}], " ", "pre"}], 
      "-", 
      RowBox[{"compiled", " ", "binaries", " ", "of", " ", "the", " ", "C"}], 
      "-", 
      RowBox[{
      "library", " ", "can", " ", "be", " ", "found", " ", "under", "\n", 
       "   ", 
       RowBox[{"https", ":"}]}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"inf", ".", "ethz", ".", "ch"}], "/", "personal"}], "/", 
         "fukudak"}], "/", "cdd_home"}], "/", "\n", "   ", "As"}], " ", "a", 
      " ", "substitute", " ", "use", " ", "the", " ", "function", " ", 
      RowBox[{"VerticesCore", "[", "]"}], " ", "that", " ", "is", " ", 
      "based", " ", "on", "\n", "   ", 
      RowBox[{"VertexEnum", ".", "m", "."}]}]}]}], " ", "\n", "*)"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{":", "Acknowledgment", ":", "\n", "\n", "   ", 
     RowBox[{
     "We", " ", "are", " ", "very", " ", "thankful", " ", "to", " ", 
      "Szabolcs", " ", "Horv\[AAcute]t", " ", "for", " ", "his", " ", 
      "helpful", " ", "support"}]}], ",", " ", 
    RowBox[{"suggestion", " ", "of", " ", "improvements"}], ",", "\n", "   ", 
    
    RowBox[{
    "and", " ", "of", " ", "his", " ", "piece", " ", "of", " ", "advice", " ",
      "to", " ", "follow", " ", "best", " ", "practice", " ", "of", " ", 
     "publicizing", " ", "a", " ", "Mathematica", " ", "package", "\n", "   ",
      "that", " ", "allows", " ", "a", " ", "custom", " ", "installation", 
     " ", "for", " ", 
     RowBox[{"everyone", ".", " ", "Moreover"}]}], ",", " ", 
    RowBox[{
    "we", " ", "owe", " ", "him", " ", "executables", " ", "for", "\n", "   ",
      "MacOSX"}], ",", " ", 
    RowBox[{
     RowBox[{"which", " ", "ship", " ", "with", " ", "this", " ", 
      RowBox[{"version", ".", "\n", "\n", "\n", "   ", "The"}], " ", "author",
       " ", "acknowledge", " ", "support", " ", "by", " ", "the", " ", 
      "state", " ", "of", " ", "Baden"}], "-", 
     RowBox[{"W\[UDoubleDot]rttemberg", " ", "through", " ", 
      RowBox[{"bwHPC", "."}]}]}]}], "\n", "*)"}], "   "}]], "Code",ExpressionU\
UID->"d6d4a740-1a52-4a1a-bb97-1c6898484fc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<TUG`TuGames`\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<TUG`coop`CooperativeGames`\>\"", ",", "\"\<TUG`TuGamesAux`\>\"", 
      ",", "\"\<TUG`vertex`VertexEnum`\>\"", ",", 
      "\"\<ComputationalGeometry`\>\""}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SameQ", "[", 
      RowBox[{"Global`$ParaMode", ",", "\"\<False\>\""}], "]"}], ",", "\n", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<===================================================\>\"", "]"}], 
      ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Loading Package 'TuGames' for \>\"", ",", " ", 
        "$OperatingSystem"}], "]"}], ";", "\n", 
      RowBox[{
      "Print", "[", 
       "\"\<===================================================\>\"", "]"}], 
      ";", "\n", 
      RowBox[{
      "Print", "[", "\"\<TuGames V3.1.2 by Holger I. Meinhardt\>\"", "]"}], 
      ";", "\n", 
      RowBox[{"Print", "[", "\"\<Release Date: 08.05.2023\>\"", "]"}], ";", 
      "\n", 
      RowBox[{
      "Print", "[", 
       "\"\<Program runs under Mathematica Version 12.0 or later\>\"", "]"}], 
      ";", "\n", 
      RowBox[{
      "Print", "[", "\"\<Version 12.x or higher is recommended\>\"", "]"}], 
      ";", "\n", 
      RowBox[{
      "Print", "[", 
       "\"\<===================================================\>\"", "]"}], 
      ";"}], ",", "\n", "   ", "True"}], "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", 
   RowBox[{
   "The", " ", "following", " ", "describes", " ", "some", " ", "useful", " ",
     "functions", " ", "in", " ", "the", " ", "package", " ", "to", "\n", 
    "check", " ", "properties", " ", "of", " ", "a", " ", 
    RowBox[{"game", "."}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineGame", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<GameName := (DefineGame[T,values];); defines the game to be\n \
analyzed. T is the player set and values are the worth for the coalitions.\n \
Do not forget the semicolons, otherwise some compatibly problems with\n M. \
Carter's ShapleyValue[] occurs\>\""}], ";"}]}], "Code",ExpressionUUID->\
"0bdec12d-1e77-4060-8d94-9046322980fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DualGame", "::", "usage"}], "=", " ", "\n", 
    "\"\<DualGame[game] assigns to each coalition the value what it can \
extract from \n the grand coalition by leaving the grand coalition.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CostSaving", "::", "usage"}], "=", "\n", 
    "\"\<CostSaving[costvec_List,T] computes the cost savings for each \
coalition\n from the vector of costs 'costvec'.  T is the player set. The \
resultant cost\n saving vector can be used to define a new game.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SuperAdditiveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SuperAdditiveQ[game, options] checks if a game is \
superadditive.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeaklySuperAdditiveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<WeaklySuperAdditiveQ[game] checks if a game is weakly superadditive.\
\n Suppose the coalitions S_1,S_2,...S_k partition the grand coalition T, \n \
then the game v is weakly superadditive, if sum_i v(S_i) <= v(T). \n This \
superadditivity property is a necessary condition for the core  \n of the \
game v to be nonempty.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelectSuperSets", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SelectSuperSets[i] selects all super sets of i\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PositiveGameQ", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<PositiveGameQ[game] returns True whenever all unanimity coordinates \
are non-negative, otherwise False.\>\""}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncreasingMargContributions", "::", "usage"}], " ", "=", " ", 
    "\n", "\"\<IncreasingMargContributions[game,i] checks if the marginal \
contributions of player i is increasing.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DecomposeInPositiveGames", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<{True/False,{pg1,pg2,cg}}=DecomposeInPositiveGames[game] decomposes a \
TU game into a difference of two positive (i.e., convex) games, denoted by \
pg1 and pg2. The symbol cg is the recomposed game.\>\""}], ";"}]}], "Code",Exp\
ressionUUID->"73f67a6c-e9ee-4279-8d67-29f79289bbdf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvCheck", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConvCheck[game] checks the convexity of the game. It provides \
information whether \n the marginal contributions are increasing for each \
player.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConvexQ[game] checks if the Tu-game is convex (super-modular). It \
returns the value 'True' or 'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostConvexQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AlmostConvexQ[game] checks if the Tu-game is almost convex (average \
super-modular). It returns the value 'True' or 'False'.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostAverageConvexQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AlmostAverageConvexQ[game] checks if the Tu-game is almost \
average-convex (almost average super-modular). It returns the value 'True' or \
'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostConcaveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AlmostConcaveQ[game] checks if the Tu-game is almost concave (almost \
sub-modular). It returns the value 'True' or 'False'.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostAverageConcaveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AlmostAverageConcaveQ[game] checks if the Tu-game is almost \
average-concave (almost average sub-modular). It returns the value 'True' or \
'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConcaveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConcaveQ[game] checks if the Tu-game is concave (sub-modular). It \
returns the value 'True' or 'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrIncreasMargContrib", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<StrIncreasMargContrib[game,i] checks if the marginal contributions \
of player i is \n strictly increasing.\>\""}], ";"}], " ", "\n", "  "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvStrQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConvStrQ[game] checks if the Tu-game is strictly convex. It provides \
information \n whether the marginal contributions are increasing for each \
player.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexStrQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConvexStrQ[game] checks if the Tu-game is strictly convex. It \
returns only 'True' or 'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AverageConvexQ", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<AverageConvexQ[game,opts] checks the average-convexity of the game.\n \
It returns 'True' or 'False'. Calling the function with the option will \
return\n the sum of the marginal contributions for each coalition S w.r.t. to \
each \n superset S union {j}. These values must be non-negative.\>\""}], 
  ";"}]}], "Code",ExpressionUUID->"fa555de0-d1e2-4117-b41e-edf182b17225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvConvexQ", "::", "usage"}], " ", "=", "   ", "\n", 
    "\"\<AvConvexQ[game, opts] checks the average-convexity of the game.   \n \
It returns 'True' or 'False'. Now same as AverageConvexQ[]. \n For more \
details see also the description of AverageConvexQ[].\>\""}], ";"}], "  ", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AverageConcaveQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AverageConcaveQ[game,opts] checks the average-concavity of the game.\
\n It returns 'True' or 'False'. Calling the function with the option will \
return\n the sum of the marginal contributions for each coalition S w.r.t. to \
each \n superset S union {j}. These values must be non-positive.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AvConcaveQ", "::", "usage"}], " ", "=", "   ", "\n", 
    "\"\<AvConcaveQ[game, opts] checks the average-concavity of the game.   \n\
 It returns 'True' or 'False'. Now same as AverageConcaveQ[]. \n For more \
details see also the description of AverageConcaveQ[].\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ADMCGameQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ADMCGameQ[game] checks if the TU-game satisfies the property of \
almost diminishing marginal contributions. It returns 'True' or \
'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AIMCGameQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AIMCGameQ[game] checks if the TU-game satisfies the property of \
almost increasing marginal contributions. It returns 'True' or \
'False'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GameMonotoneQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<GameMonotoneQ[game] verifies if the game is monotone.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MonotoneQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MonotoneQ[game] verifies if the game is monotone. This is done for \
all sub-games.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroMonotoneQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ZeroMonotoneQ[game] verifies if the game is zero-monotone.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroNormalization", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ZeroNormalization[game] determines the zero-normalized game.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOneNormalization", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ZeroOneNormalization[game] determines the (0,1)-normalized \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OneNormalization", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<OneNormalization[game] determines the one-normalized game.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmallestContributionVector", "::", "usage"}], " ", "=", " ", 
    "\n", "\"\<SmallestContribution[game] calculates the vector of the \
smallest contributions.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmallestContribution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SmallestContribution[game,i] calculates the smallest contribution of \
player i.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Scrb", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Scrb[game,i] calculates the separable cost-remaining benefits for \
player i. See Funaki (1986).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScrbSolution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ScrbSolution[game] calculates the separable cost-remaining benefits. \
See Funaki (1986).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TIJsets", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<TIJsets[i,j] computes the coalitions which contains player i but not \
j.\>\""}], ";"}]}], "Code",ExpressionUUID->"108c5838-a73b-4104-b02b-\
010b7a43d0c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExcessPayoff", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ExcessPayoff[game,payoff] calculates the excess vector for the \
(pre-)imputation 'payoff'.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxExcessBalanced", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MaxExcessBalanced[game,payoff] determines whether the maximum \
surpluses induced by \n the imputation 'payoff' are maximal balanced among \
the players. Be careful, the \n function does not check the efficiency \
property.  For checking in addition the efficiency\n property consult the \
function PreKernelQ[].\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinExcessBalanced", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MinExcessBalanced[game,payoff] determines whether the minimum \
surpluses induced by the \n imputation 'payoff' are minimal balanced among \
the players. Be careful, the function does \n not check the efficiency \
property.  For checking in addition the efficiency \n property consult the \
function AntiPreKernelQ[].\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxExcessSets", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MaxExcessSets[game,payoff] computes the set of proper coalitions \
having largest excesses.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectionOfMaxExcessSets", "::", "usage"}], " ", "=", " ", 
    "\n", "\"\<IntersectionOfMaxExcessSets[game, payoff] determines if the \
set of proper coalitions having\n largest excesses has an empty intersection.\
\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelCalculation", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<KernelCalculation[game,options] computes kernel or pre-kernel \
point(s) of a game. \n Optional parameters are: ChangeInternalEps, \
DisplayAllResults, EpsilonValue and \n SetGameToNonZeroMonotonic. The first \
optional parameter ChangeInternalEps can \n be used to speed up computation \
or to search for different allocations in the initial LPs.\n If the option \
DisplayAllResults is set to 'True', then the return value is related\n to a \
kernel solution, objective function, constraint set of the final LP, \n all \
bi-symmetrical transfers, and the allocations computed by the initial LPs.\n \
In this case invoke the function by \
{solker,obj,const,tra,pay}=KernelCalculation[game].\n The default value is \
set to 'False', that is, the return value is just related to a kernel \n \
solution and the allocation obtained by the initial LPs. The option \
EpsilonValue is a critical \n value for changing the strong epsilon-core. \
This value can be calculated, for instance,\n by the function \
FirstCriticalVal[game]. A solution can be checked with the functions \n \
KernelImputationQ[], KernelImputationListQ[], PreKernelQ[], or \
MaxExcessBalanced[]. To \n search for a kernel solution of an non \
zero-monotonic game set the last variable to \n 'True', but in this case the \
function need not to terminate properly. For its default value \n 'False' the \
function Kernel[game] will be invoked to avoid infinite loops. To increases \
the \n computational reliability in cases of numerical issues the following \
methods can be used: \n RevisedSimplex, CLP, GUROBI, MOSEK, or Automatic. \
Default setting is Automatic. This option\n can be used in either case by \
CallMaximize->False. For getting more \n precise results one can even set \
Method->{InteriorPoint, Tolerance->10^-10}.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Kernel", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Kernel[game,options] computes a kernel point of the game from one \
LP. Options are:\n DisplayAllResults and EpsilonValue. If the option \
DisplayAllResults is set to 'True', \n then the return value is related to a \
kernel solution, objective function, constraint \n set of the final LP, the \
complete variable set, and all bi-symmetrical transfers. In \n this case \
invoke the function by {solker,obj,const,var,tra}=Kernel[game]. The option \n \
EpsilonValue is a critical value to change the strong epsilon-core. This \
value can be \n calculated, for instance, by the function \
FirstCriticalVal[game]. To increases the computational \n reliability in \
cases of numerical issues the following methods can be used: RevisedSimplex, \
CLP,\n GUROBI, MOSEK, or Automatic. Default setting is Automatic. For getting \
more precise results \n one can even set Method->{InteriorPoint, \
Tolerance->10^-10}.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelVertices", "::", "usage"}], " ", "=", "\n", 
    "\"\<KernelVertices[game,options] computes the vertices of the Kernel \
solution from an LP. To \n increases the computational reliability in cases \
of numerical issues the following methods \n can be used: RevisedSimplex, \
CLP, GUROBI, MOSEK, or Automatic. Default setting is Automatic. \n This \
option must be used in connection with CallMaximize->False. For getting more \
precise \n results one can even set Method->{InteriorPoint, \
Tolerance->10^-10}.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ModifiedKernel", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<ModifiedKernel[game,options] computes a kernel point from the least \
core.\n That means, a vertex of the kernel solution inside of the least core \
will be computed.\n Thus, in many cases the Nucleolus should be computed. The \
algorithm is based \n on a method by Peleg to translate the definition of the \
Nucleolus into \n a sequence of linear programs. To increases the \
computational reliability in \n cases of numerical issues the following \
methods can be used: RevisedSimplex, CLP, \n MOSEK, or Automatic. Default \
setting is Automatic. For getting more precise results \n one can even set \
Method->{InteriorPoint, Tolerance->10^-10}.\>\""}], ";"}]}], "Code",Expression\
UUID->"3d35268e-e77c-442f-9cb4-ef00cf997681"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModifiedNucleolus", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<ModifiedNucleolus[game,options] computes the nucleolus from the least \
core.\n The algorithm is based on a method by Peleg to translate the \
definition of the \n Nucleolus into a sequence of linear programs. The \
recursion stops, if the set\n of new equal constraints is empty. To increases \
the computational reliability in \n cases of numerical issues the following \
methods can be used: RevisedSimplex, CLP, \n  MOSEK, or Automatic. Default \
setting is Automatic. For getting more precise results \n one can even set \
Method->{InteriorPoint, Tolerance->10^-10}.\>\""}], ";"}]], "Code",ExpressionU\
UID->"53a2684a-139e-4be4-9a6c-506832165df3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LexiCenter", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LexiCenter[game,options] computes the lexicographic center of a \
TU-game, i.e. \n the nucleolus. Same as ModifiedNucleolus[].\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LSPreNuc", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LSPreNuc[game] computes the least square pre-nucleolus.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LSNuc", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LSNuc[game] computes the least square nucleolus.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FTPreNuc", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<FTPreNuc[game] computes the pre-nucleolus by a Fenchel Transform \
Method.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonLinPreNuc", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NonLinPreNuc[game,p,k,tol,options] computes by a non-linear \
optimization method the pre-nucleolus, \n otherwise it returns a $Failed. \
Different solvers can be selected by option setting Method->Solver. \n \
Permissible solvers are: Automatic, GUROBI, IPOPT, MOSEK, \
DifferentialEvolution, NelderMead, \n RandomSearch, or SimulatedAnnealing. \
Default setting is Automatic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxPreNuc", "::", "usage"}], " ", "=", "\n", 
    "\"\<ApproxPreNuc[game,p,k,options] computes the (p,k)-nucleolus by a \
non-linear minimization method. \n It is an approximation of the \
pre-nucleolus. If (p,k)=(2,k), then it computes the least square \
pre-nucleolus. \n Different solvers can be selected by option setting \
Method->Solver. Permissible solvers are: Automatic, GUROBI, \n IPOPT, MOSEK, \
DifferentialEvolution, NelderMead, RandomSearch, or SimulatedAnnealing. \
Default setting is Automatic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonLinNuc", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NonLinNuc[game,p,k,tol,options] computes by a non-linear \
optimization method the nucleolus, \n otherwise it returns a $Failed. \
Different solvers can be selected by option setting Method->Solver. \n \
Permissible solvers are: Automatic, GUROBI, IPOPT, MOSEK, \
DifferentialEvolution, NelderMead, \n RandomSearch, or SimulatedAnnealing. \
Default setting is Automatic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxNuc", "::", "usage"}], " ", "=", "\n", 
    "\"\<ApproxNuc[game,p,k,options] computes the (p,k)-nucleolus by a \
non-linear minimization method. \n It is an approximation of the nucleolus. \
If (p,k)=(2,k), then it computes the least square nucleolus. \n Different \
solvers can be selected by option setting Method->Solver. Permissible solvers \
are: Automatic, \n GUROBI, IPOPT, MOSEK, DifferentialEvolution, NelderMead, \
RandomSearch, or SimulatedAnnealing. \n Default setting is Automatic.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModCoalArray", "::", "usage"}], " ", "=", "\n", 
    "\"\<ModCoalArray[game,payoff] computes a modified coalition array of \
first, second, ..., kth maximal excess.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StandardSolution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<StandardSolution[game] computes the standard solution of a \
two-person TU-game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NucleolusThreePerson", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NucleolusThreePerson[game] computes the nucleolus of zero-normalized \
super-additive three person games. Uses the formula of Leng and Parlar \
(2010).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreNucleolus", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PreNucleolus[game,options] computes the pre-nucleolus from the set \
of pre-imputations.\n The algorithm is based on a method by Peleg to \
translate the definition of the Nucleolus into \n a sequence of linear \
programs on the pre-imputation set. To increases the computational \
reliability \n in cases of numerical issues the following methods can be \
used: RevisedSimplex, CLP, MOSEK, \n or Automatic. Default setting is \
Automatic. This option must be used in connection with CallMaximize->False. \n\
 For getting more precise results, one can even set  Method->{InteriorPoint, \
Tolerance->10^-10}.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Modiclus", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<Modiclus[game,opts] computes the modiclus as the projection of the \
pre-nucleolus from the\n dual cover game onto the player set T of the \
original game. Do not confound this command\n with the function \
ModifiedNucleolus[]. The algorithm is based on a method by Peleg to translate\
\n the definition of the Nucleolus into a sequence of linear programs on the \
pre-imputation set.\n To increases the computational reliability in cases of \
numerical issues the following methods\n can be used: RevisedSimplex, CLP, \
MOSEK, or Automatic. Default setting is Automatic. For getting more precise \
results one can even set \n Method->{InteriorPoint, \
Tolerance->10^-10}.\>\""}], ";"}]}], "Code",ExpressionUUID->"bdbe042a-8b5c-\
4473-9053-7f125a0ff9d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IsModiclusQ", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<IsModiclusQ[game,payoff,opts] checks whether the provided payoff \
vector is the modiclus of the game.\n To increases the computational \
reliability in cases of numerical issues the following methods\n can be used: \
RevisedSimplex, CLP, MOSEK, or Automatic. Default setting is Automatic. For \
getting more precise results one can even set \n Method->{InteriorPoint, \
Tolerance->10^-10}\>\""}], ";"}]], "Code",ExpressionUUID->"9a7082b4-118f-45e9-\
af27-9dedf070ef36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModPreKernel", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ModPreKernel[game] computes a modified pre-kernel element as the \
solution\n of the pre-kernel from the excess comparability cover game.\n Do \
not confound this command with the function ModifiedKernel[].\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsModPreKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<IsModPreKernelQ[game,payoff] checks whether the provided payoff \
vector is a modified\n pre-kernel element of the game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProperModPreKernel", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ProperModPreKernel[game] computes a proper modified pre-kernel \
element as the projection\n of the pre-kernel from the dual cover game onto \
the player set T of the original game.\n Do not confound this command with \
the function ModifiedKernel[].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsProperModPreKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<IsProperModPreKernelQ[game,payoff] checks whether the provided \
payoff vector is a proper modified\n pre-kernel element of the game.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DualCover", "::", "usage"}], " ", "=", "\n", 
    "\"\<DualCover[game] computes the dual cover game from which the modiclus \
will be determined.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DualExtension", "::", "usage"}], " ", "=", "\n", 
    "\"\<DualExtension[game] determines the dual extension of the primal \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimalExtension", "::", "usage"}], " ", "=", "\n", 
    "\"\<PrimalExtension[game] determines the primal extension of the dual \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ECCoverGame", "::", "usage"}], " ", "=", "\n", 
    "\"\<ECCoverGame[game] computes the excess comparability cover \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SMPreKernel", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SMPreKernel[game] computes the simplified modified pre-kernel of the \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsSMPreKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<IsSMPreKernelQ[game,payoff] checks if payoff is the simplified \
modified pre-kernel of the game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SMPrenucleolus", "::", "usage"}], " ", "=", "\n", 
    "\"\<SMPrenucleolus[game] computes the simplified modified pre-nucleolus \
of the game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsSMPrenucleolusQ", "::", "usage"}], " ", "=", "\n", 
    "\"\<IsSMPrenucleolusQ[game,payoff] checks if payoff is the simplified \
modified pre-nucleolus of the game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DuttaRay", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DuttaRay[game,options] computes the Dutta-Ray solution for convex \
games. Different solvers can be selected \n by option setting Method->Solver. \
Permissible solvers are: Automatic, GUROBI, IPOPT, MOSEK, \
DifferentialEvolution, \n NelderMead, RandomSearch, or SimulatedAnnealing. \
Default setting is Automatic\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LorenzSolution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LorenzSolution[game,options] computes the Lorenz solution whenever \
the core exits. Different solvers can be \n selected by option setting \
Method->Solver. Permissible solvers are: Automatic, GUROBI, IPOPT, MOSEK, \n \
DifferentialEvolution, NelderMead, RandomSearch, or SimulatedAnnealing. \
Default setting is Automatic\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CollectionOfDecreasingExcess", "::", "usage"}], " ", "=", "\n", 
    "\"\<CollectionOfDecreasingExcess[game,payoff] determines the collection \
of coalitions with highest up \n to the lowest level of excesses.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BalancedCollectionQ", "::", "usage"}], " ", "=", "\n", 
   "\"\<BalancedCollectionQ[game,payoff,options] determines whether the \
induced collections\n are balanced w.r.t. all excess levels.  Implements \
Kohlberg's Theorem. The return value must\n be 'True' for the prenucleolus, \
otherwise 'False'. To increases the computational reliability \n in cases of \
numerical issues the following methods can be used: RevisedSimplex, CLP, \
GUROBI, MOSEK, \n or Automatic. Default setting is RevisedSimplex. For \
getting more precise results one can even set \n Method->{InteriorPoint, \
Tolerance->10^-10}.\>\""}], ";"}]}], "Code",ExpressionUUID->"81038ea6-02d8-\
41f9-946e-606538aa2b15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeaklyBalancedCollectionQ", "::", "usage"}], " ", "=", "\n", 
    "\"\<WeaklyBalancedCollectionQ[game,payoff,options] determines whether \
the induced collections\n are weakly balanced w.r.t. all excess levels.  \
Implements Kohlberg's Theorem. The return value must\n be 'True' for the \
nucleolus, otherwise 'False'. To increases the computational reliability in \
cases of numerical issues \n the following methods can be used: \
RevisedSimplex, CLP, GUROBI, MOSEK, or Automatic. Default setting is \
RevisedSimplex. \n For getting more precise results one can even set \
Method->{InteriorPoint, Tolerance->10^-10}.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kBalancednessQ", "::", "usage"}], " ", "=", "\n", 
   "\"\<kBalancednessQ[collect_List, coalOfsize_k, options] determines \
whether the coalition collection\n is k-balanced w.r.t. all excess levels. It \
is based on Kurskal rank condition.\>\""}], ";"}]}], "Code",ExpressionUUID->\
"cc9b798e-635a-4bcd-adfd-1e1f573bbdc5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BalancedSelectionQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<BalancedSelectionQ[game,payoff,options] or \
BalancedSelectionQ[coalstruct, options] \n determines whether the induced \
collections are balanced w.r.t. all excess levels. \n Implements Kohlberg's \
Theorem. The return value must be 'True' for the prenucleolus, \n otherwise \
'False'. It might be that this function returns in any case a 'False', \n \
this is due to circumvent wrong selections. Whenever one has computed the \
prekernel \n set, one can set the option Tight->True to filter out the \
prenucleolus. It is recommended\n to switch to BalancedCollectionQ, which is \
more robust.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeaklyBalancedSelectionQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<WeaklyBalancedSelectionQ[game,payoff,options] or \
WeaklyBalancedSelectionQ[coalstruct, options] \n determines whether the \
induced collections are weakly balanced w.r.t. all excess levels. \n \
Implements a weak form of Kohlberg's Theorem, i.e. it allows zero weights. It \
is recommended\n to switch to WeaklyBalancedCollectionQ, which is more \
robust.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelectionKBalancedQ", "::", "usage"}], " ", "=", "\n", 
    "\"\<SelectionKBalancedQ[game, payoff,k options] or \
SelectionKBalancedQ[coalstruct,k options] \n determines whether a coalition \
collection or its induced from an imputation 'payoff' is\n k-balanced. The \
value k must be an integer between 2 and n. Experimental, not stable!\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernel", "::", "usage"}], " ", "=", "\n", 
    "\"\<PreKernel[game] or PreKernel[game,payoff,options] computes a \
pre-kernel element by iteratively solving\n a system of linear equations. \
(cf. Algorithm 8.2.1 of Meinhardt (2013))\>\""}], " ", ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelElement", "::", "usage"}], " ", "=", "\n", 
    "\"\<PreKernelElement[game,payoff,options] computes a pre-kernel element \
by iteratively \n determining a direction of improvement. The iteration \
process stops whenever the \n direction of improvement is equal to the null \
vector. (cf. Algorithm 8.3.1 of Meinhardt (2013)).\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelSolution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PreKernelSolution[game,payoff,options] computes a pre-kernel \
solution by relying on \n Algorithm 8.1.1 and 8.2.1 of Meinhardt (2013). \
Default solver is SolutionExact -> True in order to call\n FindMinimum set \
SolutionExact->False. If the solution is still not correct or to search for a\
\n different pre-kernel element change the Method of FindMinimum, admissible \
values are: Method -> Automatic\n either to: Method -> Newton, Method-> \
QuasiNewton, Method -> InteriorPoint, Method->Gradient, \n Method -> \
ConjugateGradient, Method -> PrincipalAxis, Method->LevenbergMarquardt, \
Method->GUROBI, \n Method->MOSEK, or Method -> IPOPT.  By setting the  option \
AntiPreKernel -> True,  \n an anti-pre-kernel of the game can be computed. In \
order to look for further solutions, invoke   \n {prk,cvfunc,grad} = \
PreKernelSolution[game,payoff, ConjugateFunction -> True, \n \
ShowObjectiveFunction -> True].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AntiPreKernelSolution", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AntiPreKernelSolution[game,payoff,options] computes an \
anti-pre-kernel solution by relying on a \n SDM-Method. This approach was \
discussed by Meseguer-Artola (1997). Setting the option AntiPreKernel \n to \
'False', a pre-kernel of the game can be computed.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImputationToMatrix", "::", "usage"}], " ", "=", "   ", "\n", 
    "\"\<ImputationToMatrix[game,payoff,opts] transforms an imputation into \
equivalence class matrix Q. \n Same as BestCoalToMatrix[]. Only the input \
parameters are different. See also BestCoalToMatrix[].\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BestCoalitions", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<BestCoalitions[game,payoff] computes the set of most effective \
coalitions that supports the claim of \n player i against j, for all possible \
pair of players.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BestCoalToMatrix", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<BestCoalToMatrix[bestcoal,T,options] computes an equivalence matrix \
Q, all sub-matrices, and \n determinants from the set of best/most effective \
coalitions. For details see Meinhardt (2013).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetsToVec", "::", "usage"}], " ", "=", "\n", 
    "\"\<SetsToVec[bestcoal,T,options] converts the set of most effective \
coalitions to a set of vectors \n of length T. A vector reflects how the best \
arguments are distributed between a bargaining pair \n (i,j) at a proposal. A \
plus sign indicates that the arguments are skewed in favor of the player i, \n\
 zero means that the arguments are balanced, and a minus sign indicates that \
the arguments are \n skewed in favor of the player j. See also Meinhardt \
(2013).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationToVec", "::", "usage"}], " ", "=", "\n", 
   "\"\<ImputationToVec[game,payoff,options] converts an imputation to a set \
of vectors of length T. A \n vector reflects how the best arguments are \
distributed between a bargaining pair i,j at a proposal \n 'payoff'. A \
positive number indicates that the arguments are skewed in favor of the \
player i, zero \n means that the arguments are balanced, and a negative \
number indicates that the arguments are skewed \n in favor of the player j. \
This information can be obtained by invoking the option InFavor. Notice that \
\n whenever the option EffVector is set to 'True', then the first vector must \
be positive, since it is \n related to the grand coalition. Similar to \
SetsToVec[]. See also SetsToVec[].\>\""}], ";"}]}], "Code",ExpressionUUID->\
"23b6f545-d1aa-4d8f-b511-ce76f94ab0d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImputationToEqClass", "::", "usage"}], " ", "=", "    ", "\n", 
    "\"\<ImputationToEqClass[game,payoff] determines an equivalence class \
from an imputation. See also DetEqClass[] for more details.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetEqClass", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DetEqClass[matrix,T] replicates the set of most effective coalitions \
from the unanimity \n matrix-(Binom(t,2) x 2^t -1), where t is the \
cardinality of the player set. The unanimity \n matrix can be determined by \
the function BargainUnanMatrix[game,payoff,EffVector -> False].\>\""}], ";"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BargainUnanMatrix", "::", "usage"}], " ", "=", "   ", "\n", 
   "\"\<BargainUnanMatrix[game,payoff,options] computes an unanimity matrix \
of dimension (Binom(t,2) x 2^t -1), \n where t is the cardinality of the \
player set. This is matrix W of equation 5.14, for details,\n see Meinhardt \
(2013).\>\""}], ";"}]}], "Code",ExpressionUUID->"2df5efc6-d4ae-4fc4-a69f-\
3c233a775a96"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ValueExcess", "::", "usage"}], " ", "=", "     ", "\n", 
   "\"\<ValueExcess[exc_vec] or ValueExcess[game, payoff] value the excess \
list or the list of all maximum \n surpluses induced by a (pre)imputation. \
This is function h_gamma of Meinhardt (2013).\>\""}], ";"}]], "Code",Expressio\
nUUID->"e8d77a57-2d3e-4062-9544-6f4c44847ce2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexConjugate", "::", "usage"}], "=", "    ", "\n", 
    "\"\<ConvexConjugate[game, confunc] specifies the convex conjugate \
(Fenchel transform) of the convex \n input function 'confunc'. The convex \
input function must be determined by the function \n PreKernelSolution[] by \
invoking the option ShowObjectiveFunction -> True.\>\""}], ";"}], "\n", " ", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptStepSize", "::", "usage"}], " ", "=", "  ", "\n", 
    "\"\<OptStepSize[game, payoff, options] computes the optimal step size in \
order to decrease  the excess \n value of the function ValueExcess[]. A \
direction of improvement 'doi' can be determined by the \n function \
DirectionOfImprovement[]. Then a new payoff vector can be constructed by \n \
newpay = payoff + Optstep * doi. Use this vector to value the excesses by \
ValueExcess[game, newpay]. \n This value should be smaller than \
ValueExcess[game,payoff].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirectionOfImprovement", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DirectionOfImprovement[game, payoff, options] determines a vector of \
improvement in order reduce \n the maximum surpluses.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindKernelSolution", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<FindKernelSolution[game,payoff] tries to approximate a pre-kernel \
solution by iteratively carrying \n out transfers between pairs of players. \
The suggested algorithm is due to M. Maschler. For details \n see U. Faigle, \
W. Kern and J. Kuipers (1998).\>\""}], ";"}]}], "Code",ExpressionUUID->\
"1676886d-5bf2-473d-bce1-11f19cf7458b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindPreKernelSolution", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<FindKernelSolution[game,payoff] tries to approximate a pre-kernel \
solution by iteratively carrying \n out transfers between pairs of players. \
The suggested algorithm is due to M. Maschler. For details \n see U. Faigle, \
W. Kern and J. Kuipers (1998).\>\""}], ";"}]], "Code",ExpressionUUID->\
"ebcdd842-e889-48c8-b5ec-7f9e80397be2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelImputationQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<KernelImputationQ[game,payoff] checks whether the payoff belongs to \
the kernel.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelImputationListQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<KernelImputationListQ[game,payoff] checks whether the list of \
payoffs belongs to the kernel.\>\""}], ";"}], "\n", 
  "                                "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PreKernelQ[game,payoff] checks whether the (pre-)imputation 'payoff' \
is an element of the pre-kernel. \n PreKernelQ checks also the efficiency \
condition in contrast to the function MaxExcessBalanced.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AntiPreKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AntiPreKernelQ[game,payoff] checks whether the vector 'payoff' is an \
element of the anti-pre-kernel. \n AntiPreKernelQ checks also the efficiency \
condition in contrast to the function MinExcessBalanced.\>\""}], ";"}], "\n", 
  "                            "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transfer", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Transfer[payoff, T, d, i, j] determines the bi-symmetrical transfer \
w.r.t. the strong epsilon-core. \n The function Transfer[] computes the \
endpoint of the imputation 'payoff' in the ij-direction by \n transferring \
the amount 'd_ij' from player i to player j. The argument 'payoff' is the \
initial \n distribution, T is the player set, d is the amount which should be \
transferred from player i to j.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaLP", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DeltaLP[game, i, j, eps] determines the largest amount d_ij that can \
be transferred from player i \n to player j while remaining in the \
epsilon-core.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransferConstraints", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<TransferConstraints[game, i, j] or TransferConstraints[game, i, j, \
eps] computes the constraints \n for calculating the largest amount that be \
transferred from player i to j while remaining in the \n core or strong \
epsilon core. Default value for 'eps' is zero, and the value 'eps' can be \
omitted\n while calling this function.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VetoRichPlayers", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<VetoRichPlayers[game] returns the list of veto-rich players within \
the game, otherwise an empty list.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllConstraints", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AllConstraints[game] computes the constraints set and variable set \
which are needed to calculate a \n kernel point of a game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllMaxSurpluses", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AllMaxSurpluses[game,payoff] calculates the maximum surplus of \
player i over j w.r.t. the imputation \n 'payoff' for all possible player \
combinations. Note that the efficiency condition will not be checked.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllAntiSurpluses", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AllAntiSurpluses[game,payoff] calculates the minimum surplus of \
player i over j with respect to the \n imputation 'payoff' for all possible \
player combinations. Note that the efficiency condition will not\n be \
checked.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxSurplus", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<MaxSurplus[game,pi,pj,payoff] calculates the maximum surplus of \
player i over j with respect to the \n imputation 'payoff'. Note that the \
efficiency condition will not be checked.\>\""}], ";"}]}], "Code",ExpressionUU\
ID->"cf28abac-de0f-466c-bfa6-f55a0134a14a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EpsValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EpsValue[game,eps] assigns the cost amount 'eps' to every proper \
coalition.\>\""}], ";"}], "\n", "                    "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EpsCore", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EpsCore[game] determines the least-core. Gives more information than \
the function LeastCore[game].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstCriticalVal", "::", "usage"}], "  ", "=", " ", "\n", 
    "\"\<FirstCriticalVal[game] calculates the smallest epsilon such that the \
epsilon-core is nonempty.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SecCriticalVal[game] calculates the largest gain that any group of \
individuals can assure while \n forming a coalition. The epsilon core is \
included in the imputation set iff epsilon is greater \n than the \
sec-critical-val. See Maschler, Peleg and Shapley (1979) on page 306 for more \
details.\>\""}], ";"}], "\n", "                         "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThirdCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ThirdCriticalVal[game] calculates another critical value for epsilon \
to generalize the\n bisection property w.r.t. the strong epsilon-core. The \
epsilon-core is included in the \n reasonable set iff epsilon is greater or \
equal than the third critical value.\>\""}], ";"}], "\n", 
  "                            ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FourthCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<FourthCriticalVal[game] returns the minimum of the SecCriticalVal[] \
and the ThirdCriticalVal[].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FifthCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<The Union of the lower set and the core is included in the strong \
epsilon-core iff \n epsilon >= epsilon5. See Chang and Kan (1992) for more \
details.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StarCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<StarCriticalVal[game] determines a bound for epsilon as defined by \
Maschler, Peleg and \n Shapley (1979) on page 320. The epsilon-core is \
included in the intersection of the imputation \n set and the reasonable set \
iff epsilon is greater or equal than this epsilon bound. \n Hence, the kernel \
is included in the strong epsilon core if epsilon >= epsilon*.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondStarCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SecondStarCriticalVal[game] determines a bound for epsilon as \
defined by Chang and Kan (1992) \n on page 92. This is a better lower epsilon \
bound than the epsilon bound obtained by StarCriticalVal[].\n The kernel is \
included in the strong epsilon core if epsilon >= epsilon**.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThirdStarCriticalVal", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ThirdStarCriticalVal[game] determines a bound for epsilon as defined \
by Chang and Driessen (1994). \n This is a better lower epsilon bound than \
the epsilon or epsilon** bound obtained by StarCriticalVal[] \n and \
ThirdStarCritical[]. The kernel is included in the strong epsilon core if \
epsilon >= epsilon***.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerSetQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LowerSetQ[game] checks if the lower set is non empty. An important \
set to define kernel catcher.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperSetQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UpperSetQ[game] checks if the upper set is non empty. An important \
set to define kernel catcher. \n Furthermore, the kernel is equal to the \
pre-kernel.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerSetIncImputationQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LowerSetIncImputationQ[game] checks if the lower set is included in \
the imputation set. This is \n equivalent to the statement that the game is \
zero-monotone.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperSetIncImputationQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UpperSetIncImputationQ[game] checks if the upper set is included in \
the imputation set.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectionUpperLowerSetQ", "::", "usage"}], " ", "=", " ", 
    "\n", "\"\<IntersectionUpperLowerSetQ[game] checks if the intersection of \
the lower and upper set is non-empty.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrandCoalitionLargestValueQ", "::", "usage"}], " ", "=", " ", 
    "\n", "\"\<GrandCoalitionLargestValueQ[game] checks if the worth of the \
grand coalition is the largest.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelEqualsKernelQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PreKernelEqualsKernelQ[game] checks if 'game' belongs to a class of \
games where the prekernel \n is equal to the kernel.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LargestAmount", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<LargestAmount[game] or LargestAmount[game,i] indicates the largest \
amount a player i can contribute \n to a coalition.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProperAmount", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ProperAmount[game_] or ProperAmount[game,i] indicates the largest \
amount a player i can contribute \n to a proper coalition.\>\""}], ";"}], 
  "\n", "                        "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReasonableSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ReasonableSet[game] returns the set of imputations that give no \
player more than his largest amount \n that he can contribute to a coalition.\
\>\""}], ";"}], "\n", "                        "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReasonableOutcome", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ReasonableOutcome[game] set the largest amount to the variable \
r.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Quota", "::", "usage"}], " ", "=", " ", 
    "\"\<Quota[game] determines the quotas of the game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesCore", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<VerticesCore[game] calculates all vertices of the core. Be careful \
for games greater than n > 6. \n Calculation time explodes.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddVerticesCore", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddVerticesCore[game] calculates all vertices of the core with \
Cddmathlink via Mathlink.\n Cddmathlink uses floating point \
arithmetic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpVerticesCore", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddGmpVerticesCore[game,Options] calculates all vertices of the core \
with Cddmathlink2gmp via Mathlink.\n Cddmathlink2gmp uses GMP rational exact \
arithmetic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotCore", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddGmpPlotCore[game,Options] plots the core of a game with \
Cddmathlink2gmp via Mathlink.\n Cddmathlink2gmp uses GMP rational exact \
arithmetic.\>\""}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotImputationSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddGmpPlotCore[game,Options] plots the core of a game with \
Cddmathlink2gmp via Mathlink.\n Cddmathlink2gmp uses GMP rational exact \
arithmetic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotReasonableSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddGmpPlotReasonableSet[game,Options] plots the reasonable set of a \
game with Cddmathlink2gmp \n via Mathlink. Cddmathlink2gmp uses GMP rational \
exact arithmetic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpImputationVertices", "::", "usage"}], " ", "=", "\n", 
    "\"\<CddGmpImputationVertices[game] calculates all vertices of the \
imputation set with Cddmathlink2gmp via Mathlink.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddVerticesImputationSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddVerticesReasonableSet[game] calculates all vertices of the \
imputation set with Cddmathlink via Mathlink.\>\""}], ";"}], " ", "\n", 
  "                          "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddVerticesReasonableSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddVerticesReasonableSet[game] calculates all vertices of the \
reasonable set with Cddmathlink via Mathlink.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddVerticesLowerSet", "::", "usage"}], " ", "=", "\n", 
    "\"\<CddVerticesLowerSet[game] calculates all vertices of the lower set \
with Cddmathlink via Mathlink.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotLowerSet", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CddGmpPlotLowerSet[game,Options] plots the lower set of a game with \
Cddmathlink2gmp via Mathlink.\n Cddmathlink2gmp uses GMP rational exact \
arithmetic.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BaryCenter", "::", "usage"}], " ", "=", "\n", 
    "\"\<BaryCenter[game] computes the barycenter from the extreme points of \
the core.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AnimationKernelProperty2d", "::", "usage"}], " ", "=", "\n", 
    "\"\<AnimationKernelProperty2d[game,options] visualizes the relationship \
between the kernel solution \n and the strong epsilon core for three person \
games.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrongEpsCore2d", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<StrongEpsCore2d[game,opts] plots the strong epsilon core of a three \
person game. For more details see FilledCoreV6[].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FilledCoreV6", "::", "usage"}], " ", "=", "\n", 
    "\"\<FilledCoreV6[game,opts] plots the core of a three person game. \
Filled the core area with light blue color. \n Furthermore, the Shapley value \
will be depicted as a blue point, the kernel as a light red, the pre-kernel \n\
 as a red, and the nucleolus as a green point. Dedicated for Mathematica \
Version 6.x or higher only.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vec3DToSimplex", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Vec3DToSimplex[{x1,x2,x3}] transforms a vector of dimension 3 into a \
vector of dimension 2.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vec4DToSimplex", "::", "usage"}], " ", "=", "\n", 
    "\"\<Vec4DToSimplex[{x1,x2,x3,x4}] transforms a vector of dimension 4 \
into a vector of dimension 3.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Nuc1convex", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Nuc1convex[game] can be only used to calculate the nucleolus for \
1-convex games.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EANSCValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EANSCValue[game] computes the Equal Allocation of Non-Separable \
Contribution/Cost value.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TauValAirProb", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<TauValAirProb[cost,nj] calculates the Tau value from an airport cost \
allocation problem (cost,nj).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NucAirProb", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NucAirProb[cost,nj] calculates the nucleolus from an airport cost \
allocation problem (cost,nj).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShapAirProb", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ShapAirProb[cost,nj] calculates the Shapley value from an airport \
cost allocation problem (cost,nj).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewShapley", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NewShapley[game] calculates the Shapley value of the game based on \
the marginal contributions of players. Function not very efficient!\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Potential", "::", "usage"}], " ", "=", "\n", 
    "\"\<Potential[game] computes the potential of a game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShapleyValueML", "::", "usage"}], " ", "=", "\n", 
    "\"\<ShapleyValueML[game] computes the Shapley value of the game using \
the multi-linear extension.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MLExtension", "::", "usage"}], " ", "=", "\n", 
    "\"\<MLExtension[game] computes the multi-linear extension of the game.\>\
\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HarsanyiValue", "::", "usage"}], " ", "=", "\n", 
    "\"\<HarsanyiValue[game] computes the Harsanyi value of the game.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaVector", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UtopiaVector[game] calculates the utopia payoffs for all \
players.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaPayoff", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UtopiaPayoff[game,i] or UtopiaPayoff[i] represents the utopia payoff \
of player i.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaSum", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UtopiaSum[game,S_List] calculates the sum of utopia payoffs for \
coalition S.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperVector", "::", "usage"}], " ", "=", "\n", "    ", 
    "\"\<UpperVector[game] calculates the upper payoff for all \
players.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperSum", "::", "usage"}], " ", "=", "\n", "    ", 
    "\"\<UpperSum[game,S_List] calculates the sum of upper payoffs for \
coalition S.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gap", "::", "usage"}], "  ", "=", " ", "\n", 
    "\"\<Gap[game] balances the difference of the total utopia payoff of a \
coalition and its value.\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenGap", "::", "usage"}], "  ", "=", " ", "\n", 
    "\"\<GenGap[game] balances the difference of the total generalized utopia \
payoff of a coalition and its value.\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenUpperVector", "::", "usage"}], " ", "=", "\n", "    ", 
    "\"\<UpperVector[game] calculates the generalized upper payoff for all \
players.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenUpperSum", "::", "usage"}], " ", "=", "\n", "    ", 
    "\"\<GenUpperSum[game,S_List] calculates the sum of generalized upper \
payoffs for coalition S.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SemiConvexQ", "::", "usagge"}], " ", "=", " ", "\n", "    ", 
   "\"\<SemiConvexQ[game] checks if the game is semi-convex.\>\""}], 
  ";"}]}], "Code",ExpressionUUID->"9fe8a44b-b931-43ce-be87-5d7e463b1bce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjustedEffVector", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AdjustedEffVector[game,i] calculates the adjusted efficient upper \
vector of player i for 1-convex games.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjustedEffUpperVectors", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AdjustedEffUpperVectors[game] calculates the adjusted efficient \
upper vectors for all players \n for 1-convex games. There are exactly |T| \
upper efficient vectors in a 1-convex game.\>\""}], ";"}], " ", "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjustedWorthVectors", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<AdjustedWorthVectors[game,k] computes the adjusted worth vectors of \
k-convex games. k is a natural number.\>\""}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Concession", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Concession[game] is the maximum concession of player w.r.t. his \
utopia payoff UtopiaPayoff[game,i].\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisagreeConvex", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DisagreeConvex[game] calculates the disagreement vector for convex \
games.\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Disagreement", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<Disagreement[game] calculates the disagreement vector of a \
game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TauValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<The TauValue[game] represents some efficient compromise between the \
upper bound 'Utopia-Payoff' \n and some lower bound 'Disagreement' of the \
core.\>\""}], ";"}], "  ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChiValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<The ChiValue[game] represents some efficient compromise between the \
generalized upper bound 'Utopia-Payoff' \n and some lower bound \
'Disagreement' of the core.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GatelyValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<GatelyValue[game] computes the Gately point of an essential game \
v.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PDValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PDValue[game] computes the proportional division value of a \
individually positive TU-game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EPSDValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EPSDValue[game] computes the egalitarian proportional surplus \
division value of a individually positive TU-game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenConcession", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<GenConcession[game] is the maximum concession of player w.r.t. his \
generalized utopia payoff GenUtopiaPayoff[game,i].\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MargValue", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MargValue[game] calculates the marginal worth for all \
players.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kCover", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<kCover[game,k] determines the k-cover of the game. k is a natural \
number.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kConvexity", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<kConvexity[game] determines whether the TU-game is k-convex. Return \
value is a list of natural numbers to indicate \n which kind of k-convexity \
is fulfilled. In case that the game is not k-convex, a list of zeors will be \
returned.\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoreElementsQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CoreElementsQ[game,payoff] checks if a list of payoffs contain core \
allocations.\>\""}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BelongToCoreQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<BelongToCore[game,payoff] checks if a list of payoffs contain core \
allocations. An imputation x \n is in the core iff x =< dual v.\>\""}], ";"}],
   " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BalancedInequalityQ", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<BalancedInequalityQ[game,coll] checks if the balanced system of sets \
satisfies a balanced inequality\nof the game. It returns True or False. The \
latter includes also the case that the system is not\nbalanced.\>\""}], 
  ";"}]}], "Code",ExpressionUUID->"c0f8162a-b1fb-4815-b4ab-556f2e2abf27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImputationQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ImputationQ[game,payoff] checks whether the imputation or list of \
imputations belongs to the \n imputation set.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordS", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<CoordS[game,S] determines the unanimity coordinate of coalitions \
S.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GameBasis", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<GameBasis[T] computes the basis of a |T|-person game.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CharacteristicValues", "::", "usage"}], " ", "=", "\n", 
    "\"\<CharacteristicValues[unancrd_List,T,opts] computes the coalitional \
values from the vector of \n unanimity coordinates.\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnanimityCoordinates", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<UnanimityCoordinates[game] determines all unanimity coordinates of \
the game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HarsanyiDividends", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<HarsanyiDividends[game] determines all unanimity coordinates of the \
game. It computes the \n coordinates by multiplying the inverse of the game \
basis with the worth vector of the game.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinUnanimityCoordinates", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<MinUnanimityCoordinates[game] calculates the minimum unanimity \
coordinate for each coalition size.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StrictlyConvexUnanConditionQ", "::", "usage"}], " ", "=", " ", 
   "\n", "\"\<StrictlyConvexUnanConditionQ[game] checks at most (n-1) \
inequalities of the unanimity coordinates \n constraints for strict positive \
sums. It examines if the sufficient condition of convexity in terms \n of \
unanimity coordinates is satisfied. The return value is 'True' or 'False'. \
See also EvalSumMinCoord[].\>\""}], ";"}]}], "Code",ExpressionUUID->"0b1f0f67-\
5e5b-48dd-aae5-a8b1fe8cb060"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexUnanConditionQ", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<ConvexUnanConditionQ[game] checks at most (n-1) inequalities of the \
unanimity coordinates constraints \n for positive sums. It examines if the \
sufficient condition of convexity in terms of  unanimity \n coordinates is \
satisfied. The return value is 'True' or 'False'. See also EvalSumMinCoord[].\
\>\""}], ";"}], "     "}]], "Code",ExpressionUUID->"6569f484-d3a5-4398-aaa3-\
d640c44a3f4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnanConvexQ", "::", "usage"}], " ", "=", "\n", 
    "\"\<UnanConvexQ[coord,T,opts] checks if the coordinates satisfy the \
sufficient and necessary condition \n of convexity of the game in terms of \
unanimity coordinates. Calling the function with its options\n open a glance \
on the results, all terms must be non-negative.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UnanAvConvexQ", "::", "usage"}], " ", "=", "\n", 
   "\"\<UnanAvConvexQ[coord,T,opts] checks if the coordinates satisfy the \
sufficient and necessary condition \n of average convexity of the game in \
terms of unanimity coordinates. Calling the function with its options\n open \
a glance on the results, all terms must be non-negative. See Solano and \
Rafels (1996).\>\""}], ";"}]}], "Code",ExpressionUUID->"5a0b555f-317d-40aa-\
851b-34b8ba4aac58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetUCoord", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<DetUCoord[coord_List,T] determines the missing unanimity coordinates \
of size greater than 2 to \n generate a TU-game. It is required that the list \
of unanimity coordinates which represents the  \n coordinates of size 2 has \
non-negative input values. Thus, the input dimension of coord_List \n is \
Binomial[|T|,2], where T is the player set. See Meinhardt (2009).\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetQuasiAvConvex", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<vallist = DetQuasiAvConvex[Origgame] determines from the game \
'Origame' the coalitional values of \n a quasi average convex game. The \
resultant list of the coalitional values can be used to define \n a new game \
by NewGame := (DefineGame[T, vallist];);. See also DetUCoord[].\>\""}], ";"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlayerPairs", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<PlayerPairs[T] determines the set of all pair of players from the \
player set T.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EvalSumMinCoord", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EvalSumMinCoord[game] calculates at most (n-1) inequalities of the \
unanimity coordinates constraints \n of non-negative sums. It is a sufficient \
condition of convexity for a game. If all values are \n non-negative then the \
game is convex. But the converse is not true.\>\""}], ";"}], " ", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeightedMajority", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<WeightedMajority[T,weightList] determines a simple game from the \
non-negative vector [q; p1, ..., pt], \n where T={1,...t}=Range[t]. It is \
admissible to specify the vector of weights by the following \n format of \
lists {q, p1, ...,pt} or {q, {p1, ..., pt}} or {{q}, {p1, ...,pt}}. The \
resultant list can \n then be used to define a game by using the function \
DefineGame[].\>\""}], ";"}]}], "Code",ExpressionUUID->"c34d6dbf-2f00-4a56-\
8ddb-78c660b4bc50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Some", " ", "explanations", " ", "for", " ", "options", " ", "are", " ", 
    "given", " ", 
    RowBox[{"next", "."}]}], "*)"}], " ", "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CallMaximize", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option for the function KernelCalculation[]. With this option \
the LP solver is changed from\n LinearOptimization to NMaximize/NMinimize. \
The solver ConstrainedMax has been deprecated in \n Mathematica version 12.\>\
\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ChangeInternalEps", "::", "usage"}], " ", "=", "\n", 
     "\"\<Is an option for the function KernelCalculation[]. With this option \
it is possible to change internally \n the epsilon value within the first \
loop. This option is useful to obtain different allocations from the \n \
initial LPs.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayAllResults", "::", "usage"}], " ", "=", "\n", 
     "\"\<Is an option for the functions Kernel[] and KernelCalculation[]. If \
the option is set to 'True', then \n all internal results are returned, \
otherwise a kernel element and the imputations computed by the \n initial LPs \
are returned.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EpsilonValue", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option of the functions Kernel[] and KernelCalculation[]. The \
default value is set to zero. Using \n different real numbers, the strong \
epsilon-core can be changed.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RationalApproximate", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option for the function DefineGame[]. The real numbers of the \
coalitional values are approximated \n by rational numbers. Default value is \
true.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RationalExact", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option for the functions CddGmpVerticesCore[] and \
CddGmpPlotCore[].\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SetGameToNonZeroMonotonic", "::", "usage"}], " ", "=", " ", 
     "\n", "\"\<Is an option for the function KernelCalculation[]. Switching \
this option on, it is possible \n to search for additional pre-imputations \
for non-zero-monotonic games.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WithIncidences", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option for the function CddGmpVerticesCore[]. Switching this \
option on, a facets-vertices \n incidence matrix will be returned.\>\""}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConjugateFunction", "::", "usage"}], " ", "=", "\n", 
     "\"\<Is an option for the function PreKernelSolution[]. Switching this \
option on, the Fenchel transform \n of a convex function will be returned. \
The Fenchel transform gives evidence whether the pre-kernel \n solution is a \
set solution or whether it consists of a unique vector.\>\""}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Silent", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<If this option is set to 'False', then it is possible to monitor \
the iterative numerical computation \n to search for a (pre)-kernel solution. \
Similar to verbose.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SetRecursionLimit", "::", "usage"}], " ", "=", "\n", 
     "\"\<Is an option to change the current limit on the number of level of \
recursion. The default value is \n set to 128.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ShowObjectiveFunction", "::", "usage"}], " ", "=", "\n", 
     "\"\<Is an option of the function PreKernelSolution[] to return the \
objective function \n (convex function) that has determined a pre-kernel \
solution of the game. In connection  \n with the option 'ConjugateFunction' \
it gives evidence whether the pre-kernel solution \n is a set of solution or \
whether it consists of a unique vector.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllCoalitions", "::", "usage"}], " ", "=", " ", "\n", 
     "\"\<Is an option of the function BestCoalitions[] to return the \
complete set of most effective \n coalitions w.r.t an imputation. When this \
option is switched on, then use the function in this \n way: {bscij,bscji} = \
BestCoalitions[game,payoff,AllCoalitions->True].\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestCardinality", "::", "usage"}], " ", "=", "  ", "\n", 
     "\"\<Is an option of the functions PreKernelSolution[] and \
BestCoalitions[] to return the set of most \n effective coalitions with \
smallest cardinality. Whenever this option is set to 'False', then the \n set \
of coalitions w.r.t. the largest cardinality is returned.\>\""}], ";"}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"obsolete", "\n", 
       RowBox[{"KernelRange", "::", "usage"}]}], " ", "=", "\n", 
      "\"\<Is an option for the function ModifiedKernel[] to search for a \
line segment of the (pre)-kernel.\>\""}], ";"}], "\n", " ", "*)"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProperContribution", "::", "usage"}], " ", "=", "\n", 
     "\"\<This is an option to determine the vertices of the upper set, which \
is a kernel catcher.\n This function may useful in connection with the \
package 'TuGamesView3D' to visualize for \n four person games the upper set. \
This set can coincide with the reasonable set.\>\""}], ";"}]}]}]], "Code",Expr\
essionUUID->"16cc5d20-7219-4957-b3dc-e54941c9e0e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"$OperatingSystem", " ", "===", " ", "\"\<Unix\>\""}], ",", "\n", 
    "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"Options", "[", "AverageConvexQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AverageConcaveQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], "}"}]}], ";", 
     "      ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BalancedCollectionQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "SuperAdditiveQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DefineGame", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalApproximate", " ", "->", " ", "True"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpVerticesCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RationalExact", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"WithIncidences", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesImputationSet", "]"}], " ", "=", 
      "  ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesReasonableSet", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RationalExact", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"ProperContribution", " ", "->", " ", "False"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotReasonableSet", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ProperContribution", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesLowerSet", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotLowerSet", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BestCoalitions", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AllCoalitions", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "OptStepSize", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelElement", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "Modiclus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "IsModiclusQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModPreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "       ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DirectionOfImprovement", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "Kernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "KernelCalculation", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ChangeInternalEps", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
        RowBox[{"SetGameToNonZeroMonotonic", " ", "->", " ", "False"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModifiedKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "KernelVertices", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModifiedNucleolus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LexiCenter", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreNucleolus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "NonLinPreNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "NonLinNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ApproxNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ApproxPreNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LorenzSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "20"}], ",", " ", 
        RowBox[{"RationalApproximate", " ", "->", " ", "True"}], ",", 
        RowBox[{"Method", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DuttaRay", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "20"}], ",", " ", 
        RowBox[{"RationalApproximate", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "kBalancednessQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BalancedSelectionQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "WeaklyBalancedSelectionQ", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "WeaklyBalancedCollectionQ", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "SelectionKBalancedQ", "]"}], " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "True"}]}], "}"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "the", " ", "solution", " ", "is", " ", "not", " ", 
        "correct"}], ",", " ", 
       RowBox[{"change", " ", "Method", " ", 
        RowBox[{"to", ":", " ", "\"\<Newton\>\""}]}], ",", " ", 
       "\"\<ConjugateGradient\>\"", ",", " ", "\"\<PrincipalAxis\>\""}], "  ",
       "*)"}], "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "        ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AntiPreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ProperModPreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BestCoalToMatrix", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"DisplayMatrixForm", " ", "->", " ", "True"}]}], "}"}]}], ";",
      "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ConvexConjugate", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AllMaxSurpluses", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AllAntiSurpluses", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ExcessPayoff", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FindKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}]}], ",", " ", 
        RowBox[{"SetRecursionLimit", " ", "->", " ", "512"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FindPreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}]}], ",", " ", 
        RowBox[{"SetRecursionLimit", " ", "->", " ", "512"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AntiPreKernelQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "MaxExcessBalanced", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "MinExcessBalanced", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UpperSetIncImputationQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LowerSetIncImputationQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelEqualsKernelQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AnimationKernelProperty2d", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"UpperCritVal", " ", "->", 
         RowBox[{"{", "5", "}"}]}], ",", " ", 
        RowBox[{"LowerCritVal", " ", "->", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"IncSize", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "4"}], ")"}]}], "}"}]}], ",", " ", 
        RowBox[{"FigureSize", " ", "->", " ", "500"}], ",", " ", 
        RowBox[{"UseManipulate", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     
     RowBox[{
      RowBox[{"Options", "[", "StrongEpsCore2d", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EpsilonValue", " ", "->", " ", "5"}], ",", 
        RowBox[{"FigureSize", " ", "->", " ", "500"}], ",", 
        RowBox[{"Labeling", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FilledCoreV6", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayLegend", " ", "->", " ", "True"}], ",", 
        RowBox[{"FigureSize", " ", "->", " ", "500"}], ",", 
        RowBox[{"PreImpSet", " ", "->", " ", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "False"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "SetsToVec", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{"EffVector", " ", "->", " ", "False"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ImputationToVec", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EffVector", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"InFavor", " ", "->", " ", "False"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ImputationToEqClass", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"BargUnanMat", " ", "->", " ", "False"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BargainUnanMatrix", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{"EffVector", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DeltaLP", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", "->", " ", "False"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UnanConvexQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayCoord", "->", " ", "False"}], ",", " ", 
        RowBox[{"NumericalPrec", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "12"}], ")"}]}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UnanAvConvexQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayCoord", "->", " ", "False"}], ",", " ", 
        RowBox[{"NumericalPrec", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "12"}], ")"}]}]}]}], "}"}]}], ";"}], ",", "\n", 
    "True", ",", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"Options", "[", "AverageConvexQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AverageConcaveQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], "}"}]}], ";", 
     "      ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BalancedCollectionQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DefineGame", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalApproximate", " ", "->", " ", "True"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "False"}], "}"}]}], ";", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpVerticesCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RationalExact", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"WithIncidences", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotCore", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesImputationSet", "]"}], " ", "=", 
      "  ", 
      RowBox[{"{", 
       RowBox[{"RationalExact", " ", "->", " ", "False"}], "}"}]}], ";", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddVerticesReasonableSet", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RationalExact", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"ProperContribution", " ", "->", " ", "False"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotReasonableSet", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"ProperContribution", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "CddGmpPlotLowerSet", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BestCoalitions", "]"}], " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AllCoalitions", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "OptStepSize", "]"}], " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "   ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelElement", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "Modiclus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "IsModiclusQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModPreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ProperModPreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DirectionOfImprovement", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"PseudoInv", "->", "True"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "Kernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}]}], "}"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "KernelCalculation", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"ChangeInternalEps", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
        RowBox[{"SetGameToNonZeroMonotonic", " ", "->", " ", "False"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModifiedKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "KernelVertices", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}], ",", " ", 
        RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", " ", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ModifiedNucleolus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LexiCenter", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreNucleolus", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "NonLinPreNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "NonLinNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ApproxNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ApproxPreNuc", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", " ", "->", " ", "Automatic"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LorenzSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "20"}], ",", " ", 
        RowBox[{"RationalApproximate", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DuttaRay", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "20"}], ",", " ", 
        RowBox[{"RationalApproximate", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Method", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "kBalancednessQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BalancedSelectionQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "WeaklyBalancedSelectionQ", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BalancedCollectionQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Method", "->", " ", "RevisedSimplex"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "SelectionKBalancedQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Tight", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", "  ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Newton"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernel", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", "  ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}]}], "}"}]}], 
     ";", "    ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AntiPreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AntiPreKernel", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"ConjugateFunction", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Newton"}], ",", " ", 
        RowBox[{"ShowObjectiveFunction", " ", "->", " ", "False"}], ",", " ", 
        
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "9"}], ")"}]}]}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SmallestCardinality", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "}"}]}], ";", 
     "   ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BestCoalToMatrix", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"DisplayMatrixForm", " ", "->", " ", "True"}]}], "}"}]}], ";",
      " ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ImputationToMatrix", "]"}], " ", "=", " ", 
      RowBox[{"Options", "[", "BestCoalToMatrix", "]"}]}], ";", " ", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ConvexConjugate", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AllMaxSurpluses", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AllAntiSurpluses", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ExcessPayoff", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"DisplayMatrixForm", " ", "->", " ", "False"}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FindKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}]}], ",", " ", 
        RowBox[{"SetRecursionLimit", " ", "->", " ", "512"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FindPreKernelSolution", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DigitPrecision", " ", "->", " ", "6"}], ",", " ", 
        RowBox[{"RationalTol", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "7"}], ")"}]}]}], ",", " ", 
        RowBox[{"SetRecursionLimit", " ", "->", " ", "512"}], ",", " ", 
        RowBox[{"Silent", " ", "->", " ", "True"}]}], "}"}]}], ";", " ", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UpperSetIncImputationQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "LowerSetIncImputationQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelEqualsKernelQ", "]"}], " ", "=", " ", 
      
      RowBox[{"{", 
       RowBox[{"Silent", " ", "->", " ", "True"}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "PreKernelQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AntiPreKernelQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "MaxExcessBalanced", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", 
     "                        ", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "MinExcessBalanced", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"RationalTol", " ", "->", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "AnimationKernelProperty2d", "]"}], " ", "=", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"UpperCritVal", " ", "->", 
         RowBox[{"{", "5", "}"}]}], ",", " ", 
        RowBox[{"LowerCritVal", " ", "->", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"IncSize", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "4"}], ")"}]}], "}"}]}], ",", 
        RowBox[{"UseManipulate", "->", "False"}]}], "}"}]}], ";", "\n", "  ", 
     
     RowBox[{
      RowBox[{"Options", "[", "StrongEpsCore2d", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EpsilonValue", " ", "->", " ", "5"}], ",", 
        RowBox[{"FigureSize", " ", "->", " ", "500"}], ",", 
        RowBox[{"Labeling", " ", "->", " ", "True"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "FilledCoreV6", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayLegend", " ", "->", " ", "True"}], ",", 
        RowBox[{"FigureSize", " ", "->", " ", "500"}], ",", 
        RowBox[{"PreImpSet", " ", "->", " ", "True"}], ",", 
        RowBox[{"Silent", " ", "->", " ", "False"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "SetsToVec", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{"EffVector", " ", "->", " ", "False"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ImputationToVec", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"EffVector", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"InFavor", " ", "->", " ", "False"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "ImputationToEqClass", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"BargUnanMat", " ", "->", " ", "False"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "BargainUnanMatrix", "]"}], " ", "=", 
      RowBox[{"{", 
       RowBox[{"EffVector", " ", "->", " ", "True"}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"Options", "[", "DeltaLP", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CallMaximize", "->", " ", "False"}], ",", " ", 
        RowBox[{"Method", " ", "->", " ", "Automatic"}]}], "}"}]}], ";", "\n",
      "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UnanConvexQ", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayCoord", "->", " ", "False"}], ",", " ", 
        RowBox[{"NumericalPrec", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "12"}], ")"}]}]}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"Options", "[", "UnanAvConvexQ", "]"}], "  ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DisplayAllResults", " ", "->", " ", "False"}], ",", " ", 
        RowBox[{"DisplayCoord", "->", " ", "False"}], ",", " ", 
        RowBox[{"NumericalPrec", " ", "->", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "12"}], ")"}]}]}]}], "}"}]}], ";"}]}], "\n", "]"}], 
  ";"}]], "Code",ExpressionUUID->"7b56b875-2f26-47cf-9df6-0e6aa51bfff5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Error", " ", "Messages"}], ":"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"One", " ", "Argument"}], ":"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffUpperVectors", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ADMCGameQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AIMCGameQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllConstraints", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostConcaveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostAverageConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostAverageConcaveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AntiPreKernelSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvConcaveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AverageConcaveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AverageConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BaryCenter", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpPlotCore", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpPlotImputationSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpPlotLowerSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpPlotReasonableSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpVerticesCore", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddGmpImputationVertices", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesCore", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesImputationSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesLowerSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesReasonableSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ChiValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConcaveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Concession", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvCheck", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexStrQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexUnanConditionQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvStrQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DecomposeInPositiveGames", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetQuasiAvConvex", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Disagreement", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisagreeConvex", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualCover", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualExtension", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualGame", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DuttaRay", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EANSCValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EpsCore", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EPSDValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EvalSumMinCoord", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FifthCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FilledCoreV6", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FindKernelSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FindPreKernelSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FirstCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FourthCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GameBasis", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GameMonotoneQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Gap", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GatelyValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenConcession", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperPayoff", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperSum", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperVector", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GrandCoalitionLargestValueQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"HarsanyiDividends", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"HarsanyiValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IntersectionUpperLowerSetQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelCalculation", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Kernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelVertices", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kConvexity", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"LargestAmount", "::", "argerr"}], "=", 
    "\"\<One argument was expected.\>\""}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LexiCenter", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LorenzSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerSetIncImputationQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerSetQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LSNuc", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LSPreNuc", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MargValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MinUnanimityCoordinates", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MLExtension", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Modiclus", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedKernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedNucleolus", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModPreKernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MonotoneQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NewShapley", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NucleolusThreePerson", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuc1convex", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OneNormalization", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PDValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PlayerPairs", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PositiveGameQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Potential", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelElement", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelEqualsKernelQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreNucleolus", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PrimalExtension", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProperAmount", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ProperModPreKernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Quota", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ReasonableOutcome", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ReasonableSet", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StandardSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ScrbSolution", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondStarCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectSuperSets", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SemiConvexQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ShapleyValueML", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContributionVector", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SMPreKernel", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SMPrenucleolus", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StarCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StrictlyConvexUnanConditionQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StrongEpsCore2d", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperAdditiveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TauValue", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdStarCriticalVal", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperSum", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperVector", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperPayoff", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaSum", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaVector", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaPayoff", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeaklySuperAdditiveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UnanimityCoordinates", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperSetIncImputationQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperSetQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaVector", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ValueExcess", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VetoRichPlayers", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesCore", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeaklyBalancedSelectionQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeaklySuperAdditiveQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMonotoneQ", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroNormalization", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroOneNormalization", "::", "argerr"}], "=", 
     "\"\<One argument was expected.\>\""}], ";"}]}]}]], "Code",ExpressionUUID\
->"0b50b529-3377-4c30-8320-1bc582f13667"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Two", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffVector", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedWorthVectors", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllAntiSurpluses", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllMaxSurpluses", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AntiPreKernelQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedSelectionQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedCollectionQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedInequalityQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BargainUnanMatrix", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BelongToCoreQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BestCoalitions", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BestCoalToMatrix", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CharacteristicValues", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CollectionOfDecreasingExcess", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexConjugate", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordS", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoreElementsQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CostSaving", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DefineGame", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetEqClass", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetUCoord", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectionOfImprovement", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ECCoverGame", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EpsValue", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExcessPayoff", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ImputationQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ImputationToEqClass", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ImputationToMatrix", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ImputationToVec", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreasMargContributions", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IntersectionOfMaxExcessSets", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsModiclusQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsModPreKernelQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsProperModPreKernelQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsSMPreKernelQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsSMPrenucleolusQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kBalancednessQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kCover", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelImputationQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelImputationListQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxExcessBalanced", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxExcessSets", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MinExcessBalanced", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModCoalArray", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NucAirProb", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OptStepSize", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Scrb", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SetsToVec", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ShapAirProb", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContribution", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StrIncreasMargContrib", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SubGame", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SbgAlmostAvQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SbgAlmostAvCoQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TauValAirProb", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TIJsets", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UnanAvConvexQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UnanConvexQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperSum", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaPayoff", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UtopiaSum", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WekalyBalancedCollectionQ", "::", "argerr"}], "=", 
     "\"\<Two arguments were expected.\>\""}], ";"}]}]}]], "Code",ExpressionUU\
ID->"70712ff2-aafc-441a-b863-af3c9721e658"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Three", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TransferConstraints", "::", "argerr"}], "=", 
     "\"\<Threee arguments were expected.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"Four", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DeltaLP", "::", "argerr"}], "=", 
     "\"\<Four arguments were expected.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxSurplus", "::", "argerr"}], "=", 
     "\"\<Four arguments were expected.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{":", 
     RowBox[{"Five", " ", "Arguments"}], ":"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Transfer", "::", "argerr"}], "=", 
     "\"\<Five arguments were expected.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "the", " ", "directory", " ", "where", " ", "you", " ", 
     "have", " ", "installed", " ", "your", " ", "packages"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "\n", "  ", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "run", " ", "even", " ", "the", " ", 
      "cddmathlink", " ", "libraries", " ", "in", " ", "parallel"}], ",", " ", 
     RowBox[{
     "we", " ", "have", " ", "to", " ", "create", " ", "here", " ", "some", 
      " ", "artificial", " ", "\n", "  ", "links", " ", "for", " ", "the", 
      " ", "SubKernels", " ", "to", " ", "be", " ", "synchronized", " ", 
      "with", " ", "the", " ", "links", " ", "created", " ", "by", " ", "the",
       " ", "Master", " ", 
      RowBox[{"Kernel", ".", " ", "Otherwise"}], "\n", "  ", "the", " ", 
      "link", " ", "numbering", " ", "of", " ", "the", " ", "SubKernels", " ",
       "does", " ", "not", " ", "coincide", " ", "with", " ", "the", " ", 
      "numbering", " ", "created", " ", "by", " ", "the", " ", "Master", " ", 
      
      RowBox[{"Kernel", ".", "\n", "  ", "This"}], " ", "might", " ", "not", 
      " ", "happen", " ", "on", " ", "all", " ", "platforms"}], ",", " ", 
     RowBox[{
      RowBox[{
      "in", " ", "this", " ", "case", " ", "enclose", " ", "the", " ", "line",
        " ", "below", " ", "with", " ", "command", " ", 
       RowBox[{"marks", ".", "\n", "  ", "For"}], " ", "more", " ", "details",
        " ", "have", " ", "a", " ", "look", " ", "in", " ", "the", " ", 
       "README", " ", "file", " ", 
       RowBox[{"and", "/", "or"}], " ", "in", " ", 
       RowBox[{"TuGamesMovieParaModeV6", ".", "nb"}], " ", "in", " ", "the", 
       " ", "Documentation", " ", "\n", "  ", 
       RowBox[{"directory", ".", " ", "See"}], " ", "also", "\n", "\n", "  ", 
       
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
          "questions"}], "/", "25561"}], "/", "how"}], "-", "to", "-", "run", 
       "-", "an", "-", "external", "-", "program", "-", "in", "-", "parallel",
        "-", "with", "-", "a", "-", "mathematica", "-", "package"}]}]}], "\n",
     "\n", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$ParaMode", ",", "\"\<False\>\""}], "]"}], " ", "&&", 
       " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$NotebookMode", ",", "\"\<False\>\""}], "]"}]}], ",", 
      "False", ",", "\n", "      ", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$ParaMode", ",", "\"\<False\>\""}], "]"}], " ", "&&", 
       " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$NotebookMode", ",", "\"\<True\>\""}], "]"}]}], ",", 
      " ", "False", ",", "\n", "      ", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$ParaMode", ",", "\"\<True\>\""}], "]"}], "  ", "&&", 
       " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$NotebookMode", ",", "\"\<False\>\""}], "]"}]}], ",", 
      
      RowBox[{
       RowBox[{"kc", "=", "$KernelCount"}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"LinkCreate", "[", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"kc", "-", "1"}], "}"}]}], "]"}]}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$ParaMode", ",", "\"\<True\>\""}], "]"}], "  ", "&&", 
       " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"Global`$NotebookMode", ",", "\"\<True\>\""}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"kc", "=", "$KernelCount"}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"LinkCreate", "[", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"kc", "+", "6"}], "}"}]}], "]"}]}]}], "\n", "      ", "]"}],
     ";"}]}]}]], "Code",ExpressionUUID->"339c68f7-943c-4df5-85f5-\
76664362d941"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{
    "Comments", " ", "for", " ", "Windows", " ", "OS", " ", "starts"}], ":", 
    "\n", "   ", 
    RowBox[{
    "Check", " ", "the", " ", "paths", " ", "where", " ", "you", " ", "have", 
     " ", "to", " ", "install", " ", "the", " ", "cddmathlink", " ", 
     RowBox[{"library", ".", "\n", "\n", "   ", 
      RowBox[{"PacletInformation", "[", "\"\<TUG\>\"", "]"}]}], "\n", "\n", 
     "   ", "Then", " ", "open", " ", "the", " ", "directory", " ", "under", 
     " ", "Mathematica", " ", "Version", " ", "12.", "x", " ", "by", "\n", 
     "\n", "   ", 
     RowBox[{"Information", "[", 
      RowBox[{
       RowBox[{"PacletObject", "[", "\"\<TUG\>\"", "]"}], ",", 
       "\"\<Location\>\""}], "]"}], "\n", "   ", "\n", "   ", "otherwise", 
     " ", "use", " ", "\n", "\n", "   ", 
     RowBox[{"SystemOpen", "@", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"PacletInformation", "[", "\"\<TUG\>\"", "]"}], ",", " ", 
        "\"\<Location\>\""}], "]"}]}]}], "\n", "\n", "   ", ":", 
    RowBox[{"Comments", " ", "for", " ", "Windows", " ", "OS", " ", "ends"}], 
    ":"}], " ", "\n", "*)"}], "\n", "\n", 
  RowBox[{"(*", "  ", 
   RowBox[{
   "Deactivate", " ", "the", " ", "lines", " ", "below", " ", "if", " ", 
    "you", " ", "have", " ", "not", " ", "installed", " ", 
    RowBox[{"cddmathlink", "."}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"linksQ", "=", 
     RowBox[{"Links", "[", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringFreeQ", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{
              "\"\<TUG\>\"", " ", "~~", " ", "___", " ", "~~", " ", 
               "\"\<cddmathlink\>\""}]}], "]"}], " ", "&"}], " ", "/@", " ", 
           "linksQ"}], ",", " ", "False"}], "]"}], "]"}], "!=", "0"}], ",", 
      "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Checking", " ", "first", " ", "if", " ", "a", " ", "LinkObject", " ", 
        "exists", " ", "already", " ", "and", " ", "uninstall", " ", "the", 
        " ", "cddml", " ", 
        RowBox[{"libraries", "."}]}], " ", "*)"}], "\n", "         ", 
      RowBox[{
       RowBox[{"Uninstall", "[", "cddml", "]"}], ";", "\n", "         ", 
       RowBox[{"Uninstall", "[", "cddmlgmp", "]"}], ";", "\n", "         ", 
       RowBox[{"Uninstall", "[", "cddml2", "]"}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "owe", " ", "the", " ", "following", " ", "lines", " ", 
         "of", " ", "code", " ", "to", " ", "Szabolcs", " ", 
         RowBox[{"Horv\[AAcute]t", "."}]}], " ", "*)"}], "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
        "In", " ", "the", " ", "second", " ", "step", " ", "install", " ", 
         "the", " ", "cddml", " ", "libraries", " ", 
         RowBox[{"again", "."}]}], "*)"}], "\n", "         ", 
       RowBox[{"cddml", "=", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink\>\""}], "}"}], "]"}]}]}], ";", "\n", "         ", 
       RowBox[{"cddmlgmp", " ", "=", " ", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink2gmp\>\""}], "}"}], "]"}]}]}], ";", "\n", 
       "         ", 
       RowBox[{"cddml2", "=", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink2\>\""}], "}"}], "]"}]}]}], ";"}], ",", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "the", " ", "LinkObject", " ", "is", " ", "empty"}], ",", 
        " ", 
        RowBox[{"then", " ", "install", " ", "the", " ", "cddml", " ", 
         RowBox[{"libraries", "."}]}]}], "*)"}], "\n", "         ", 
      RowBox[{
       RowBox[{"cddml", " ", "=", " ", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink\>\""}], "}"}], "]"}]}]}], ";", "\n", "         ", 
       RowBox[{"cddmlgmp", " ", "=", " ", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink2gmp\>\""}], "}"}], "]"}]}]}], ";", "\n", 
       "         ", 
       RowBox[{"cddml2", " ", "=", " ", 
        RowBox[{"Install", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", " ", 
            "\"\<cddmathlink2\>\""}], "}"}], "]"}]}]}]}]}], "\n", "]"}], 
    ";"}]}]}]], "Code",ExpressionUUID->"6b51f19e-8c87-4b7c-bbcf-10b8b2aa6ac3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"LinearOptimization", "::", "ubnd"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"LinearOptimization", "::", "dinfeas"}], "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Section", " ", "general", " ", "functions", " ", "starts"}], " ", 
   "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DefineGame", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineGame", "[", 
    RowBox[{"R_List", ",", " ", "values_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "DefineGame", "]"}]}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "T", "]"}], ";", " ", 
     RowBox[{"T", " ", "=", " ", "R"}], ";", " ", 
     RowBox[{"Clear", "[", "v", "]"}], ";", "\n", "    ", 
     RowBox[{"approxrat", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "RationalApproximate", "]"}]}], ";", "\n", 
     "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"Length", "[", "T", "]"}]}], ",", 
         RowBox[{"Length", "[", "values", "]"}]}], "]"}], ",", "True", ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Game is not consistently defined!\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "    ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"approxrat", ",", "True"}], "]"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Set", "[", 
            RowBox[{
             RowBox[{"v", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], " ", 
           "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Coalitions", ",", " ", 
            RowBox[{"Rationalize", "[", 
             RowBox[{"values", ",", " ", 
              RowBox[{"5", "^", 
               RowBox[{"(", 
                RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Set", "[", 
            RowBox[{
             RowBox[{"v", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], " ", 
           "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Coalitions", ",", " ", "values"}], "}"}]}], "]"}], 
        ";"}]}], "]"}]}], ")"}]}], ";"}]}], "Code",ExpressionUUID->"cdd03c25-\
891f-473d-8ebd-6ed2d8734cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CostSaving", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CostSaving", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CostSaving", "[", 
    RowBox[{"costvec_List", ",", "T_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "cs", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SetDelayed", "[", 
          RowBox[{
           RowBox[{"c", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], " ", "&"}],
         ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "costvec"}], "}"}]}], 
       "]"}], ";", "\n", "  ", 
      RowBox[{"cs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
             "#"}], "]"}], " ", "-", " ", 
           RowBox[{"c", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
        
        RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"cs", ",", "1"}], "]"}]}], "}"}], "]"}]}]}], "\n", "  ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"cda092e4-de03-4224-a941-\
b911e47c1903"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DualGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DualGame", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DualGame", "[", "game_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "T", "]"}], "-", 
        RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"Reverse", "[", "Coalitions", "]"}]}], ")"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Def", "."}], ":", " ", 
     RowBox[{"Let", " ", "S_", "1"}]}], ",", 
    RowBox[{"S_", "2"}], ",", 
    RowBox[{
    "...", "S_k", " ", "be", " ", "a", " ", "partition", " ", "of", " ", 
     "the", " ", "grand", " ", "coalition", " ", "T"}], ",", " ", 
    RowBox[{
    "then", "\n", "the", " ", "game", " ", "v", " ", "is", " ", "called", " ",
      "weakly", " ", "superadditive"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"if", " ", "sum_", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", "=", "1"}], "}"}], "^", "k"}], " ", "v", 
       RowBox[{"(", "S_i", ")"}]}], " ", "<=", " ", 
      RowBox[{"v", 
       RowBox[{
        RowBox[{"(", "T", ")"}], ".", " ", "\n", "\t", "\n", "Prop", 
        "."}]}]}], ":", "\n", 
     RowBox[{
      RowBox[{
      "v", " ", "is", " ", "a", " ", "weakly", " ", "superadditive", " ", 
       "game", " ", "if", " ", "and", " ", "only", " ", "if", " ", "v"}], " ",
       "<=", " ", 
      RowBox[{"dual", " ", "v"}]}]}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklySuperAdditiveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"WeaklySuperAdditiveQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeaklySuperAdditiveQ", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "truelist", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"truelist", " ", "=", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "Coalitions"}], ")"}], " ", "<=", " ", 
          RowBox[{"DualGame", "[", "game", "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "truelist"}], "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Def", ".", " ", "Every"}], " ", "subset", " ", "S", " ", "of", 
      " ", "T", " ", "induce", " ", "a", " ", "subgame", " ", "w", " ", "via",
       " ", "w", 
      RowBox[{"(", "S", ")"}]}], " ", "=", " ", 
     RowBox[{"v", 
      RowBox[{"(", "S", ")"}], " ", "on", " ", "the", " ", "new", " ", 
      "player", " ", "set", " ", 
      RowBox[{"S", ".", "\n", "Prop", ".", " ", "A"}], " ", "game", " ", "v", 
      " ", "is", " ", "superadditive"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "if", " ", "for", " ", "every", " ", "subgame", " ", "w", " ", "it", " ",
       "holds", " ", "w"}], " ", "=", 
     RowBox[{"<", " ", 
      RowBox[{"dual", " ", 
       RowBox[{"w", "."}]}]}]}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperAdditiveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SuperAdditiveQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperAdditiveQ", "[", 
    RowBox[{"game_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "SuperAdditiveQ", "]"}]}]}], "]"}], " ", 
   ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sil", ",", " ", "coal", ",", " ", "clsup"}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"sil", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
      RowBox[{"clsup", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SupAddQ", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "Coalitions"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sil", "===", "False"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<w greater dual w= \>\"", ",", "clsup"}], "]"}], ";"}], 
        " ", ",", " ", "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"Apply", "[", 
       RowBox[{"And", ",", " ", "clsup"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"44133fd2-d80a-4b55-9d35-e7630b65bd5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"Checking", " ", "if", " ", "w"}], " ", "=", 
    RowBox[{"<", " ", 
     RowBox[{
     "dual", " ", "w", " ", "holds", " ", "for", " ", "every", " ", "subgame",
       " ", 
      RowBox[{"w", "."}]}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SupAddQ", "[", "teilmg_List", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tpws", ",", "valsubg", ",", " ", "duval", ",", " ", "leq"}], 
        "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"tpws", "=", 
         RowBox[{"Subsets", "[", "teilmg", "]"}]}], ";", "\t\t\t       ", 
        "\n", "    ", 
        RowBox[{"valsubg", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "tpws"}]}], ";", "\n", "    ", 
        RowBox[{"duval", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", "T", "]"}], "-", 
             RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Reverse", "[", "tpws", "]"}]}], ")"}]}], ";", "\n", 
        "    ", 
        RowBox[{"leq", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"LessEqual", ",", " ", 
           RowBox[{"{", 
            RowBox[{"valsubg", ",", " ", "duval"}], "}"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "leq"}], "]"}]}]}], "\n", " ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectSuperSets", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SelectSuperSets", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectSuperSets", "[", "i_Integer", "]"}], ":=", 
     RowBox[{"W", "[", "i", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "[", "i_Integer", "]"}], ":=", " ", 
     RowBox[{"Cases", "[", 
      RowBox[{"Coalitions", ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", "i", ",", "___"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Assign", "[", "values_List", "]"}], ":=", 
     RowBox[{"Thread", "[", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", 
          "Coalitions"}], ")"}], ",", "values"}], "]"}], "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WeightedMajority", "[", 
      RowBox[{"T_", ",", "weight_List"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "wgs", "}"}], ",", "\n", "                    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "weight", "]"}], "===", "3"}], ",", "\n", 
         "                               ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Last", "[", "weight", "]"}], "]"}], ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "\n", 
           "                                  ", 
           RowBox[{
            RowBox[{"wgs", "=", 
             RowBox[{"Flatten", "[", "weight", "]"}]}], ";", "\n", 
            "                                  ", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"Length", "[", "wgs", "]"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "T", "]"}], "+", "1"}]}], "]"}], ",", 
              
              RowBox[{"WeightedMajMain", "[", 
               RowBox[{"T", ",", "wgs"}], "]"}], ",", "\n", 
              "                                        ", "True", ",", 
              RowBox[{"Print", "[", "\"\<Wrong Input\>\"", "]"}]}], "]"}]}], 
           ",", "\n", "                                   ", 
           RowBox[{"Print", "[", "\"\<Wrong Input\>\"", "]"}]}], "]"}], ",", 
         "\n", "                          ", 
         RowBox[{
          RowBox[{"Depth", "[", "weight", "]"}], "===", "2"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", "weight", "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "T", "]"}], "+", "1"}]}], "]"}], ",", 
           "\n", "                                             ", 
           RowBox[{"WeightedMajMain", "[", 
            RowBox[{"T", ",", "weight"}], "]"}], ",", "\n", 
           "                                              ", 
           RowBox[{"Print", "[", "\"\<Wrong Input\>\"", "]"}]}], "]"}], ",", 
         "\n", "                          ", "True", ",", 
         RowBox[{"Print", "[", "\"\<Wrong Input\>\"", "]"}]}], "]"}]}], " ", 
      "\n", "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"f7dd71a9-63d2-446f-\
b662-77b35ec5c2d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeightedMajMain", "[", 
     RowBox[{"T_", ",", "weight_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "outersets", ",", "coalweights", ",", "sumweights", ",", "threshold"}],
        "}"}], ",", "\n", "       ", 
      RowBox[{
       RowBox[{"outersets", " ", "=", " ", 
        RowBox[{"Outer", "[", 
         RowBox[{"List", ",", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}], "]"}]}], ";", "\n", "       ", 
       RowBox[{"coalweights", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"weight", ",", "1"}], "]"}], ",", " ", "#"}], "]"}], " ",
           "&"}], " ", "/@", " ", "outersets"}]}], ";", "\n", "       ", 
       RowBox[{"sumweights", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "coalweights"}]}], ";", "\n", "       ", 
       RowBox[{"threshold", " ", "=", " ", 
        RowBox[{"First", "[", "weight", "]"}]}], ";", " ", "\n", "       ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"GreaterEqual", "[", 
            RowBox[{"#", ",", " ", "threshold"}], "]"}], " ", "&"}], " ", "/@",
           " ", "sumweights"}], " ", "/.", " ", 
         RowBox[{"True", " ", "->", " ", "1"}]}], " ", "/.", " ", 
        RowBox[{"False", " ", "->", " ", "0"}]}]}]}], " ", "\n", "]"}]}], 
   ";"}], "\n", "\n"}]], "Code",ExpressionUUID->"ab499cd4-4ba9-420a-a7da-\
8c161d875b1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StandardSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"StandardSolution", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StandardSolution", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "dmQ", "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"dmQ", "=", 
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"2", "^", 
           RowBox[{"Length", "[", "T", "]"}]}], ",", 
          RowBox[{"2", "^", "2"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{"dmQ", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"{", "#", "}"}], "]"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"v", "[", "T", "]"}], "-", 
               RowBox[{"v", "[", 
                RowBox[{"{", "1", "}"}], "]"}], "-", 
               RowBox[{"v", "[", 
                RowBox[{"{", "2", "}"}], "]"}]}], ")"}], "/", "2"}]}], " ", 
           "&"}], "/@", " ", "T"}], ",", "\n", "      ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Game has incorrect dimension!\>\"", "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "\n", "   ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Section", " ", "general", " ", "functions", " ", "ends"}], " ", 
   "*)"}]}]}], "Code",ExpressionUUID->"5cb69abe-8dc4-415f-8f46-a59310f98b46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convexity", " ", "and", " ", "av"}], "-", 
    RowBox[{"convexity", " ", "section", " ", "starts"}]}], " ", "*)"}], "\n",
   "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PositiveGameQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PositiveGameQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"PositiveGameQ", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "unc", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"unc", " ", "=", " ", 
        RowBox[{"UnanimityCoordinates", "[", "game", "]"}]}], ";", " ", "\n", 
       "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"GreaterEqual", "[", 
            RowBox[{"#", ",", "0"}], "]"}], " ", "&"}], "/@", " ", "unc"}]}], 
        "]"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DecomposeInPositiveGames", "[", "game_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gb", ",", "valvec", ",", "hd", ",", "lhd", ",", "shd", ",", "pg1", 
         ",", "pg2", ",", "cg"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"gb", "=", 
         RowBox[{"GameBasis", "[", "T", "]"}]}], ";", "\n", "    ", 
        RowBox[{"valvec", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "    ", 
        RowBox[{"hd", " ", "=", " ", 
         RowBox[{
          RowBox[{"Inverse", "[", "gb", "]"}], ".", 
          RowBox[{"Drop", "[", 
           RowBox[{"valvec", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
        RowBox[{"lhd", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "#"}], "}"}], "]"}], " ", "&"}], "/@", " ", 
          "hd"}]}], ";", "\n", "    ", 
        RowBox[{"shd", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "#"}], "}"}], "]"}]}], " ", "&"}], "/@", " ", 
          "hd"}]}], ";", "\n", "    ", 
        RowBox[{"pg1", " ", "=", " ", 
         RowBox[{"gb", ".", "lhd"}]}], ";", "\n", "    ", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"pg1", ",", "0"}], "]"}], ";", "\n", "    ", 
        RowBox[{"pg2", " ", "=", " ", 
         RowBox[{"gb", ".", "shd"}]}], ";", "\n", "    ", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"pg2", ",", "0"}], "]"}], ";", "\n", "    ", 
        RowBox[{"cg", "=", 
         RowBox[{"pg1", "-", "pg2"}]}], ";", "\n", "    ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Equal", "[", 
            RowBox[{"valvec", ",", "cg"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"pg1", ",", "pg2", ",", "cg"}], "}"}]}], "}"}], "]"}], 
        ";"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreasMargContributions", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"IncreasMargContributions", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreasMargContributions", "[", 
      RowBox[{"game_", ",", "i_Integer", " ", ",", "values_List"}], "]"}], ":=",
      "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], "-", 
              RowBox[{"v", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", "<=", " ", "\n",
              "         ", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", 
              "-", " ", 
              RowBox[{"v", "[", 
               RowBox[{"DeleteCases", "[", " ", "\n", "          ", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
                "]"}], "]"}]}]}], ")"}], "&"}], " ", "/@", " ", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"W", "[", "i", "]"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}]}], "/.", 
         RowBox[{"Assign", "[", "values", "]"}]}], "]"}], ",", "\n", 
       "           ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreasingMargContributions", "[", 
      RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], "-", 
            RowBox[{"v", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", "<=", " ", "\n", 
           "          ", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-",
             " ", 
            RowBox[{"v", "[", 
             RowBox[{"DeleteCases", "[", " ", "\n", "            ", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
              "]"}], "]"}]}]}], ")"}], "&"}], " ", "/@", " ", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"W", "[", "i", "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}]}], " ", 
       ",", "\n", "              ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvCheck", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ConvCheck", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvCheck", "[", "game_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"IncreasingMargContributions", "[", 
        RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
      "T"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexQ", "[", "game_", "]"}], ":=", " ", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "liste", "}"}], ",", " ", "\n", "    ", 
       RowBox[{
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"IncreasingMargContributions", "[", 
              RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
            "T"}], ",", "1"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
      "\t", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostConvexQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AlmostConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AlmostConvexQ", "[", "game_", "]"}], ":=", " ", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "liste", "}"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"QuasiIncreasingMargContributions", "[", 
              RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
            "T"}], ",", "1"}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
      "\t", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"delT", "[", 
      RowBox[{"i_Integer", ",", "j_Integer"}], "]"}], ":=", " ", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"W", "[", "i", "]"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}], ",", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"T", ",", "j"}], "]"}]}], "]"}]}], ";"}]}]}]], "Code",Expressi\
onUUID->"e4004a02-4193-4c26-85fe-5b4a732d2714"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QuasiIncreasingMargContributions", "[", 
     RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", "<=", " ", "\n", 
          "          ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-", 
           " ", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", " ", "\n", "\t\t  ", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
             "]"}], "]"}]}]}], ")"}], " ", "&"}], " ", "/@", " ", 
       RowBox[{"delT", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], " ", ",", "\n", "              ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", "i"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ADMCGameQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ADMCGameQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ADMCGameQ", "[", "game_", "]"}], ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "liste", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"AlmostDiminishingMargContributions", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}], ",", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
     "\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostDiminishingMargContributions", "[", 
     RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", ">=", " ", "\n", 
          "          ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-", 
           " ", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", " ", "\n", "\t\t  ", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
             "]"}], "]"}]}], " ", ">=", " ", 
          RowBox[{"v", "[", 
           RowBox[{"{", "i", "}"}], "]"}]}], ")"}], "&"}], " ", "/@", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"W", "[", "i", "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}], ",", 
         "1"}], "]"}]}], " ", ",", "\n", "              ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AIMCGameQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AIMCGameQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AIMCGameQ", "[", "game_", "]"}], ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "liste", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"AlmostIncreasingMargContributions", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}], ",", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
     "\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostIncreasingMargContributions", "[", 
     RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", "<=", " ", "\n", 
          "          ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-", 
           " ", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", " ", "\n", "\t\t  ", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
             "]"}], "]"}]}], " ", "<=", " ", 
          RowBox[{"v", "[", 
           RowBox[{"{", "i", "}"}], "]"}]}], ")"}], "&"}], " ", "/@", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"W", "[", "i", "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}], ",", 
         "1"}], "]"}]}], " ", ",", "\n", "              ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AlmostConcaveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AlmostConcaveQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostConcaveQ", "[", "game_", "]"}], ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "liste", "}"}], ",", " ", "\n", "      ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"QuasiDiminishingMargContributions", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}], ",", "1"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
     "\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QuasiDiminishingMargContributions", "[", 
     RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", ">=", " ", "\n", 
          "          ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-", 
           " ", 
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", " ", "\n", "\t\t  ", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
             "]"}], "]"}]}]}], ")"}], " ", "&"}], " ", "/@", " ", 
       RowBox[{"delT", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], " ", ",", "\n", "              ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", "i"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Almost", " ", "Average"}], "-", "Convexity"}], " ", "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AlmostAverageConvexQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AlmostAverageConvexQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostAverageConvexQ", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ovls", ",", "acvQ"}], "}"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", "\n", "      ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "It", " ", "is", " ", "only", " ", "necessary", " ", "to", " ", 
          "check", " ", "proper", " ", "sub"}], "-", 
         RowBox[{
         "coalitions", " ", "of", " ", "size", " ", "equal", " ", "or", " ", 
          "greater", " ", "than", " ", "2."}]}], " ", "*)"}], "\n", "      ", 
       
       RowBox[{"acvQ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SbgAlmostAvQ", "[", 
           RowBox[{"game", ",", "#", ",", "ovls", ",", "T"}], "]"}], " ", 
          "&"}], " ", "/@", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"Coalitions", ",", 
             RowBox[{
              RowBox[{"Length", "[", "T", "]"}], "+", "1"}]}], "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\n", "      ", 
       RowBox[{"acvQ", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "acvQ"}], "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SbgAlmostAvQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SbgAlmostAvQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SbgAlmostAvQ", "[", 
     RowBox[{"game_", ",", "R_List", ",", "val_List", ",", "T0_List"}], "]"}],
     ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sbs", ",", "sbvl", ",", "sbg", ",", "acvQ"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"T", "=", "R"}], ";", "\n", "    ", 
       RowBox[{"sbs", "=", 
        RowBox[{"Subsets", "[", "R", "]"}]}], ";", "\n", "    ", 
       RowBox[{"sbvl", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", "sbs"}]}], ";",
        "\n", "    ", 
       RowBox[{"sbg", "=", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", "sbvl"}], "]"}]}], ";", " ", "\n", "    ", 
       RowBox[{"acvQ", "=", 
        RowBox[{"AvConvexQ", "[", "sbg", "]"}]}], ";", "\n", "    ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T0", ",", " ", "ovls"}], "]"}], ";", "\n", "    ", 
       RowBox[{"Return", "[", "acvQ", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Almost", " ", "Average"}], "-", "Concavity"}], " ", "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AlmostAverageConcaveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AlmostAverageConcaveQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlmostAverageConcaveQ", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ovls", ",", "acvQ"}], "}"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", "\n", "      ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "It", " ", "is", " ", "only", " ", "necessary", " ", "to", " ", 
          "check", " ", "proper", " ", "sub"}], "-", 
         RowBox[{
         "coalitions", " ", "of", " ", "size", " ", "equal", " ", "or", " ", 
          "greater", " ", "than", " ", "2."}]}], " ", "*)"}], "\n", "      ", 
       
       RowBox[{"acvQ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SbgAlmostAvCoQ", "[", 
           RowBox[{"game", ",", "#", ",", "ovls", ",", "T"}], "]"}], " ", 
          "&"}], " ", "/@", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"Coalitions", ",", 
             RowBox[{
              RowBox[{"Length", "[", "T", "]"}], "+", "1"}]}], "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\n", "      ", 
       RowBox[{"acvQ", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "acvQ"}], "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SbgAlmostAvCoQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SbgAlmostAvCoQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SbgAlmostAvCoQ", "[", 
    RowBox[{"game_", ",", "R_List", ",", "val_List", ",", "T0_List"}], "]"}], 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sbs", ",", "sbvl", ",", "sbg", ",", "acvQ"}], "}"}], ",", "\n",
      "    ", 
     RowBox[{
      RowBox[{"T", "=", "R"}], ";", "\n", "    ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "R", "]"}]}], ";", "\n", "    ", 
      RowBox[{"sbvl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", "sbs"}]}], ";", 
      "\n", "    ", 
      RowBox[{"sbg", "=", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", "sbvl"}], "]"}]}], ";", " ", "\n", "    ", 
      RowBox[{"acvQ", "=", 
       RowBox[{"AvConcaveQ", "[", "sbg", "]"}]}], ";", "\n", "    ", 
      RowBox[{"DefineGame", "[", 
       RowBox[{"T0", ",", " ", "ovls"}], "]"}], ";", "\n", "    ", 
      RowBox[{"Return", "[", "acvQ", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"8adb159a-622b-4470-a09c-48984e2ae637"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SubGame", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SubGame", "[", 
    RowBox[{"game_", ",", "R_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ovls", ",", "t0", ",", "sbs", ",", "sbvl", ",", "sbgame"}], 
      "}"}], ",", "\n", "       ", 
     RowBox[{
      RowBox[{"ovls", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "Coalitions"}]}], ";", "\n", "       ", 
      RowBox[{"t0", "=", "T"}], ";", "\n", "       ", 
      RowBox[{"sbs", "=", 
       RowBox[{"Subsets", "[", "R", "]"}]}], ";", "\n", "       ", 
      RowBox[{"sbvl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", "sbs"}]}], ";", 
      "\n", "       ", 
      RowBox[{"sbgame", ":=", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"R", ",", "sbvl"}], "]"}]}], ";", "\n", "       ", 
      RowBox[{"DefineGame", "[", 
       RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", "\n", "       ", 
      RowBox[{"Return", "[", "sbgame", "]"}], ";"}]}], "\n", "       ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"b905172d-ae4d-42fb-b080-\
650c42319116"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConcaveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ConcaveQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConcaveQ", "[", "game_", "]"}], ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "liste", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DiminishingMargContributions", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}], ",", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
     "\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DiminishingMargContributions", "[", 
    RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "i"}], "]"}], "]"}]}], " ", ">=", " ", "\n", 
         "          ", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-", 
          " ", 
          RowBox[{"v", "[", 
           RowBox[{"DeleteCases", "[", " ", "\n", "            ", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
            "]"}], "]"}]}]}], ")"}], "&"}], " ", "/@", " ", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"W", "[", "i", "]"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}]}], " ", 
     ",", "\n", "              ", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "Code",Ex\
pressionUUID->"1292c54b-68c9-4814-9517-317f4de76b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StrIncreasMargContrib", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"StrIncreasMargContrib", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrIncreasMargContrib", "[", 
     RowBox[{"game_", ",", " ", "i_Integer"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rationalize", "[", 
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "]"}]}], "]"}], " ", "<", " ", 
          "\n", "          ", 
          RowBox[{"Rationalize", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], "]"}], " ", "-",
             " ", 
            RowBox[{"v", "[", 
             RowBox[{"DeleteCases", "[", " ", "\n", "             ", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "j"}], "}"}], "]"}], "]"}], ",", "i"}], 
              "]"}], "]"}]}], "]"}]}], ")"}], "&"}], " ", "/@", " ", 
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"W", "[", "i", "]"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}]}], "]"}]}], " ", 
      ",", "\n", "              ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvStrQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ConvStrQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvStrQ", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"StrIncreasMargContrib", "[", 
       RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", "T"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexStrQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ConvexStrQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexStrQ", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "liste", "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StrIncreasMargContrib", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}], ",", "1"}], "]"}]}], ";", "\n", "\t\t ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
     "\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AverageConvexQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AverageConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AverageConvexQ", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dispres", ",", " ", "pwset", ",", " ", "chsum", ",", "delmp"}], "}"}],
       ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"pwset", " ", "=", " ", 
        RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"chsum", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CheckSumQ", "[", 
           RowBox[{"#", ",", " ", "T", ",", " ", "opts"}], "]"}], "  ", "&"}],
          " ", "/@", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"pwset", ",", " ", "1"}], "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"delmp", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"chsum", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{"Union", "[", "chsum", "]"}]}], "]"}], ",", "\n", 
         "                  ", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ",
                 "delmp"}], "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "delmp"}]}], "}"}]}], "\n", "                ", "]"}]}]}], "\n", 
     " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckSumQ", "[", 
    RowBox[{"teilmg_List", ",", " ", "T_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], " ", 
   ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"supset", ",", " ", "smarg", ",", " ", "dispres"}], "}"}], ",", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"supset", " ", "=", " ", 
       RowBox[{"OberMenge", "[", 
        RowBox[{"teilmg", ",", " ", "T"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"smarg", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SumMargContribution", "[", 
          RowBox[{"#", ",", " ", "teilmg", ",", " ", "opts"}], "]"}], " ", 
         "&"}], " ", "/@", " ", "supset"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", 
          RowBox[{"Union", "[", "smarg", "]"}]}], "]"}], ",", "\n", 
        "                  ", "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "smarg"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "smarg"}]}], "}"}]}], "\n", "                 ", "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"63d33d44-2c7f-45cb-8b80-\
d04349601a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OberMenge", "[", 
    RowBox[{"teilmg_List", ",", " ", "T_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"compl", ",", "subc", ",", "prop"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"compl", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"T", ",", " ", "teilmg"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"subc", "=", 
       RowBox[{"Subsets", "[", "compl", "]"}]}], ";", "\n", "    ", 
      RowBox[{"prop", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"teilmg", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
        " ", "subc"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
       "prop"}]}]}], "\n", "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->\
"48924db7-1547-4b7b-9325-6b3ba8fc4dcb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SumMargContribution", "[", 
     RowBox[{"superset_List", ",", " ", "teilmg_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], " ",
     ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dispres", ",", " ", "delisp", ",", " ", "delitlm", ",", " ", "sumtmg",
         ",", " ", "add", ",", " ", "nnegQ"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"delisp", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"superset", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
         " ", "teilmg"}]}], ";", "\n", "    ", 
       RowBox[{"delitlm", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"teilmg", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
         " ", "teilmg"}]}], ";", "\n", "    ", 
       RowBox[{"sumtmg", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"v", "[", "superset", "]"}], " ", "-", " ", 
             RowBox[{"v", "[", "#1", "]"}], " ", "-", " ", 
             RowBox[{"v", "[", "teilmg", "]"}], " ", "+", " ", 
             RowBox[{"v", "[", "#2", "]"}]}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"delisp", ",", " ", "delitlm"}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"add", " ", "=", " ", 
        RowBox[{
         RowBox[{"Total", "[", "sumtmg", "]"}], " ", "//", " ", 
         "Simplify"}]}], ";", "\n", "    ", 
       RowBox[{"nnegQ", " ", "=", " ", 
        RowBox[{"NonNegative", "[", "add", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", "nnegQ", ",", 
         "\n", "                 ", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{"nnegQ", ",", " ", "add"}], "}"}]}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AverageConcaveQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AverageConcaveQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AverageConcaveQ", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AverageConcaveQ", "]"}]}]}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dispres", ",", " ", "pwset", ",", " ", "chsum", ",", "delmp"}], "}"}],
       ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"pwset", " ", "=", " ", 
        RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"chsum", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CovCheckSumQ", "[", 
           RowBox[{"#", ",", " ", "T", ",", " ", "opts"}], "]"}], "  ", "&"}],
          " ", "/@", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"pwset", ",", " ", "1"}], "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"delmp", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"chsum", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{"Union", "[", "chsum", "]"}]}], "]"}], ",", "\n", 
         "                  ", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ",
                 "delmp"}], "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "delmp"}]}], "}"}]}], "\n", "                ", "]"}]}]}], "\n", 
     " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CovCheckSumQ", "[", 
     RowBox[{"teilmg_List", ",", " ", "T_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], " ",
     ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"supset", ",", " ", "smarg", ",", " ", "dispres"}], "}"}], ",",
       "\n", "    ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"supset", " ", "=", " ", 
        RowBox[{"OberMenge", "[", 
         RowBox[{"teilmg", ",", " ", "T"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"smarg", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CovSumMargContribution", "[", 
           RowBox[{"#", ",", " ", "teilmg", ",", " ", "opts"}], "]"}], " ", 
          "&"}], " ", "/@", " ", "supset"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{"Union", "[", "smarg", "]"}]}], "]"}], ",", "\n", 
         "                  ", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "smarg"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "smarg"}]}], "}"}]}], "\n", "                 ", "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CovSumMargContribution", "[", 
    RowBox[{"superset_List", ",", " ", "teilmg_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], " ", 
   ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", " ", "delisp", ",", " ", "delitlm", ",", " ", "sumtmg", 
       ",", " ", "add", ",", " ", "nnegQ"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"delisp", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"superset", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
        " ", "teilmg"}]}], ";", "\n", "    ", 
      RowBox[{"delitlm", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"teilmg", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
        " ", "teilmg"}]}], ";", "\n", "    ", 
      RowBox[{"sumtmg", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"v", "[", "superset", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "#1", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "teilmg", "]"}], " ", "+", " ", 
            RowBox[{"v", "[", "#2", "]"}]}], "]"}], " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"delisp", ",", " ", "delitlm"}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"add", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", "sumtmg", "]"}], " ", "//", " ", "Simplify"}]}],
       ";", "\n", "    ", 
      RowBox[{"nnegQ", " ", "=", " ", 
       RowBox[{"NonPositive", "[", "add", "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", "nnegQ", ",", 
        "\n", "                 ", "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{"nnegQ", ",", " ", "add"}], "}"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"92f7bf40-e90f-448b-b6b4-\
888135286328"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AvConvexQ", "[", "]"}], " ", "is", " ", "same", " ", "as", " ", 
    RowBox[{"AverageConvexQ", "[", "]"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AvConvexQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AvConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvConvexQ", "[", 
      RowBox[{"game_", ",", "  ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "AverageConvexQ", "]"}]}]}], "]"}], 
     "  ", ":=", " ", 
     RowBox[{"AverageConvexQ", "[", 
      RowBox[{"game", ",", " ", "opts"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvConcaveQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AvConcaveQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvConcaveQ", "[", 
      RowBox[{"game_", ",", "  ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "AverageConcaveQ", "]"}]}]}], "]"}], 
     "  ", ":=", " ", 
     RowBox[{"AverageConcaveQ", "[", 
      RowBox[{"game", ",", " ", "opts"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Old", " ", "Average", " ", "Convex", " ", "Function", " ", "is", " ", 
     "deprecated"}], " ", "*)"}]}]}]], "Code",ExpressionUUID->"2f6fedbd-7168-\
4a33-94e3-590c13afa2af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convexity", " ", "and", " ", "av"}], "-", 
    RowBox[{"convexity", " ", "section", " ", "ends"}]}], " ", "*)"}], "\n", 
  "      ", "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", "zero", ")"}], "-", 
    RowBox[{"monotonicity", " ", "section", " ", "starts"}]}], " ", "*)"}], 
  "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMonotoneQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ZeroMonotoneQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMonotoneQ", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "zeroval", ",", " ", "orgval", ",", "newgame", ",", "mQ", ",", 
         "oldgame"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"orgval", " ", "=", " ", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Subsets", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"zeroval", " ", "=", " ", 
         RowBox[{"ZeroNormalization", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"newgame", " ", ":=", " ", 
         RowBox[{"DefineGame", "[", 
          RowBox[{"T", ",", " ", "zeroval"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"mQ", "=", 
         RowBox[{"MonotoneQ", "[", "newgame", "]"}]}], ";", "\n", "    ", 
        RowBox[{"oldgame", " ", "=", " ", 
         RowBox[{"DefineGame", "[", 
          RowBox[{"T", ",", "orgval"}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Reconstruction", " ", "of", " ", "the", " ", "original", " ", 
          RowBox[{"game", "."}]}], " ", "*)"}], "\n", "    ", 
        RowBox[{"Return", "[", "mQ", "]"}], ";"}]}], "\n", "    ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroNormalization", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ZeroNormalization", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroNormalization", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"genIndVal", ",", " ", "addIndVal", ",", " ", "coalval"}], 
        "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"coalval", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "Coalitions"}]}], " ", ";", "\n", "    ", 
        RowBox[{"genIndVal", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"v", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", " ", "Coalitions"}], "]"}]}]}], ";", "\n", 
        "    ", 
        RowBox[{"addIndVal", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "genIndVal"}]}], ";", "\n", "    ", 
        RowBox[{"Subtract", "[", 
         RowBox[{"coalval", ",", " ", "addIndVal"}], "]"}]}]}], "\n", "    ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroOneNormalization", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ZeroOneNormalization", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroOneNormalization", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zeroli", ",", " ", "div"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"zeroli", " ", "=", " ", 
         RowBox[{"ZeroNormalization", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"div", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Divide", "[", " ", 
            RowBox[{"#", ",", " ", 
             RowBox[{"Take", "[", 
              RowBox[{"zeroli", ",", " ", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}], " ", "&"}], " ", "/@", 
          " ", "zeroli"}]}], ";", "\n", "    ", 
        RowBox[{"Flatten", "[", "div", "]"}]}]}], "\n", "    ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OneNormalization", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"OneNormalization", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OneNormalization", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "newgame", "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"newgame", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "    ", 
        RowBox[{"newgame", " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Last", "[", "newgame", "]"}]}], ")"}]}]}]}], "\n", "\n", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", "\n", 
    RowBox[{
     RowBox[{
     "A", " ", "game", " ", "v", " ", "is", " ", "monotone", " ", "if", " ", 
      "v", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", "\\", "cup"}], " ", "i"}], ")"}]}], " ", "-", " ", 
     RowBox[{"v", 
      RowBox[{"(", "S", ")"}], " ", "is", " ", "non"}], "-", 
     RowBox[{"negative", " ", "for", " ", "all", " ", 
      RowBox[{"i", " ", "\\", "in"}], " ", 
      RowBox[{"N", "."}]}]}], "\n", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GameMonotoneQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GameMonotoneQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GameMonotoneQ", "[", "game_", "]"}], ":=", " ", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "liste", "}"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MargContribPositive", "[", 
              RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
            "T"}], ",", "1"}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", "liste", ",", "1"}], "]"}]}], "]"}]}]}], "\n", 
      "\t", "]"}]}], ";"}], "\n"}]}]], "Code",ExpressionUUID->"9272cc3e-8bf5-\
4e9c-a68e-edce6ce98c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MargContribPositive", "[", 
     RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "margli", "}"}], ",", "\n", "        ", 
      RowBox[{
       RowBox[{"margli", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], "-", 
            RowBox[{"v", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "]"}]}], ")"}], "&"}], " ", "/@",
          " ", 
         RowBox[{"W", "[", "i", "]"}]}]}], ";", "\n", "        ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"GreaterEqual", ",", 
         RowBox[{"{", 
          RowBox[{"margli", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "margli", "]"}]}], "}"}]}], "]"}]}], 
          "}"}]}], "]"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}]], "Code",Expre\
ssionUUID->"0de00bac-a053-427f-aba8-38c92cb6633c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MonotoneQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MonotoneQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MonotoneQ", "[", "game_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "coal", "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"coal", " ", "=", " ", "Coalitions"}], ";", "\n", "    ", 
      RowBox[{"MonoCheck", "[", 
       RowBox[{"game", ",", " ", "coal"}], "]"}]}]}], "\n", "    ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"2b35da1e-c2b5-4010-a04d-83573dcced5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Checks", " ", "monotonicity", " ", "for", " ", "every", " ", "subgame"}], 
   "  ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MonoCheck", "[", 
      RowBox[{"game_", ",", " ", "liste_"}], "]"}], " ", ":=", " ", "\n", 
     "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mengen", " ", "=", " ", "liste"}], ",", " ", "obermenge", 
         ",", " ", "gensub", ",", " ", "newsets", ",", " ", "val", ",", " ", 
         "pruef", ",", 
         RowBox[{"truelist", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "wahrQ"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "mengen", "]"}], " ", ">", " ", "0"}], ",", 
          "\n", "      ", 
          RowBox[{
           RowBox[{"obermenge", " ", "=", " ", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"mengen", ",", " ", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "      ", 
           RowBox[{"newsets", " ", "=", " ", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"mengen", ",", " ", "obermenge"}], "]"}]}], ";", "\n", 
           "      ", 
           RowBox[{"gensub", " ", "=", " ", 
            RowBox[{"Subsets", "[", "obermenge", "]"}]}], ";", "\n", "      ", 
           RowBox[{"val", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
             "gensub"}]}], ";", "\n", "      ", 
           RowBox[{"pruef", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"val", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "gensub", "]"}], "]"}], "]"}], " ", ">=",
                 "  ", "#"}], ")"}], " ", "&"}], " ", "/@", " ", "val"}]}], 
           ";", "\n", "      ", 
           RowBox[{"mengen", " ", "=", " ", "newsets"}], ";", "\n", "      ", 
           
           RowBox[{"wahrQ", " ", "=", " ", 
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", " ", "pruef"}], "]"}]}], ";", "\n", "      ", 
           RowBox[{"truelist", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"truelist", ",", " ", "wahrQ"}], "]"}]}], ";"}]}], "\n", 
         "     ", "]"}], ";", "\n", "    ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "truelist"}], "]"}]}]}], "\n", "    ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", "zero", ")"}], "-", 
     RowBox[{"monotonicity", " ", "section", " ", "ends"}]}], " ", "*)"}], 
   "\n", "\n"}]}]], "Code",ExpressionUUID->"dec06a10-edb9-410a-b173-\
84b234b854ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "strong", " ", "epsilon", " ", "core", " ", "section", " ", "starts"}], 
   " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EpsValue", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"EpsValue", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EpsValue", "[", 
      RowBox[{"game_", ",", " ", "eps_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Set", "[", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "-", " ", "eps"}]}], "]"}], " ",
         "&"}], ",", " ", "ProperCoalitions"}], "]"}]}], ";"}], "\n", 
   "      ", "\n", "     ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NewRelax", "[", 
      RowBox[{"ineq_", ",", " ", "epsilon_"}], "]"}], " ", ":=", " ", 
     RowBox[{"ineq", " ", "/.", " ", 
      RowBox[{
       RowBox[{"lhs_", " ", ">=", " ", "rhs_"}], " ", "->", " ", 
       RowBox[{"lhs", " ", ">=", " ", 
        RowBox[{"rhs", " ", "-", " ", "epsilon"}]}]}]}]}], ";"}], "\n", "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"EpsCore", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"EpsCore", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EpsCore", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zf", ",", "res"}], "}"}], ",", "\n", "        ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"zf", ",", "res"}], "}"}], "=", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{
           RowBox[{"Global`e", " ", "-", " ", "f"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"NewRelax", "[", 
              RowBox[{"CoalitionalRationality", ",", 
               RowBox[{"Global`e", " ", "-", " ", "f"}]}], "]"}], ",", " ", 
             "ParetoOptimality"}], "]"}], ",", "\n", "                   ", 
           RowBox[{"Join", "[", 
            RowBox[{"PayoffVector", ",", " ", 
             RowBox[{"{", 
              RowBox[{"Global`e", ",", " ", "f"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
            "}"}], ",", 
           RowBox[{"Method", "->", "\"\<Automatic\>\""}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", "RevisedSimplex", " ", "*)"}], "\n", "        ", 
        RowBox[{"{", 
         RowBox[{"zf", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"PayoffVector", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"Global`e", ",", " ", "f"}], "}"}]}], "]"}], ",", 
              "res"}], "}"}]}], "]"}]}], "}"}]}]}], "\n", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"628fe5bf-9baf-4a78-9830-a19c19a20bac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Section", " ", "critical", " ", "values", " ", "starts"}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "following", " ", "critical", " ", "values", " ", "are", " ", 
     "due", " ", "to", " ", "Maschler"}], ",", " ", 
    RowBox[{"Peleg", " ", "and", " ", "Shapley", " ", 
     RowBox[{"(", "1979", ")"}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FirstCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"FirstCriticalVal", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FirstCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "con", "}"}], ",", "\n", "          ", 
       RowBox[{
        RowBox[{"con", " ", "=", " ", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{
           RowBox[{"e", " ", "-", " ", "f"}], ",", " ", 
           RowBox[{"Append", "[", "\n", "          ", 
            RowBox[{
             RowBox[{"NewRelax", "[", 
              RowBox[{"CoalitionalRationality", ",", " ", 
               RowBox[{"e", " ", "-", " ", "f"}]}], "]"}], ",", "\n", 
             "          ", "ParetoOptimality"}], "]"}], ",", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"PayoffVector", ",", " ", 
             RowBox[{"{", 
              RowBox[{"e", ",", " ", "f"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
            "}"}], ",", 
           RowBox[{"Method", "->", "\"\<Automatic\>\""}]}], "]"}]}], ";", 
        "\n", "          ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`eps1", "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"con", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}]}], "]"}]}]}], 
      "\n", "    ", "]"}]}], ";"}], "\n", "        ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SecondCriticalVal", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "cval2", "}"}], ",", "\n", "         ", 
       RowBox[{
        RowBox[{"cval2", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", 
                   RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], ",", " ", 
                 "#"}], "]"}], "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
           "ProperCoalitions"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`eps2", "}"}], ",", " ", 
            RowBox[{"{", "cval2", "}"}]}], "}"}]}], "]"}]}]}], "\n", "    ", 
      "]"}]}], ";"}], "\n", "            ", "\n", " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ThirdCriticalVal", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "cval3", "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"ReasonableOutcome", "[", "game", "]"}], ";", "\n", "    ", 
        RowBox[{"cval3", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
              RowBox[{"v", "[", "T", "]"}], " ", "+", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Global`r", "[", "#1", "]"}], " ", "&"}], ",", " ", 
                 
                 RowBox[{"Complement", "[", 
                  RowBox[{"T", ",", "#"}], "]"}]}], "]"}], "]"}]}], ")"}], 
            " ", "&"}], " ", "/@", " ", "ProperCoalitions"}], "]"}]}], ";", 
        "\n", "         ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`eps3", "}"}], ",", " ", 
            RowBox[{"{", "cval3", "}"}]}], "}"}]}], "]"}]}]}], "\n", "     ", 
      "]"}]}], ";"}], "\n", "    ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FourthCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"FourthCriticalVal", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FourthCriticalVal", "[", "game_", "]"}], ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "cval4", "}"}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{"cval4", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"SecondCriticalVal", "[", "game", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"ThirdCriticalVal", "[", "game", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
        "\n", "                ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`eps4", "}"}], ",", " ", 
            RowBox[{"{", "cval4", "}"}]}], "}"}]}], "]"}]}]}], "\n", 
      "        ", "]"}]}], ";"}], "\n", "    ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StarCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"StarCriticalVal", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StarCriticalVal", "[", "game_", "]"}], " ", ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cval", ",", " ", "upbd"}], "}"}], ",", "\n", "        ", 
       RowBox[{
        RowBox[{"upbd", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", 
             RowBox[{"ReasonableOutcome", "[", "game", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\n", "        ", 
        RowBox[{"cval", " ", "=", "  ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "#"}], "]"}]}], ",", " ", "\n", "            ", 
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"up", "[", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"T", ",", " ", "#"}], "]"}], "]"}], " ", "/.", 
                  " ", "upbd"}], ")"}], " ", "-", " ", 
                RowBox[{"v", "[", "T", "]"}]}]}], "}"}], "]"}], " ", "&"}], 
           " ", "/@", " ", "\n", "         ", "ProperCoalitions"}], "]"}]}], 
        ";", " ", "\n", "      ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`stareps", "}"}], ",", " ", 
            RowBox[{"{", "cval", "}"}]}], "}"}]}], "]"}]}]}], "\n", "  ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"up", "[", "S_List", "]"}], " ", ":=", " ", 
     RowBox[{"Plus", " ", "@@", " ", 
      RowBox[{"up", " ", "/@", " ", "S"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", "S_List", "]"}], " ", ":=", " ", 
     RowBox[{"Plus", " ", "@@", " ", 
      RowBox[{"m", " ", "/@", " ", "S"}]}]}], ";"}], "\n", "\n", " ", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "next", " ", "two", " ", "critical", " ", "values", " ", 
     "are", " ", "defined", " ", "by", " ", "Chang", " ", "and", " ", "Kan", 
     " ", 
     RowBox[{"(", "1992", ")"}], " ", "and", " ", "Chang", " ", "and", " ", 
     "Driessen", " ", 
     RowBox[{"(", "1994", ")"}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondStarCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SecondStarCriticalVal", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SecondStarCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lwbd", ",", " ", "lwpara", ",", " ", "upbd", ",", " ", "uppara", ",",
          " ", "dstarcval"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"lwbd", " ", "=", " ", 
         RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"lwpara", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"m", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", "lwbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        
        RowBox[{"upbd", " ", "=", " ", 
         RowBox[{"ReasonableOutcome", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"uppara", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", "upbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        
        RowBox[{"dstarcval", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               RowBox[{"Drop", "[", 
                RowBox[{
                 RowBox[{"Subsets", "[", "T", "]"}], ",", " ", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], " ", ">", "  ", 
             RowBox[{"v", "[", "T", "]"}]}], " ", "===", " ", "False"}], ",", 
           "\n", "                        ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LowerSetQ", "[", "game", "]"}], " ", "===", " ", 
              "False"}], ",", " ", 
             RowBox[{"CaseOne", "[", 
              RowBox[{"game", ",", " ", "uppara"}], "]"}], ",", "\n", 
             "                         ", "True", ",", " ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"CoreQ", "[", "game", "]"}], " ", "===", " ", 
                "False"}], ",", " ", 
               RowBox[{"CaseTwo", "[", 
                RowBox[{"game", ",", " ", "lwpara", ",", " ", "uppara"}], 
                "]"}], ",", "\n", "                                        ", 
               "True", ",", " ", 
               RowBox[{"CaseThree", "[", 
                RowBox[{"game", ",", " ", "lwpara", ",", " ", "uppara"}], 
                "]"}]}], "]"}]}], "\n", "             ", "]"}], ",", "\n", 
           "        ", "True", ",", " ", 
           RowBox[{
            RowBox[{"StarCriticalVal", "[", "game", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "\n", "        ", 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`dstareps", "}"}], ",", " ", 
            RowBox[{"{", "dstarcval", "}"}]}], "}"}]}], "]"}]}]}], "\n", 
      "    ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdStarCriticalVal", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ThirdStarCriticalVal", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ThirdStarCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lwbd", ",", " ", "lwpara", ",", " ", "upbd", ",", " ", "uppara", ",",
          " ", "thstarcval"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"lwbd", " ", "=", " ", 
         RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"lwpara", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"m", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", "lwbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        
        RowBox[{"upbd", " ", "=", " ", 
         RowBox[{"ProperAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"uppara", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", "upbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        
        RowBox[{"thstarcval", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               RowBox[{"Drop", "[", 
                RowBox[{
                 RowBox[{"Subsets", "[", "T", "]"}], ",", " ", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], " ", ">", "  ", 
             RowBox[{"v", "[", "T", "]"}]}], " ", "===", " ", "False"}], ",", 
           "\n", "                        ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LowerSetQ", "[", "game", "]"}], " ", "||", " ", 
                  RowBox[{"UpperSetQ", "[", "game", "]"}]}], ")"}], " ", "&&",
                 " ", 
                RowBox[{"CoreQ", "[", "game", "]"}]}], ")"}], " ", "===", " ",
               "True"}], ",", " ", "0", ",", "\n", 
             "                         ", "True", ",", " ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"CoreQ", "[", "game", "]"}], " ", "===", " ", 
                "False"}], ",", " ", 
               RowBox[{"CaseTwo", "[", 
                RowBox[{"game", ",", " ", "lwpara", ",", " ", "uppara"}], 
                "]"}], ",", "\n", "                                        ", 
               "True", ",", " ", 
               RowBox[{"CaseThreeFor3", "[", 
                RowBox[{"game", ",", " ", "lwpara", ",", " ", "uppara"}], 
                "]"}]}], "]"}]}], "\n", "             ", "]"}], ",", "\n", 
           "        ", "True", ",", " ", 
           RowBox[{
            RowBox[{"StarCriticalVal", "[", "game", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "\n", "        ", 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Global`thstareps", "}"}], ",", " ", 
            RowBox[{"{", "thstarcval", "}"}]}], "}"}]}], "]"}]}]}], "\n", 
      "    ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CaseOne", "[", 
      RowBox[{"game_", ",", " ", "uppara_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                RowBox[{"up", "[", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"T", ",", " ", "#"}], "]"}], "]"}], " ", "-", " ", 
                RowBox[{"v", "[", "T", "]"}]}], ")"}], ",", " ", 
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", 
                   RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], " ", "/@", 
                 " ", "#"}], "]"}]}], ",", " ", "0"}], "}"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "ProperCoalitions"}], "  ", "/.", " ", 
         "uppara"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CaseTwo", "[", 
      RowBox[{"game_", ",", " ", "lwpara_List", ",", " ", "uppara_List"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                RowBox[{"m", "[", "#", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "#"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                RowBox[{"up", "[", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"T", ",", " ", "#"}], "]"}], "]"}], " ", "-", " ", 
                RowBox[{"v", "[", "T", "]"}]}]}], "}"}], "]"}], " ", "&"}], 
           " ", "/@", " ", "ProperCoalitions"}], "  ", "/.", " ", "lwpara"}], 
         "  ", "/.", " ", "uppara"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CaseThree", "[", 
      RowBox[{"game_", ",", " ", "lwpara_List", ",", " ", "uppara_List"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                   RowBox[{"m", "[", "#", "]"}]}], ",", " ", "0"}], "}"}], 
                "]"}], ",", " ", 
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], " ", "/@", 
                  " ", "#"}], "]"}]}], ",", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                 RowBox[{"up", "[", 
                  RowBox[{"Complement", "[", 
                   RowBox[{"T", ",", " ", "#"}], "]"}], "]"}], "  ", "-", " ", 
                 RowBox[{"v", "[", "T", "]"}]}], ")"}]}], "}"}], "]"}], " ", 
            "&"}], " ", "/@", " ", "ProperCoalitions"}], "  ", "/.", " ", 
          "lwpara"}], " ", "/.", " ", "uppara"}], "]"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CaseThreeFor3", "[", 
      RowBox[{"game_", ",", " ", "lwpara_List", ",", " ", "uppara_List"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"{", "#1", "}"}], "]"}], " ", "&"}], " ", "/@", 
                    " ", "#"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                    RowBox[{"m", "[", "#", "]"}]}]}], "}"}], "]"}], ",", 
                  "0"}], "}"}], "]"}], ",", " ", 
               RowBox[{"Max", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                    RowBox[{"up", "[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{"T", ",", " ", "#"}], "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"v", "[", "T", "]"}]}], ")"}], ",", "0"}], "}"}], 
                "]"}]}], "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "ProperCoalitions"}], "  ", "/.", " ", "lwpara"}], "  ", "/.", " ",
          "uppara"}], "]"}]}], "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->\
"a1872e6d-1e4d-4e70-98bb-2068ba0b37e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FifthCriticalVal", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FifthCriticalVal", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FifthCriticalVal", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lwbd", ",", " ", "lwpara", ",", "cval5"}], "}"}], ",", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"lwbd", " ", "=", " ", 
        RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"lwpara", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}],
             ",", " ", "lwbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"cval5", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LowerSetQ", "[", "game", "]"}], " ", "===", " ", 
           "False"}], ",", " ", "0", ",", "\n", "                 ", 
          RowBox[{
           RowBox[{"LowerSetQ", "[", "game", "]"}], " ", "===", " ", "True"}],
           ",", "\n", "      ", 
          RowBox[{"Which", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"CoreQ", "[", "game", "]"}], " ", "===", " ", "False"}], 
            ",", " ", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"m", "[", "#", "]"}], " ", "/.", " ", "lwpara"}], 
                  ")"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
              "ProperCoalitions"}], "]"}], ",", "\n", "       ", "True", ",", 
            " ", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"m", "[", "#", "]"}], " ", "/.", " ", "lwpara"}], 
                    ")"}]}], ")"}], ",", " ", "0"}], "}"}], "]"}], " ", "&"}],
               " ", "/@", " ", "ProperCoalitions"}], "]"}]}], "]"}]}], " ", 
         "\n", "      ", "]"}]}], ";", "\n", "    ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Global`eps5", "}"}], ",", " ", 
           RowBox[{"{", "cval5", "}"}]}], "}"}]}], "]"}]}]}], "\n", "   ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSetQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UpperSetQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSetQ", "[", "game_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"upbd", ",", "uppara"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"upbd", " ", "=", " ", 
       RowBox[{"ProperAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"uppara", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}],
            ",", " ", "upbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"up", "[", "T", "]"}], " ", "/.", " ", "uppara"}], ")"}], 
       " ", ">=", "  ", 
       RowBox[{"v", "[", "T", "]"}]}]}]}], "\n", "    ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"41379b9f-2c63-4c41-89a8-2225085fa645"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LowerSetQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LowerSetQ", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerSetQ", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lwbd", ",", " ", "lwpara"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"lwbd", " ", "=", " ", 
        RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"lwpara", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}],
             ",", " ", "lwbd"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", "[", "T", "]"}], " ", "/.", " ", "lwpara"}], ")"}], 
        " ", "<=", "  ", 
        RowBox[{"v", "[", "T", "]"}]}]}]}], "\n", "    ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LowerSetIncImputationQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LowerSetIncImputationQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerSetIncImputationQ", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "LowerSetIncImputationQ", "]"}]}]}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "sil", "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "   ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", 
         RowBox[{"DisplayMessageLower", ";", "True"}]}], "]"}], ";", "\n", 
       "   ", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"SmallestContributionVector", "[", "game", "]"}], "]"}], " ",
         ">=", " ", "0"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayMessageLower", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Checking if Kernel and Pre-kernel are identical\>\"",
        "]"}], ";", "\n", "                      ", 
      RowBox[{
      "Print", "[", 
       "\"\<True is equivalent to zero-monotonicity of the game.\>\"", "]"}], 
      ";"}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSetIncImputationQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UpperSetIncImputationQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSetIncImputationQ", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "UpperSetIncImputationQ", "]"}]}]}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sil", ",", "prub", ",", " ", "prpara", ",", " ", "setwoi"}], 
      "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"sil", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UpperSetQ", "[", "game", "]"}], " ", "===", " ", "True"}], 
        ",", "\n", "      ", 
        RowBox[{
         RowBox[{"prub", " ", "=", " ", 
          RowBox[{"ProperAmount", "[", "game", "]"}]}], ";", "\n", "      ", 
         RowBox[{"prpara", " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               "T"}], ",", " ", "prub"}], "}"}]}], "]"}]}], ";", "\n", 
         "      ", 
         RowBox[{"setwoi", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"T", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "T"}]}], ";", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"sil", ",", "False"}], "]"}], ",", 
           RowBox[{"DisplayMessageUpper", ";", "True"}]}], "]"}], ";", "\n", 
         "      ", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], " ", ">=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"up", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
             "setwoi"}], " ", "/.", " ", "prpara"}], "]"}]}]}], ",", "\n", 
        "      ", "True", ",", " ", 
        RowBox[{
        "Print", "[", "\"\<Upper Set is empty. Nothing to check.\>\"", 
         "]"}]}], "]"}]}]}], "\n", " ", "]"}]}], ";"}]}], "Code",ExpressionUUI\
D->"864b7245-441b-468e-b28b-9087f68f7caa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DisplayMessageUpper", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<This class of games is different from zero-monotonic games.\>\"", 
       "]"}], ";", "\n", "                      ", 
      RowBox[{
      "Print", "[", 
       "\"\<If True, then the pre-kernel is equal to the kernel.\>\"", "]"}], 
      ";"}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectionUpperLowerSetQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"IntersectionUpperLowerSetQ", "::", "argerr"}], "]"}], ";", 
      "$Failed"}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectionUpperLowerSetQ", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"LowerSetQ", "[", "game", "]"}], " ", "&&", " ", 
       RowBox[{"UpperSetQ", "[", "game", "]"}]}]}], "\n", "   ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GrandCoalitionLargestValueQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"GrandCoalitionLargestValueQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrandCoalitionLargestValueQ", "[", "game_", "]"}], " ", ":=", 
    " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}], "]"}], " ", "<=", " ", 
       RowBox[{"v", "[", "T", "]"}]}]}], " ", "\n", "  ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PreKernelEqualsKernelQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"PreKernelEqualsKernelQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelEqualsKernelQ", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreKernelEqualsKernelQ", "]"}]}]}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "sil", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"sil", "===", "False"}], ",", "\n", "         ", 
         RowBox[{"Switch", "[", 
          RowBox[{"True", ",", " ", 
           RowBox[{"ZeroMonotoneQ", "[", "game", "]"}], ",", 
           RowBox[{"PrintMessPreKernelEq01", ";", " ", "True"}], ",", " ", 
           "\n", "                      ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"LowerSetQ", "[", "game", "]"}]}], ")"}]}], " ", "&&",
              " ", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"UpperSetQ", "[", "game", "]"}]}], ")"}]}], ")"}], ",",
            " ", 
           RowBox[{"PrintMessPreKernelEq02", ";", " ", "True"}], ",", "\n", 
           "                      ", 
           RowBox[{"UpperSetIncImputationQ", "[", "game", "]"}], ",", " ", 
           RowBox[{"PrintMessPreKernelEq03", ";", " ", "True"}], ",", "\n", 
           RowBox[{"(*", "  ", 
            RowBox[{
             RowBox[{"This", " ", "statement", " ", "needs", " ", 
              RowBox[{"more", "!"}], "  ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"GrandCoalitionLargestValueQ", "[", "game", "]"}], 
                " ", "&&", " ", 
                RowBox[{"IntersectionUpperLowerSetQ", "[", "game", "]"}]}], 
               ")"}]}], ",", "\n", "                                 ", 
             RowBox[{"PrintMessPreKernelEq04", ";", " ", "True"}], ","}], 
            "*)"}], "\n", "                ", "_", ",", " ", 
           RowBox[{"PrintMessPreKernelEq05", ";", "False"}]}], "\n", 
          "         ", "]"}], ",", "\n", "        ", "True", ",", "\n", 
         "          ", 
         RowBox[{"Switch", "[", 
          RowBox[{"True", ",", " ", 
           RowBox[{"ZeroMonotoneQ", "[", "game", "]"}], ",", " ", "True", ",",
            "\n", "                     ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"LowerSetQ", "[", "game", "]"}]}], ")"}]}], " ", "&&",
              " ", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"UpperSetQ", "[", "game", "]"}]}], ")"}]}], ")"}], ",",
            " ", "True", ",", "\n", "                     ", 
           RowBox[{"UpperSetIncImputationQ", "[", "game", "]"}], ",", " ", 
           "True", ",", "\n", 
           RowBox[{"(*", "                     ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"GrandCoalitionLargestValueQ", "[", "game", "]"}], " ",
                "&&", " ", 
               RowBox[{"IntersectionUpperLowerSetQ", "[", "game", "]"}]}], 
              ")"}], ",", "True", ","}], "*)"}], "\n", 
           "                      ", "_", ",", "False"}], "\n", "      ", 
          "]"}]}], "\n", "    ", "]"}]}]}], "\n", "  ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"PrintMessPreKernelEq01", " ", ":=", " ", 
   RowBox[{
   "Print", "[", "\"\<Checking if the game is zero monotone.\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"PrintMessPreKernelEq02", " ", ":=", " ", 
   RowBox[{
   "Print", "[", 
    "\"\<Checking if the intersection of the upper and lower set is \
empty.\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMessPreKernelEq03", " ", ":=", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<Checking if the upper set is included in the imputation set.\>\"", 
     "]"}]}], ";"}], "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"PrintMessPreKernelEq04", " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Checking if the intersection of the upper and lower set is non \
empty\>\"", "]"}], ";", "\n", "                           ", 
       RowBox[{
       "Print", "[", 
        "\"\<and that the grand coalition has the largest value.\>\"", "]"}], 
       ";"}], ")"}]}], ";"}], "\n", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMessPreKernelEq05", " ", ":=", " ", 
    RowBox[{
    "Print", "[", "\"\<Checked sufficient conditions are not satisfied.\>\"", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Section", " ", "critical", " ", "values", " ", "ends"}], " ", 
   "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LargestAmount", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LargestAmount", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LargestAmount", "[", 
    RowBox[{"game_", ",", " ", "i_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
        RowBox[{"v", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", " ", "i"}], "]"}], "]"}]}], ")"}], " ", "&"}], 
     " ", "/@", " ", 
     RowBox[{"W", "[", "i", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LargestAmount", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"LargestAmount", "[", 
       RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProperAmount", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ProperAmount", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProperAmount", "[", 
    RowBox[{"game_", ",", " ", "i_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
        RowBox[{"v", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", " ", "i"}], "]"}], "]"}]}], ")"}], " ", "&"}], 
     " ", "/@", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"W", "[", "i", "]"}], ",", " ", 
       RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProperAmount", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ProperAmount", "[", 
       RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImplementReas", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Global`r", ",", " ", "T"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReasonableOutcome", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ReasonableOutcome", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReasonableOutcome", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Clear", "[", "Global`r", "]"}], ";", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Set", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ImplementReas", "[", "game", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"\\\n", "LargestAmount"}], "[", "game", "]"}]}], "}"}]}], 
       "]"}]}], ")"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReasonableConst", " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "#", "]"}], " ", "<=", " ", 
       RowBox[{"Global`r", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
     "T"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReasonableSet", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ReasonableSet", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReasonableSet", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "assr", "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"ReasonableOutcome", "[", "game", "]"}], ";", "\n", "    ", 
       RowBox[{"assr", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Clear", "[", "Global`r", "]"}], ";", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Set", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ImplementReas", "[", "game", "]"}], ",", " ", 
              RowBox[{"LargestAmount", "[", "game", "]"}]}], "}"}]}], "]"}]}],
          ")"}]}], ";", "\n", "    ", 
       RowBox[{"Append", "[", 
        RowBox[{"ReasonableConst", ",", " ", "ParetoOptimality"}], "]"}]}]}], 
     "\n", "    ", "]"}]}], ";"}], "\n", " ", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "strong", " ", "epsilon", " ", "core", " ", "section", " ", "ends"}], " ", 
   "*)"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HarsanyiValue", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"HarsanyiValue", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HarsanyiValue", "[", "game_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hd", ",", "sz", ",", "pt", ",", "liste", ",", "pm", ",", "aryf", ",", 
       "mat"}], "}"}], ",", "\n", "                     ", 
     RowBox[{
      RowBox[{"hd", "=", 
       RowBox[{"HarsanyiDividends", "[", "game", "]"}]}], ";", "\n", 
      "\t\t     ", 
      RowBox[{"sS", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"sz", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", "sS"}], 
         ",", "1"}], "]"}]}], ";", "\n", "\t\t     ", 
      RowBox[{"pt", "=", 
       RowBox[{"Total", "[", "sz", "]"}]}], ";", "\n", "\t\t     ", 
      RowBox[{"liste", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">=", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t     ", 
      RowBox[{"pm", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        "liste"}]}], ";", "\n", "\t\t     ", 
      RowBox[{"aryf", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"pm", ",", "1"}], "]"}]}], ";", "\n", "\t\t     ", 
      RowBox[{"mat", "=", 
       RowBox[{"aryf", "/", "sz"}]}], ";", "\n", "\t\t     ", 
      RowBox[{"hd", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"HarsanyiDividends", "[", "game", "]"}], ",", "1"}], "]"}]}],
       ";", "\n", "\t\t     ", 
      RowBox[{"hd", ".", "mat"}]}]}], "\n", "\t\t      ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"2317ca69-9d38-4767-b98e-19b9b274c5ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NewShapley", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"NewShapley", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewShapley", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "pot", "}"}], ",", "\n", "                   ", 
      RowBox[{
       RowBox[{"pot", "=", 
        RowBox[{"Potential", "[", "game", "]"}]}], ";", "\n", 
       "                   ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"pot", ",", "1"}], "]"}], "-", 
          RowBox[{"Part", "[", 
           RowBox[{"pot", ",", 
            RowBox[{
             RowBox[{"-", "#"}], "-", "1"}]}], "]"}]}], " ", "&"}], "/@", " ",
         "T"}]}]}], "\n", "\t\t   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Potential", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Potential", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Potential", "[", "game_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"rho", "[", "#", "]"}], " ", "&"}], "/@", " ", 
     RowBox[{"Subsets", "[", "T", "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", 
    RowBox[{"S_List", " ", "/;", " ", 
     RowBox[{
      RowBox[{"Length", "[", "S", "]"}], "==", "1"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"rho", "[", "S", "]"}], "=", 
    RowBox[{"v", "[", "S", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", 
    RowBox[{"S_List", " ", "/;", " ", 
     RowBox[{
      RowBox[{"Length", "[", "S", "]"}], ">", "1"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"rho", "[", "S", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", "S", "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rho", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"S", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", " ", 
         "S"}], "]"}]}], ")"}], "/", 
     RowBox[{"Length", "[", "S", "]"}]}]}]}], ";"}]}], "Code",ExpressionUUID->\
"50d6f918-bee8-4d69-84b7-ed879715ac45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShapleyValueML", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ShapleyValueML", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShapleyValueML", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vars", ",", "tv", ",", "rl", ",", "F", ",", "dmat", ",", "G"}], "}"}],
       ",", "\n", "     ", 
      RowBox[{
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
       "\t\t\t      ", "\n", "     ", 
       RowBox[{"tv", "=", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"t", " ", "&"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"rl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"vars", ",", "tv"}], "}"}]}], "]"}]}], ";", "\t\t\t      ",
        "\n", "     ", 
       RowBox[{"F", "=", 
        RowBox[{"MLExtension", "[", "game", "]"}]}], ";", "\n", "     ", 
       RowBox[{"dmat", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", "#"}], "]"}], " ", "&"}], "/@", " ", "vars"}]}], 
       ";", "\n", "     ", 
       RowBox[{"G", "=", 
        RowBox[{"dmat", " ", "/.", " ", "rl"}]}], ";", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "&"}], "/@",
         " ", "G"}]}]}], "\t\t\t      ", "\n", "\t\t", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MLExtension", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MLExtension", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MLExtension", "[", "game_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ss", ",", "cS", ",", "ms", ",", "ns", ",", "smd"}], "}"}], ",",
      "\n", "   ", 
     RowBox[{
      RowBox[{"ss", "=", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "   ", 
      RowBox[{"cS", "=", 
       RowBox[{"Reverse", "[", "ss", "]"}]}], ";", "\n", "   ", 
      RowBox[{"ms", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "#", "}"}]}], "]"}], " ", "&"}], "/@", " ", "ss"}]}], 
      ";", "\t\t\t   ", "\n", "   ", 
      RowBox[{"ns", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "#", "}"}]}], "]"}], " ", "&"}], "/@", " ", "cS"}]}], 
      ";", "\n", "   ", 
      RowBox[{"smd", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"ms", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Subtract", "[", 
                 RowBox[{"1", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
               RowBox[{"ns", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], "*", 
          RowBox[{"v", "[", 
           RowBox[{"ss", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ms", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"Total", "[", "smd", "]"}]}]}], "\t\t\t   ", "\n", "\t\t    ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"f72b00d6-7e7a-469d-9f55-\
4289cccb92cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrintRemark", "[", "payoff_List", "]"}], ":=", " ", 
    RowBox[{"(", "\n", "      ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Dimensions is equal to \>\"", ",", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], "]"}], ";", "\n", 
      "      ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Depth is equal to \>\"", ",", 
        RowBox[{"Depth", "[", "payoff", "]"}]}], "]"}], ";", "\n", "      ", 
      RowBox[{
      "Print", "[", 
       "\"\<Usage: MaxExcessBalanced[game,payoff] and \
ExcessPayoff[game,payoff]\>\"", "]"}], ";", "\n", "      ", 
      RowBox[{
      "Print", "[", 
       "\"\<The variable 'payoff' has not the correct input format.\>\"", 
       "]"}], ";", "\n", "      ", 
      RowBox[{
      "Print", "[", 
       "\"\<The variable 'payoff' must be a list of payoff vectors or a \
single payoff vector.\>\"", "]"}]}], "\n", ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExcessPayoff", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ExcessPayoff", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExcessPayoff", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ExcessPayoff", "]"}]}]}], "]"}], ":=", 
    " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dispmat", ",", "assg", ",", "li", ",", "res"}], "}"}], ",", 
      "\n", "  ", 
      RowBox[{
       RowBox[{"dispmat", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayMatrixForm", "]"}]}], ";", "    ",
        "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}], " ",
           "||", " ", 
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "3"}]}], 
         ",", "\n", "    ", 
         RowBox[{
          RowBox[{"li", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Dimensions", "[", "payoff", "]"}], "]"}], "===", 
              "1"}], ",", 
             RowBox[{"{", "payoff", "}"}], ",", "payoff"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"assg", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"x", ",", "T"}], "]"}], ",", "#"}], "}"}]}], "]"}], 
             " ", "&"}], " ", "/@", " ", "li"}]}], ";", "\n", "    ", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "[", "#", "]"}], "-", 
                   RowBox[{"x", "[", "#", "]"}]}], ")"}], "&"}], " ", "/@", 
                " ", 
                RowBox[{"Subsets", "[", "T", "]"}]}], ",", " ", "#"}], "]"}], 
             " ", "&"}], " ", "/@", " ", "assg"}]}], ";", "\n", "    ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"dispmat", " ", "==", " ", "False"}], ",", " ", "res", 
            ",", " ", "True", ",", " ", 
            RowBox[{"DisplayErgb", "[", "res", "]"}]}], "]"}]}], ",", "\n", 
         "            ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", "\t\t", 
        "]"}]}]}], "\n", "  ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayErgb", "[", "payoff_List", "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"exc", ",", "coal", ",", "mpc"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"exc", " ", "=", " ", "payoff"}], ";", "\n", "    ", 
      RowBox[{"coal", " ", "=", " ", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"mpc", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"Global`Co", ",", "coal"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"PrependTo", "[", 
        RowBox[{"exc", ",", "mpc"}], "]"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"761ed972-28b7-456e-897d-6d5ecb1bbf32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Airport", " ", "Cost", " ", "Allocation", " ", "Problem"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ShapAirProb", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ShapAirProb", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ShapAirProb", "[", 
      RowBox[{"cost_List", ",", "nj_List"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c0", ",", "dc", ",", "smNj", ",", "cumMv", ",", "shv"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Length", "[", "cost", "]"}], ",", 
            RowBox[{"Length", "[", "nj", "]"}]}], "]"}], ",", "True", ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Lists must have same size!\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "   ", "\n", 
        "        ", 
        RowBox[{"c0", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"cost", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}], ";", "\n", 
        "        ", 
        RowBox[{"dc", "=", 
         RowBox[{"cost", "-", "c0"}]}], ";", "\n", "        ", 
        RowBox[{"smNj", "=", 
         RowBox[{"Total", "[", "nj", "]"}]}], ";", "\n", "        ", 
        RowBox[{"cumMv", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"smNj", "-", 
              RowBox[{"Accumulate", "[", "nj", "]"}]}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "smNj"}], "]"}]}], ";", "\n", 
        "        ", 
        RowBox[{"shv", "=", 
         RowBox[{"Accumulate", "[", 
          RowBox[{"dc", "/", "cumMv"}], "]"}]}]}]}], "\n", "\t", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"487236b8-96d6-466a-9093-d2ddec7a1ddf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NucAirProb", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"NucAirProb", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NucAirProb", "[", 
    RowBox[{"cost_List", ",", "nj_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cnj", ",", "cnjm", ",", "tCrd", ",", "cm", ",", "nc", ",", "alp", ",", 
       "tk", ",", "elm", ",", "st", ",", "mta", ",", "cnj1", ",", "c1", ",", 
       "idx", ",", "c2", ",", "df", ",", "lt"}], "}"}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Length", "[", "cost", "]"}], ",", 
          RowBox[{"Length", "[", "nj", "]"}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Lists must have same size!\>\"", "]"}], 
         ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], "]"}]}]}], "]"}], ";", "   ", "\n", 
      "\t", 
      RowBox[{"cnj", "=", 
       RowBox[{"Accumulate", "[", "nj", "]"}]}], ";", "\n", "\t", 
      RowBox[{"cnjm", "=", 
       RowBox[{"Last", "[", "cnj", "]"}]}], ";", "\n", "\t", 
      RowBox[{"cm", "=", 
       RowBox[{"Last", "[", "cost", "]"}]}], ";", "\n", "\t", 
      RowBox[{"cnj", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"cnj", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"tCrd", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"cost", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"cm", "=", 
       RowBox[{"Last", "[", "cost", "]"}]}], ";", "\n", "\t", 
      RowBox[{"nc", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"alp", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"tk", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"elm", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\n", "\t", 
      RowBox[{"mta", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"tCrd", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "False"}], "]"}], ",", "\n", 
        "             ", 
        RowBox[{
         RowBox[{"cnj1", "=", 
          RowBox[{"cnj", "+", "1"}]}], ";", "\n", "\t     ", 
         RowBox[{"c1", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tCrd", "-", 
              RowBox[{"Total", "[", "mta", "]"}]}], ")"}], "/", "cnj1"}], 
           "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"idx", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tCrd", "-", 
               RowBox[{"Total", "[", "mta", "]"}]}], ")"}], "/", "cnj1"}], 
            ",", "c1"}], "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"elm", "=", 
          RowBox[{"idx", "+", "elm"}]}], ";", "\n", "\t     ", 
         RowBox[{"c2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cm", "-", 
             RowBox[{"Total", "[", "mta", "]"}]}], ")"}], "/", "cnjm"}]}], 
         ";", "\n", "\t     ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"alp", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{"c1", ",", "c2"}], "}"}], "]"}]}], "]"}], ";", "\n", 
         "             ", 
         RowBox[{"alp", "=", 
          RowBox[{"Flatten", "[", "alp", "]"}]}], ";", "\n", "             ", 
         
         RowBox[{"AppendTo", "[", 
          RowBox[{"tk", ",", 
           RowBox[{"Extract", "[", 
            RowBox[{"cnj", ",", "idx"}], "]"}]}], "]"}], ";", "\n", "\t     ", 
         RowBox[{"tk", "=", 
          RowBox[{"Flatten", "[", "tk", "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"nc", ",", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "alp", "]"}], " ", "&"}], ",", 
             RowBox[{
              RowBox[{"Flatten", "[", "idx", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", "\n", 
         "\t     ", 
         RowBox[{"nc", "=", 
          RowBox[{"Flatten", "[", "nc", "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"df", "=", 
          RowBox[{
           RowBox[{"Length", "[", "nj", "]"}], "-", 
           RowBox[{
            RowBox[{"Flatten", "[", "elm", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "\t     ", 
         RowBox[{"cnj", "=", 
          RowBox[{"Accumulate", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"nj", ",", 
             RowBox[{"-", "df"}]}], "]"}], "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"cnjm", "=", 
          RowBox[{"Last", "[", "cnj", "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"cnj", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"cnj", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"mta", ",", 
           RowBox[{
            RowBox[{"Last", "[", "tk", "]"}], "*", 
            RowBox[{"Last", "[", "alp", "]"}]}]}], "]"}], ";", "\n", 
         "\t     ", 
         RowBox[{"mta", "=", 
          RowBox[{"Flatten", "[", "mta", "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"lt", "=", 
          RowBox[{
           RowBox[{"Length", "[", "tCrd", "]"}], "-", 
           RowBox[{
            RowBox[{"Flatten", "[", "idx", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "\t     ", 
         RowBox[{"tCrd", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"tCrd", ",", 
            RowBox[{"-", "lt"}]}], "]"}]}], ";"}]}], "\n", "\t ", "]"}], ";", 
      "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"tk", ",", "cnjm"}], "]"}], ";", "\n", "\t", 
      RowBox[{"tk", "=", 
       RowBox[{"Flatten", "[", "tk", "]"}]}], ";", "\n", "\t", 
      RowBox[{"c2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"cm", "-", 
          RowBox[{"Total", "[", "mta", "]"}]}], ")"}], "/", "cnjm"}]}], ";", 
      "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"alp", ",", "c2"}], "]"}], ";", "\n", "\t", 
      RowBox[{"alp", "=", 
       RowBox[{"-", 
        RowBox[{"Flatten", "[", "alp", "]"}]}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"nc", ",", "c2"}], "]"}], ";", "\n", "\t", 
      RowBox[{"nc", "=", 
       RowBox[{"Flatten", "[", "nc", "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"nc", ",", "alp", ",", "tk"}], "}"}]}]}], "\n", "\t", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"10a94b82-42fe-45ff-b7c1-34abbc1a527e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TauValAirProb", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"TauValAirProb", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TauValAirProb", "[", 
    RowBox[{"cost_List", ",", "nj_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c1", ",", "nj1", ",", "tv", ",", "tvm"}], "}"}], ",", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Length", "[", "cost", "]"}], ",", 
          RowBox[{"Length", "[", "nj", "]"}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Lists must have same size!\>\"", "]"}], 
         ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "   ", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"GreaterEqual", "[", 
         RowBox[{
          RowBox[{"Last", "[", "nj", "]"}], ",", "2"}], "]"}], ",", "\n", 
        "\t", 
        RowBox[{
         RowBox[{"Last", "[", "cost", "]"}], "*", 
         RowBox[{"cost", "/", 
          RowBox[{"Total", "[", 
           RowBox[{"cost", "*", "nj"}], "]"}]}]}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{"c1", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"cost", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "        ", 
         RowBox[{"nj1", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"nj", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "        ", 
         RowBox[{"tv", "=", 
          RowBox[{
           RowBox[{"Last", "[", "c1", "]"}], "*", 
           RowBox[{"c1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"c1", "*", "nj1"}], "]"}], "+", 
              RowBox[{"Last", "[", "c1", "]"}]}], ")"}]}]}]}], ";", "\n", 
         "\t", 
         RowBox[{"tvm", "=", 
          RowBox[{
           RowBox[{"Last", "[", "tv", "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Last", "[", "cost", "]"}], "-", 
             RowBox[{"Last", "[", "c1", "]"}]}], ")"}]}]}], ";", "\n", "\t", 
         RowBox[{"Append", "[", 
          RowBox[{"tv", ",", "tvm"}], "]"}]}]}], "]"}]}]}], "\n", "\t", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"19a00cbc-f8ea-413e-8664-\
ee8c9d6cf3a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxExcessSets", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MaxExcessSets", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxExcessSets", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exclist", ",", " ", "propexc", ",", " ", "maxexc", ",", " ", "pos"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"exclist", " ", "=", " ", 
        RowBox[{"ExcessPayoff", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"propexc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"#", ",", " ", "1"}], "]"}], ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
         "exclist"}]}], ";", "\n", "    ", 
       RowBox[{"maxexc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "propexc"}]}], ";", "\n", "    ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"propexc", ",", " ", "maxexc"}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"ProperCoalitions", ",", " ", "#"}], "]"}], " ", "&"}], " ",
         "/@", " ", "pos"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IntersectionOfMaxExcessSets", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"IntersectionOfMaxExcessSets", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectionOfMaxExcessSets", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "dsets", "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"dsets", " ", "=", " ", 
        RowBox[{"MaxExcessSets", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GrandCoalitionLargestValueQ", "[", "game", "]"}], "===", 
          "False"}], ",", 
         RowBox[{"DisplayMessFalse", "[", 
          RowBox[{"game", ",", "payoff"}], "]"}], ",", "\n", "         ", 
         "True", ",", " ", 
         RowBox[{"DisplayMessTrue", "[", 
          RowBox[{"game", ",", "payoff"}], "]"}]}], "]"}], ";", "\n", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Intersection", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@",
         " ", "dsets"}]}]}], "\n", "  ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayMessFalse", "[", 
    RowBox[{"game_", ",", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
   "                 ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Grand Coalition has not largest value.\>\"", "]"}], 
     ";", "\n", "                  ", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Payoff vector/s is/are kernel element(s)? \>\"", ",", " ", 
       RowBox[{"KernelImputationListQ", "[", 
        RowBox[{"game", ",", "payoff"}], "]"}]}], "]"}], ";"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayMessTrue", "[", 
    RowBox[{"game_", ",", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
   "                  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<If kernel payoff, then the intersection set is empty.\>\"", "]"}], 
     ";", "\n", "                   ", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Payoff vector/s is/are kernel element(s)? \>\"", ",", " ", 
       RowBox[{"KernelImputationListQ", "[", 
        RowBox[{"game", ",", "payoff"}], "]"}]}], "]"}], ";"}], ")"}]}], 
  ";"}]}], "Code",ExpressionUUID->"2b49989c-5229-41a9-9be2-d60c66471437"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TIJsets", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"TIJsets", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TIJsets", "[", 
    RowBox[{"i_Integer", ",", " ", "j_Integer"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"ProperCoalitions", ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", "i", ",", "___"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"___", ",", "j", ",", "___"}], "}"}]}], "]"}]}], ";"}]}], "Code",\
ExpressionUUID->"99e0f071-14f8-492a-8954-bb1b612ae199"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxExcessBalanced", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MaxExcessBalanced", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxExcessBalanced", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "MaxExcessBalanced", "]"}]}]}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rattol", ",", "dimpay"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", "    ", 
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",",
          "\n", "         ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MaxExcessBalCheck", "[", 
              RowBox[{"game", ",", " ", "#", ",", 
               RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], " ", "&"}], 
            " ", "/@", " ", "payoff"}], ",", " ", "\n", 
           "                       ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",",
          "\n", "            ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", " ", 
           RowBox[{"MaxExcessBalCheck", "[", 
            RowBox[{"game", ",", " ", "payoff", ",", 
             RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], ",", " ", "\n",
            "                         ", "True", ",", "  ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
         "\n", "   ", "True", ",", " ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxExcessBalCheck", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "MaxExcessBalanced", "]"}]}]}], "]"}], ":=",
     " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rattol", ",", "plpr", ",", "rvpr", ",", "asspay", ",", "sij", ",", 
        "sji", ",", "msrplij", ",", "msrplji", ",", "msrij", ",", "msrji", 
        ",", "lthij", ",", "tolvec", ",", "sysij", ",", "sysji", ",", "eqQ"}],
        "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", "    ", 
       RowBox[{"plpr", " ", "=", " ", 
        RowBox[{"PlayerPairs", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"rvpr", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "plpr"}]}], ";", "\n", "    ", 
       RowBox[{"asspay", " ", "=", " ", 
        RowBox[{"AssgPay", "[", "payoff", "]"}]}], ";", "\n", "    ", 
       RowBox[{"sij", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@", 
         " ", "plpr"}]}], ";", "\n", "    ", 
       RowBox[{"sji", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@", 
         " ", "rvpr"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"msrplij", ",", "msrplji"}], "}"}], "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MaxExcess", "[", 
           RowBox[{"sij", ",", " ", "asspay"}], "]"}], ",", 
          RowBox[{"MaxExcess", "[", 
           RowBox[{"sji", ",", " ", "asspay"}], "]"}]}], "}"}]}], ";", "\n", 
       "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"msrij", ",", "msrji"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"msrplij", " ", "-", " ", "msrplji"}], ",", 
          RowBox[{"msrplji", " ", "-", " ", "msrplij"}]}], "}"}]}], ";", "\n",
        "    ", 
       RowBox[{"lthij", " ", "=", " ", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"tolvec", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1.5", "*", "rattol"}], " ", "&"}], ",", " ", "lthij"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"sysij", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"LessEqual", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"N", "[", "msrij", "]"}], "]"}], ",", " ", "tolvec"}], 
            "}"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"sysji", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"LessEqual", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"N", "[", "msrji", "]"}], "]"}], ",", " ", "tolvec"}], 
            "}"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"eqQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Join", ",", " ", 
          RowBox[{"{", 
           RowBox[{"sysij", ",", " ", "sysji"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "eqQ"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MinExcessBalanced", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MinExcessBalanced", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinExcessBalanced", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "MaxExcessBalanced", "]"}]}]}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rattol", ",", "dimpay"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", " ", "\n", 
       "    ", 
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",",
          "\n", "         ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MinExcessBalCheck", "[", 
              RowBox[{"game", ",", " ", "#", ",", 
               RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], " ", "&"}], 
            " ", "/@", " ", "payoff"}], ",", " ", "\n", 
           "                       ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",",
          "\n", "            ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", " ", 
           RowBox[{"MinExcessBalCheck", "[", 
            RowBox[{"game", ",", " ", "payoff", ",", 
             RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], ",", " ", "\n",
            "                         ", "True", ",", "  ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
         "\n", "   ", "True", ",", " ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinExcessBalCheck", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "MinExcessBalanced", "]"}]}]}], "]"}], ":=",
     " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rattol", ",", "plpr", ",", " ", "rvpr", ",", " ", "asspay", ",", 
        "sij", ",", "sji", ",", "msrplij", ",", "msrplji", ",", "msrij", ",", 
        " ", "msrji", ",", "lthij", ",", "tolvec", ",", "sysij", ",", "sysji",
         ",", "eqQ"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", "    ", 
       RowBox[{"plpr", " ", "=", " ", 
        RowBox[{"PlayerPairs", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"rvpr", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "plpr"}]}], ";", "\n", "    ", 
       RowBox[{"asspay", " ", "=", " ", 
        RowBox[{"AssgPay", "[", "payoff", "]"}]}], ";", "\n", "    ", 
       RowBox[{"sij", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@", 
         " ", "plpr"}]}], ";", "\n", "    ", 
       RowBox[{"sji", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@", 
         " ", "rvpr"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"msrplij", ",", "msrplji"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MinExcess", "[", 
           RowBox[{"sij", ",", " ", "asspay"}], "]"}], ",", 
          RowBox[{"MinExcess", "[", 
           RowBox[{"sji", ",", " ", "asspay"}], "]"}]}], "}"}]}], ";", "\n", 
       "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"msrij", ",", "msrji"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"msrplij", " ", "-", " ", "msrplji"}], ",", 
          RowBox[{"msrplji", " ", "-", " ", "msrplij"}]}], "}"}]}], ";", "\n",
        "    ", 
       RowBox[{"lthij", " ", "=", " ", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"tolvec", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"1.5", "*", "rattol"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "lthij"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"sysij", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"LessEqual", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", "msrij", "]"}], ",", " ", "tolvec"}], 
            "}"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"sysji", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"LessEqual", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", "msrji", "]"}], ",", " ", "tolvec"}], 
            "}"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"eqQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Join", ",", " ", 
          RowBox[{"{", 
           RowBox[{"sysij", ",", " ", "sysji"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "eqQ"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Quota", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Quota", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Quota", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"secsize", ",", "matrix"}], "}"}], ",", "\n", "\t\t ", 
      RowBox[{
       RowBox[{"secsize", " ", "=", " ", 
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"T", ",", "#"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "T"}], "]"}]}], ";", "\n", "\t\t ", 
       RowBox[{"matrix", " ", "=", " ", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "==", "j"}], ",", "0", ",", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "   ", "\n", "                 ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"matrix", ",", "secsize"}], "]"}]}]}], "\n", "\t\t   ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VerticesCore", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"VerticesCore", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VerticesCore", "[", "game_", "]"}], ":=", "\n", "   ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"liste", ",", "mat", ",", "values"}], "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"liste", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">=", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"mat", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
          " ", "liste"}], ",", "1"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"mat", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Last", "[", "mat", "]"}]}]}], "]"}], ";", "\n", "   ", 
      RowBox[{"values", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Rest", "[", "Coalitions", "]"}]}]}], " ", ";", "\n", "   ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"values", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Last", "[", "values", "]"}]}]}], "]"}], ";", "\n", "   ", 
      RowBox[{"VertexEnumeration", "[", 
       RowBox[{
        RowBox[{"-", "mat"}], ",", 
        RowBox[{"-", "values"}]}], "]"}]}]}], "\n", "\t  ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"19be2abb-36cb-4c57-801e-6633958414c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Nucleolus", "/", "Kernel"}], " ", "section", " ", "starts"}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"See", " ", 
    RowBox[{"M", ".", " ", "Maschler"}], " ", "1992", " ", "for", " ", "a", 
    " ", "detailed", " ", "description", " ", "of", " ", "the", " ", 
    "algorithm", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Kopelowitz", " ", "Algorithm"}], ")"}], "."}]}], " ", "*)"}], 
  "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedNucleolus", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ModifiedNucleolus", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedNucleolus", "[", 
      RowBox[{"game_", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "ModifiedNucleolus", "]"}]}]}], "]"}], 
     " ", ":=", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "essgQ", ",", "propsets", ",", "const01", ",", "const02", ",", 
         "const", ",", "var", ",", "obf", ",", "cmat", ",", "bvect", ",", 
         "pra", ",", "minf", ",", "bds", ",", "ubds", ",", "blg", ",", "pbd", 
         ",", "zv", ",", "rl"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"essgQ", "=", 
         RowBox[{"EssentialQ", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"essgQ", ",", "False"}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<No solution can be found. Game not essential\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\n", "    ", 
        RowBox[{"propsets", " ", "=", " ", "ProperCoalitions"}], ";", "\n", 
        "    ", 
        RowBox[{"const01", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"{", "#", "}"}], "]"}], " ", "+", " ", 
              "Global`\[Alpha]"}], " ", ">=", "  ", 
             RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
           "propsets"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"const02", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Equal", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
                "T"}], "]"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"v", "[", "T", "]"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"const", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"const01", ",", " ", "const02"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"Length", "[", "const01", "]"}], " ", "+", " ", "1"}]}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"var", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Global`\[Alpha]", ",", " ", 
             RowBox[{"x", " ", "/@", " ", "T"}]}], "}"}], ",", " ", "2"}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect"}], "}"}], " ", 
         "=", " ", 
         RowBox[{"LPtoMatrix", "[", 
          RowBox[{"Global`\[Alpha]", ",", " ", "const", ",", " ", "var"}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"pra", " ", "=", " ", 
         RowBox[{"LargestAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"minf", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
        ";", "\n", "    ", 
        RowBox[{"bds", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", 
            RowBox[{"minf", ",", "pra"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"ubds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", "#", "]"}], " ", "&"}], "/@", " ", "bds"}]}],
         ";", "\n", "    ", 
        RowBox[{"blg", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          "ubds"}]}], ";", "\n", "    ", 
        RowBox[{"pbd", " ", "=", " ", 
         RowBox[{"Position", "[", 
          RowBox[{"blg", ",", "1"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"pbd", "==", 
             RowBox[{"{", "}"}]}], ",", "False"}], "]"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Infinity", " ", "does", " ", "not", " ", "work", " ", 
            RowBox[{"anymore", "!!"}], " ", "We", " ", "replace", " ", "it", 
            " ", "by", " ", "1000", "*", 
            RowBox[{"v", "[", "T", "]"}]}], " ", "*)"}], "\n", 
          "             ", 
          RowBox[{
           RowBox[{"zv", " ", "=", " ", 
            RowBox[{"Array", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1000", "*", 
                RowBox[{"v", "[", "T", "]"}]}], " ", "&"}], ",", " ", 
              RowBox[{"Length", "[", "pbd", "]"}]}], "]"}]}], ";", "\n", 
           "             ", 
           RowBox[{"rl", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Flatten", "[", "pbd", "]"}], ",", "zv"}], "}"}]}], 
             "]"}]}], ";", "\n", "             ", 
           RowBox[{"pra", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"pra", ",", "rl"}], "]"}]}], ";", "\n", "             ", 
           
           RowBox[{"bds", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", 
              RowBox[{"{", 
               RowBox[{"minf", ",", "pra"}], "}"}]}], "]"}]}], ";"}]}], "\n", 
         "      ", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Infinity", " ", "does", " ", "not", " ", "work", " ", 
          RowBox[{"anymore", "!!"}], " ", "We", " ", "replace", " ", "it", 
          " ", "by", " ", "1000", "*", 
          RowBox[{"v", "[", "T", "]"}]}], " ", "*)"}], "\n", "    ", 
        RowBox[{"bds", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1000"}], "*", 
                RowBox[{"v", "[", "T", "]"}]}], ",", 
               RowBox[{"1000", "*", 
                RowBox[{"v", "[", "T", "]"}]}]}], "}"}], ",", "bds"}], "}"}], 
           ",", "2"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"SeqLP", "[", 
         RowBox[{
         "obf", ",", " ", "cmat", ",", " ", "bvect", ",", "bds", ",", 
          RowBox[{"{", "}"}], ",", "opts"}], "]"}]}]}], "\n", "    ", "]"}]}],
     ";"}], "\n", "\n", " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedKernel", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ModifiedKernel", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ModifiedKernel", "[", 
      RowBox[{"game_", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "ModifiedKernel", "]"}]}]}], "]"}], 
     " ", ":=", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "essgQ", ",", "propsets", ",", "const01", ",", "const02", ",", 
         "const", ",", "var", ",", "obf", ",", "cmat", ",", "bvect", ",", 
         "pra", ",", "minf", ",", "bds", ",", "ubds", ",", "blg", ",", "pbd", 
         ",", "zv", ",", "rl"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"essgQ", "=", 
         RowBox[{"EssentialQ", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"essgQ", ",", "False"}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<No solution can be found. Game not essential\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\n", "    ", 
        RowBox[{"propsets", " ", "=", " ", "ProperCoalitions"}], ";", "\n", 
        "    ", 
        RowBox[{"const01", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"{", "#", "}"}], "]"}], " ", "+", " ", 
              "Global`\[Alpha]"}], " ", ">=", "  ", 
             RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
           "propsets"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"const02", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Equal", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
                "T"}], "]"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"v", "[", "T", "]"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"const", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"const01", ",", " ", "const02"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"Length", "[", "const01", "]"}], " ", "+", " ", "1"}]}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"var", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Global`\[Alpha]", ",", " ", 
             RowBox[{"x", " ", "/@", " ", "T"}]}], "}"}], ",", " ", "2"}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect"}], "}"}], " ", 
         "=", " ", 
         RowBox[{"LPtoMatrix", "[", 
          RowBox[{"Global`\[Alpha]", ",", " ", "const", ",", " ", "var"}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"pra", " ", "=", " ", 
         RowBox[{"LargestAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
        RowBox[{"minf", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
        ";", "\n", "    ", 
        RowBox[{"bds", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", 
            RowBox[{"minf", ",", "pra"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"ubds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", "#", "]"}], " ", "&"}], "/@", " ", "bds"}]}],
         ";", "\n", "    ", 
        RowBox[{"blg", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          "ubds"}]}], ";", "\n", "    ", 
        RowBox[{"pbd", " ", "=", " ", 
         RowBox[{"Position", "[", 
          RowBox[{"blg", ",", "1"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"pbd", "==", 
             RowBox[{"{", "}"}]}], ",", "False"}], "]"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Infinity", " ", "does", " ", "not", " ", "work", " ", 
            RowBox[{"anymore", "!!"}], " ", "We", " ", "replace", " ", "it", 
            " ", "by", " ", "1000", "*", 
            RowBox[{"v", "[", "T", "]"}]}], "*)"}], "\n", "             ", 
          RowBox[{
           RowBox[{"zv", " ", "=", " ", 
            RowBox[{"Array", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1000", "*", 
                RowBox[{"v", "[", "T", "]"}]}], " ", "&"}], ",", " ", 
              RowBox[{"Length", "[", "pbd", "]"}]}], "]"}]}], ";", "\n", 
           "             ", 
           RowBox[{"rl", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Flatten", "[", "pbd", "]"}], ",", "zv"}], "}"}]}], 
             "]"}]}], ";", "\n", "             ", 
           RowBox[{"pra", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"pra", ",", "rl"}], "]"}]}], ";", "\n", "             ", 
           
           RowBox[{"bds", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", 
              RowBox[{"{", 
               RowBox[{"minf", ",", "pra"}], "}"}]}], "]"}]}], ";"}]}], "\n", 
         "      ", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Infinity", " ", "does", " ", "not", " ", "work", " ", 
          RowBox[{"anymore", "!!"}], " ", "We", " ", "replace", " ", "it", 
          " ", "by", " ", "1000", "*", 
          RowBox[{"v", "[", "T", "]"}]}], "*)"}], "\n", "    ", 
        RowBox[{"bds", " ", "=", " ", 
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1000"}], "*", 
                RowBox[{"v", "[", "T", "]"}]}], ",", 
               RowBox[{"1000", "*", 
                RowBox[{"v", "[", "T", "]"}]}]}], "}"}], ",", "bds"}], "}"}], 
           ",", "2"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"SeqLP2", "[", 
         RowBox[{
         "game", ",", "obf", ",", " ", "cmat", ",", " ", "bvect", ",", "bds", 
          ",", 
          RowBox[{"{", "}"}], ",", "opts"}], "]"}]}]}], "\n", "    ", "]"}]}],
     ";"}]}]}]], "Code",ExpressionUUID->"647abac8-3a42-4e19-87b3-\
5478797b953c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PreNucleolus", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"PreNucleolus", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreNucleolus", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreNucleolus", "]"}]}]}], "]"}], " ", ":=",
     "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "propsets", ",", "const01", ",", "const02", ",", "const", ",", " ", 
        "var", ",", "obf", ",", " ", "cmat", ",", " ", "bvect", ",", "pra", 
        ",", "minf", ",", "mv", ",", "bds"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"propsets", " ", "=", " ", "ProperCoalitions"}], ";", "\n", 
       "    ", 
       RowBox[{"const01", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"{", "#", "}"}], "]"}], " ", "+", " ", 
             "Global`\[Alpha]"}], " ", ">=", "  ", 
            RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
          "propsets"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"const02", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Equal", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               "T"}], "]"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"v", "[", "T", "]"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"const", " ", "=", " ", 
        RowBox[{"FlattenAt", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"const01", ",", " ", "const02"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", "const01", "]"}], " ", "+", " ", "1"}]}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"var", " ", "=", " ", 
        RowBox[{"FlattenAt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Global`\[Alpha]", ",", " ", 
            RowBox[{"x", " ", "/@", " ", "T"}]}], "}"}], ",", " ", "2"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect"}], "}"}], " ", 
        "=", " ", 
        RowBox[{"LPtoMatrix", "[", 
         RowBox[{"Global`\[Alpha]", ",", " ", "const", ",", " ", "var"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"pra", " ", "=", " ", 
        RowBox[{"LargestAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
       RowBox[{"minf", " ", "=", " ", 
        RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"mv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", "minf", "]"}], ">", 
          RowBox[{"Max", "[", "mv", "]"}]}], ",", 
         RowBox[{"minf", "=", "mv"}], ",", "True"}], "]"}], ";", "\n", 
       RowBox[{"(*", "    ", 
        RowBox[{
         RowBox[{"minf", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Infinity"}], " ", "&"}], ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";"}], " ", "*)"}], 
       "\n", "    ", 
       RowBox[{"bds", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"List", ",", 
          RowBox[{"{", 
           RowBox[{"minf", ",", "pra"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       
       RowBox[{"bds", " ", "=", " ", 
        RowBox[{"FlattenAt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
            "bds"}], "}"}], ",", "2"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"SeqLP", "[", 
        RowBox[{"obf", ",", " ", "cmat", ",", " ", "bvect", ",", "bds", ",", 
         RowBox[{"{", "}"}], ",", "opts"}], "]"}]}]}], "\n", "    ", "]"}]}], 
   ";"}], "\n", "  ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LexiCenter", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LexiCenter", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LexiCenter", "[", 
    RowBox[{"game_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "LexiCenter", "]"}]}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"ModifiedNucleolus", "[", 
    RowBox[{"game", ",", "opts"}], "]"}]}], ";"}], "\n"}], "Code",ExpressionUU\
ID->"f3a950cd-49b7-4c76-8cc3-8c9ed4dc602d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EssentialQ", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indrat", ",", "sumirat", ",", "zeroess"}], "}"}], ",", " ", 
      "\n", "   ", 
      RowBox[{
       RowBox[{"indrat", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], "/@", "T"}]}], ";", 
       "  ", "\n", "   ", 
       RowBox[{"sumirat", " ", "=", " ", 
        RowBox[{"Total", "[", "indrat", "]"}]}], ";", "\n", "   ", 
       RowBox[{"zeroess", " ", "=", " ", 
        RowBox[{"sumirat", "<=", 
         RowBox[{"v", "[", "T", "]"}]}]}]}]}], " ", "\n", "   ", "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Formula", " ", "of", " ", "the", " ", "Nucleolus", " ", "for", " ", 
    "Three", " ", "Person", " ", "Games", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"cf", ".", " ", "Leng"}], " ", "and", " ", "Parlar"}], ",", 
      " ", "2010"}], ")"}]}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NucleolusThreePerson", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"NucleolusThreePerson", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NucleolusThreePerson", "[", "game_", "]"}], " ", ":=", " ", "\n",
     "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dmQ", ",", "cl2", ",", "ci", ",", "cdi", ",", "xd3", ",", "cd1", ",", 
        "pcd1", ",", "ptk", ",", "cd4a", ",", "cd4b", ",", "cd4", ",", "pcd4",
         ",", "pcd4b", ",", "tkl", ",", "tk2", ",", "ch", ",", "cd2", ",", 
        "cd2a", ",", "cd2b", ",", "tc", ",", "cd3a", ",", "cd3b", ",", "cd3", 
        ",", "ccik", ",", "pstrQ", ",", "cik", ",", "ext", ",", "sl1", ",", 
        "sl2", ",", "rl1", ",", "rl2", ",", "rl3", ",", "its", ",", "cmp", 
        ",", "pk", ",", "svl", ",", "cl"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dmQ", "=", 
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"2", "^", 
           RowBox[{"Length", "[", "T", "]"}]}], ",", 
          RowBox[{"2", "^", "3"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{"dmQ", ",", "True", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Game has incorrect dimension!\>\"", "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "    ", 
       RowBox[{"cl2", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", "T", "]"}], ",", 
            RowBox[{"-", "4"}]}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"ci", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"cl2", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], " ", 
          "&"}], "/@", " ", "T"}]}], ";", "\n", "    ", 
       RowBox[{"cdi", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"cl2", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], " ", 
          "&"}], "/@", " ", "T"}]}], ";", "\n", "    ", 
       RowBox[{"xd3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v", "[", "T", "]"}], " ", "+", " ", "#"}], ")"}], "/", 
            "3"}], "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subtract", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"v", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", " ",
               "ci"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"2", "*", 
                RowBox[{"Map", "[", 
                 RowBox[{"v", ",", "#"}], "]"}]}], " ", "&"}], "/@", " ", 
              "cdi"}]}], "}"}]}], "]"}]}]}], ";", "\n", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"Defining", " ", "Cases"}], "  ", "*)"}], "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"CoreQ", "[", "game", "]"}], ",", "False"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Case 0\>\"", "]"}], ";", "xd3"}], ",", 
         "\n", "      ", 
         RowBox[{
          RowBox[{"cd1", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"GreaterEqual", "[", 
              RowBox[{
               RowBox[{"v", "[", "T", "]"}], ",", 
               RowBox[{"3", "*", 
                RowBox[{"v", "[", "#", "]"}]}]}], "]"}], " ", "&"}], "/@", 
            " ", "cl2"}]}], ";", "\n", "      ", 
          RowBox[{"pcd1", "=", 
           RowBox[{"Position", "[", 
            RowBox[{"cd1", ",", "False"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"ptk", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"cl2", ",", "pcd1"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"cd4a", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"2", "*", 
                 RowBox[{"v", "[", "#", "]"}]}], "]"}], " ", "&"}], "/@", " ", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"cl2", ",", "#"}], "]"}]}], " ", "&"}], "/@", " ", 
            "cl2"}]}], ";", "\n", "      ", 
          RowBox[{"cd4b", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "T", "]"}], "+", 
              RowBox[{"v", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
            "cl2"}]}], ";", "\n", "      ", 
          RowBox[{"cd4", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GreaterEqual", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"cd4b", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Total", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                "cd4a"}]}], "}"}]}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"pcd4", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"cl2", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"cd4", ",", "True"}], "]"}]}], "]"}]}], ";", "\n", 
          "      ", 
          RowBox[{"tk2", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"cl2", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"cd1", ",", "False"}], "]"}]}], "]"}]}], ";", "\n", 
          "      ", 
          RowBox[{"tkl", " ", "=", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"tk2", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], ",", " ", 
             RowBox[{"{", "}"}], ",", "\n", "                  ", 
             RowBox[{"SameQ", "[", 
              RowBox[{"pcd4", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], ",", " ", 
             RowBox[{"{", "}"}], ",", "\n", "                  ", "True", ",",
              " ", 
             RowBox[{"First", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"tk2", ",", " ", "pcd4"}], "]"}], "]"}]}], "]"}]}], 
          ";", "\n", "      ", 
          RowBox[{"ch", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"ci", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "tkl", ",", "___"}], "}"}]}], "]"}]}], ";", 
          "\n", "      ", 
          RowBox[{"tc", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Complement", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "tkl", "}"}]}], "]"}], "]"}], " ", "&"}], "/@", 
            " ", "ch"}]}], ";", "\n", "      ", 
          RowBox[{"cd2", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"GreaterEqual", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"v", "[", "T", "]"}], "}"}], ",", "#"}], "}"}]}], 
                "]"}], " ", "&"}], "/@", " ", "#"}], " ", "&"}], "/@", "  ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"cl2", ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}]}], 
                    " ", "&"}], "/@", " ", "#"}], ")"}]}]}], " ", "&"}], "/@",
               " ", "cl2"}], ")"}]}]}], ";", "\n", "      ", 
          RowBox[{"cd2a", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "T", "]"}], " ", ">=", " ", 
              RowBox[{
               RowBox[{"v", "[", "tkl", "]"}], " ", "+", " ", 
               RowBox[{"2", "*", 
                RowBox[{"v", "[", "#", "]"}]}]}]}], " ", "&"}], "/@", " ", 
            "tc"}]}], ";", "\n", "      ", 
          RowBox[{"cd2b", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Or", ",", "cd2a"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"cd3a", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"GreaterEqual", "[", 
              RowBox[{
               RowBox[{"v", "[", "tkl", "]"}], ",", "#"}], "]"}], " ", "&"}], 
            "/@", " ", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], "&"}], ",", " ", "tc"}], 
             "]"}]}]}], ";", "\n", "      ", 
          RowBox[{"cd3b", "=", 
           RowBox[{"Position", "[", 
            RowBox[{"cd3a", ",", "True"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"cd3", "=", 
           RowBox[{"SameQ", "[", 
            RowBox[{"cd3b", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"pstrQ", "=", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Or", ",", 
                 RowBox[{"Flatten", "[", "#", "]"}]}], "]"}], " ", "&"}], "/@",
               " ", "cd2"}], ",", "True"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"cik", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"pstrQ", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], ",", " ", 
             RowBox[{"First", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"ci", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"___", ",", " ", "tkl", ",", " ", "___"}], "}"}]}], 
               "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"ci", ",", " ", "pstrQ"}], "]"}], " ", "//", " ", 
              "First"}]}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"(*", 
           RowBox[{
           "Assigning", " ", "Payoffs", " ", "to", " ", "the", " ", 
            "Players"}], "  ", "*)"}], "\n", "      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", "cd1"}], "]"}], ",", "\n", 
            "                 ", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Case 1\>\"", "]"}], ";", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"v", "[", "T", "]"}], "/", "3"}], " ", "&"}], ",", 
               "3"}], "]"}]}], ",", "\n", "            ", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Or", ",", "cd1"}], "]"}], ",", "True"}], "]"}], " ", 
             "&&", " ", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", " ", "cd2a"}], "]"}]}], ",", "\n", 
            "                 ", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Case 2\>\"", "]"}], ";", "\n", 
             "                 ", 
             RowBox[{"ext", "=", 
              RowBox[{"Extract", "[", 
               RowBox[{"cl2", ",", "pcd1"}], "]"}]}], ";", "\n", 
             "                 ", 
             RowBox[{"sl1", "=", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "[", "T", "]"}], " ", "+", " ", 
                   RowBox[{"v", "[", "#", "]"}]}], ")"}], "/", "4"}], " ", 
                "&"}], "/@", " ", "ext"}]}], ";", "\n", "                 ", 
             RowBox[{"sl2", "=", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
                   RowBox[{"v", "[", "#", "]"}]}], ")"}], "/", "2"}], " ", 
                "&"}], "/@", " ", "ext"}]}], ";", "\n", "                 ", 
             RowBox[{"rl1", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"MapThread", "[", 
                 RowBox[{"Rule", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "#", "}"}], ",", "sl1"}], "}"}]}], "]"}], 
                " ", "&"}], "/@", " ", 
               RowBox[{"Flatten", "[", "ext", "]"}]}]}], ";", "\n", 
             "                 ", 
             RowBox[{"rl2", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{"T", ",", 
                    RowBox[{"Flatten", "[", "ext", "]"}]}], "]"}], ",", 
                  "sl2"}], "}"}]}], "]"}]}], ";", "\n", "                 ", 
             RowBox[{"T", " ", "/.", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"rl1", ",", "rl2"}], "]"}], "]"}]}]}], ",", "\n", 
            "            ", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"cd3", ",", "False"}], "]"}], " ", "&&", " ", 
             RowBox[{"SameQ", "[", 
              RowBox[{"cd2b", ",", "True"}], "]"}]}], ",", "\n", "\t        ", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Case 3\>\"", "]"}], ";", "\n", 
             "                ", 
             RowBox[{"ptk", " ", "=", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "ptk", "]"}], " ", "==", " ", "1"}], 
                ",", "\n", "                        ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "pcd4", "]"}], " ", "==", " ", 
                   "1"}], ",", "\n", "                           ", 
                  RowBox[{
                   RowBox[{"pcd4b", " ", "=", " ", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"cl2", ",", " ", 
                    RowBox[{"Position", "[", 
                    RowBox[{"cd4", ",", " ", "False"}], "]"}]}], "]"}]}], ";",
                    "\n", "                           ", 
                   RowBox[{"svl", " ", "=", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
                    "pcd4b"}]}], ";", "\n", "                           ", 
                   RowBox[{"cl", " ", "=", " ", 
                    RowBox[{"First", "[", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"pcd4b", ",", " ", 
                    RowBox[{"Position", "[", 
                    RowBox[{"svl", ",", " ", 
                    RowBox[{"Max", "[", "svl", "]"}]}], "]"}]}], "]"}], 
                    "]"}]}], ";", "\n", "                           ", 
                   RowBox[{"{", 
                    RowBox[{"cl", ",", " ", "tkl"}], "}"}]}], " ", ",", " ", 
                  "pcd4"}], "]"}], ",", " ", "ptk"}], "]"}]}], ";", "\n", 
             "                ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"ptk", " ", "=", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "ptk", "]"}], " ", "==", " ", "1"}],
                   ",", " ", "pcd4", ",", " ", "ptk"}], "]"}]}], ";"}], " ", 
              "*)"}], "\n", "                ", 
             RowBox[{"its", "=", 
              RowBox[{"Apply", "[", 
               RowBox[{"Intersection", ",", "ptk"}], "]"}]}], ";", "\n", 
             "                ", 
             RowBox[{"rl1", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"its", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    "ptk"}], "]"}], "/", "2"}], "}"}]}], "}"}]}], "]"}]}], 
             ";", "\n", "                ", 
             RowBox[{"cmp", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"tkl", ",", "its"}], "]"}]}], ";", "\n", 
             "                ", 
             RowBox[{"ccik", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"ptk", ",", 
                RowBox[{"{", "tkl", "}"}]}], "]"}]}], ";", "\n", 
             "                ", 
             RowBox[{"rl2", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"cmp", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
                    RowBox[{"v", "[", "#", "]"}]}], ")"}], "/", "2"}], " ", 
                    "&"}], "/@", " ", "ccik"}]}], "}"}]}], "]"}]}], ";", "\n",
              "                ", 
             RowBox[{"rl3", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{"T", ",", "tkl"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
                    RowBox[{"v", "[", "tkl", "]"}]}], ")"}], "/", "2"}], 
                   "}"}]}], "}"}]}], "]"}]}], ";", "\n", "                ", 
             RowBox[{"T", " ", "/.", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"rl1", ",", " ", "rl2", ",", " ", "rl3"}], "}"}], 
               "]"}]}]}], ",", "\n", "            ", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Or", ",", "cd4"}], "]"}], " ", "&&", " ", 
             RowBox[{"SameQ", "[", 
              RowBox[{"cd2b", ",", "False"}], "]"}]}], ",", "\n", 
            "                ", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Case 4\>\"", "]"}], ";", "\n", 
             "                ", 
             RowBox[{"pk", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"T", ",", "tkl"}], "]"}]}], ";", "\n", 
             "                ", 
             RowBox[{"its", "=", 
              RowBox[{
               RowBox[{"First", "[", "tkl", "]"}], " ", "//", "List"}]}], ";",
              "\n", "                ", 
             RowBox[{"rl2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"its", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", "[", "T", "]"}], " ", "+", " ", 
                    RowBox[{"v", "[", "tkl", "]"}], " ", "+", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Subtract", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    "tc"}]}], "]"}]}]}], ")"}], "/", "4"}], "}"}]}], "}"}]}], 
               "]"}]}], ";", "\n", "                ", 
             RowBox[{"cmp", "=", 
              RowBox[{
               RowBox[{"Last", "[", "tkl", "]"}], " ", "//", "List"}]}], ";", 
             "\n", "                ", 
             RowBox[{"rl1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"cmp", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", "[", "T", "]"}], " ", "+", " ", 
                    RowBox[{"v", "[", "tkl", "]"}], " ", "-", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Subtract", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    "tc"}]}], "]"}]}]}], ")"}], "/", "4"}], "}"}]}], "}"}]}], 
               "]"}]}], ";", "\n", "                ", 
             RowBox[{"rl3", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"pk", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
                    RowBox[{"v", "[", "tkl", "]"}]}], ")"}], "/", "2"}], 
                   "}"}]}], "}"}]}], "]"}]}], ";", "\n", "                ", 
             RowBox[{"T", " ", "/.", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"rl1", ",", " ", "rl2", ",", " ", "rl3"}], "}"}], 
               "]"}]}]}], ",", "\n", "           ", "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Case 5\>\"", "]"}], ";", "xd3"}]}], 
           "\n", "           ", "]"}]}]}], "\n", "      ", "]"}]}]}], "\n", 
     " ", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "The", " ", "next", " ", "function", " ", "translates", " ", "the", " ", 
      "definition", " ", "of", " ", "the", " ", "Nucleolus", " ", "into", 
      "\n", " ", "a", " ", "sequence", " ", "of", " ", "linear", " ", 
      "programs", " ", "on", " ", "the", " ", "pre"}], "-", 
     RowBox[{"imputation", " ", 
      RowBox[{"set", ".", " ", "\n", " ", "To"}], " ", "obtain", " ", "a", 
      " ", "pre"}], "-", 
     RowBox[{
     "kernel", " ", "solution", " ", "the", " ", "recursion", " ", 
      "stops"}]}], ",", " ", 
    RowBox[{"in", " ", "general"}], ",", " ", 
    RowBox[{
    "before", "\n", " ", "the", " ", "nucleolus", " ", "of", " ", "the", " ", 
     "game", " ", "has", " ", "been", " ", 
     RowBox[{"computed", ".", " ", "One"}], " ", "stopping", " ", "criterion",
      " ", "of", " ", "\n", " ", "the", " ", "recursion", " ", "procedure", 
     " ", "is", " ", "if", " ", "the", " ", "set", " ", "of", " ", "new", " ",
      "equal", " ", "constraints", " ", "is", " ", 
     RowBox[{"empty", ".", " ", "\n", " ", "C", ".", "f", ".", " ", "Owen"}], 
     " ", "1974", " ", "and", " ", "Owen", " ", 
     RowBox[{"(", 
      RowBox[{"1995", ",", " ", 
       RowBox[{
        RowBox[{"pp", ".322"}], "-", "334."}]}], ")"}]}]}], "\n", "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SeqLP", "[", 
    RowBox[{
    "obf_", ",", " ", "cmat_List", ",", " ", "bvect_List", ",", "bds_List", 
     ",", 
     RowBox[{"bA_List", ":", " ", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "ModifiedNucleolus", "]"}]}]}], "]"}], 
   " ", ":=", "\n", "   ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "filopts", ",", "mthd", ",", "cmat0", ",", "cmat1", ",", "meq", ",", 
       "beq", ",", "lw", ",", "up", ",", "idm", ",", "res", ",", "res1", ",", 
       "bv", ",", "yineq", ",", "yeq", ",", "zf", ",", "bv0", ",", "rl2", ",",
        "gr", ",", "ps", ",", "al1", ",", "psal1", ",", "ov", ",", "ps1", ",",
        "zv", ",", "rl", ",", "bA1", ",", "lb", ",", "bA2", ",", "ons", ",", 
       "wghs", ",", "mr", ",", "pw", ",", "pwQ", ",", "extb", ",", "bvect1", 
       ",", "twv", ",", "ps2", ",", "rl3", ",", "zQ"}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
      RowBox[{"meq", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bA", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "cmat", "]"}], "}"}], ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "bA", "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"beq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"First", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"bvect", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"idm", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], " ", "+", " ", "1"}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"cmat0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"cmat", ",", 
           RowBox[{"-", "idm"}]}], "]"}], ",", "idm"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"cmat0", "=", 
       RowBox[{"SparseArray", "[", "cmat0", "]"}]}], ";", " ", "\n", "    ", 
      RowBox[{"lw", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"bds", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"up", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"bds", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"bv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"First", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
        "bvect"}]}], ";", "\n", "    ", 
      RowBox[{"bv0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"bv", ",", "up"}], "]"}], ",", 
         RowBox[{"-", "lw"}]}], "]"}]}], ";", "  ", "\n", "    ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "ConstraintSensitivity", " ", "cannot", " ", "be", " ", "used", " ", 
        "with", " ", 
        RowBox[{"GUROBI", "."}]}], " ", "*)"}], "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res1", ",", 
         RowBox[{"{", 
          RowBox[{"yineq", ",", "yeq"}], "}"}], ",", "zf"}], "}"}], "=", 
       RowBox[{"LinearOptimization", "[", 
        RowBox[{"obf", ",", 
         RowBox[{"{", 
          RowBox[{"cmat0", ",", "bv0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"meq", ",", "beq"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<PrimalMinimizer\>\"", ",", "\"\<ConstraintSensitivity\>\"", 
           ",", "\"\<PrimalMinimumValue\>\""}], "}"}], ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<res=\>\"", ",", "res1"}], "]"}], ";"}], " ", "*)"}], 
      "\n", "    ", 
      RowBox[{"res", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"res1", ",", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"zf", ",", 
          RowBox[{"-", "Infinity"}]}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"gr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Less", "[", 
          RowBox[{"#", ",", "0"}], "]"}], " ", "&"}], "/@", " ", "yineq"}]}], 
      ";", "\n", "    ", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"gr", ",", "True"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"al1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "cmat"}]}], 
      ";", "\n", "    ", 
      RowBox[{"psal1", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"al1", ",", "0"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"ps", ",", "psal1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ps", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"slc", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Less", "[", 
            RowBox[{"#", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "cmat", "]"}], "]"}]}], "]"}], " ", 
           "&"}], " ", "/@", " ", "ps"}], ",", "True"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"ps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"ps", ",", "slc"}], "]"}]}], ";", " ", "\n", "    ", 
      RowBox[{"ov", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"1", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps1", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"ps", ",", "ov"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"zv", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"rl", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps1", ",", "zv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"cmat1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"cmat", ",", "rl"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"cmat1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "___"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lb", " ", "=", " ", 
       RowBox[{"Length", "[", "bA", "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA2", "=", 
       RowBox[{"FlattenAt", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"bA", ",", "bA1"}], "]"}], ",", 
         RowBox[{"lb", "+", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], "/@", " ", "bA2"}]}], 
      ";", "\n", "    ", 
      RowBox[{"ons", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"1", " ", "&"}], ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"wghs", "=", 
       RowBox[{
        RowBox[{"PseudoInverse", "[", 
         RowBox[{"Transpose", "[", "bA2", "]"}], "]"}], ".", "ons"}]}], ";", 
      "\n", "    ", 
      RowBox[{"mr", " ", "=", " ", 
       RowBox[{"MatrixRank", "[", "bA2", "]"}]}], ";", "\n", "    ", 
      RowBox[{"pw", "=", 
       RowBox[{"Positive", "[", "wghs", "]"}]}], ";", "\n", "    ", 
      RowBox[{"pwQ", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", "pw"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"mr", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"SameQ", "[", 
          RowBox[{"pwQ", ",", "True"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"cmat1", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"cmat1", ",", " ", "bA1"}], "]"}]}], ";"}], "*)"}], "\n", 
      "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bA", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{"bA1", ",", 
           RowBox[{"{", 
            RowBox[{"Drop", "[", 
             RowBox[{"meq", ",", "1"}], "]"}], "}"}]}], "]"}], ",", "bA1"}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"bA1", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"extb", "=", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"bvect", ",", "ps1"}], "]"}], "-", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{"res1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"rl2", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps1", ",", "extb"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bvect1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"bvect", ",", "rl2"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"twv", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"2", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps2", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"ps", ",", "twv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"rl3", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps2", ",", "zv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bvect1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"bvect1", ",", "rl3"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"zQ", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "cmat1"}],
          ",", 
         RowBox[{
          RowBox[{"#", "==", "1"}], " ", "&"}]}], "]"}]}], ";", "\n", "    ", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"zQ", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "res", ",", 
        RowBox[{"SeqLP", "[", 
         RowBox[{
         "obf", ",", "cmat1", ",", "bvect1", ",", "bds", ",", "bA1", ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"9e095473-09c4-4295-8a55-\
a1f9b7e2755f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SeqLP2", "[", 
    RowBox[{
    "game_", ",", "obf_", ",", " ", "cmat_List", ",", " ", "bvect_List", ",", 
     "bds_List", ",", 
     RowBox[{"bA_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "ModifiedKernel", "]"}]}]}], "]"}], " ", 
   ":=", "\n", "      ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "filopts", ",", "mthd", ",", "cmat1", ",", "dl1", ",", "dl2", ",", 
       "dl3", ",", "dl4", ",", "pkQ", ",", "gr", ",", "ps", ",", "al1", ",", 
       "psal1", ",", "ov", ",", "rl2", ",", "res", ",", "ps1", ",", "zv", ",",
        "rl", ",", "bA1", ",", "lb", ",", "bA2", ",", "ons", ",", "wghs", ",",
        "mr", ",", "pw", ",", "pwQ", ",", "extb", ",", "bvect1", ",", "twv", 
       ",", "ps2", ",", "rl3", ",", "zQ"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
      RowBox[{"meq", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bA", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "cmat", "]"}], "}"}], ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "bA", "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"beq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"First", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"bvect", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"idm", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], " ", "+", " ", "1"}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"cmat0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"cmat", ",", 
           RowBox[{"-", "idm"}]}], "]"}], ",", "idm"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"cmat0", "=", 
       RowBox[{"SparseArray", "[", "cmat0", "]"}]}], ";", "\n", "    ", 
      RowBox[{"lw", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"bds", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"up", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"bds", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"bv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"First", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
        "bvect"}]}], ";", "\n", "    ", 
      RowBox[{"bv0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"bv", ",", "up"}], "]"}], ",", 
         RowBox[{"-", "lw"}]}], "]"}]}], ";", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res1", ",", 
         RowBox[{"{", 
          RowBox[{"yineq", ",", "yeq"}], "}"}], ",", "zf"}], "}"}], "=", 
       RowBox[{"LinearOptimization", "[", 
        RowBox[{"obf", ",", 
         RowBox[{"{", 
          RowBox[{"cmat0", ",", "bv0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"meq", ",", "beq"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<PrimalMinimizer\>\"", ",", "\"\<ConstraintSensitivity\>\"", 
           ",", "\"\<PrimalMinimumValue\>\""}], "}"}], ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"res", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"res1", ",", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"pkQ", " ", "=", " ", 
       RowBox[{"KernelImputationQ", "[", 
        RowBox[{"game", ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"pkQ", ",", "True"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"zf", ",", 
          RowBox[{"-", "Infinity"}]}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"gr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Less", "[", 
          RowBox[{"#", ",", "0"}], "]"}], " ", "&"}], "/@", " ", "yineq"}]}], 
      ";", "\n", "    ", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"gr", ",", "True"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"al1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "cmat"}]}], 
      ";", "\n", "    ", 
      RowBox[{"psal1", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"al1", ",", "0"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"ps", ",", "psal1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ps", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"slc", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Less", "[", 
            RowBox[{"#", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "cmat", "]"}], "]"}]}], "]"}], " ", 
           "&"}], " ", "/@", " ", "ps"}], ",", "True"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"ps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"ps", ",", "slc"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ov", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"1", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps1", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"ps", ",", "ov"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"zv", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"rl", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps1", ",", "zv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"cmat1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"cmat", ",", "rl"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"cmat1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "___"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lb", " ", "=", " ", 
       RowBox[{"Length", "[", "bA", "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA2", "=", 
       RowBox[{"FlattenAt", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"bA", ",", "bA1"}], "]"}], ",", 
         RowBox[{"lb", "+", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA2", "=", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], "/@", " ", "bA2"}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"ons", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"1", " ", "&"}], ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"wghs", "=", 
       RowBox[{
        RowBox[{"PseudoInverse", "[", 
         RowBox[{"Transpose", "[", "bA2", "]"}], "]"}], ".", "ons"}]}], ";", 
      "\n", "    ", 
      RowBox[{"mr", " ", "=", " ", 
       RowBox[{"MatrixRank", "[", "bA2", "]"}]}], ";", "\n", "    ", 
      RowBox[{"pw", "=", 
       RowBox[{"Positive", "[", "wghs", "]"}]}], ";", "\n", "    ", 
      RowBox[{"pwQ", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", "pw"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"mr", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"SameQ", "[", 
          RowBox[{"pwQ", ",", "True"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"res", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"bA", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{"bA1", ",", 
           RowBox[{"{", 
            RowBox[{"Drop", "[", 
             RowBox[{"meq", ",", "1"}], "]"}], "}"}]}], "]"}], ",", "bA1"}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"bA1", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"bA1", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"extb", "=", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"bvect", ",", "ps1"}], "]"}], "-", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{"res1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"rl2", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps1", ",", "extb"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bvect1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"bvect", ",", "rl2"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"twv", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"2", " ", "&"}], ",", 
         RowBox[{"Length", "[", "ps", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ps2", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"ps", ",", "twv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"rl3", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"ps2", ",", "zv"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bvect1", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"bvect1", ",", "rl3"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"zQ", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "cmat1"}],
          ",", 
         RowBox[{
          RowBox[{"#", "==", "1"}], " ", "&"}]}], "]"}]}], ";", "\n", "    ", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"zQ", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "res", ",", 
        RowBox[{"SeqLP2", "[", 
         RowBox[{
         "game", ",", "obf", ",", "cmat1", ",", "bvect1", ",", "bds", ",", 
          "bA1", ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]], "Code",ExpressionUUID->"8562ef98-5ebf-44c0-b11d-\
a5c954988de3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "provide", " ", "two", " ", "functions", " ", "to", " ", 
      "calculate", " ", "the", " ", "pre"}], "-", 
     RowBox[{
     "nucleolus", " ", "as", " ", "well", " ", "as", " ", "the", " ", 
      "nucleolus"}]}], ",", " ", 
    RowBox[{
    "which", " ", "have", " ", "been", " ", "invented", " ", "by", " ", 
     RowBox[{"L", ".", " ", "M", ".", " ", "Ruiz"}]}], ",", " ", 
    RowBox[{"F", ".", " ", "Valenciano"}], ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"J", ".", " ", "M", ".", " ", "Zarzuelo"}], " ", 
     RowBox[{
      RowBox[{"(", "1996", ")"}], "."}]}]}], "\n", "*)"}], "   ", "\n", "\n", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LSPreNuc", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"LSPreNuc", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LSPreNuc", "[", "game_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "av", ",", "lt", ",", "pd", ",", "sS", ",", "Si", ",", "Sni", ",", 
         "vi", ",", "vni", ",", "lci", ",", "lcni", ",", "pdi", ",", "pdni", 
         ",", "sm1", ",", "sm2", ",", "sd1"}], "}"}], ",", "\n", "\t\t ", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "                 ", 
        
        RowBox[{"av", "=", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], "/", "lt"}]}], ";", "\n", 
        "\t         ", 
        RowBox[{"pd", "=", 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"lt", "*", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"lt", "-", "2"}], ")"}]}]}], ")"}]}], ")"}]}], ";", 
        "\n", "\t         ", 
        RowBox[{"sS", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}]}], ";", "\n",
         "\t         ", 
        RowBox[{"Si", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"sS", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], " ", 
           "&"}], "/@", " ", "T"}]}], ";", "\n", "                 ", 
        RowBox[{"Sni", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"sS", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], " ", 
           "&"}], "/@", " ", "T"}]}], ";", "\n", "\t\t ", 
        RowBox[{"vi", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Si", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], " ", 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"vni", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Sni", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], " ", 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"lci", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"lt", "-", 
               RowBox[{"Length", "[", "#", "]"}]}], " ", "&"}], "/@", " ", 
             RowBox[{"Si", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"lcni", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Sni", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"pdi", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"vi", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "*", 
            RowBox[{"lci", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], "/@", " ", "T"}]}],
         ";", "\n", "\t\t ", 
        RowBox[{"pdni", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"vni", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "*", 
            RowBox[{"lcni", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], "/@", " ", "T"}]}],
         ";", "\n", "\t\t ", 
        RowBox[{"sm1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Plus", " ", "@@", " ", "#"}], ")"}], " ", "&"}], "/@", 
          " ", "pdi"}]}], ";", " ", "\n", "\t\t ", 
        RowBox[{"sm2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Plus", " ", "@@", " ", "#"}], ")"}], " ", "&"}], "/@", 
          " ", "pdni"}]}], ";", "\n", "\t\t ", 
        RowBox[{"sd1", "=", 
         RowBox[{"av", "+", 
          RowBox[{"pd", "*", 
           RowBox[{"(", 
            RowBox[{"sm1", "-", "sm2"}], ")"}]}]}]}]}]}], "\n", "\t\t ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LSNuc", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"LSNuc", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LSNuc", "[", "game_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lt", ",", "av", ",", "sV", ",", "sN", ",", "sS", ",", "Si", ",", 
         "vi", ",", "lci", ",", "nV", ",", "py", ",", "ngQ", ",", "cM", ",", 
         "mM"}], "}"}], ",", "\n", "                 ", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "                 ", 
        
        RowBox[{"av", "=", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], "/", "lt"}]}], ";", "\n", "\t\t ", 
        RowBox[{"sN", "=", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"lt", "-", "2"}], ")"}]}]}], ";", "\n", "\t         ", 
        RowBox[{"sS", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}]}], ";", "\n",
         "\t         ", 
        RowBox[{"Si", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"sS", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "#", ",", "___"}], "}"}]}], "]"}], " ", 
           "&"}], "/@", " ", "T"}]}], ";", "\n", "\t\t ", 
        RowBox[{"vi", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Si", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], " ", 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"lci", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Si", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], ",", "T"}], 
          "]"}]}], ";", "\n", "                 ", 
        RowBox[{"sV", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Plus", " ", "@@", " ", "#"}], " ", "&"}], ",", "vi"}], 
          "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"nV", "=", 
         RowBox[{"Plus", " ", "@@", " ", "sV"}]}], ";", "    ", "\n", "\t\t ", 
        RowBox[{"py", "=", 
         RowBox[{"av", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lt", "*", "sV"}], "-", "nV"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"lt", "*", "sN"}], ")"}]}]}]}], ";", "\n", "\t\t ", 
        RowBox[{"ngQ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Negative", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          "py"}]}], ";", "\n", "\t\t ", 
        RowBox[{"mM", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"ngQ", ",", "True"}], "]"}], "]"}]}], ";", "\n", "\t\t ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"mM", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"Return", "[", "py", "]"}], ",", "\n", "                 ", 
          
          RowBox[{
           RowBox[{"cM", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"T", ",", "mM"}], "]"}]}], ";", "\n", 
           "                 ", 
           RowBox[{"fLSnc", "[", 
            RowBox[{"py", ",", "cM", ",", "mM", ",", "lt"}], "]"}]}]}], "\n", 
         "\t\t ", "]"}]}]}], "      ", "\n", "\t\t ", "\n", "\n", "\t      ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"d26ab3d9-c547-40f2-aff8-\
51410fb218f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fLSnc", "[", 
    RowBox[{"pyf_List", ",", "cmpM_List", ",", "stM_List", ",", "n_"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "M0", ",", "xm", ",", "lm", ",", "zv", ",", "cpM", ",", "pyM", ",", 
       "tpy", ",", "cmpPy", ",", "rlcmp", ",", "rlp", ",", "py", ",", "pcM", 
       ",", "ngQ", ",", "mM", ",", "nM", ",", "cM"}], "}"}], ",", "\n", 
     "          ", 
     RowBox[{
      RowBox[{"M0", "=", "stM"}], ";", "\n", "          ", 
      RowBox[{"py", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"cmpM", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "False"}], "]"}], ",", "\n", 
         "\t     ", 
         RowBox[{
          RowBox[{"pyM", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"pyf", ",", 
             RowBox[{"Partition", "[", 
              RowBox[{"stM", ",", "1"}], "]"}]}], "]"}]}], ";", "\t", "\n", 
          "\t     ", 
          RowBox[{"xm", "=", 
           RowBox[{"Plus", " ", "@@", " ", "pyM"}]}], ";", "\n", "\t     ", 
          RowBox[{"lm", "=", 
           RowBox[{"Length", "[", "stM", "]"}]}], ";", "\n", "\t     ", 
          RowBox[{"zv", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", "lm"}], "]"}]}], ";", "\n", "\t     ", 
          RowBox[{"pcM", "=", 
           RowBox[{"Partition", "[", 
            RowBox[{"cmpM", ",", "1"}], "]"}]}], ";", "\n", "\t     ", 
          RowBox[{"tpy", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"pyf", ",", "pcM"}], "]"}]}], ";", "\n", "\t     ", 
          RowBox[{"cmpPy", "=", 
           RowBox[{"tpy", " ", "+", " ", 
            RowBox[{"xm", "/", 
             RowBox[{"(", 
              RowBox[{"n", "-", "lm"}], ")"}]}]}]}], ";", "\n", "\t     ", 
          RowBox[{"rlcmp", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{"cmpM", ",", "cmpPy"}], "}"}]}], "]"}]}], ";", "\n", 
          "\t     ", 
          RowBox[{"rlp", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{"stM", ",", "zv"}], "}"}]}], "]"}]}], ";", "\n", 
          "\t     ", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"pyf", ",", "rlcmp"}], "]"}], ",", "rlp"}], "]"}]}], ",",
          "True"}], "]"}]}], ";", "\n", "          ", 
      RowBox[{"ngQ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Negative", "[", "#", "]"}], " ", "&"}], "/@", " ", "py"}]}],
       ";", "\t\t\t\t\t      ", "\n", "          ", 
      RowBox[{"mM", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"ngQ", ",", "True"}], "]"}], "]"}]}], ";", "\n", 
      "          ", 
      RowBox[{"nM", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Append", "[", 
          RowBox[{"stM", ",", "mM"}], "]"}], "]"}], "]"}]}], ";", "\n", 
      "\t  ", 
      RowBox[{"cM", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"T", ",", "nM"}], "]"}]}], ";", "\t\t\t\t      ", "\n", 
      "\t  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"M0", ",", "nM"}], "]"}], ",", 
        RowBox[{"Return", "[", "py", "]"}], ",", 
        RowBox[{"fLSnc", "[", 
         RowBox[{"py", ",", "cM", ",", "nM", ",", "n"}], "]"}]}], "]"}]}]}], 
    "\t\t\t\t      ", "\n", "\n", "\t ", "]"}]}], ";"}]], "Code",ExpressionUUI\
D->"f808b022-13f3-4eda-991d-3c5aa0c3c972"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "introduce", " ", "a", " ", "set", " ", "of", " ", 
      "functions", " ", "to", " ", "compute", " ", "the", " ", "pre"}], "-", 
     RowBox[{
     "nucleolus", " ", "by", " ", "a", " ", "Fenchel", " ", "Transform", " ", 
      
      RowBox[{"Method", ".", " ", "This"}], " ", "is", " ", "just", " ", "a", 
      " ", "conjecture"}]}], ",", "\n", 
    RowBox[{
    "and", " ", "it", " ", "is", " ", "a", " ", "combination", " ", "of", " ",
      "the", " ", "the", " ", "approach", " ", "discussed", " ", "in", " ", 
     "Meinhardt", " ", 
     RowBox[{"(", "2013", ")"}], " ", "and", " ", "Kido", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2004", ",", "2005", ",", "2008"}], ")"}], "."}]}]}], "\n", 
   "\n", "*)"}], "   ", "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"FTPreNuc", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"tol_", ":", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "2"}], ")"}]}]}], ",", 
      RowBox[{"jj_", ":", "2"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pk", ",", "vars", ",", "xpk", ",", "mcl", ",", "tol1", ",", "pmcl", 
        ",", "clm", ",", "lcm", ",", "cex", ",", "rC", ",", "rexc", ",", 
        "sme", ",", "mtr", ",", "smtr", ",", "slc", ",", "sC", ",", "lc", ",",
         "ls", ",", "sz"}], "}"}], ",", "\n", "                      ", 
      RowBox[{
       RowBox[{"pk", "=", 
        RowBox[{"PreKernel", "[", "game", "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
       "\n", "                      ", 
       RowBox[{"pmcl", "=", 
        RowBox[{"FTCoalArray", "[", 
         RowBox[{"game", ",", "pk", ",", "tol"}], "]"}]}], ";", "\n", 
       "\t\t      ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<pmcl=\>\"", ",", "pmcl"}], "]"}], ";"}], " ", "*)"}], 
       "\n", "\t\t      ", 
       RowBox[{"clm", "=", 
        RowBox[{"pmcl", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"lcm", "=", 
        RowBox[{"pmcl", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"cex", "=", 
        RowBox[{"pmcl", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"rC", "=", 
        RowBox[{"pmcl", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"rexc", "=", 
        RowBox[{"pmcl", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\n", "\t\t      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Last", "[", "lcm", "]"}], ",", "1"}], "]"}], ",", "\n", 
         "\t\t\t ", 
         RowBox[{
          RowBox[{"sme", "=", 
           RowBox[{"Last", "[", 
            RowBox[{
             RowBox[{"Sort", "[", "rexc", "]"}], ",", "1"}], "]"}]}], ";", 
          " ", 
          RowBox[{"(*", 
           RowBox[{"Sorting", " ", "is", " ", "ascending", " ", 
            RowBox[{"order", "."}]}], " ", "*)"}], " ", "\n", "\t\t\t ", 
          RowBox[{"mtr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Subtract", "[", 
                RowBox[{"#", ",", "sme"}], "]"}], "]"}], "<=", "tol"}], " ", 
             "&"}], "/@", " ", "rexc"}]}], ";", "\n", "\t                 ", 
          RowBox[{"smtr", "=", 
           RowBox[{"Position", "[", 
            RowBox[{"mtr", ",", "True"}], "]"}]}], ";", "\t\t\t ", "\n", 
          "\t\t\t ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"slc", ",", "sC"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Extract", "[", 
              RowBox[{"#", ",", "smtr"}], "]"}], " ", "&"}], "/@", " ", 
            RowBox[{"{", 
             RowBox[{"rexc", ",", "rC"}], "}"}]}]}], ";", "\n", "\t\t\t ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ls", ",", "lc", ",", "sz"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            RowBox[{"{", 
             RowBox[{"clm", ",", "sC", ",", "lcm"}], "}"}]}]}], ";", "\n", 
          "\t\t\t ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"clm", ",", "cex"}], "}"}], "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Append", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"clm", ",", "cex"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"sC", ",", "slc"}], "}"}]}], "}"}]}], "]"}]}], ";", 
          "\n", "\t\t\t ", 
          RowBox[{"clm", "=", 
           RowBox[{"FlattenAt", "[", 
            RowBox[{"clm", ",", 
             RowBox[{"ls", "+", "1"}]}], "]"}]}], ";", "\n", "\t\t\t ", 
          RowBox[{"lcm", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"lcm", ",", 
             RowBox[{"sz", "->", 
              RowBox[{"lc", "+", "1"}]}]}], "]"}]}], ";"}], ",", "\n", 
         "\t\t\t ", "False"}], "]"}], ";", "\n", "\t\t      ", 
       RowBox[{"mcl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Prepend", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"clm", ",", "lcm", ",", "cex"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
       ";", "\n", "\t\t      ", 
       RowBox[{"tol1", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "jj"}], ")"}]}]}], ";", "\n", "                      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clm", "==", 
           RowBox[{"{", "}"}]}], " ", "&&", " ", 
          RowBox[{"jj", "<", "11"}]}], ",", "\n", "\t\t\t ", 
         RowBox[{"FTPreNuc", "[", 
          RowBox[{"game", ",", "tol1", ",", 
           RowBox[{"jj", "+", "1"}]}], "]"}], ",", "\n", "\t\t\t ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"mcl", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", "\n", "\t\t\t\t ", 
           RowBox[{"Return", "[", "$Failed", "]"}], ",", "\n", "\t\t\t\t ", 
           RowBox[{"FormPreNuc", "[", 
            RowBox[{"game", ",", "tol1", ",", "jj", ",", "mcl", ",", "vars"}],
             "]"}]}], "\n", "\t\t\t ", "]"}]}], "\n", "\t\t      ", "]"}]}]}],
      "\n", "\t\t\t\t\t     ", "]"}]}], ";"}]}]], "Code",ExpressionUUID->\
"e0f0f23b-3764-4660-aa62-fd0e931e35d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FormPreNuc", "[", 
     RowBox[{
     "game_", ",", "tol_", ",", "jj_", ",", "iim_List", ",", "xvars_List"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "lsg", "}"}], ",", "\n", "                      ", 
      RowBox[{
       RowBox[{"lsg", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"FindSolX", "[", 
          RowBox[{"iim", ",", "xvars"}], "]"}], "]"}]}], ";", "\n", 
       "                      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lsg", ",", 
            RowBox[{"{", "}"}]}], "]"}], " ", "&&", " ", 
          RowBox[{"jj", " ", "<", "11"}]}], ",", 
         RowBox[{"FTPreNuc", "[", 
          RowBox[{"game", ",", "tol", ",", 
           RowBox[{"jj", "+", "1"}]}], "]"}], ",", "\n", "\t\t       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"lsg", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"Return", "[", "$Failed", "]"}], ",", 
           RowBox[{"xvars", " ", "/.", " ", "lsg"}]}], "]"}]}], "]"}]}]}], 
     "\n", "\t\t\t\t\t   ", "]"}]}], ";"}], "\n"}]], "Code",ExpressionUUID->\
"0222d264-cdba-4334-b624-d476c583f690"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FTCoalArray", "[", 
    RowBox[{"game_", ",", "payoff_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sC", ",", "irQ", ",", "irc", ",", "slir", ",", "b0", ",", "I0", ",", 
       "excpay", ",", "lI0", ",", "zv"}], "}"}], ",", "\n", "\t        ", 
     RowBox[{
      RowBox[{"sC", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"lt", "=", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\t\t\t\t  ", "\n", 
      "                ", 
      RowBox[{"excpay", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"ExcessPayoff", "[", 
             RowBox[{"game", ",", "payoff"}], "]"}], "]"}], ",", "1"}], "]"}],
          ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "                ", 
      RowBox[{"PnSelectFTMCR", "[", 
       RowBox[{"excpay", ",", "sC", ",", "lt", ",", "tol", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t     ", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"ef1dc5e6-6989-4241-b674-a184b6d2d1e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "set", " ", "the", " ", "default", " ", "of", " ", "blQ", " ", 
     "to", " ", "True", " ", "in", " ", "order", " ", "to", " ", "allow", " ",
      "a", " ", "return", " ", "if", " ", "mrk"}], "==", 
    RowBox[{"lt", " ", "on", " ", "the", " ", "first", " ", 
     RowBox[{"iteration", "."}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PnSelectFTMCR", "[", 
      RowBox[{"exc_List", ",", "sC_", ",", "lt_", ",", "tol_", ",", 
       RowBox[{"pIk_List", ":", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"plIk_List", ":", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"pslex_List", ":", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"blQ_", ":", "True"}], ",", 
       RowBox[{"mtrk_", ":", "0"}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mtr", ",", "smtr", ",", "slc", ",", "sS", ",", "lS", ",", "sC1", ",",
          "Im", ",", "bQ", ",", "mt", ",", "mrk", ",", "exc1", ",", "slex1", 
         ",", "lIm1"}], "}"}], ",", "\n", "                ", 
       RowBox[{
        RowBox[{"mtr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Subtract", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Max", "[", "exc", "]"}]}], "]"}], "]"}], "<=", 
            "tol"}], " ", "&"}], "/@", " ", "exc"}]}], ";", "\n", 
        "\t        ", 
        RowBox[{"smtr", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"mtr", ",", "True"}], "]"}]}], ";", "\n", "\t        ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"slc", ",", "sS"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"#", ",", "smtr"}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"{", 
           RowBox[{"exc", ",", "sC"}], "}"}]}]}], ";", "\n", "\t\t", 
        RowBox[{"lS", "=", 
         RowBox[{"Length", "[", "sS", "]"}]}], ";", "\t\t\t\t", "\n", "\t\t", 
        
        RowBox[{"sC1", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"sC", ",", "smtr"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"Im", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"pIk", ",", "sS"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"lIm1", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"plIk", ",", 
           RowBox[{"{", "lS", "}"}]}], "]"}]}], ";", "\n", "                ", 
        RowBox[{"bQ", "=", 
         RowBox[{"First", "[", 
          RowBox[{"BalancedSystemQ", "[", 
           RowBox[{"Im", ",", " ", "T"}], "]"}], "]"}]}], ";", "\n", 
        "\t        ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"bQ", "=", 
           RowBox[{"BalancedSelectionQ", "[", 
            RowBox[{"Im", ",", "tol", ",", 
             RowBox[{"Tight", "->", "True"}]}], "]"}]}], ";"}], " ", "*)"}], 
        "\n", "                ", 
        RowBox[{"mt", " ", "=", " ", 
         RowBox[{"ConstVec", "[", "Im", "]"}]}], ";", "\n", 
        "                ", 
        RowBox[{"mrk", " ", "=", " ", 
         RowBox[{"MatrixRank", "[", "mt", "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"(*", "\n", "\t\t  ", 
         RowBox[{
          RowBox[{
           RowBox[{"If", " ", "blQ"}], "==", "True"}], ",", " ", 
          RowBox[{
           RowBox[{"but", " ", "bQ"}], "==", 
           RowBox[{"False", " ", "with", " ", "mrk"}], "==", "mtrk"}], ",", 
          " ", 
          RowBox[{
          "then", " ", "the", " ", "new", " ", "sets", " ", "are", " ", 
           "still", " ", "in", " ", "the", " ", 
           RowBox[{"span", ".", "\n", "\t\t  ", "However"}]}], ",", " ", 
          RowBox[{
           RowBox[{"if", " ", "mrk"}], ">", 
           RowBox[{"mtrk", " ", "and", " ", "bQ"}], "==", "False"}], ",", " ", 
          RowBox[{
          "the", " ", "collection", " ", "of", " ", "sets", " ", "ought", " ",
            "to", " ", "be", "\n", "\t\t  ", "discarded", " ", "during", " ", 
           "the", " ", "next", " ", 
           RowBox[{"iteration", "."}]}]}], "\n", "\t\t", "*)"}], "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"blQ", ",", "True"}], "]"}], " ", "&&", " ", 
           RowBox[{"LessEqual", "[", 
            RowBox[{"mtrk", ",", "mrk"}], "]"}]}], ",", 
          RowBox[{"bQ", "=", "True"}], ",", "False"}], "]"}], ";", "\n", 
        "\t        ", 
        RowBox[{"slex1", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"pslex", ",", "slc"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"exc1", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"exc", ",", "smtr"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"mrk", ",", "lt"}], "]"}], " ", "&&", " ", 
           RowBox[{"SameQ", "[", 
            RowBox[{"bQ", ",", "True"}], "]"}]}], ",", "\n", "\t\t   ", 
          RowBox[{"{", 
           RowBox[{"Im", ",", "lIm1", ",", "slex1", ",", "sC1", ",", "exc1"}],
            "}"}], ",", "\n", "\t\t   ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"bQ", ",", "True"}], "]"}], ",", "\n", "\t\t      ", 
            RowBox[{"PnSelectFTMCR", "[", 
             RowBox[{
             "exc1", ",", "sC1", ",", "lt", ",", "tol", ",", "Im", ",", 
              "lIm1", ",", "slex1", ",", "bQ", ",", "mrk"}], "]"}], ",", "\n",
             "\t\t      ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "\n", "\t\t   ", "]"}]}], "\n", 
         "\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t     ", "]"}]}], ";"}], "\n",
    "\n", "\n", "\n"}]}]], "Code",ExpressionUUID->"543200a7-c39e-4363-95f6-\
48dbebffd990"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "provide", " ", "a", " ", "set", " ", "of", " ", "functions", 
      " ", "that", " ", "compute", " ", "the", " ", "nucleolus", " ", "by", 
      " ", "a", " ", "non"}], "-", 
     RowBox[{"linear", " ", "optimization", " ", "method", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"cf", ".", " ", "Kido"}], " ", "2003"}], ",", "2005", ",", 
         "2008"}], ")"}], ".", " ", "Based"}], " ", "on", " ", "this", " ", 
      "idea"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "extend", " ", "this", " ", "approach", " ", "to", " ", "the",
       " ", "pre"}], "-", 
     RowBox[{"nucleolus", " ", 
      RowBox[{"too", "."}]}]}]}], "\n", "\n", "*)"}], "   ", "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NonLinPreNuc", "[", 
      RowBox[{"game_", ",", "p_", ",", "k_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "NonLinNuc", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "mthd", "}"}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{"mthd", "=", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "     ", 
        RowBox[{"NonLinPreNuc", "[", 
         RowBox[{"game", ",", "p", ",", "k", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}], ",", "2", ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}]}]}], "\n", "]"}]}], ";"}],
    "\n"}]}]], "Code",ExpressionUUID->"8b6603cb-b921-40d6-a69a-0fec1731d217"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NonLinPreNuc", "[", 
    RowBox[{"game_", ",", "p_", ",", "k_", ",", 
     RowBox[{"tol_", ":", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}]}], ",", 
     RowBox[{"jj_", ":", "2"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "NonLinPreNuc", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mthd", ",", "sar", ",", "vars", ",", "xpk", ",", "mcl", ",", "tol1", 
       ",", "pmcl", ",", "clm", ",", "lcm", ",", "cex"}], "}"}], ",", "\n", 
     "                      ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"sar", "=", 
       RowBox[{"ApproxPreNuc", "[", 
        RowBox[{"game", ",", "p", ",", "k", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
      "\n", "                      ", 
      RowBox[{"xpk", "=", 
       RowBox[{"vars", " ", "/.", " ", 
        RowBox[{"sar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", 
      "                      ", 
      RowBox[{"pmcl", "=", 
       RowBox[{"PnModCoalArray", "[", 
        RowBox[{"game", ",", "xpk", ",", "tol"}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"clm", "=", 
       RowBox[{"pmcl", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "                      ", 
      RowBox[{"lcm", "=", 
       RowBox[{"pmcl", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "                      ", 
      RowBox[{"cex", "=", 
       RowBox[{"pmcl", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\n", "                      ", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"clm", ",", "T"}], "]"}], ";", "\n", "                      ", 
      
      RowBox[{"PrependTo", "[", 
       RowBox[{"lcm", ",", "1"}], "]"}], ";", "\n", "                      ", 
      
      RowBox[{"PrependTo", "[", 
       RowBox[{"cex", ",", "0"}], "]"}], ";", "\n", "                      ", 
      
      RowBox[{"mcl", "=", 
       RowBox[{"{", 
        RowBox[{"clm", ",", "lcm", ",", "cex"}], "}"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"mcl", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Prepend", ",", 
           RowBox[{"{", 
            RowBox[{"pmcl", ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
        ";"}], " ", "*)"}], "\n", "                      ", 
      RowBox[{"tol1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "jj"}], ")"}]}]}], ";", "\n", "                      ", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"clm", "==", 
          RowBox[{"{", "}"}]}], " ", "&&", " ", 
         RowBox[{"jj", "<", "11"}]}], ",", "\n", "                         ", 
        
        RowBox[{"NonLinPreNuc", "[", 
         RowBox[{"game", ",", "p", ",", "k", ",", "tol1", ",", 
          RowBox[{"jj", "+", "1"}], ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}], ",", "\n", 
        "                         ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"mcl", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", "\n", 
          "                                 ", 
          RowBox[{"Return", "[", "$Failed", "]"}], ",", "\n", 
          "                                 ", 
          RowBox[{"FormatPreNuc", "[", 
           RowBox[{
           "game", ",", "p", ",", "k", ",", "tol1", ",", "jj", ",", "mcl", 
            ",", "vars"}], "]"}]}], "\n", "                         ", 
         "]"}]}], "\n", "                      ", "]"}]}]}], "\n", 
    "                                                                         \
  ", "\n", "           ", "]"}]}], ";"}]], "Code",ExpressionUUID->"1b3595c1-\
3023-4269-b2ab-e0db6e7cb3a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FormatPreNuc", "[", 
     RowBox[{
     "game_", ",", "p_", ",", "k_", ",", "tol_", ",", "jj_", ",", "iim_List", 
      ",", "xvars_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "lsg", "}"}], ",", "\n", "                      ", 
      RowBox[{
       RowBox[{"lsg", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"FindSolX", "[", 
          RowBox[{"iim", ",", "xvars"}], "]"}], "]"}]}], ";", "\n", 
       "                      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lsg", ",", 
            RowBox[{"{", "}"}]}], "]"}], " ", "&&", " ", 
          RowBox[{"jj", " ", "<", "11"}]}], ",", 
         RowBox[{"NonLinPreNuc", "[", 
          RowBox[{"game", ",", "p", ",", "k", ",", "tol", ",", 
           RowBox[{"jj", "+", "1"}]}], "]"}], ",", "\n", 
         "                       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"lsg", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"Return", "[", "$Failed", "]"}], ",", 
           RowBox[{"xvars", " ", "/.", " ", "lsg"}]}], "]"}]}], "]"}]}]}], 
     "\n", "            ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonLinNuc", "[", 
     RowBox[{"game_", ",", "p_", ",", "k_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "NonLinNuc", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "mthd", "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "     ", 
       RowBox[{"NonLinNuc", "[", 
        RowBox[{"game", ",", "p", ",", "k", ",", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "2"}], ")"}]}], ",", "2", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NonLinNuc", "[", 
    RowBox[{"game_", ",", "p_", ",", "k_", ",", 
     RowBox[{"tol_", ":", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}]}], ",", 
     RowBox[{"jj_", ":", "2"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "NonLinNuc", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sar", ",", "vars", ",", "xpk", ",", "mcl", ",", "tol1", ",", "mthd"}], 
      "}"}], ",", "\n", "                      ", 
     RowBox[{
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"sar", "=", 
       RowBox[{"ApproxNuc", "[", 
        RowBox[{"game", ",", "p", ",", "k", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
      "\n", "                      ", 
      RowBox[{"xpk", "=", 
       RowBox[{"vars", " ", "/.", " ", 
        RowBox[{"sar", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", 
      "                      ", 
      RowBox[{"mcl", "=", 
       RowBox[{"ModCoalArray", "[", 
        RowBox[{"game", ",", "xpk", ",", "tol"}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"tol1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "jj"}], ")"}]}]}], ";", "\n", "                      ", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mcl", "==", 
          RowBox[{"{", "}"}]}], " ", "&&", " ", 
         RowBox[{"jj", "<", "11"}]}], ",", 
        RowBox[{"NonLinNuc", "[", 
         RowBox[{"game", ",", "p", ",", "k", ",", "tol1", ",", 
          RowBox[{"jj", "+", "1"}], ",", 
          RowBox[{"Method", "->", "mthd"}]}], "]"}], ",", 
        RowBox[{"FormatSol", "[", 
         RowBox[{
         "game", ",", "p", ",", "k", ",", "tol1", ",", "jj", ",", "mcl", ",", 
          "vars"}], "]"}]}], "]"}]}]}], "\n", "        ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"b55cc732-2e2f-4df5-b5a4-3fb479a5a8eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FormatSol", "[", 
    RowBox[{
    "game_", ",", "p_", ",", "k_", ",", "tol_", ",", "jj_", ",", "iim_List", 
     ",", "xvars_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "lsg", "}"}], ",", "\n", "                      ", 
     RowBox[{
      RowBox[{"lsg", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"FindSolX", "[", 
         RowBox[{"iim", ",", "xvars"}], "]"}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"lsg", ",", 
           RowBox[{"{", "}"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"jj", " ", "<", "11"}]}], ",", 
        RowBox[{"NonLinNuc", "[", 
         RowBox[{"game", ",", "p", ",", "k", ",", "tol", ",", 
          RowBox[{"jj", "+", "1"}]}], "]"}], ",", "\n", 
        "                       ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lsg", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"Return", "[", "$Failed", "]"}], ",", 
          RowBox[{"xvars", " ", "/.", " ", "lsg"}]}], "]"}]}], "]"}]}]}], 
    "\n", "        ", "]"}]}], ";"}]], "Code",ExpressionUUID->"d599c46a-8ec2-\
4b5a-a16c-89519a83ead0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FormatPreNuc", "[", 
    RowBox[{
    "game_", ",", "p_", ",", "k_", ",", "tol_", ",", "jj_", ",", "iim_List", 
     ",", "xvars_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "lsg", "}"}], ",", "\n", "                      ", 
     RowBox[{
      RowBox[{"lsg", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"FindSolX", "[", 
         RowBox[{"iim", ",", "xvars"}], "]"}], "]"}]}], ";", "\n", 
      "                      ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"lsg", ",", 
           RowBox[{"{", "}"}]}], "]"}], " ", "&&", " ", 
         RowBox[{"jj", " ", "<", "11"}]}], ",", 
        RowBox[{"NonLinPreNuc", "[", 
         RowBox[{"game", ",", "p", ",", "k", ",", "tol", ",", 
          RowBox[{"jj", "+", "1"}]}], "]"}], ",", "\n", 
        "                       ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lsg", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"Return", "[", "$Failed", "]"}], ",", 
          RowBox[{"xvars", " ", "/.", " ", "lsg"}]}], "]"}]}], "]"}]}]}], 
    "\n", "            ", "]"}]}], ";"}]], "Code",ExpressionUUID->"5b9c9e19-\
b64f-4795-87fa-7ac7576861f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindSolX", "[", 
     RowBox[{"ssz_List", ",", "vars_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sys", ",", "eqsys"}], "}"}], ",", "\n", 
      "                           ", 
      RowBox[{
       RowBox[{"sys", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], "-", 
            RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], "/@", " ", 
         RowBox[{"ssz", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "  ", "\n", 
       "                           ", 
       RowBox[{"eqsys", "=", 
        RowBox[{"SolveSys", "[", 
         RowBox[{"sys", ",", 
          RowBox[{"ssz", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ssz", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", "\n", 
       "                           ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "eqsys", "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}], ",", 
         RowBox[{"Solve", "[", 
          RowBox[{"eqsys", ",", "vars"}], "]"}]}], "]"}]}]}], "\n", 
     "        ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveSys", "[", 
    RowBox[{"bsys_List", ",", "iim_List", ",", "exc_List", ",", 
     RowBox[{"glsys_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"idx_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lg", ",", "gls", ",", "eq", ",", "zv", ",", "vexc", ",", "rsys", ",", 
       "nwgl", ",", "riim", ",", "rexc"}], "}"}], ",", "\n", 
     "                     ", 
     RowBox[{
      RowBox[{"gls", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"bsys", ",", 
         RowBox[{"First", "[", "iim", "]"}]}], "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"lg", "=", 
       RowBox[{"Length", "[", "gls", "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"exc", "==", 
          RowBox[{"{", "}"}]}], " ", "&&", " ", 
         RowBox[{"lg", "==", "1"}]}], ",", "True", ",", 
        RowBox[{"vexc", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"exc", ",", 
           RowBox[{"First", "[", "iim", "]"}]}], "]"}]}]}], "]"}], ";", "\n", 
      "                     ", 
      RowBox[{"eq", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idx", "==", "1"}], ",", "\n", "                           ", 
         RowBox[{
          RowBox[{"zv", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", "lg"}], "]"}]}], ";", "\n", 
          "                           ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Equal", ",", 
            RowBox[{"{", 
             RowBox[{"gls", ",", "zv"}], "}"}]}], "]"}]}], ",", "\n", 
         "                           ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"lg", ">", "1"}], ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"Equal", ",", "gls"}], "]"}], ",", "\n", 
           "                             ", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<Warning:: An isolated excess found!\>\"", 
             "]"}], ";", "\n", "                             ", 
            RowBox[{
            "Print", "[", "\"\<Solution might not be correct!!!\>\"", "]"}], 
            ";", "\n", "                             ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Equal", ",", 
              RowBox[{"{", 
               RowBox[{"gls", ",", "vexc"}], "}"}]}], "]"}]}]}], "]"}]}], 
        "\n", "                        ", "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"nwgl", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"glsys", ",", "eq"}], "]"}]}], ";", 
      "                                   ", "\n", "                     ", 
      RowBox[{"rsys", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"bsys", ",", 
         RowBox[{"First", "[", "iim", "]"}]}], "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"rexc", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"exc", ",", 
         RowBox[{"First", "[", "iim", "]"}]}], "]"}]}], ";", "\n", 
      "                     ", 
      RowBox[{"riim", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"iim", ",", "1"}], "]"}]}], ";", "                     ", 
      "\n", "                     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"riim", "==", 
         RowBox[{"{", "}"}]}], ",", "\n", "                        ", 
        RowBox[{"Flatten", "[", "nwgl", "]"}], ",", "\n", 
        "                        ", 
        RowBox[{"SolveSys", "[", 
         RowBox[{"rsys", ",", "riim", ",", "rexc", ",", "nwgl", ",", 
          RowBox[{"idx", "+", "1"}]}], "]"}]}], "\n", 
       "                      ", "]"}]}]}], "\n", "                     ", 
    "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"baa19dd6-0867-4096-aa85-\
1ecd87a44ddc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxNuc", "[", 
     RowBox[{"game_", ",", "p_", ",", "k_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ApproxNuc", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mthd", ",", "lt", ",", "obj", ",", "const", ",", "rl", ",", "vars", 
        ",", "sC", ",", "pexc", ",", "vi", ",", "eq"}], "}"}], ",", "\n", 
      "                        ", 
      RowBox[{
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
       "                        ", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
       "\n", "                        ", 
       RowBox[{"lt", "=", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", "       ", "\n", 
       "                        ", 
       RowBox[{"sC", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}]}], ";", "\n", 
       "                        ", 
       RowBox[{"pexc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], "-", 
             RowBox[{"x", "[", "#", "]"}], "-", "k1"}], ")"}], "^", "p1"}], 
          " ", "&"}], "/@", " ", "sC"}]}], ";", "\n", 
       "                        ", 
       RowBox[{"rl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", "k1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "k"}], "}"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "                        ", 
       RowBox[{"obj", " ", "=", " ", 
        RowBox[{
         RowBox[{"Total", "[", "pexc", "]"}], " ", "/.", " ", "rl"}]}], ";", 
       "\n", "                        ", 
       RowBox[{"vi", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"sC", ",", "lt"}], "]"}]}]}], ";", "\n", 
       "                        ", 
       RowBox[{"const", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"GreaterEqual", ",", 
            RowBox[{"{", 
             RowBox[{"vars", ",", "vi"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\n", "                        ", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"Total", "[", "vars", "]"}], "==", 
         RowBox[{"v", "[", "T", "]"}]}]}], ";", "\n", 
       "                        ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"const", ",", "eq"}], "]"}], ";", "\n", 
       "                        ", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"{", "const", "}"}], ",", "obj"}], "]"}], ",", "vars", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}]}], "\n", 
     "                        ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ModCoalArray", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ModCoalArray", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModCoalArray", "[", 
     RowBox[{"game_", ",", "payoff_", ",", 
      RowBox[{"tol_", ":", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "7"}], ")"}]}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sC", ",", "lt", ",", "prl", ",", "irQ", ",", "irc", ",", "slir", ",", 
        "b0", ",", "I0", ",", "excpay", ",", "lI0", ",", "zv"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"sC", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"lt", "=", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", 
       "                             ", "\n", "    ", 
       RowBox[{"prl", "=", 
        RowBox[{"Payoff", "[", "payoff", "]"}]}], ";", "\n", "    ", 
       RowBox[{"irQ", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"{", "#", "}"}], "]"}], "-", 
               RowBox[{"x", "[", "#", "]"}]}], "]"}], "<=", "tol"}], " ", 
            "&"}], ",", "T"}], "]"}], " ", "/.", "prl"}]}], ";", "\n", "    ", 
       RowBox[{"irc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], " ", "&"}], "/@", " ", "T"}]}], ";", "\n", 
       "    ", 
       RowBox[{"slir", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"irQ", ",", "True"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"b0", "=", 
        RowBox[{"Extract", "[", 
         RowBox[{"irc", ",", "slir"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"I0", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"{", "T", "}"}], ",", "b0"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"lI0", "=", 
        RowBox[{"Length", "[", "I0", "]"}]}], ";", "\n", "    ", 
       RowBox[{"zv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", "lI0"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"excpay", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"ExcessPayoff", "[", 
              RowBox[{"game", ",", "payoff"}], "]"}], "]"}], ",", "1"}], 
           "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"SelectMCR", "[", 
        RowBox[{"excpay", ",", "sC", ",", "lt", ",", "tol", ",", "I0", ",", 
         RowBox[{"{", "lI0", "}"}], ",", "zv"}], "]"}]}]}], "\n", " ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PnModCoalArray", "[", 
    RowBox[{"game_", ",", "payoff_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sC", ",", "lt", ",", "excpay"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"sC", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lt", "=", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", 
      "                             ", "\n", "    ", 
      RowBox[{"excpay", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"ExcessPayoff", "[", 
             RowBox[{"game", ",", "payoff"}], "]"}], "]"}], ",", "1"}], "]"}],
          ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"PnSelectMCR", "[", 
       RowBox[{"excpay", ",", "sC", ",", "lt", ",", "tol", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "   ", "]"}]}], ";"}]}], "Code",\
ExpressionUUID->"c583ab63-2ebc-4b31-b559-7551adde5acd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelectMCR", "[", 
     RowBox[{"exc_List", ",", "sC_", ",", "lt_", ",", "tol_", ",", 
      RowBox[{"Ik_List", ":", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"lIk_List", ":", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"slex_List", ":", 
       RowBox[{"{", "0", "}"}]}], ",", 
      RowBox[{"blQ_", ":", "False"}], ",", 
      RowBox[{"mtrk_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mtr", ",", "smtr", ",", "slc", ",", "sS", ",", "lS", ",", "sC1", ",", 
        "Im", ",", "mrk", ",", "bQ", ",", "mt", ",", "mkr", ",", "exc1", ",", 
        "slex1", ",", "lIm1"}], "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"mtr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Subtract", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Max", "[", "exc", "]"}]}], "]"}], "]"}], "<=", "tol"}],
           " ", "&"}], "/@", " ", "exc"}]}], ";", "\n", "     ", 
       RowBox[{"smtr", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"mtr", ",", "True"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"slc", "=", 
        RowBox[{"Extract", "[", 
         RowBox[{"exc", ",", "smtr"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"sS", "=", 
        RowBox[{"Extract", "[", 
         RowBox[{"sC", ",", "smtr"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"lS", "=", 
        RowBox[{"Length", "[", "sS", "]"}]}], ";", 
       "                          ", "\n", "     ", 
       RowBox[{"sC1", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"sC", ",", "smtr"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"Im", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Ik", ",", "sS"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"lIm1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"lIk", ",", 
          RowBox[{"{", "lS", "}"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"bQ", "=", 
        RowBox[{"First", "[", 
         RowBox[{"BalancedSystemQ", "[", 
          RowBox[{"Im", ",", " ", "T"}], "]"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", "\n", "     ", 
        RowBox[{
         RowBox[{"bQ", "=", 
          RowBox[{"IIMBalancedSelectionQ", "[", 
           RowBox[{"Im", ",", "tol", ",", 
            RowBox[{"Tight", "->", "True"}]}], "]"}]}], ";", " ", "\n", 
         "     ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<bQ=\>\"", ",", "bQ"}], "]"}], ";"}], "\n", "     ", 
        "*)"}], "\n", "     ", 
       RowBox[{"mt", " ", "=", " ", 
        RowBox[{"ConstVec", "[", "Im", "]"}]}], ";", "\n", "     ", 
       RowBox[{"mrk", " ", "=", " ", 
        RowBox[{"MatrixRank", "[", "mt", "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", "\n", "     ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", " ", "blQ"}], "==", "True"}], ",", " ", 
         RowBox[{
          RowBox[{"but", " ", "bQ"}], "==", 
          RowBox[{"False", " ", "with", " ", "mrk"}], "==", "mtrk"}], ",", 
         " ", 
         RowBox[{
         "then", " ", "the", " ", "new", " ", "sets", " ", "are", " ", 
          "still", " ", "in", " ", "the", " ", 
          RowBox[{"span", ".", "\n", "     ", "However"}]}], ",", " ", 
         RowBox[{
          RowBox[{"if", " ", "mrk"}], ">", 
          RowBox[{"mtrk", " ", "and", " ", "bQ"}], "==", "False"}], ",", " ", 
         
         RowBox[{
         "the", " ", "collection", " ", "of", " ", "sets", " ", "ought", " ", 
          "to", " ", "be", "\n", "     ", "discarded", " ", "during", " ", 
          "the", " ", "next", " ", 
          RowBox[{"iteration", "."}]}]}], "\n", "      ", "*)"}], "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"blQ", ",", "True"}], "]"}], " ", "&&", " ", 
          RowBox[{"LessEqual", "[", 
           RowBox[{"mtrk", ",", "mrk"}], "]"}]}], ",", 
         RowBox[{"bQ", "=", "True"}], ",", "False"}], "]"}], ";", "\n", 
       "     ", 
       RowBox[{"slex1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Append", "[", 
          RowBox[{"slex", ",", "slc"}], "]"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"exc1", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"exc", ",", "smtr"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"mrk", ",", "lt"}], "]"}], " ", "&&", " ", 
          RowBox[{"SameQ", "[", 
           RowBox[{"bQ", ",", "True"}], "]"}]}], ",", "\n", "       ", 
         RowBox[{"{", 
          RowBox[{"Im", ",", "lIm1", ",", "slex1"}], "}"}], ",", "\n", 
         "       ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"bQ", "==", "True"}], ",", "\n", "          ", 
           RowBox[{"SelectMCR", "[", 
            RowBox[{
            "exc1", ",", "sC1", ",", "lt", ",", "tol", ",", "Im", ",", "lIm1",
              ",", "slex1", ",", "bQ", ",", "mrk"}], "]"}], ",", "\n", 
           "          ", 
           RowBox[{"{", "}"}]}], "\n", "       ", "]"}]}], "\n", "     ", 
        "]"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PnSelectMCR", "[", 
    RowBox[{"exc_List", ",", "sC_", ",", "lt_", ",", "tol_", ",", 
     RowBox[{"pIk_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"plIk_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"pslex_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"blQ_", ":", "False"}], ",", 
     RowBox[{"mtrk_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mtr", ",", "smtr", ",", "slc", ",", "sS", ",", "lS", ",", "sC1", ",", 
       "mrk", ",", "Im", ",", "bQ", ",", "mt", ",", "mkr", ",", "exc1", ",", 
       "slex1", ",", "lIm1"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"mtr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Subtract", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Max", "[", "exc", "]"}]}], "]"}], "]"}], "<=", "tol"}], 
         " ", "&"}], "/@", " ", "exc"}]}], ";", "\n", "    ", 
      RowBox[{"smtr", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"mtr", ",", "True"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"slc", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"exc", ",", "smtr"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"sS", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"sC", ",", "smtr"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lS", "=", 
       RowBox[{"Length", "[", "sS", "]"}]}], ";", 
      "                          ", "\n", "    ", 
      RowBox[{"sC1", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"sC", ",", "smtr"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Im", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pIk", ",", "sS"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"lIm1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"plIk", ",", 
         RowBox[{"{", "lS", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"bQ", "=", 
       RowBox[{"First", "[", 
        RowBox[{"BalancedSystemQ", "[", 
         RowBox[{"Im", ",", " ", "T"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "    ", 
       RowBox[{
        RowBox[{"bQ", "=", 
         RowBox[{"BalancedSelectionQ", "[", 
          RowBox[{"Im", ",", "tol", ",", 
           RowBox[{"Tight", "->", "True"}]}], "]"}]}], ";"}], " ", "*)"}], 
      "\n", "    ", 
      RowBox[{"mt", " ", "=", " ", 
       RowBox[{"ConstVec", "[", "Im", "]"}]}], ";", "\n", "    ", 
      RowBox[{"mrk", " ", "=", " ", 
       RowBox[{"MatrixRank", "[", "mt", "]"}]}], ";", "\n", "    ", 
      RowBox[{"(*", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", " ", "blQ"}], "==", "True"}], ",", " ", 
        RowBox[{
         RowBox[{"but", " ", "bQ"}], "==", 
         RowBox[{"False", " ", "with", " ", "mrk"}], "==", "mtrk"}], ",", " ", 
        RowBox[{
        "then", " ", "the", " ", "new", " ", "sets", " ", "are", " ", "still",
          " ", "in", " ", "the", " ", 
         RowBox[{"span", ".", "\n", "     ", "However"}]}], ",", " ", 
        RowBox[{
         RowBox[{"if", " ", "mrk"}], ">", 
         RowBox[{"mtrk", " ", "and", " ", "bQ"}], "==", "False"}], ",", " ", 
        RowBox[{
        "the", " ", "collection", " ", "of", " ", "sets", " ", "ought", " ", 
         "to", " ", "be", "\n", "     ", "discarded", " ", "during", " ", 
         "the", " ", "next", " ", 
         RowBox[{"iteration", "."}]}]}], "\n", "     ", "*)"}], "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"blQ", ",", "True"}], "]"}], " ", "&&", " ", 
         RowBox[{"LessEqual", "[", 
          RowBox[{"mtrk", ",", "mrk"}], "]"}]}], ",", 
        RowBox[{"bQ", "=", "True"}], ",", "False"}], "]"}], ";", "\n", 
      "     ", 
      RowBox[{"slex1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Append", "[", 
         RowBox[{"pslex", ",", "slc"}], "]"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"exc1", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"exc", ",", "smtr"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"mrk", ",", "lt"}], "]"}], " ", "&&", " ", 
         RowBox[{"SameQ", "[", 
          RowBox[{"bQ", ",", "True"}], "]"}]}], ",", "\n", "       ", 
        RowBox[{"{", 
         RowBox[{"Im", ",", "lIm1", ",", "slex1"}], "}"}], ",", "\n", 
        "       ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"bQ", ",", "True"}], "]"}], ",", "\n", "         ", 
          RowBox[{"PnSelectMCR", "[", 
           RowBox[{
           "exc1", ",", "sC1", ",", "lt", ",", "tol", ",", "Im", ",", "lIm1", 
            ",", "slex1", ",", "bQ", ",", "mrk"}], "]"}], ",", "\n", 
          "         ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "\n", "         ", "]"}]}], "\n", 
       "      ", "]"}]}]}], "\n", "  ", "]"}]}], ";"}], "\n"}], "Code",Express\
ionUUID->"429ef056-4c90-4118-b0c0-8d5b60d7c01a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IIMBalancedSelectionQ", "[", 
     RowBox[{"selcoal_List", ",", " ", "tol_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BalancedSelectionQ", "]"}]}]}], "]"}], 
    ":=", " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tig", ",", "ufs", ",", "sysvec", ",", "lt", ",", "tol1", ",", 
        "wghvec1", ",", "tolv", ",", "mrk", ",", "onesvec", ",", "wghvec", 
        ",", "chres", ",", "poswghQ", ",", "posQ", ",", "addoneQ", ",", 
        "oneQ", ",", "balcQ"}], "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"tig", " ", "=", "  ", 
        RowBox[{"OptionValue", "[", "Tight", "]"}]}], ";", "\n", "     ", 
       RowBox[{"ufs", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "selcoal", "]"}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ufs", ",", "T"}], "]"}], ",", "True", ",", 
         RowBox[{"Return", "[", "\"\<False\>\"", "]"}]}], "]"}], ";", "\n", 
       "     ", 
       RowBox[{"sysvec", " ", "=", " ", 
        RowBox[{"Developer`ToPackedArray", "[", 
         RowBox[{"ConstVec", "[", "selcoal", "]"}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"mrk", " ", "=", " ", 
        RowBox[{"MatrixRank", "[", "sysvec", "]"}]}], ";", "\n", "     ", 
       RowBox[{"lt", " ", "=", " ", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"tig", ",", "True"}], "]"}], ",", "True", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mrk", "<", "lt"}], ",", " ", 
           RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ",", "True"}], 
          "]"}]}], "]"}], ";", " ", "\n", "     ", 
       RowBox[{"onesvec", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"wghvec", " ", "=", " ", 
        RowBox[{
         RowBox[{"PseudoInverse", "[", 
          RowBox[{"Transpose", "[", "sysvec", "]"}], "]"}], ".", 
         "onesvec"}]}], ";", "\n", "     ", 
       RowBox[{"tol1", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{"tol", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "5"}], ")"}]}]}], "}"}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"wghvec1", "=", 
        RowBox[{"wghvec", "+", "tol1"}]}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
          "sub"}], "-", "collection"}], " ", "*)"}], "\n", "     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"wghvec1", ",", "0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"wghvec", ",", "sysvec"}], "}"}], "=", 
          RowBox[{"ReduceMatrix", "[", 
           RowBox[{"wghvec1", ",", "sysvec", ",", "T", ",", "onesvec"}], 
           "]"}]}], ",", "\n", "          ", 
         RowBox[{"Apply", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"Negative", "[", "wghvec1", "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"wghvec", ",", "sysvec"}], "}"}], "=", 
          RowBox[{"ReduceRkMatrix", "[", 
           RowBox[{"wghvec1", ",", "sysvec", ",", "T", ",", "onesvec"}], 
           "]"}]}], ",", " ", "\n", "          ", "True", ",", "wghvec"}], 
        "]"}], ";", "\n", "     ", 
       RowBox[{"chres", " ", "=", "  ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "sysvec", "]"}], ",", " ", "wghvec"}], 
         "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<chres=\>\"", ",", "chres"}], "]"}], ";"}], "*)"}], 
       "\n", "     ", 
       RowBox[{"poswghQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "wghvec1"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<wghvec=\>\"", ",", "wghvec"}], "]"}], ";", "\n", 
         "     ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<poswghQ=\>\"", ",", "poswghQ"}], "]"}], ";"}], "*)"}], 
       "\n", "     ", 
       RowBox[{"posQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"tolv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"tol1", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"addoneQ", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"LessEqual", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Subtract", "[", 
              RowBox[{"chres", ",", " ", "onesvec"}], "]"}], "]"}], ",", 
            "tolv"}], "}"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<addoneQ=\>\"", ",", "addoneQ"}], "]"}], ";"}], " ", 
        "*)"}], "\n", "     ", 
       RowBox[{"oneQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"balcQ", " ", "=", " ", 
        RowBox[{"And", "[", 
         RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<balcQ=\>\"", ",", "balcQ"}], "]"}], ";"}], "*)"}], 
       "\n", "     ", 
       RowBox[{"Return", "[", "balcQ", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
  "\n"}]], "Code",ExpressionUUID->"1505b78e-263f-4a9c-ab26-229f91476c1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxPreNuc", "[", 
     RowBox[{"game_", ",", "p_", ",", "k_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ApproxPreNuc", "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mthd", ",", "obj", ",", "const", ",", "lt", ",", "ra", ",", "rl", ",",
         "vars", ",", "sC", ",", "pexc", ",", "vi", ",", "eq"}], "}"}], ",", 
      "\n", "      ", 
      RowBox[{
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
       "\n", "      ", 
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "      ", 
       RowBox[{"lt", "=", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", "       ", "\n", "      ", 
       RowBox[{"sC", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"pexc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], "-", 
             RowBox[{"x", "[", "#", "]"}], "-", "k1"}], ")"}], "^", "p1"}], 
          " ", "&"}], "/@", " ", "sC"}]}], ";", "\n", "      ", 
       RowBox[{"rl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", "k1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "k"}], "}"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"obj", " ", "=", " ", 
        RowBox[{
         RowBox[{"Total", "[", "pexc", "]"}], " ", "/.", " ", "rl"}]}], ";", 
       "\n", "      ", 
       RowBox[{"ra", "=", 
        RowBox[{"ReasonableOutcome", "[", "game", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"const", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"LessEqual", ",", 
            RowBox[{"{", 
             RowBox[{"vars", ",", "ra"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\n", "      ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<const=\>\"", ",", "const"}], "]"}], ";"}], " ", "*)"}],
        "       ", "\n", "      ", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"Total", "[", "vars", "]"}], "==", 
         RowBox[{"v", "[", "T", "]"}]}]}], ";", "\n", "      ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"const", ",", "eq"}], "]"}], ";", "\n", "      ", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"{", "const", "}"}], ",", "obj"}], "]"}], ",", "vars", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}]}], "\n", "  ", "]"}]}], 
   ";"}], "\n"}]], "Code",ExpressionUUID->"0cf3a3b7-3552-423b-9db9-\
e36138a619c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "section", " ", "is", " ", "designated", " ", "to", " ", 
     "the", " ", "Modiclus", " ", "Modified", " ", "and", " ", "Proper", " ", 
     "Modified", " ", "Pre"}], "-", "Kernel"}], " ", "*)"}], " "}]], "Code",Ex\
pressionUUID->"a90bd914-54cd-4f18-bf86-e44089bc501f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Thm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sudhoelter", " ", "1997"}], ",", " ", 
       RowBox[{"Thm", " ", "1.4"}]}], ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"The", " ", "projection", " ", "of", " ", "the", " ", "pre"}], 
     "-", 
     RowBox[{
     "nucleolus", " ", "of", " ", "the", " ", "the", " ", "dual", " ", 
      "cover", " ", "game", "\n", "   ", "onto", " ", "the", " ", "player", 
      " ", "set", " ", "T", " ", "gives", " ", "the", " ", "modiclus", " ", 
      "of", " ", "the", " ", "original", " ", 
      RowBox[{"game", "."}]}]}]}], "  ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Modiclus", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"Modiclus", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Modiclus", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "Modiclus", "]"}]}]}], "]"}], " ", ":=",
      " ", "\n", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mthd", ",", "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", 
         "t0", ",", " ", "t1", ",", " ", "DCGame", ",", " ", "mdnc"}], "}"}], 
       ",", "\n", "  ", 
       RowBox[{
        RowBox[{"mthd", "=", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "  ", 
        RowBox[{"ovls", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "Coalitions"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Storing", " ", "original", " ", "game", " ", 
          RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Storing", " ", "original", " ", "game", " ", 
          RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"dcvals", " ", "=", " ", 
         RowBox[{"DualCover", "[", "game", "]"}]}], ";", "\n", "  ", 
        RowBox[{"lt", " ", "=", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
        RowBox[{"t1", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"2", "*", "lt"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"DCGame", " ", "=", " ", 
         RowBox[{"DefineGame", "[", 
          RowBox[{"t1", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"mdnc", " ", "=", " ", 
         RowBox[{"PreNucleolus", "[", 
          RowBox[{"DCGame", ",", 
           RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "the", " ", "original", " ", 
          RowBox[{"game", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"Take", "[", 
         RowBox[{"mdnc", ",", " ", "lt"}], "]"}]}]}], "\n", "  ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsModiclusQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"IsModiclusQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IsModiclusQ", "[", 
      RowBox[{"game_", ",", "payoff_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "IsModiclusQ", "]"}]}]}], "]"}], " ", ":=",
      " ", "\n", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mthd", ",", "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", 
         "t0", ",", " ", "t1", ",", " ", "dpay", ",", " ", "DCGame", ",", " ",
          "bcQ"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"mthd", "=", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "  ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
              RowBox[{"v", "[", "T", "]"}]}], ",", " ", "0"}], "]"}], " ", "&&",
            " ", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}], "/@", " ", 
              "payoff"}]}], "]"}]}], ",", " ", "True", ",", " ", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "  ", 
        RowBox[{"ovls", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "Coalitions"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Storing", " ", "original", " ", "game", " ", 
          RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Storing", " ", "original", " ", "game", " ", 
          RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"dcvals", " ", "=", " ", 
         RowBox[{"DualCover", "[", "game", "]"}]}], ";", "\n", "  ", 
        RowBox[{"lt", " ", "=", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
        RowBox[{"t1", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"2", "*", "lt"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"DCGame", " ", "=", " ", 
         RowBox[{"DefineGame", "[", 
          RowBox[{"t1", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"dpay", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"payoff", ",", "payoff"}], "}"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"bcQ", " ", "=", " ", 
         RowBox[{"BalancedCollectionQ", "[", 
          RowBox[{"DCGame", ",", "dpay", ",", 
           RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Redefine", " ", "the", " ", "original", " ", 
          RowBox[{"game", "."}]}], " ", "*)"}], "\n", "  ", 
        RowBox[{"Return", "[", "bcQ", "]"}]}]}], "\n", "  ", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"6e4c64ec-c9b8-4895-ba6c-2aaa93529a08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ModPreKernel", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ModPreKernel", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModPreKernel", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ModPreKernel", "]"}]}]}], "]"}], " ", ":=",
     " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"pay", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"v", "[", "T", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
         RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
       RowBox[{"ModPreKernel", "[", 
        RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModPreKernel", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ModPreKernel", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dimpay", ",", "rclim"}], "}"}], ",", " ", "\n", "      ", 
      RowBox[{
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
       "      ", 
       RowBox[{"rclim", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "11"}], ",", 
          "1024", ",", "512"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
         "\n", "                       ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], ",", " ", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",",
              " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"FuncModPreKernel", "[", 
                 RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
                " ", "payoff"}], " ", "//", "Union"}]}], "]"}], ",", "\n", 
           "                                     ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "                    ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
         "\n", "                        ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", " ", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",", 
             RowBox[{"FuncModPreKernel", "[", 
              RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], 
              "]"}]}], "]"}], ",", " ", "\n", 
           "                                     ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "                    ", "True", ",", " ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
        "                                   ", "]"}]}]}], "\n", "      ", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Main", " ", "Functions"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FuncModPreKernel", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ModPreKernel", "]"}]}]}], "]"}], " ", ":=",
     " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sil", ",", " ", "smc", ",", " ", "optst", ",", " ", "pinv", ",", " ", 
        "ovls", ",", " ", "t0", ",", " ", "dcvals", ",", " ", "dcgame", ",", 
        " ", "doi", ",", " ", "optstep", ",", " ", "itpay", ",", "tol", ",", 
        "brc"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", 
       "     ", "\n", "    ", 
       RowBox[{"optst", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "CalcStepSize", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"pinv", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "PseudoInv", "]"}]}], ";", "\n", "    ", 
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"dcvals", " ", "=", " ", 
        RowBox[{"ECCoverGame", "[", 
         RowBox[{"game", ",", "payoff"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"dcgame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t0", ",", " ", "dcvals"}], "]"}]}], ";", "       ", "\n", 
       "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"optstep", ",", " ", "doi"}], "}"}], " ", "=", " ", 
        RowBox[{"Developer`ToPackedArray", "[", 
         RowBox[{"DirectionOfImprovement", "[", 
          RowBox[{"dcgame", ",", " ", "payoff", ",", " ", 
           RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
           RowBox[{"CalcStepSize", " ", "->", " ", "optst"}], ",", " ", 
           RowBox[{"PseudoInv", "->", "pinv"}], ",", 
           RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
           RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<doi=\>\"", ",", " ", "doi"}], "]"}], ",", " ", 
         "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<optstep=\>\"", ",", " ", "optstep"}], "]"}], ",", " ", 
         "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"itpay", " ", "=", "  ", 
        RowBox[{"payoff", " ", "+", " ", 
         RowBox[{"optstep", "*", "doi"}]}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<itpay=\>\"", ",", " ", "itpay"}], "]"}], ",", " ", 
         "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "itpay", "]"}], "!=", "2"}], ",", 
         RowBox[{"Return", "[", "payoff", "]"}], ",", "True"}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"tol", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"1.5", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"brc", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LessEqual", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Abs", "[", "doi", "]"}], ",", "tol"}], "}"}]}], 
           "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", "   ", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"brc", ",", "True"}], "]"}], ",", " ", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"N", "[", "itpay", "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}]}], "]"}], ",", " ", 
         RowBox[{"FuncModPreKernel", "[", 
          RowBox[{"game", ",", " ", "itpay", ",", " ", 
           RowBox[{"CalcStepSize", " ", "->", " ", "optst"}], ",", " ", 
           RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
           RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}]}], 
        "]"}]}]}], " ", "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProperModPreKernel", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ProperModPreKernel", "::", "argerr"}], "]"}], ";", "$Failed"}],
     ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ProperModPreKernel", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "ProperModPreKernel", "]"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", "t0", ",", " ", 
       "t1", ",", " ", "dcpay", ",", "DCGame", ",", " ", "mdnc"}], "}"}], ",",
      "\n", "  ", 
     RowBox[{
      RowBox[{"ovls", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "Coalitions"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Storing", " ", "original", " ", "game", " ", 
        RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
      RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Storing", " ", "original", " ", "game", " ", 
        RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
      RowBox[{"dcvals", " ", "=", " ", 
       RowBox[{"DualCover", "[", "game", "]"}]}], ";", "\n", "  ", 
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"2", "*", "lt"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"dcpay", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"v", "[", "T", "]"}], ",", " ", 
           RowBox[{"Length", "[", "t1", "]"}]}], "]"}], "/", "2"}], "*", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{"0", " ", "&"}], ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "t1", "]"}], " ", "-", " ", "2"}]}], 
            "]"}]}], "]"}], "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"DCGame", " ", "=", " ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"t1", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"mdnc", " ", "=", " ", 
       RowBox[{"PreKernelSolution", "[", 
        RowBox[{"DCGame", ",", "dcpay", ",", "opts"}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"DefineGame", "[", 
       RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Redefine", " ", "the", " ", "original", " ", 
        RowBox[{"game", "."}]}], " ", "*)"}], "\n", "  ", 
      RowBox[{"Take", "[", 
       RowBox[{"mdnc", ",", " ", "lt"}], "]"}]}]}], "\n", "  ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"132f7b2d-347e-4037-b5c7-dfb1b0da72dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProperModPreKernel", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ProperModPreKernel", "]"}]}]}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", "t0", ",", " ", 
        "t1", ",", " ", "DCGame", ",", " ", "mdnc", ",", "dcpay"}], "}"}], 
      ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"dcvals", " ", "=", " ", 
        RowBox[{"DualCover", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"lt", " ", "=", " ", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"2", "*", "lt"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"dcpay", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"payoff", ",", "payoff"}], "}"}], "]"}]}], ";", "\n", "  ", 
       
       RowBox[{"DCGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t1", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"mdnc", " ", "=", " ", 
        RowBox[{"PreKernelSolution", "[", 
         RowBox[{"DCGame", ",", "dcpay", ",", "opts"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"Take", "[", 
        RowBox[{"mdnc", ",", " ", "lt"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsModPreKernelQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"IsModPreKernelQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsModPreKernelQ", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
    " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", "t0", ",", " ", 
        "t1", ",", " ", "DCGame", ",", " ", "pmpkQ"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "T", "]"}]}], ",", " ", "0"}], "]"}], ",", " ", 
         "True", ",", " ", "\n", "        ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            "payoff"}]}], "]"}], ",", " ", "True", ",", " ", "\n", "        ",
          "True", ",", " ", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"t0", " ", "=", " ", "T"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"dcvals", " ", "=", " ", 
        RowBox[{"ECCoverGame", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DCGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t0", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"pmpkQ", " ", "=", " ", 
        RowBox[{"PreKernelQ", "[", 
         RowBox[{"DCGame", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"Return", "[", "pmpkQ", "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsProperModPreKernelQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"IsProperModPreKernelQ", "::", "argerr"}], "]"}], ";", 
      "$Failed"}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsProperModPreKernelQ", "[", 
     RowBox[{"game_", ",", "payoff_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dcvals", ",", " ", "lt", ",", " ", "t0", ",", " ", 
        "t1", ",", " ", "dpay", ",", " ", "DCGame", ",", " ", "pmpkQ"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "T", "]"}]}], ",", " ", "0"}], "]"}], ",", " ", 
         "True", ",", " ", "\n", "        ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            "payoff"}]}], "]"}], ",", " ", "True", ",", " ", "\n", "        ",
          "True", ",", " ", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"t0", " ", "=", " ", "T"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"dcvals", " ", "=", " ", 
        RowBox[{"DualCover", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"lt", " ", "=", " ", 
        RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"2", "*", "lt"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DCGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"t1", ",", " ", "dcvals"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"dpay", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"payoff", ",", "payoff"}], "}"}], "]"}]}], ";", "\n", "  ", 
       
       RowBox[{"pmpkQ", " ", "=", " ", 
        RowBox[{"PreKernelQ", "[", 
         RowBox[{"DCGame", ",", "dpay"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"t0", ",", " ", "ovls"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"Return", "[", "pmpkQ", "]"}]}]}], "\n", "  ", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Dual", " ", "Extension", " ", "of", " ", "the", " ", "primal", " ", 
    "game"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DualExtension", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DualExtension", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DualExtension", "[", "game_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lt", ",", " ", "T1", ",", " ", "cl1", ",", " ", "clset", ",", " ", 
       "vlset", ",", " ", "dlext", ",", "vals"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
      RowBox[{"T1", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"lt", " ", "+", " ", "1"}], ",", " ", 
         RowBox[{"2", "*", "lt"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"cl1", " ", "=", " ", 
       RowBox[{"Subsets", "[", "T1", "]"}]}], ";", "\n", "  ", 
      RowBox[{"clset", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Coalitions", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "cl1"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "cl1", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "  ", 
      RowBox[{"vlset", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"Coalitions", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "+", " ", 
            RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", 
             RowBox[{"Complement", "[", 
              RowBox[{"T", ",", " ", "#"}], "]"}], "]"}]}], " ", "&"}], " ", "/@",
           " ", "Coalitions"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "cl1", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "  ", 
      RowBox[{"dlext", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "[", 
                 RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
               
               RowBox[{"{", 
                RowBox[{"#1", ",", " ", "#2"}], "}"}]}], "]"}], " ", "&"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"clset", ",", " ", "vlset"}], "}"}]}], "]"}], ",", " ", 
          "1"}], "]"}], " ", "//", " ", "Sort"}]}], ";", "\n", "  ", 
      RowBox[{"vals", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "dlext"}]}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{"vals", ",", " ", "dlext"}], "}"}]}]}], "\n", "  ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"49a85250-9160-46c5-959a-f3c38e4a33a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Primal", " ", "Extension", " ", "of", " ", "the", " ", "dual", " ", 
    "game"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PrimalExtension", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PrimalExtension", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PrimalExtension", "[", "game_", "]"}], " ", ":=", " ", "\n", 
     " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lt", ",", " ", "T1", ",", " ", "cl1", ",", " ", "clset", ",", " ", 
         "vlset", ",", " ", "plext", ",", "vals"}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"lt", " ", "=", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
        RowBox[{"T1", " ", "=", " ", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"lt", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"2", "*", "lt"}]}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"cl1", " ", "=", " ", 
         RowBox[{"Subsets", "[", "T1", "]"}]}], ";", "\n", "  ", 
        RowBox[{"clset", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Coalitions", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "]"}], " ", 
             "&"}], " ", "/@", " ", "cl1"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "cl1", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"vlset", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "+", " ", 
              RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
              RowBox[{"v", "[", 
               RowBox[{"Complement", "[", 
                RowBox[{"T", ",", " ", 
                 RowBox[{"Coalitions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], " ", 
             "&"}], " ", "/@", " ", "Coalitions"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "cl1", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"plext", " ", "=", " ", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"List", "[", 
                   RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{"#1", ",", " ", "#2"}], "}"}]}], "]"}], " ", "&"}], 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{"clset", ",", " ", "vlset"}], "}"}]}], "]"}], ",", " ",
             "1"}], "]"}], " ", "//", " ", "Sort"}]}], ";", "\n", "  ", 
        RowBox[{"vals", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "plext"}]}], ";", "\n", "  ", 
        RowBox[{"{", 
         RowBox[{"vals", ",", " ", "plext"}], "}"}]}]}], "\n", " ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualCover", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"DualCover", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DualCover", "[", "game_", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dvals", ",", " ", "dexts", ",", " ", "pvals", ",", " ", "pexts"}], 
        "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dvals", ",", " ", "dexts"}], "}"}], " ", "=", " ", 
         RowBox[{"DualExtension", "[", "game", "]"}]}], ";", "\n", "  ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pvals", ",", " ", "pexts"}], "}"}], " ", "=", " ", 
         RowBox[{"PrimalExtension", "[", "game", "]"}]}], ";", "\n", "  ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"dvals", ",", " ", "pvals"}], "}"}]}], "]"}]}]}], "\n", 
      "  ", "]"}]}], ";"}], "\n"}]}]], "Code",ExpressionUUID->"9abb74e5-587a-\
4811-829a-c9782e3e6121"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModECCoverGame", "[", 
     RowBox[{"game_", ",", " ", "payoff_"}], "]"}], " ", ":=", " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exc", ",", " ", "mexc", ",", " ", "dv", ",", " ", "sx", ",", " ", 
        "df", ",", " ", "assg", ",", " ", "dmexc", ",", " ", "pvals", ",", 
        " ", "dvals", ",", " ", "vals"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"exc", " ", "=", " ", 
        RowBox[{"ExcessPayoff", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"mexc", " ", "=", " ", 
        RowBox[{"Max", "[", "exc", "]"}]}], ";", "\n", "  ", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Reverse", "[", "Coalitions", "]"}]}]}], ";", "\n", "  ", 
       RowBox[{"assg", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"x", ",", " ", "T"}], "]"}], ",", " ", "payoff"}], 
           "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sx", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "Coalitions"}], " ", "/.", " ", "assg"}]}], ";", "\n", "  ", 
       RowBox[{"df", " ", "=", " ", 
        RowBox[{"dv", " ", "-", " ", "sx"}]}], ";", "\n", "  ", 
       RowBox[{"dmexc", " ", "=", " ", 
        RowBox[{"Max", "[", "df", "]"}]}], ";", "\n", "  ", 
       RowBox[{"pvals", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "+", " ", "dmexc"}], " ", "&"}],
          " ", "/@", " ", "Coalitions"}]}], ";", "\n", "  ", 
       RowBox[{"dvals", " ", "=", " ", 
        RowBox[{"dv", " ", "+", " ", "mexc"}]}], ";", "\n", "  ", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"pvals", ",", " ", "dvals"}], "}"}]}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"vals", ",", " ", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"vals", ",", " ", 
          RowBox[{"v", "[", "T", "]"}]}], "}"}], "]"}]}]}], "\n", "  ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ECCoverGame", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ECCoverGame", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ECCoverGame", "[", 
     RowBox[{"game_", ",", " ", "payoff_"}], "]"}], " ", ":=", " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exc", ",", " ", "mexc", ",", " ", "dv", ",", " ", "sx", ",", " ", 
        "df", ",", " ", "assg", ",", " ", "dmexc", ",", " ", "pvals", ",", 
        " ", "dvals", ",", " ", "vals"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"exc", " ", "=", " ", 
        RowBox[{"ExcessPayoff", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"mexc", " ", "=", " ", 
        RowBox[{"Max", "[", "exc", "]"}]}], ";", "\n", "  ", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Reverse", "[", "Coalitions", "]"}]}]}], ";", "\n", "  ", 
       RowBox[{"assg", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"x", ",", " ", "T"}], "]"}], ",", " ", "payoff"}], 
           "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sx", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "Coalitions"}], " ", "/.", " ", "assg"}]}], ";", "\n", "  ", 
       RowBox[{"df", " ", "=", " ", 
        RowBox[{"dv", " ", "-", " ", "sx"}]}], ";", "\n", "  ", 
       RowBox[{"dmexc", " ", "=", " ", 
        RowBox[{"Max", "[", "df", "]"}]}], ";", "\n", "  ", 
       RowBox[{"pvals", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "+", " ", "mexc", " ", "+", " ", 
           RowBox[{"2", "*", "dmexc"}]}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", "\n", "  ", 
       RowBox[{"dvals", " ", "=", " ", 
        RowBox[{"dv", " ", "+", " ", "dmexc", " ", "+", " ", 
         RowBox[{"2", "*", "mexc"}]}]}], ";", "\n", "  ", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"pvals", ",", " ", "dvals"}], "}"}]}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"vals", ",", "1"}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"vals", ",", " ", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"vals", ",", " ", 
          RowBox[{"v", "[", "T", "]"}]}], "}"}], "]"}]}]}], "\n", "  ", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "End", " ", "of", " ", "the", " ", "section", " ", "designated", " ", 
     "to", " ", "the", " ", "Modiclus", " ", "Modified", " ", "and", " ", 
     "Proper", " ", "Modified", " ", "Pre"}], "-", "Kernel"}], " ", "*)"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Start", " ", "of", " ", "the", " ", "section", " ", "related", " ", "to",
      " ", "the", " ", "simplified", " ", "modified", " ", "pre"}], "-", 
    RowBox[{
     RowBox[{"kernel", "/", "nucleolus"}], " ", "of", " ", "a", " ", 
     RowBox[{"game", "."}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SMPreKernel", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SMPreKernel", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SMPreKernel", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dv", ",", " ", "av", ",", " ", "AVGame", ",", " ", 
        "smpk"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"av", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ovls", " ", "+", " ", "dv"}], ")"}], "/", "2"}]}], ";", 
       "\n", "  ", 
       RowBox[{"AVGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", " ", "av"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"smpk", " ", "=", " ", 
        RowBox[{"PreKernelElement", "[", "AVGame", "]"}]}], ";", "\n", "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", " ", "ovls"}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"Return", "[", "smpk", "]"}], ";"}]}], "\n", "  ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IsSMPreKernelQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"IsSMPreKernelQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsSMPreKernelQ", "[", 
     RowBox[{"game_", ",", " ", "payoff_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dv", ",", " ", "av", ",", " ", "AVGame", ",", " ", 
        "smpkQ"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"av", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ovls", " ", "+", " ", "dv"}], ")"}], "/", "2"}]}], ";", 
       "\n", "  ", 
       RowBox[{"AVGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", " ", "av"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"smpkQ", " ", "=", " ", 
        RowBox[{"PreKernelQ", "[", 
         RowBox[{"AVGame", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", " ", "ovls"}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"Return", "[", "smpkQ", "]"}], ";"}]}], "\n", "  ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SMPrenucleolus", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SMPrenucleolus", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SMPrenucleolus", "[", "game_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ovls", ",", " ", "dv", ",", " ", "av", ",", " ", "AVGame", ",", " ", 
        "smpn"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ovls", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Storing", " ", "original", " ", "game", " ", 
         RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"av", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ovls", " ", "+", " ", "dv"}], ")"}], "/", "2"}]}], ";", 
       "\n", "  ", 
       RowBox[{"AVGame", " ", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", " ", "av"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"smpn", " ", "=", " ", 
        RowBox[{"PreNucleolus", "[", "AVGame", "]"}]}], ";", "\n", "  ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", " ", "ovls"}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Redefine", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], "*)"}], "\n", "  ", 
       RowBox[{"Return", "[", "smpn", "]"}], ";"}]}], "\n", "  ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IsSMPrenucleolusQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"IsSMPrenulceolusQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IsSMPrenucleolusQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_"}], "]"}], " ", ":=", " ", "\n", " ", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ovls", ",", " ", "dv", ",", " ", "av", ",", " ", "AVGame", ",", " ", 
       "smpnQ"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"ovls", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "Coalitions"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Storing", " ", "original", " ", "game", " ", 
        RowBox[{"values", "."}]}], "*)"}], "\n", "  ", 
      RowBox[{"dv", " ", "=", " ", 
       RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "  ", 
      RowBox[{"av", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ovls", " ", "+", " ", "dv"}], ")"}], "/", "2"}]}], ";", 
      "\n", "  ", 
      RowBox[{"AVGame", " ", "=", " ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", " ", "av"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"smpnQ", " ", "=", " ", 
       RowBox[{"BalancedCollectionQ", "[", 
        RowBox[{"AVGame", ",", " ", "payoff"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"DefineGame", "[", 
       RowBox[{"T", ",", " ", "ovls"}], "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{"Redefine", " ", "the", " ", "original", " ", 
        RowBox[{"game", "."}]}], "*)"}], "\n", "  ", 
      RowBox[{"Return", "[", "smpnQ", "]"}], ";"}]}], "\n", "  ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"04223c01-d782-4be5-a94f-d70305a282c3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "End", " ", "of", " ", "the", " ", "section", " ", "related", " ", "to", 
    " ", "the", " ", "simplified", " ", "modified", " ", "pre"}], "-", 
   RowBox[{"kernel", " ", "of", " ", "a", " ", 
    RowBox[{"game", "."}]}]}], " ", "*)"}]], "Code",ExpressionUUID->"ef4b079a-\
935d-40d9-b541-9332594d1309"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "next", " ", "function", " ", "checks", " ", "whether", " ", 
     "a", " ", "pre"}], "-", 
    RowBox[{"imputation", " ", "is", " ", "the", " ", "pre"}], "-", 
    RowBox[{"nucleolus", " ", "of", " ", "the", " ", "game"}]}], " ", "*)"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"It", " ", "is", " ", "based", " ", "on", " ", 
    RowBox[{"Kolberg", "'"}], "s", " ", "Theorem"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", "\n", "   ", 
   RowBox[{
    RowBox[{"Use", " ", "the", " ", "function", " ", "with", " ", 
     RowBox[{"care", ".", " ", "Not"}], " ", "every", " ", "result", " ", 
     "is", " ", 
     RowBox[{"correct", "!!"}], " ", "This", " ", "is", " ", "a", " ", "very",
      " ", "crude"}], ",", " ", 
    RowBox[{"but", " ", "quick", " ", "checking", "\n", "   ", "of", " ", 
     RowBox[{"balancedness", ".", " ", "We"}], " ", "tried", " ", "to", " ", 
     "implement", " ", "some", " ", "well", " ", "known", " ", "results", " ",
      "like", " ", "span", " ", "and", " ", "rank", " ", "consideration", 
     "\n", "   ", "without", " ", "relying", " ", "on", " ", "an", " ", "LP", 
     " ", 
     RowBox[{"approach", "."}]}]}], "\n", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"User", " ", "interface"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BalancedSelectionQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"BalancedSelectionQ", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedSelectionQ", "[", 
      RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "BalancedSelectionQ", "]"}]}]}], "]"}],
      ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimpay", ",", "cc"}], "}"}], ",", " ", "\n", "       ", 
       RowBox[{
        RowBox[{"dimpay", " ", "=", " ", 
         RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
             ")"}], " ", ",", " ", "\n", 
            "                                       ", 
            RowBox[{
             RowBox[{"cc", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"BalancedSelctQ", "[", 
                 RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
                " ", "payoff"}]}], ";", 
             RowBox[{"Simplify", "[", "cc", "]"}]}], ",", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", 
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", 
               "2"}]}], " ", ")"}], ",", " ", "\n", 
            "                                        ", 
            RowBox[{
             RowBox[{"cc", "=", 
              RowBox[{"BalancedSelctQ", "[", 
               RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], 
               "]"}]}], ";", 
             RowBox[{"Simplify", "[", "cc", "]"}]}], ",", " ", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
         "                                   ", "]"}]}]}], "\n", "      ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"ce29e377-8036-4f3b-a758-\
1bf51f864706"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalancedSelectionQ", "[", 
    RowBox[{"selcoal_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedSelectionQ", "]"}]}]}], "]"}], ":=",
    " ", "\n", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", "tig", ",", "ufs", ",", "sysvec", ",", "mrk", ",", 
       "onesvec", ",", "wghvec", ",", "chres", ",", "poswghQ", ",", "posQ", 
       ",", "addoneQ", ",", "oneQ", ",", "balcQ"}], "}"}], ",", "\n", "     ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"tig", " ", "=", "  ", 
       RowBox[{"OptionValue", "[", "Tight", "]"}]}], ";", "\n", "     ", 
      RowBox[{"ufs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "selcoal", "]"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ufs", ",", "T"}], "]"}], ",", "True", ",", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}]}], "]"}], ";", "\n", 
      "     ", 
      RowBox[{"sysvec", " ", "=", " ", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"ConstVec", "[", "selcoal", "]"}], "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"mrk", " ", "=", " ", 
       RowBox[{"MatrixRank", "[", "sysvec", "]"}]}], ";", "\n", "     ", 
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"tig", ",", "True"}], "]"}], ",", "True", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mrk", "<", "lt"}], ",", " ", 
          RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ",", "True"}], 
         "]"}]}], "]"}], ";", " ", "\n", "     ", 
      RowBox[{"onesvec", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"wghvec", " ", "=", " ", 
       RowBox[{
        RowBox[{"PseudoInverse", "[", 
         RowBox[{"Transpose", "[", "sysvec", "]"}], "]"}], ".", "onesvec"}]}],
       ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
        "subcollection"}], " ", "*)"}], "\n", "     ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"wghvec", ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghvec", ",", "sysvec"}], "}"}], "=", 
         RowBox[{"ReduceMatrix", "[", 
          RowBox[{"wghvec", ",", "sysvec", ",", "T", ",", "onesvec"}], 
          "]"}]}], ",", "\n", "          ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Negative", "[", "wghvec", "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghs", ",", "smat"}], "}"}], "=", 
         RowBox[{"ReduceRkMatrix", "[", 
          RowBox[{"wghvec", ",", "sysvec", ",", "T", ",", "onesvec"}], 
          "]"}]}], ",", " ", "\n", "          ", "True", ",", "wghvec"}], 
       "]"}], ";", "\n", "     ", 
      RowBox[{"chres", " ", "=", "  ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "sysvec", "]"}], ",", " ", "wghvec"}], 
        "]"}]}], ";", "\n", "     ", 
      RowBox[{"poswghQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "wghvec"}]}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"posQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"addoneQ", " ", "=", " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"chres", ",", " ", "onesvec"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"oneQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"balcQ", " ", "=", " ", 
       RowBox[{"And", "[", 
        RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "True"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "balcQ", ",", " ", "wghvec", ",", " ", "sysvec", ",", " ", 
          "selcoal"}], "}"}], ",", " ", "balcQ"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"008986f3-ef26-4771-a649-77c5fd8a06b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalancedSelectionQ", "[", 
    RowBox[{"selcoal_List", ",", " ", "tol_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedSelectionQ", "]"}]}]}], "]"}], ":=",
    " ", "\n", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", "tig", ",", "ufs", ",", "sysvec", ",", "mrk", ",", "lt",
        ",", "onesvec", ",", "wghvec", ",", "chres", ",", "tol1", ",", 
       "wghvec1", ",", "tolv", ",", "wghs", ",", "smat", ",", "poswghQ", ",", 
       "posQ", ",", "addoneQ", ",", "oneQ", ",", "balcQ"}], "}"}], ",", "\n", 
     "     ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"tig", " ", "=", "  ", 
       RowBox[{"OptionValue", "[", "Tight", "]"}]}], ";", "\n", "     ", 
      RowBox[{"ufs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "selcoal", "]"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ufs", ",", "T"}], "]"}], ",", "True", ",", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}]}], "]"}], ";", "\n", 
      "     ", 
      RowBox[{"sysvec", " ", "=", " ", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"ConstVec", "[", "selcoal", "]"}], "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"mrk", " ", "=", " ", 
       RowBox[{"MatrixRank", "[", "sysvec", "]"}]}], ";", "\n", "     ", 
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"tig", ",", "True"}], "]"}], ",", "True", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mrk", "<", "lt"}], ",", " ", 
          RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ",", "True"}], 
         "]"}]}], "]"}], ";", " ", "\n", "     ", 
      RowBox[{"onesvec", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"wghvec", " ", "=", " ", 
       RowBox[{
        RowBox[{"PseudoInverse", "[", 
         RowBox[{"Transpose", "[", "sysvec", "]"}], "]"}], ".", "onesvec"}]}],
       ";", "\n", "     ", 
      RowBox[{"tol1", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"tol", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}], "}"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"wghvec1", "=", 
       RowBox[{"wghvec", "+", "tol1"}]}], ";", "\n", 
      RowBox[{"(*", "\t", "\n", "     ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec=\>\"", ",", "wghvec"}], "]"}], ";", "\n", 
        "     ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec1=\>\"", ",", "wghvec1"}], "]"}], ";"}], "\n", 
       "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
         "sub"}], "-", "collection"}], " ", "*)"}], "\n", "     ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"wghvec1", ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghvec", ",", "sysvec"}], "}"}], "=", 
         RowBox[{"ReduceMatrix", "[", 
          RowBox[{"wghvec1", ",", "sysvec", ",", "T", ",", "onesvec"}], 
          "]"}]}], ",", "\n", "          ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Negative", "[", "wghvec1", "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghs", ",", "smat"}], "}"}], "=", 
         RowBox[{"ReduceRkMatrix", "[", 
          RowBox[{"wghvec1", ",", "sysvec", ",", "T", ",", "onesvec"}], 
          "]"}]}], ",", " ", "\n", "          ", "True", ",", "wghvec"}], 
       "]"}], ";", "\n", "     ", 
      RowBox[{"chres", " ", "=", "  ", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "sysvec", "]"}], ",", " ", "wghvec"}], 
        "]"}]}], ";", "\n", "     ", 
      RowBox[{"poswghQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "wghvec1"}]}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"posQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"tolv", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"tol1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "     ", 
      RowBox[{"addoneQ", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"LessEqual", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Subtract", "[", 
             RowBox[{"chres", ",", " ", "onesvec"}], "]"}], "]"}], ",", 
           "tolv"}], "}"}]}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"oneQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"balcQ", " ", "=", " ", 
       RowBox[{"And", "[", 
        RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"Return", "[", "balcQ", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"e3424da4-7040-4aa4-b0e9-f07d50e60344"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Main", " ", "Function", " ", "related", " ", "to", " ", 
   RowBox[{"BalancedSelctionQ", "[", "]"}]}], " ", "*)"}]], "Code",ExpressionU\
UID->"741ad6b3-05a0-4bf6-ad81-9e24cc29cfa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalancedSelctQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedSelectionQ", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", "sil", ",", "tig", ",", "selc", ",", "ufs", ",", "lt", 
       ",", "sysvec", ",", "onesvec", ",", "balcmat", ",", "mrk", ",", "wghs",
        ",", "fpQ", ",", "mbQ", ",", "nmbQ", ",", "rQ", ",", "flr", ",", "tk",
        ",", "extb", ",", "slc", ",", "smat", ",", "wghvec", ",", "chres", 
       ",", "numch", ",", "btkm", ",", "posQ", ",", "newwghs", ",", "addoneQ",
        ",", "oneQ", ",", "balcQ"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"sil", " ", "=", "  ", 
       RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
      RowBox[{"tig", " ", "=", "  ", 
       RowBox[{"OptionValue", "[", "Tight", "]"}]}], ";", "\n", "    ", 
      RowBox[{"selc", " ", "=", " ", 
       RowBox[{"BalancedCollect", "[", 
        RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ufs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"selc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ufs", ",", "T"}], "]"}], ",", "True", ",", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"sysvec", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ConstVec", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "selc"}]}], ";", "\n", "    ", 
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"onesvec", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "lt"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      
      RowBox[{"balcmat", " ", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"sysvec", ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"mrk", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixRank", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "balcmat"}]}], ";", "\n", 
      RowBox[{"(*", "  ", "\n", 
       RowBox[{
        RowBox[{"To", " ", "avoid", " ", "wrong", " ", "selections"}], ",", 
        " ", 
        RowBox[{"the", " ", "next", " ", "condition", " ", "is", " ", 
         RowBox[{"imposed", ".", " ", "\n", "The"}], " ", "disadvantage", " ",
          "is", " ", "that", " ", "under", " ", "certain", " ", 
         "conditions"}], ",", " ", 
        RowBox[{
        "we", " ", "make", " ", "no", " ", "selection", " ", "at", " ", 
         RowBox[{"all", "."}]}]}], "  ", "\n", "*)"}], "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"tig", ",", "True"}], "]"}], ",", "True", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "mrk", "]"}], "<", "lt"}], ",", " ", 
          RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ",", "True"}], 
         "]"}]}], "]"}], ";", " ", "\n", "    ", 
      RowBox[{"flr", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"mrk", ",", "lt"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"tk", "=", 
       RowBox[{"First", "[", "flr", "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "tk", "]"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ",", "True"}], "]"}], 
      ";", "\n", "    ", 
      RowBox[{"extb", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"balcmat", ",", "tk"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"slc", "=", 
       RowBox[{"tk", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"smat", "=", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"balcmat", "[", 
         RowBox[{"[", "slc", "]"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"wghs", " ", "=", 
       RowBox[{
        RowBox[{"PseudoInverse", "[", 
         RowBox[{"Transpose", "[", "smat", "]"}], "]"}], ".", "onesvec"}]}], 
      ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
         "sub"}], "-", "collection"}], " ", "*)"}], "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"wghs", ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghs", ",", "smat"}], "}"}], "=", 
         RowBox[{"ReduceMatrix", "[", 
          RowBox[{"wghs", ",", "smat", ",", "T", ",", "onesvec"}], "]"}]}], 
        ",", "\n", "          ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Negative", "[", "wghs", "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wghs", ",", "smat"}], "}"}], "=", 
         RowBox[{"ReduceRkMatrix", "[", 
          RowBox[{"wghs", ",", "smat", ",", "T", ",", "onesvec"}], "]"}]}], 
        ",", "\n", "          ", "True", ",", "wghs"}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec=\>\"", ",", "wghs"}], "]"}], ",", " ", "True"}], 
       "]"}], ";", "\n", "    ", 
      RowBox[{"posQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", 
         RowBox[{"Positive", "[", "wghs", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"slc", "===", "1"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"posQ", ",", 
           RowBox[{"Return", "[", "posQ", "]"}], ",", "True"}], "]"}], ";"}], 
        ",", "\n", "         ", "True", ",", "True"}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec=\>\"", ",", "wghs"}], "]"}], ",", " ", "True"}], 
       "]"}], ";", "\n", "    ", 
      RowBox[{"btkm", "=", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"balcmat", ",", "slc"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"wghvec", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "btkm", "]"}], "==", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"PseudoInverse", "[", 
             RowBox[{"Transpose", "[", "#", "]"}], "]"}], ".", "onesvec"}], 
           " ", "&"}], " ", "/@", " ", "btkm"}], ",", "\n", 
         "                ", 
         RowBox[{
          RowBox[{"PseudoInverse", "[", 
           RowBox[{"Transpose", "[", "btkm", "]"}], "]"}], ".", "onesvec"}]}],
         "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<posQ01=\>\"", ",", "posQ"}], "]"}], ",", " ", "True"}], 
       "]"}], ";", "\n", "    ", 
      RowBox[{"newwghs", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"slc", " ", ">", " ", "1"}], ",", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NewWghs", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"btkm", ",", " ", "wghvec"}], "}"}]}], "]"}], ",", " ", 
         "wghvec"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"poswghQ", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", " ", 
              RowBox[{"Positive", "[", "#", "]"}]}], "]"}], " ", "&"}], " ", "/@",
            " ", "newwghs"}]}], ";", " ", "\n", "                          ", 
         
         RowBox[{"posQ", " ", "=", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}]}], ",", " ", "\n", 
        "      ", "posQ"}], "]"}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", "\n", "          ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<newwghs=\>\"", ",", "newwghs"}], "]"}], ";", " ", "\n",
          "          ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<posQ03=\>\"", ",", "posQ"}], "]"}], ";"}], ",", "\n", 
        "       ", "True"}], "]"}], ";", " ", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"slc", " ", ">", " ", "2"}], ",", "\n", "            ", 
        RowBox[{
         RowBox[{"fpQ", " ", "=", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"And", ",", 
                RowBox[{"Positive", "[", "#", "]"}]}], "]"}], " ", "&"}], " ",
              "/@", " ", 
             RowBox[{"Take", "[", 
              RowBox[{"newwghs", ",", "3"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "            ", 
         RowBox[{"mbQ", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Take", "[", 
            RowBox[{"newwghs", ",", "3"}], "]"}]}]}], ";", "\n", 
         "            ", 
         RowBox[{"nmbQ", " ", "=", " ", 
          RowBox[{"Not", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{"Or", ",", "mbQ"}], "]"}], "]"}]}], ";", "\n", 
         "            ", 
         RowBox[{"rQ", "=", 
          RowBox[{"And", "[", 
           RowBox[{"fpQ", ",", "nmbQ"}], "]"}]}], ";"}], ",", "\n", 
        "          ", 
        RowBox[{"slc", " ", "==", " ", "2"}], ",", " ", "\n", "            ", 
        
        RowBox[{
         RowBox[{"fpQ", " ", "=", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"And", ",", 
                RowBox[{"Positive", "[", "#", "]"}]}], "]"}], " ", "&"}], " ",
              "/@", " ", 
             RowBox[{"Take", "[", 
              RowBox[{"newwghs", ",", "2"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "            ", 
         RowBox[{"mbQ", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", "1"}], "]"}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Take", "[", 
            RowBox[{"newwghs", ",", "2"}], "]"}]}]}], ";", "\n", 
         "            ", 
         RowBox[{"nmbQ", " ", "=", " ", 
          RowBox[{"Not", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{"Or", ",", "mbQ"}], "]"}], "]"}]}], ";", "\n", 
         "            ", 
         RowBox[{"rQ", "=", 
          RowBox[{"And", "[", 
           RowBox[{"fpQ", ",", "nmbQ"}], "]"}]}], ";"}], ",", "\n", 
        "          ", "True", ",", "True"}], "\n", "          ", "]"}], ";", 
      " ", "\n", "    ", 
      RowBox[{"posQ", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"slc", " ", ">", " ", "1"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{"rQ", ",", 
           RowBox[{"Return", "[", "rQ", "]"}], ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"And", ",", " ", 
                 RowBox[{"Positive", "[", "#", "]"}]}], "]"}], " ", "&"}], 
              " ", "/@", " ", "newwghs"}]}], "]"}]}], "]"}], ",", " ", "\n", 
         "                 ", "True", ",", " ", "posQ"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"chres", " ", "=", "  ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], 
          " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"btkm", ",", "newwghs"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"numch", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"N", "[", "#", "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}], "]"}], " ", "&"}], "/@", " ", 
        "chres"}]}], ";", "\n", "    ", 
      RowBox[{"addoneQ", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"#", ",", " ", "onesvec"}], "]"}], " ", "&"}], " ", "/@", 
        " ", "numch"}]}], ";", "\n", "    ", 
      RowBox[{"oneQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"balcQ", " ", "=", " ", 
       RowBox[{"And", "[", 
        RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<oneQ=\>\"", ",", " ", "oneQ"}], "]"}], ",", " ", 
        "True"}], "]"}], ";", " ", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dispres", " ", "===", " ", "True"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "balcQ", ",", " ", "newwghs", ",", " ", "balcmat", ",", " ", 
          "selc"}], "}"}], ",", " ", "balcQ"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"04239c8a-3389-4727-8e01-0ebff7eafda0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewWghs", "[", 
     RowBox[{"mat_List", ",", "wghs_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"poswghsQ", ",", "posQ", ",", " ", "newwghs"}], " ", "}"}], 
      ",", "\n", "    ", 
      RowBox[{
       RowBox[{"poswghsQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "wghs"}]}], ";", "\n", "    ", 
       RowBox[{"posQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "poswghsQ"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"newwghs", " ", "=", " ", 
          RowBox[{"DetPosWeights", "[", 
           RowBox[{"mat", ",", "wghs"}], "]"}]}], ",", " ", 
         RowBox[{"newwghs", " ", "=", " ", "wghs"}]}], "]"}], ";", "\n", 
       "    ", 
       RowBox[{"poswghsQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "newwghs"}]}], ";", "\n", "    ", 
       RowBox[{"posQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "poswghsQ"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"NormMinimize", "[", 
          RowBox[{"mat", ",", "wghs"}], "]"}], ",", " ", "newwghs"}], 
        "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Floating", " ", "Point", " ", "Exception", " ", 
       RowBox[{"Ver", ".", " ", "7."}], "x"}], " ", "*)"}], " ", "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMinimize", "[", 
    RowBox[{"mat_List", ",", " ", "wghs_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "onesvec", ",", "zerolist", ",", "avars", ",", "constset", ",", "objfu",
        ",", "objsys", ",", "resmin", ",", "gw"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"onesvec", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"zerolist", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "    ", 
      RowBox[{"avars", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "    ", 
      RowBox[{"constset", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Greater", "[", 
           RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"avars", ",", " ", "zerolist"}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"objfu", " ", "=", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "mat", "]"}], ".", "avars"}], " ", "-", 
         " ", "onesvec"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"objsys", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"constset", ",", "objfu"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"$OperatingSystem", ",", "\"\<Unix\>\""}], "]"}], ",", 
        RowBox[{"resmin", " ", "=", " ", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"objfu", ",", " ", "avars"}], "]"}]}], ",", "\n", 
        "             ", 
        RowBox[{"resmin", " ", "=", " ", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"objsys", ",", " ", "avars"}], "]"}]}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"gw", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"resmin", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"Rationalize", "[", 
         RowBox[{"#", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}], " ", "&"}], " ", "/@", " ", 
       "gw"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->\
"91307f89-4c84-4b28-bd3f-d6f877cf0225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetPosWeights", "[", 
     RowBox[{"mat_List", ",", " ", "wghs_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlsp", ",", "nlvec", ",", "nwghs01", ",", "nwghs02", ",", "negQ"}], 
       "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"nlsp", " ", "=", " ", 
        RowBox[{"NullSpace", "[", 
         RowBox[{"Transpose", "[", "mat", "]"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"nlvec", " ", "=", " ", 
        RowBox[{"Total", "[", "nlsp", "]"}]}], ";", "\n", "   ", 
       RowBox[{"nwghs01", " ", "=", " ", 
        RowBox[{"wghs", " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "100"}], ")"}], " ", "*", " ", "nlvec"}]}]}], 
       ";", "\n", "   ", 
       RowBox[{"nwghs02", " ", "=", " ", 
        RowBox[{"wghs", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "25"}], ")"}], " ", "*", " ", "nlvec"}]}]}], ";",
        "\n", "   ", 
       RowBox[{"negQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", " ", 
            RowBox[{"Positive", "[", "#", "]"}]}], " ", "]"}], " ", "&"}], "/@",
          " ", 
         RowBox[{"{", 
          RowBox[{"nwghs01", ",", "nwghs02"}], "}"}]}]}], ";", "\n", "   ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"negQ", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "===", " ", "True"}], ",", 
         " ", "nwghs01", ",", "\n", "                 ", 
         RowBox[{
          RowBox[{"negQ", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "===", " ", "True"}], ",", 
         " ", "nwghs02", ",", "\n", "                 ", "True", ",", " ", 
         "wghs"}], "\n", "   ", "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedSelectionQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"WeaklyBalancedSelectionQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedSelectionQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "WeaklyBalancedSelectionQ", "]"}]}]}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "dimpay", "}"}], ",", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], " ", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"WeakBalancedSelctQ", "[", 
             RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
            " ", "payoff"}], ",", "\n", 
          "                                     ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"WeakBalancedSelctQ", "[", 
           RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], "]"}], 
          ",", " ", "\n", "                                     ", "True", 
          ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
       "                                   ", "]"}]}]}], "\n", "      ", 
    "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"4a3bb002-a9a1-427f-89e2-\
68e03ada13a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WeakBalancedSelctQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "WeaklyBalancedSelectionQ", "]"}]}]}], 
    "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", "selc", ",", "ufs", ",", "lt", ",", "sysvec", ",", 
       "onesvec", ",", "balcmat", ",", "mrk", ",", "sil", ",", "flr", ",", 
       "trQ", ",", "wghvec", ",", "chres", ",", "numch", ",", "poswghQ", ",", 
       "posQ", ",", "newwghs", ",", "addoneQ", ",", "oneQ", ",", "balcQ"}], 
      "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"sil", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
      RowBox[{"selc", " ", "=", " ", 
       RowBox[{"BalancedCollect", "[", 
        RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ufs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"selc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ufs", ",", "T"}], "]"}], ",", "True", ",", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"sysvec", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ConstVec", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "selc"}]}], ";", "\n", "    ", 
      RowBox[{"lt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"onesvec", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "lt"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"balcmat", " ", "=", " ", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"sysvec", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"mrk", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixRank", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "balcmat"}]}], ";", " ", "\n", "    ", 
      RowBox[{"flr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Equal", "[", 
          RowBox[{"#", ",", "lt"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "mrk"}]}], ";", "\n", "    ", 
      RowBox[{"trQ", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", "flr"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{"trQ", ",", "True", ",", 
        RowBox[{"Return", "[", "trQ", "]"}]}], "]"}], ";", " ", "\n", "    ", 
      
      RowBox[{"wghvec", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"Transpose", "[", "#", "]"}], "]"}], ".", "onesvec"}], 
          " ", ")"}], " ", "&"}], " ", "/@", " ", "balcmat"}]}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec=\>\"", ",", "wghvec"}], "]"}], ",", " ", 
        "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"poswghQ", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{"NonNegative", "[", "#", "]"}]}], "]"}], " ", "&"}], " ", "/@",
         " ", "wghvec"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"First", "[", "poswghQ", "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"First", "[", "poswghQ", "]"}], "]"}], ",", "True"}], "]"}], 
      ";", " ", "\n", "    ", 
      RowBox[{"posQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<posQ01=\>\"", ",", "posQ"}], "]"}], ",", " ", "True"}], 
       "]"}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"newwghs", " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NewWeakWghs", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"balcmat", ",", " ", "wghvec"}], "}"}]}], "]"}]}], " ", 
         ";"}], ",", " ", 
        RowBox[{"newwghs", " ", "=", " ", "wghvec"}]}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"poswghQ", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", " ", 
              RowBox[{"NonNegative", "[", "#", "]"}]}], "]"}], " ", "&"}], 
           " ", "/@", " ", "newwghs"}]}], ";", " ", 
         RowBox[{"posQ", " ", "=", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}]}], ",", " ", 
        "posQ"}], "]"}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", "\n", "          ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<newwghs=\>\"", ",", "newwghs"}], "]"}], ";", " ", "\n",
          "          ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<posQ03=\>\"", ",", "posQ"}], "]"}], ";"}], ",", "\n", 
        "       ", "True"}], "]"}], ";", " ", "\n", "    ", 
      RowBox[{"chres", " ", "=", "  ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "#1", "]"}], ",", " ", "#2"}], "]"}], 
          " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"balcmat", ",", " ", "newwghs"}], "}"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"numch", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"N", "[", "#", "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}], "]"}], " ", "&"}], "/@", " ", 
        "chres"}]}], ";", "\n", "    ", 
      RowBox[{"addoneQ", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"#", ",", " ", "onesvec"}], "]"}], " ", "&"}], " ", "/@", 
        " ", "numch"}]}], ";", "\n", "    ", 
      RowBox[{"oneQ", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"balcQ", " ", "=", " ", 
       RowBox[{"And", "[", 
        RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<oneQ=\>\"", ",", " ", "oneQ"}], "]"}], ",", " ", 
        "True"}], "]"}], ";", " ", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "True"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "balcQ", ",", " ", "newwghs", ",", " ", "balcmat", ",", " ", 
          "selc"}], "}"}], ",", " ", "balcQ"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"6dbd7a7b-4128-4004-b687-36d5a740f698"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewWeakWghs", "[", 
     RowBox[{"mat_List", ",", "wghs_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"poswghsQ", ",", "posQ", ",", " ", "newwghs"}], " ", "}"}], 
      ",", "\n", "    ", 
      RowBox[{
       RowBox[{"poswghsQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"NonNegative", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "wghs"}]}], ";", "\n", "    ", 
       RowBox[{"posQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "poswghsQ"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"newwghs", " ", "=", " ", 
          RowBox[{"DetPosWeights", "[", 
           RowBox[{"mat", ",", "wghs"}], "]"}]}], ",", " ", 
         RowBox[{"newwghs", " ", "=", " ", "wghs"}]}], "]"}], ";", "\n", 
       "    ", 
       RowBox[{"poswghsQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "newwghs"}]}], ";", "\n", "    ", 
       RowBox[{"posQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "poswghsQ"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"posQ", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"WeakNormMinimize", "[", 
          RowBox[{"mat", ",", "wghs"}], "]"}], ",", " ", "newwghs"}], 
        "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Floating", " ", "Point", " ", "Exception", " ", 
       RowBox[{"Ver", ".", " ", "7."}], "x"}], " ", "*)"}], " ", "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeakNormMinimize", "[", 
     RowBox[{"mat_List", ",", " ", "wghs_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "onesvec", ",", "zerolist", ",", "avars", ",", "constset", ",", 
        "objfu", ",", "objsys", ",", "resmin", ",", "gw"}], "}"}], ",", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"onesvec", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"zerolist", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"avars", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"a", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"constset", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GreaterEqual", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"avars", ",", " ", "zerolist"}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"objfu", " ", "=", " ", 
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ".", "avars"}], " ", "-", 
          " ", "onesvec"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"objsys", "=", 
        RowBox[{"Prepend", "[", 
         RowBox[{"constset", ",", "objfu"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"$OperatingSystem", ",", "\"\<Unix\>\""}], "]"}], ",", 
         RowBox[{"resmin", " ", "=", " ", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"objfu", ",", " ", "avars"}], "]"}]}], ",", "\n", 
         "             ", 
         RowBox[{"resmin", " ", "=", " ", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"objsys", ",", " ", "avars"}], "]"}]}]}], "]"}], ";", "\n",
        "    ", 
       RowBox[{"gw", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"resmin", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], "]"}], " ", "&"}], " ", "/@", " ",
         "gw"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CollectionOfDecreasingExcess", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CollectionOfDecreasingExcess", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CollectionOfDecreasingExcess", "[", 
     RowBox[{"game_", ",", "payoff_List"}], "]"}], ":=", 
    RowBox[{"BalancedCollect", "[", 
     RowBox[{"game", ",", "payoff"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BalancedCollect", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"levexc", ",", " ", "redlev"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"levexc", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ExcessPayoff", "[", 
              RowBox[{"game", ",", " ", "payoff"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"redlev", " ", "=", " ", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Union", "[", 
          RowBox[{"Sort", "[", "levexc", "]"}], "]"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DetBalancedCollec", "[", 
              RowBox[{"#", ",", " ", "payoff", ",", " ", 
               RowBox[{"redlev", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
             " ", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"Subsets", "[", "T", "]"}], ",", " ", 
                RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], ",", " ", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "redlev", "]"}]}], "}"}]}], "]"}]}]}], "\n",
      "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetBalancedCollec", "[", 
     RowBox[{"S_List", ",", " ", "payoff_List", ",", " ", "\[Alpha]_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"GreaterEqual", "[", 
         RowBox[{
          RowBox[{"Excess", "[", 
           RowBox[{"payoff", ",", " ", "S"}], "]"}], ",", " ", "\[Alpha]"}], 
         "]"}], ",", " ", "S", ",", " ", 
        RowBox[{"{", "}"}]}], "]"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstVec", "[", "meff_List", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zrv", ",", " ", "onesvec", ",", " ", "pscoal"}], "}"}], ",", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"zrv", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"pscoal", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "meff"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"zrv", ",", " ", "1", ",", " ", "#"}], "]"}], " ", "&"}], 
       " ", "/@", " ", "pscoal"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "Code",Ex\
pressionUUID->"944d406e-5c64-48eb-a55b-0a5d736a0b29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"k", "-", 
     RowBox[{"Balancedness", " ", "Section"}]}], ",", " ", 
    RowBox[{"see", " ", 
     RowBox[{"I", ".", " ", "Katsev"}], " ", "and", " ", 
     RowBox[{"E", ".", " ", "Yanovskaya"}], " ", 
     RowBox[{"(", "2009", ")"}]}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"User", " ", "interface", " ", "for", " ", "coalition", " ", 
    RowBox[{"structure", "."}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kBalancednessQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"kBalancednessQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kBalancednessQ", "[", 
      RowBox[{"selcoal_List", ",", " ", "KC_List", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "kBalancednessQ", "]"}]}]}], "]"}], ":=",
      " ", "\n", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dispres", ",", "sysvec", ",", "mrk", ",", "trQ", ",", "vecps", ",", 
         "zrv", ",", "onesvec", ",", "wghvec", ",", "chres", ",", "poswghQ", 
         ",", "posQ", ",", "addoneQ", ",", "oneQ", ",", "balcQ"}], "}"}], ",",
        "\n", "     ", 
       RowBox[{
        RowBox[{"dispres", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
        "     ", 
        RowBox[{"sysvec", " ", "=", " ", 
         RowBox[{"Developer`ToPackedArray", "[", 
          RowBox[{"ConstVec", "[", "selcoal", "]"}], "]"}]}], ";", "\n", 
        "     ", 
        RowBox[{"mrk", "=", 
         RowBox[{"MatrixRank", "[", "sysvec", "]"}]}], ";", "\n", "     ", 
        RowBox[{"trQ", "=", 
         RowBox[{"Equal", "[", 
          RowBox[{"mrk", ",", 
           RowBox[{"Length", "[", "KC", "]"}]}], "]"}]}], ";", "\n", "     ", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"trQ", "===", "True"}], ",", "True", ",", 
          RowBox[{"Return", "[", "trQ", "]"}]}], "]"}], ";", " ", "\n", 
        "     ", 
        RowBox[{"vecps", "=", 
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", "KC"}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"zrv", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
         "     ", 
        RowBox[{"onesvec", " ", "=", " ", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"zrv", ",", "1", ",", "vecps"}], "]"}]}], ";", "\n", 
        "     ", 
        RowBox[{"wghvec", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"Transpose", "[", "sysvec", "]"}], "]"}], ".", 
           "onesvec"}], " ", ")"}]}], ";", " ", "\n", "     ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<wghvec=\>\"", ",", "wghvec"}], "]"}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
          "subcollection"}], " ", "*)"}], "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"wghvec", ",", "0"}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"wghvec", ",", "sysvec"}], "}"}], "=", 
           RowBox[{"ReduceMatrix", "[", 
            RowBox[{"wghvec", ",", "sysvec", ",", "KC", ",", "onesvec"}], 
            "]"}]}], ",", "wghvec"}], "]"}], ";", "\n", "     ", 
        RowBox[{"chres", " ", "=", "  ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "sysvec", "]"}], ",", " ", "wghvec"}], 
          "]"}]}], ";", "\n", "     ", 
        RowBox[{"poswghQ", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
            "wghvec"}]}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"posQ", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", "poswghQ"}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"addoneQ", " ", "=", " ", 
         RowBox[{"SameQ", "[", 
          RowBox[{"chres", ",", " ", "onesvec"}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"oneQ", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", "addoneQ"}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"balcQ", " ", "=", " ", 
         RowBox[{"And", "[", 
          RowBox[{"posQ", ",", " ", "oneQ"}], "]"}]}], ";", "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"dispres", ",", "True"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "balcQ", ",", " ", "wghvec", ",", " ", "sysvec", ",", " ", 
            "selcoal"}], "}"}], ",", " ", "balcQ"}], "]"}]}]}], "\n", "]"}]}],
     ";"}]}]}]], "Code",ExpressionUUID->"df85226a-1a85-4e56-9040-\
660dc45fb297"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceMatrix", "[", 
    RowBox[{"wghs_List", ",", "mat_List", ",", "KC_List", ",", "onesv_List"}],
     "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lkc", ",", "adv", ",", "zrv", ",", "nwm"}], "}"}], ",", "\n", 
     "     ", 
     RowBox[{
      RowBox[{"lkc", " ", "=", " ", 
       RowBox[{"Length", "[", "KC", "]"}]}], ";", "\n", "     ", 
      RowBox[{"adv", "=", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], ",", "1", ",", "0"}], "]"}], 
          " ", "&"}], " ", "/@", " ", "wghs"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"nwm", "=", 
       RowBox[{"adv", "*", "mat"}]}], ";", "\n", "     ", 
      RowBox[{"zrv", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", " ", "&"}], ",", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"nwm", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"nwm", ",", "zrv"}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"MatrixRank", "[", "nwm", "]"}], ",", "lkc"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"Transpose", "[", "nwm", "]"}], "]"}], ".", "onesv"}], 
          ",", "nwm"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"wghs", ",", "mat"}], "}"}]}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"3e293388-6ce7-4c45-9889-350c47db7813"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceRkMatrix", "[", 
     RowBox[{
     "wghs_List", ",", "mat_List", ",", "KC_List", ",", "onesv_List"}], "]"}],
     ":=", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lkc", ",", "adv", ",", "ctz", ",", "zrv", ",", "psz", ",", "pso", ",",
         "tk", ",", "nwm", ",", "nwm1", ",", "nwm2", ",", "swgh"}], "}"}], 
      ",", "\n", "     ", 
      RowBox[{
       RowBox[{"lkc", " ", "=", " ", 
        RowBox[{"Length", "[", "KC", "]"}]}], ";", "\n", "     ", 
       RowBox[{"adv", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], ",", "1", ",", "0"}], "]"}], 
          " ", "&"}], " ", "/@", " ", "wghs"}]}], ";", "\n", "     ", 
       RowBox[{"ctz", " ", "=", " ", 
        RowBox[{"Count", "[", 
         RowBox[{"adv", ",", "0"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"psz", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"adv", ",", "0"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"pso", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"adv", ",", "1"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"tk", " ", "=", " ", 
        RowBox[{
         RowBox[{"Last", "[", "psz", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ctz", ">", "0"}], ",", 
         RowBox[{"nwm", " ", "=", " ", 
          RowBox[{"Developer`ToPackedArray", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"mat", ",", "tk"}], "]"}], "]"}]}], ",", 
         RowBox[{"nwm", " ", "=", " ", 
          RowBox[{"Developer`ToPackedArray", "[", "mat", "]"}]}]}], "]"}], 
       ";", "\n", "     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"MatrixRank", "[", "nwm", "]"}], ",", "lkc"}], "]"}], ",", 
         
         RowBox[{
          RowBox[{"swgh", " ", "=", " ", 
           RowBox[{
            RowBox[{"PseudoInverse", "[", 
             RowBox[{"Transpose", "[", "nwm", "]"}], "]"}], ".", "onesv"}]}], 
          ";"}], ",", "\n", "           ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"MatrixRank", "[", "nwm", "]"}], ",", 
           RowBox[{"lkc", "-", "1"}]}], "]"}], ",", "\n", "              ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ctz", ",", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"fpsz", "=", 
             RowBox[{"Sort", "[", 
              RowBox[{"Append", "[", 
               RowBox[{"pso", ",", 
                RowBox[{"First", "[", "psz", "]"}]}], "]"}], "]"}]}], ";", 
            "\n", "                                 ", 
            RowBox[{"lpsz", "=", 
             RowBox[{"Sort", "[", 
              RowBox[{"Append", "[", 
               RowBox[{"pso", ",", 
                RowBox[{"Last", "[", "psz", "]"}]}], "]"}], "]"}]}], ";", 
            "\n", "                                 ", 
            RowBox[{"nwm1", "=", 
             RowBox[{"Extract", "[", 
              RowBox[{"mat", ",", "fpsz"}], "]"}]}], ";", "\n", 
            "                                 ", 
            RowBox[{"nwm2", "=", 
             RowBox[{"Extract", "[", 
              RowBox[{"mat", ",", "lpsz"}], "]"}]}], ";", "\n", 
            "                                 ", 
            RowBox[{"mrkQ", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"SameQ", "[", 
                RowBox[{
                 RowBox[{"MatrixRank", "[", "#", "]"}], ",", "lkc"}], "]"}], 
               " ", "&"}], " ", "/@", " ", 
              RowBox[{"{", 
               RowBox[{"nwm1", ",", "mwm2"}], "}"}]}]}], ";", "\n", 
            "                                 ", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"First", "[", "mrkQ", "]"}], ",", 
              RowBox[{
               RowBox[{"nwm", "=", "nwm1"}], ";", 
               RowBox[{"swgh", "=", 
                RowBox[{
                 RowBox[{"PseudoInverse", "[", 
                  RowBox[{"Transpose", "[", "nwm", "]"}], "]"}], ".", 
                 "onesv"}]}], ";"}], ",", "\n", "\t\t\t\t       ", 
              RowBox[{"Last", "[", "mrkQ", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"nwm", "=", "nwm2"}], ";", 
               RowBox[{"swgh", "=", 
                RowBox[{
                 RowBox[{"PseudoInverse", "[", 
                  RowBox[{"Transpose", "[", "nwm", "]"}], "]"}], ".", 
                 "onesv"}]}], ";"}], ",", "\n", 
              "                                       ", "True", ",", 
              RowBox[{"Return", "[", 
               RowBox[{"{", 
                RowBox[{"wghs", ",", "mat"}], "}"}], "]"}]}], " ", "\n", 
             "                                      ", "]"}], ";"}], ",", 
           "\n", "                    ", "True", ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"wghs", ",", "mat"}], "}"}], "]"}]}], "]"}], ",", "\n", 
         "           ", "True", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"wghs", ",", "mat"}], "}"}], "]"}]}], "\n", "          ", 
        "]"}], ";", "\n", "     ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"swgh", ",", "nwm"}], "}"}], "]"}]}]}], "\n", "]"}]}], ";"}],
   "\n"}]], "Code",ExpressionUUID->"8c49a355-d7fe-4df7-a562-4fe442c2a64f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "  ", 
   RowBox[{"User", " ", "interface", " ", "for", " ", "payoff", " ", 
    RowBox[{"vectors", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SelectionKBalancedQ", "[", 
      RowBox[{
      "game_", ",", " ", "payoff_List", ",", " ", "k_Integer", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "SelectionKBalancedQ", "]"}]}]}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dispres", ",", " ", "verb", ",", " ", "dimpay", ",", " ", "selc", 
         ",", "binval", ",", "cc"}], "}"}], ",", " ", "\n", "       ", 
       RowBox[{
        RowBox[{"dispres", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
        "       ", 
        RowBox[{"verb", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "       ", 
        
        RowBox[{"dimpay", " ", "=", " ", 
         RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
             ")"}], " ", ",", "     ", "\n", 
            "                                           ", 
            RowBox[{
             RowBox[{"selc", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"BalancedCollect", "[", 
                 RowBox[{"game", ",", " ", "#"}], "]"}], " ", "&"}], "/@", 
               " ", "payoff"}]}], ";", " ", "\n", 
             "                                           ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dispres", " ", "===", " ", "True"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"CheckCoalStructure", "[", 
                  RowBox[{"#", ",", " ", "k", ",", " ", 
                   RowBox[{"DisplayAllResults", "->", " ", "True"}]}], "]"}], 
                 " ", "&"}], "/@", " ", "selc"}], ",", " ", "\n", 
               "                                                              \
                   ", 
               RowBox[{
                RowBox[{"binval", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"CheckCoalStructure", "[", 
                    RowBox[{"#", " ", ",", " ", "k", ",", " ", 
                    RowBox[{"DisplayAllResults", "->", " ", "False"}]}], 
                    "]"}], " ", "&"}], "/@", " ", "selc"}]}], ";", " ", "\n", 
                "                                                             \
                    ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"verb", " ", "===", "False"}], ",", "  ", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<binval1=\>\"", ",", "binval"}], "]"}], ",", 
                  " ", "True"}], "]"}], ";", "\n", 
                "                                                             \
                   ", 
                RowBox[{"Simplify", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Apply", "[", 
                    RowBox[{"And", ",", "#"}], "]"}], "&"}], "/@", " ", 
                  "binval"}], "]"}]}]}], " ", "]"}]}], "  ", ",", " ", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", 
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", 
               "2"}]}], " ", ")"}], ",", "  ", "\n", 
            "                                          ", 
            RowBox[{
             RowBox[{"selc", " ", "=", " ", 
              RowBox[{"BalancedCollect", "[", 
               RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "  ", "\n",
              "                                          ", 
             RowBox[{"cc", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"CheckCoalStructure", "[", 
                 RowBox[{"#", " ", ",", " ", "k", ",", " ", "opts"}], " ", 
                 "]"}], " ", "&"}], "/@", " ", "selc"}]}], ";", "\n", 
             "                                          ", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", "cc"}], "]"}]}], ",", "  ", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
         "                                   ", "]"}]}]}], "\n", "      ", 
      "]"}]}], ";"}], "\n", "\n", "\n"}]}]], "Code",ExpressionUUID->"54c0cea2-\
b5c2-4c78-b761-305e285e6a5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CheckCoalStructure", "[", 
     RowBox[{"selcoal_List", ",", " ", "k_Integer", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "SelectionKBalancedQ", "]"}]}]}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"verb", ",", " ", "cst"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verb", " ", "===", " ", "False"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<selcoal=\>\"", ",", " ", "selcoal"}], " ", "]"}], 
          ";"}], ",", " ", "True"}], " ", "]"}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "selcoal", "]"}], "  ", "===", " ", "3"}], 
         ",", "\n", "                     ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"GreaterEqual", "[", 
             RowBox[{"k", ",", " ", 
              RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "===", " ", 
            "True"}], ",", " ", 
           RowBox[{"First", "[", 
            RowBox[{"BalancedSystemQ", "[", 
             RowBox[{"selcoal", ",", " ", "T", ",", " ", "opts"}], "]"}], 
            "]"}], ",", "  ", "\n", "                                   ", 
           RowBox[{
            RowBox[{"GreaterEqual", "[", 
             RowBox[{"k", ",", " ", "2"}], "]"}], " ", "===", " ", "True"}], 
           ",", " ", 
           RowBox[{"SelctKBalacQ", "[", 
            RowBox[{"selcoal", ",", " ", "k", ",", " ", "opts"}], "]"}], ",", 
           "\n", "                                   ", "True", ",", "  ", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The value of k must be an integer between 2 and \>\"", ",", 
             " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}], ",", "\n", 
         "                  ", 
         RowBox[{
          RowBox[{"Depth", "[", "selcoal", "]"}], "  ", "===", " ", "4"}], 
         ",", "\n", "                       ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verb", " ", "===", " ", "False"}], ",", " ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<selcoal=\>\"", ",", " ", "selcoal"}], " ", "]"}], 
             ";"}], ",", " ", "True"}], " ", "]"}], ";", "\n", 
          "                       ", 
          RowBox[{"cst", " ", "=", " ", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"selcoal", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", 
          "                       ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GreaterEqual", "[", 
              RowBox[{"k", ",", " ", 
               RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "===", " ", 
             "True"}], ",", "  ", 
            RowBox[{"bcQ", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"BalancedSystemQ", "[", 
                 RowBox[{"#", ",", " ", "T", ",", " ", "opts"}], "]"}], "]"}],
                " ", "&"}], "/@", " ", "cst"}]}], ",", "  ", "\n", 
            "                                     ", 
            RowBox[{
             RowBox[{"GreaterEqual", "[", 
              RowBox[{"k", ",", " ", "2"}], "]"}], " ", "===", " ", "True"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"SelctKBalacQ", "[", 
               RowBox[{"#", ",", " ", "k", ",", " ", "opts"}], "]"}], " ", 
              "&"}], "/@", " ", "cst"}], ",", "\n", 
            "                                     ", "True", ",", "  ", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<The value of k must be an integer between 2 and \>\"", ",", 
              " ", 
              RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\n", "                   ", 
         RowBox[{"selcoal", " ", "===", 
          RowBox[{"{", "}"}]}], ",", " ", "True", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Depth", "[", "selcoal", "]"}], " ", "==", "2"}], " ", 
          "*)"}], " ", "\n", "                  ", "True", ",", " ", 
         RowBox[{
         "Print", "[", "\"\<The input dimension is not correct.\>\"", "]"}]}],
         "\n", "                                      ", "]"}]}]}], "\n", 
     "  ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"User", " ", "interface", " ", "for", " ", "coalition", " ", 
    RowBox[{"structures", "."}]}], " ", "*)"}]}]}], "Code",ExpressionUUID->\
"d785282d-62df-4f5b-84ac-7ea35456bf18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SelectionKBalancedQ", "[", 
    RowBox[{"selcoal_List", ",", " ", "k_Integer", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "SelectionKBalancedQ", "]"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "selcoal", "]"}], "  ", "===", " ", "3"}], ",", 
       "\n", "                     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"k", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "===", " ", 
          "True"}], ",", " ", 
         RowBox[{"First", "[", 
          RowBox[{"BalancedSystemQ", "[", 
           RowBox[{"selcoal", ",", " ", "T", ",", " ", "opts"}], "]"}], "]"}],
          ",", "  ", "\n", "                                   ", 
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"k", ",", " ", "2"}], "]"}], " ", "===", " ", "True"}], 
         ",", " ", 
         RowBox[{"SelctKBalacQ", "[", 
          RowBox[{"selcoal", ",", " ", "k", ",", " ", "opts"}], "]"}], ",", 
         "\n", "                                   ", "True", ",", "  ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<The value of k must be an integer between 2 and \>\"", ",", 
           " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}], ",", "\n", 
       "                  ", 
       RowBox[{
        RowBox[{"Depth", "[", "selcoal", "]"}], "  ", "===", " ", "4"}], ",", 
       "\n", "                       ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"k", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "===", " ", 
          "True"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"BalancedSystemQ", "[", 
             RowBox[{"#", ",", " ", "T", ",", " ", "opts"}], "]"}], "]"}], 
           " ", "&"}], "/@", " ", "selcoal"}], ",", "  ", "\n", 
         "                                     ", 
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"k", ",", " ", "2"}], "]"}], " ", "===", " ", "True"}], 
         ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"SelctKBalacQ", "[", 
            RowBox[{"#", ",", " ", "k", ",", " ", "opts"}], "]"}], " ", "&"}],
           "/@", " ", "selcoal"}], ",", "\n", 
         "                                     ", "True", ",", "  ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<The value of k must be an integer between 2 and \>\"", ",", 
           " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}], ",", "\n", 
       "                  ", "True", ",", " ", 
       RowBox[{
       "Print", "[", "\"\<The input dimension is not correct.\>\"", "]"}]}], 
      "\n", "       ", "]"}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->\
"75c4dddc-0a18-4f50-bde0-4ecf9c0dded8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelctKBalacQ", "[", 
     RowBox[{"selcoal_List", ",", " ", "k_Integer", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "SelectionKBalancedQ", "]"}]}]}], "]"}],
     " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "verb", ",", "dispres", ",", "onesvec", ",", "eqtok", ",", "ufs", ",", 
        "bveq", ",", "kcoll", ",", "kbalsel", ",", "kbalmat", ",", "mrk", ",",
         "flr", ",", "trQ", ",", "kwghs", ",", "selkbalQ", ",", "redw", ",", 
        "nkwghs", ",", "nkbalmat", ",", "kpos", ",", "kselall", ",", "\n", 
        "    ", "kbalQ", ",", " ", "kinprd", ",", " ", "ksum", ",", " ", 
        "ksumeqQ", ",", " ", "ksQ"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"verb", ",", "False"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<selcoal=\>\"", ",", "selcoal"}], "]"}], ";"}], ",", 
         " ", "True"}], " ", "]"}], ";", "\n", "    ", 
       RowBox[{"onesvec", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"eqtok", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], " ", "===", " ", "k"}], ",",
               " ", "#", ",", " ", 
              RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Subsets", "[", "T", "]"}]}], ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"bveq", " ", "=", " ", 
        RowBox[{"ConstVec", "[", "eqtok", "]"}]}], ";", "\n", "    ", 
       RowBox[{"kcoll", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"selcoal", ",", " ", "#"}], "]"}], " ", "===", " ", 
               "True"}], ",", "  ", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"eqtok", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "]"}], ",", 
              " ", 
              RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
           "selcoal"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "eqtok", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"kbalsel", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], "]"}], " ", "&"}], " ", "/@", " ",
            "kcoll"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"kbalmat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ConstVec", "[", 
           RowBox[{"Union", "[", "#", "]"}], "]"}], " ", "&"}], " ", "/@", 
         " ", "kbalsel"}]}], ";", "\n", "    ", 
       RowBox[{"mrk", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MatrixRank", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "kbalmat"}]}], ";", "\n", "    ", 
       RowBox[{"flr", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"#", ",", "k"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "mrk"}]}], ";", "\n", "    ", 
       RowBox[{"trQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "flr"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"trQ", ",", "True"}], "]"}], ",", "True", ",", 
         RowBox[{"Return", "[", "trQ", "]"}]}], "]"}], ";", "\n", "    ", 
       RowBox[{"kwghs", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ComputeWeights", "[", 
            RowBox[{"#1", ",", " ", "#2", ",", " ", "k"}], "]"}], " ", "&"}], 
          " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"kbalmat", ",", " ", "bveq"}], "}"}]}], "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"verb", ",", "False"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<kwghs=\>\"", ",", " ", "kwghs"}], "]"}], ";"}], ",", 
         " ", "True"}], "]"}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Trying", " ", "to", " ", "find", " ", "a", " ", "balanced", " ", 
         "subcollection"}], " ", "*)"}], "\n", "    ", 
       RowBox[{"redw", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"#1", ",", "0"}], "]"}], ",", 
             RowBox[{"ReduceMatrix", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "onesvec"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"kwghs", ",", "kbalmat", ",", "eqtok"}], "}"}]}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"nkwghs", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "redw"}]}], ";", "\n", "    ", 
       RowBox[{"nkbalmat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "redw"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"verb", ",", "False"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<nkwghs=\>\"", ",", " ", "nkwghs"}], "]"}], ";"}], ",",
          " ", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"kpos", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"nkwghs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "nkwghs", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"kselall", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "kpos"}]}], ";", "\n", "    ", 
       RowBox[{"kbalQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "kselall"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"kinprd", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "nkbalmat", "]"}], "==", "4"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "#1", "]"}], ",", " ", "#2"}], "]"}],
              " ", "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"nkbalmat", ",", " ", "nkwghs"}], "}"}]}], "]"}], ",", 
          "\n", "                   ", 
          RowBox[{
           RowBox[{"Depth", "[", "nkbalmat", "]"}], "==", "3"}], ",", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "nkbalmat", "]"}], ",", " ", "nkwghs"}],
            "]"}], ",", "\n", "                   ", "True", ",", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{"nkbalmat", ",", " ", "nkwghs"}], "]"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"verb", ",", "False"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<kinprd=\>\"", ",", " ", "kinprd"}], "]"}], ";"}], ",",
          " ", "True"}], " ", "]"}], ";", "\n", "    ", 
       RowBox[{"ksum", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"#", ",", " ", "onesvec"}], "]"}], " ", "&"}], " ", "/@", 
         " ", "kinprd"}]}], ";", "\n", "    ", 
       RowBox[{"ksumeqQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"#", ",", " ", "k"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "ksum"}]}], ";", "\n", "    ", 
       RowBox[{"ksQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "ksumeqQ"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"selkbalQ", " ", "=", " ", 
        RowBox[{"And", "[", 
         RowBox[{"ksQ", ",", " ", "kbalQ"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "True"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "selkbalQ", ",", " ", "nkwghs", ",", " ", "nkbalmat", ",", " ", 
           "kbalsel"}], "}"}], ",", " ", "selkbalQ"}], "]"}]}]}], "\n", " ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComputeWeights", "[", 
     RowBox[{"kmatrix_List", ",", " ", "onesv_List", ",", " ", "k_Integer"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trkmat", ",", " ", "d1", ",", " ", "d2"}], "}"}], ",", "\n", 
      "     ", 
      RowBox[{
       RowBox[{"trkmat", " ", "=", " ", 
        RowBox[{"Transpose", "[", "kmatrix", "]"}]}], ";", " ", "\n", "    ", 
       
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d1", ",", "d2"}], "}"}], " ", "=", " ", 
        RowBox[{"Dimensions", "[", "trkmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d1", " ", ",", "d2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "k"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Inverse", "[", "trkmat", "]"}], ".", "onesv"}], ",", " ", 
         RowBox[{"WghsPseudoInvers", "[", 
          RowBox[{"trkmat", ",", " ", "onesv"}], "]"}]}], " ", "]"}]}]}], 
     "\n", "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WghsPseudoInvers", "[", 
     RowBox[{"kmatrix_List", ",", " ", "onesv_List"}], "]"}], " ", ":=", " ", 
    
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "psmat", ",", " ", "wghs", ",", " ", "psQ", ",", " ", "trQ", ",", 
        "tmat"}], "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"tmat", " ", "=", " ", 
        RowBox[{"Developer`ToPackedArray", "[", "kmatrix", "]"}]}], ";", 
       "\t\t\t\t\t\t    ", "\n", "   ", 
       RowBox[{"psmat", " ", "=", " ", 
        RowBox[{"PseudoInverse", "[", "tmat", "]"}]}], ";", " ", "\n", "   ", 
       
       RowBox[{"wghs", " ", "=", " ", 
        RowBox[{"psmat", ".", "onesv"}]}], ";", "\n", "   ", 
       RowBox[{"psQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Positive", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "wghs"}]}], ";", "\n", "   ", 
       RowBox[{"trQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "psQ"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"trQ", ",", "True"}], "]"}], ",", " ", "wghs", " ", ",", 
         " ", 
         RowBox[{"DetPositiveWeights", "[", 
          RowBox[{"psmat", ",", " ", "wghs"}], "]"}]}], "]"}]}]}], "     ", 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DetPositiveWeights", "[", 
    RowBox[{"kmatrix_List", ",", " ", "wghs_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nlsp", ",", "nlvec", ",", "nwghs01", ",", "nwghs02", ",", "negQ"}], 
      "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"nlsp", " ", "=", " ", 
       RowBox[{"NullSpace", "[", 
        RowBox[{"Transpose", "[", "kmatrix", "]"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"nlvec", " ", "=", " ", 
       RowBox[{"Total", "[", "nlsp", "]"}]}], ";", "\n", "   ", 
      RowBox[{"nwghs01", " ", "=", " ", 
       RowBox[{"wghs", " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "100"}], ")"}], " ", "*", " ", "nlvec"}]}]}], ";",
       "\n", "   ", 
      RowBox[{"nwghs02", " ", "=", " ", 
       RowBox[{"wghs", " ", "-", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "100"}], ")"}], " ", "*", " ", "nlvec"}]}]}], ";",
       "\n", "   ", 
      RowBox[{"negQ", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{"Positive", "[", "#", "]"}]}], " ", "]"}], " ", "&"}], "/@",
         " ", 
        RowBox[{"{", 
         RowBox[{"nwghs01", ",", "nwghs02"}], "}"}]}]}], ";", "\n", "   ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"negQ", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "True"}], "]"}], ",", " ", 
        "nwghs01", ",", "\n", "                 ", 
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"negQ", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "True"}], "]"}], ",", " ", 
        "nwghs02", ",", "\n", "                 ", "True", ",", " ", "wghs"}],
        "\n", "   ", "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "Code",Expressio\
nUUID->"f5d3071b-c77d-40fd-a777-548585c16783"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Alternative", " ", "Function", " ", "to", " ", "check", " ", "a", " ", 
   "Kohlberg", " ", "criterion"}], "*)"}]], "Code",ExpressionUUID->"deefb92b-\
f8f7-4259-b4c1-94d303cb6d39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BalancedCollectionQ", "[", "args___", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BalancedCollectionQ", "::", "argerr"}], "]"}], ";", " ", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BalancedCollectionQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedCollectionQ", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimpay", ",", " ", "cc"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "   ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",", 
        " ", "\n", "    ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "3"}]}], 
           ")"}], ",", " ", "\n", "      ", 
          RowBox[{
           RowBox[{"cc", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"BalancedCollMainQ", "[", 
               RowBox[{"game", ",", " ", "#", ",", " ", "opts"}], "]"}], " ", 
              "&"}], " ", "/@", " ", "payoff"}]}], ";", " ", 
           RowBox[{"Simplify", "[", "cc", "]"}]}], ",", " ", "\n", "      ", 
          "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
        "\n", "    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",", 
        " ", "\n", "       ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           ")"}], ",", " ", "\n", "       ", 
          RowBox[{
           RowBox[{"cc", " ", "=", " ", 
            RowBox[{"BalancedCollMainQ", "[", 
             RowBox[{"game", ",", " ", "payoff", ",", " ", "opts"}], "]"}]}], 
           ";", " ", 
           RowBox[{"Simplify", "[", "cc", "]"}]}], ",", " ", "\n", "       ", 
          "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
        "\n", "    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"f80b0591-a3ca-4dfd-8820-5950fd3fdd18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BalancedCollMainQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BalancedCollectionQ", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cde", ",", " ", "acde", ",", " ", "rkQ", ",", " ", "tk", ",", " ", 
       "lprs"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "T", "]"}]}], ",", " ", "0"}], "]"}], " ", "&&",
          " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            "payoff"}]}], "]"}]}], ",", " ", "True", ",", " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "   ", 
      RowBox[{"cde", " ", "=", " ", 
       RowBox[{"CollectionOfDecreasingExcess", "[", 
        RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"cde", ",", " ", 
        RowBox[{"{", "}"}]}], "]"}], ";", "\n", "   ", 
      RowBox[{"acde", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"FlattenAt", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"{", "#", "}"}], ",", " ", "T"}], "]"}], ",", " ", "1"}],
           "]"}], " ", "&"}], " ", "/@", " ", "cde"}]}], ";", "\n", "   ", 
      RowBox[{"rkQ", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RankConQ", "[", 
          RowBox[{"#", ",", " ", "T"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "acde"}]}], ";", "\n", "   ", 
      RowBox[{"tk", " ", "=", " ", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"rkQ", ",", " ", "True"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"lprs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"BalancedSystemQ", "[", 
           RowBox[{"#", ",", " ", "T", ",", "opts"}], "]"}], "]"}], " ", 
         "&"}], " ", "/@", " ", 
        RowBox[{"Take", "[", 
         RowBox[{"acde", ",", " ", "tk"}], "]"}]}]}], ";", "\n", "   ", 
      RowBox[{"Apply", "[", 
       RowBox[{"And", ",", " ", "lprs"}], "]"}]}]}], "]"}]}], ";"}]], "Code",E\
xpressionUUID->"6cb0ceef-ffab-47aa-8639-158f253eeb6b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RankConQ", "[", 
     RowBox[{"coll_List", ",", " ", "T_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "zvec", ",", " ", "ovec", ",", " ", "pos", ",", " ", "mat", ",", " ", 
        "rk"}], "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"zvec", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"ovec", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"1", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ",
          "coll"}]}], ";", "\n", "   ", 
       RowBox[{"mat", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"zvec", ",", " ", "1", ",", " ", "#"}], "]"}], " ", "&"}], 
         " ", "/@", " ", "pos"}]}], ";", "\n", "   ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"mat", ",", " ", "ovec"}], "]"}], ";", "\n", "   ", 
       RowBox[{"rk", " ", "=", " ", 
        RowBox[{"MatrixRank", "[", "mat", "]"}]}], ";", "\n", "   ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"rk", ",", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedCollectionQ", "[", "args___", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"WeaklyBalancedCollectionQ", "::", "argerr"}], "]"}], ";", " ", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WeaklyBalancedCollectionQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "WeaklyBalancedCollectionQ", "]"}]}]}], 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimpay", ",", " ", "cc"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "   ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",", 
        "\n", "    ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "3"}]}], 
           ")"}], ",", "\n", "      ", 
          RowBox[{
           RowBox[{"cc", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"WeaklyBalancedCollMainQ", "[", 
               RowBox[{"game", ",", " ", "#", ",", " ", "opts"}], "]"}], " ", 
              "&"}], " ", "/@", " ", "payoff"}]}], ";", " ", 
           RowBox[{"Simplify", "[", "cc", "]"}]}], ",", "\n", "      ", 
          "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",", 
        "\n", "       ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           ")"}], ",", "\n", "       ", 
          RowBox[{
           RowBox[{"cc", " ", "=", " ", 
            RowBox[{"WeaklyBalancedCollMainQ", "[", 
             RowBox[{"game", ",", " ", "payoff", ",", " ", "opts"}], "]"}]}], 
           ";", " ", 
           RowBox[{"Simplify", "[", "cc", "]"}]}], ",", "\n", "       ", 
          "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"97783a9c-cee4-4a6c-b2fc-c1415e815e82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WeaklyBalancedCollMainQ", "[", 
     RowBox[{"game_", ",", " ", "payoff_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "WeaklyBalancedCollectionQ", "]"}]}]}], 
     "]"}], " ", ":=", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cde", ",", "excp", ",", "b0", ",", "ps0", ",", "jcl", ",", "acde", 
        ",", " ", "rkQ", ",", " ", "tk", ",", " ", "lprs"}], "}"}], ",", "\n",
       "   ", 
      RowBox[{
       RowBox[{"excp", "=", 
        RowBox[{"First", "[", 
         RowBox[{"ExcessPayoff", "[", 
          RowBox[{"game", ",", "payoff"}], "]"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"b0", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"excp", ",", "1"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"LessEqual", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ",
             "b0"}]}], "]"}], ",", "True", ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
             RowBox[{"v", "[", "T", "]"}]}], ",", " ", "0"}], "]"}], " ", "&&",
           " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             "payoff"}]}], "]"}]}], ",", " ", "True", ",", " ", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", "   ", 
       RowBox[{"cde", " ", "=", " ", 
        RowBox[{"CollectionOfDecreasingExcess", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"ps0", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Equal", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "#", "]"}], ",", "0"}], "]"}], " ", "&"}], "/@",
            " ", "b0"}], ",", "True"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"cde", ",", " ", 
         RowBox[{"{", "}"}]}], "]"}], ";", "\n", "   ", 
       RowBox[{"jcl", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"#", ",", " ", "ps0"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "cde"}]}], ";", "\n", "   ", 
       RowBox[{"cde", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", "#", "]"}], " ", "&"}], " ", "/@", 
         " ", "jcl"}]}], ";", "\n", "   ", 
       RowBox[{"acde", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FlattenAt", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"{", "#", "}"}], ",", " ", "T"}], "]"}], ",", " ", 
            "1"}], "]"}], " ", "&"}], " ", "/@", " ", "cde"}]}], ";", "\n", 
       "   ", 
       RowBox[{"rkQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"RankConQ", "[", 
           RowBox[{"#", ",", " ", "T"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "acde"}]}], ";", "\n", "   ", 
       RowBox[{"tk", " ", "=", " ", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"rkQ", ",", " ", "True"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"lprs", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"WeaklyBalancedSystemQ", "[", 
           RowBox[{"#", ",", " ", "ps0", ",", "T", ",", "opts"}], "]"}], " ", 
          "&"}], " ", "/@", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"acde", ",", " ", "tk"}], "]"}]}]}], ";", " ", "\n", "   ", 
       
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "lprs"}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}]], "Code",ExpressionUUID->"26dec2af-7dfd-45d3-8bf3-14fd86bd12ce"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Nucleolus", "/", "Kernel"}], " ", "section", " ", "ends"}], " ", 
  "*)"}]], "Code",ExpressionUUID->"f18f3d42-e143-407b-88a9-277e68ddd631"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Kernel", " ", "section", " ", "starts"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContributionVector", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SmallestContributionVector", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContributionVector", "[", "game_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"SmallestContribution", "[", 
        RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
      "T"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContribution", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"SmallestContribution", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SmallestContribution", "[", 
      RowBox[{"game_", ",", " ", "i_Integer"}], "]"}], ":=", "\n", "  ", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "i"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Take", "[", " ", 
        RowBox[{
         RowBox[{"W", "[", "i", "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"W", "[", "i", "]"}], "]"}], "-", "1"}], ")"}]}]}], 
        "]"}]}], "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"b4379036-7914-\
4d4e-9006-2e64b3fd3608"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Scrb", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Scrb", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Scrb", "[", 
     RowBox[{"game_", ",", " ", "i_Integer"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"UpperPayoff", "[", 
      RowBox[{"game", ",", "i"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "T", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
        RowBox[{"Total", "[", 
         RowBox[{"UpperVector", "[", "game", "]"}], "]"}]}], ")"}]}]}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScrbSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ScrbSolution", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScrbSolution", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Scrb", "[", 
        RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", ")"}], " ", "/@", 
     " ", "T"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Computing", " ", "the", " ", "Kernel", " ", "by", " ", "a", " ", 
     "convergence", " ", "algorithm", " ", "due", " ", "to", " ", "Maschler", 
     " ", "see", " ", "Stearns", " ", 
     RowBox[{"(", "1968", ")"}], " ", "\n", "or", " ", 
     RowBox[{"U", ".", " ", "Faigle"}]}], ",", " ", 
    RowBox[{
     RowBox[{"W", ".", " ", "Kern"}], " ", "and", " ", 
     RowBox[{"J", ".", " ", "Kuipers"}], " ", 
     RowBox[{"(", "1998", ")"}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindPreKernelSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FindPreKernelSolution", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindPreKernelSolution", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "FindPreKernelSolution", "]"}]}]}], 
    "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pay", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"FindPreKernelSolution", "[", 
       RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
    "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"27f51043-fa61-4b80-bde2-\
b3ef0fc5c65e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindPreKernelSolution", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "FindPreKernelSolution", "]"}]}]}], 
     "]"}], ":=", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "prec", ",", "rattol", ",", "reclim", ",", "setprk", ",", "sil", ",", 
        "res"}], "}"}], ",", "\n", "       ", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{"$RecursionLimit", "::", "reclim"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Switching", " ", "off", " ", "all", " ", "warnings", " ", "that", 
         " ", "reclim", " ", "is", " ", "exceeded"}], " ", "*)"}], "\n", 
       "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"General", "::", "stop"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"MapThread", "::", "mptd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"MapThread", "::", "list"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"ReplaceAll", "::", "reps"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Extract", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "partw"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "pspec"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "partd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"ReplacePart", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"prec", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DigitPrecision", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"reclim", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SetRecursionLimit", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "       ", 
       RowBox[{"setprk", " ", "=", " ", "Global`PRK"}], ";", "\n", "       ", 
       
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$RecursionLimit", " ", "=", " ", "reclim"}], "}"}], ",", 
          "\n", "             ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "3"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"KernelSolution", "[", 
               RowBox[{
               "game", ",", "#", ",", "prec", ",", "rattol", ",", "setprk", 
                ",", "sil"}], "]"}], " ", "&"}], "/@", " ", "payoff"}], ",", 
            "\n", "                   ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "2"}], 
            ",", " ", 
            RowBox[{"KernelSolution", "[", 
             RowBox[{
             "game", ",", "payoff", ",", "prec", ",", "rattol", ",", "setprk",
               ",", "sil"}], "]"}], ",", "\n", "                   ", "True", 
            ",", " ", 
            RowBox[{"DisplayMessFindKernel", "[", "payoff", "]"}]}], "]"}]}], 
         "]"}]}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"$RecursionLimit", "::", "reclim"}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Switching", " ", "on", " ", "all", " ", "warnings", " ", "that", " ",
          "have", " ", "been", " ", "turned", " ", "off"}], " ", "*)"}], "\n",
        "       ", 
       RowBox[{"On", "[", 
        RowBox[{"General", "::", "stop"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"MapThread", "::", "mptd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"MapThread", "::", "list"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"ReplaceAll", "::", "reps"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Extract", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "partw"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "pspec"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "partd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"ReplacePart", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "2"}], ",", 
          " ", "res", ",", "\n", "             ", 
          RowBox[{
           RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "3"}], ",", 
          " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "res", "]"}], " ", "===", " ", "1"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"DisplayMessReclim", "[", "reclim", "]"}], ";", " ", 
             RowBox[{"First", "[", "res", "]"}]}], ",", " ", "res"}], "]"}], 
          ",", " ", "\n", "             ", "True", ",", " ", "res"}], "]"}]}],
        ";", "\n", "       ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "2"}], ",", " ", 
         RowBox[{"Flatten", "[", "res", "]"}], ",", "\n", "             ", 
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "3"}], ",", " ", 
         RowBox[{"SolutionSelection", "[", 
          RowBox[{"game", ",", "res"}], "]"}], ",", "\n", "             ", 
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "4"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SolutionSelection", "[", 
                RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], ",", " ", 
              "#"}], "]"}], " ", "&"}], " ", "/@", " ", "res"}], ";", 
          RowBox[{"Union", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Union", "[", "res", "]"}], "]"}], "]"}]}], ",", "\n", 
         "             ", "True", ",", " ", "res"}], "\n", "       ", 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindKernelSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FindKernelSolution", "::", "argerr"}], "]"}], ";", "$Failed"}],
     ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindKernelSolution", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "FindKernelSolution", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pay", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"FindKernelSolution", "[", 
       RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"6131d3be-ce73-4f5f-b0b8-\
0f3f07000a27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindKernelSolution", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "FindKernelSolution", "]"}]}]}], "]"}], 
    ":=", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "prec", ",", "rattol", ",", "reclim", ",", "setker", ",", "sil", ",", 
        "res"}], "}"}], ",", "\n", "       ", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{"$RecursionLimit", "::", "reclim"}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Switching", " ", "off", " ", "all", " ", "warnings", " ", "that", 
         " ", "reclim", " ", "is", " ", "exceeded"}], " ", "*)"}], "\n", 
       "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"General", "::", "stop"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"MapThread", "::", "mptd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"MapThread", "::", "list"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"ReplaceAll", "::", "reps"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Extract", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "partw"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "pspec"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"Part", "::", "partd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"Off", "[", 
        RowBox[{"ReplacePart", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"prec", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DigitPrecision", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"reclim", " ", "=", "  ", 
        RowBox[{"OptionValue", "[", "SetRecursionLimit", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "       ", 
       RowBox[{"setker", " ", "=", " ", "Global`KER"}], ";", "\n", "       ", 
       
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$RecursionLimit", " ", "=", " ", "reclim"}], "}"}], ",", 
          "\n", "             ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "3"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"KernelSolution", "[", 
               RowBox[{
               "game", ",", "#", ",", "prec", ",", "rattol", ",", "setker", 
                ",", "sil"}], "]"}], " ", "&"}], "/@", " ", "payoff"}], ",", 
            "\n", "                   ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "2"}], 
            ",", " ", 
            RowBox[{"KernelSolution", "[", 
             RowBox[{
             "game", ",", "payoff", ",", "prec", ",", "rattol", ",", "setker",
               ",", "sil"}], "]"}], ",", "\n", "                   ", "True", 
            ",", " ", 
            RowBox[{"DisplayMessFindKernel", "[", "payoff", "]"}]}], "]"}]}], 
         "]"}]}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"$RecursionLimit", "::", "reclim"}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Switching", " ", "on", " ", "all", " ", "warnings", " ", "that", " ",
          "have", " ", "been", " ", "turned", " ", "off"}], " ", "*)"}], "\n",
        "       ", 
       RowBox[{"On", "[", 
        RowBox[{"General", "::", "stop"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"MapThread", "::", "mptd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"MapThread", "::", "list"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"ReplaceAll", "::", "reps"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Extract", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "partw"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "pspec"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "partd"}], "]"}], ";", "\n", "       ", 
       RowBox[{"On", "[", 
        RowBox[{"ReplacePart", "::", "psl"}], "]"}], ";", "\n", "       ", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "2"}], ",", 
          " ", "res", ",", "\n", "             ", 
          RowBox[{
           RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "3"}], ",", 
          " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "res", "]"}], " ", "===", " ", "1"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"DisplayMessReclim", "[", "reclim", "]"}], ";", " ", 
             RowBox[{"First", "[", "res", "]"}]}], ",", " ", "res"}], "]"}], 
          ",", " ", "\n", "             ", 
          RowBox[{
           RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "4"}], ",", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "#", "]"}], " ", "===", " ", "1"}], ",", 
              " ", 
              RowBox[{
               RowBox[{"DisplayMessReclim", "[", "reclim", "]"}], ";", " ", 
               RowBox[{"First", "[", "#", "]"}]}], ",", " ", "#"}], "]"}], 
            "&"}], "/@", " ", "res"}], ",", " ", "\n", "             ", 
          "True", ",", " ", "res"}], "]"}]}], ";", "\n", "       ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "2"}], ",", " ", 
         RowBox[{"Flatten", "[", "res", "]"}], ",", "\n", "             ", 
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "3"}], ",", " ", 
         RowBox[{"SolutionSelection", "[", 
          RowBox[{"game", ",", "res"}], "]"}], ",", "\n", "             ", 
         RowBox[{
          RowBox[{"Depth", "[", "res", "]"}], " ", "==", " ", "4"}], ",", " ", 
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"SolutionSelection", "[", 
                 RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], ",", " ", 
               "#"}], "]"}], " ", "&"}], " ", "/@", " ", "res"}]}], ";", 
          RowBox[{"Union", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Union", "[", "res", "]"}], "]"}], "]"}]}], ",", "\n", 
         "             ", "True", ",", " ", "res"}], "\n", "       ", 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolutionSelection", "[", 
     RowBox[{"game_", ",", "payoff_List"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bool", ",", "pos", ",", "lsg"}], "}"}], ",", "\n", 
      "         ", 
      RowBox[{
       RowBox[{"bool", " ", "=", " ", 
        RowBox[{"KernelImputationListQ", "[", 
         RowBox[{"game", ",", "payoff"}], "]"}]}], ";", "\n", "         ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"bool", ",", "True"}], "]"}]}], ";", "\n", "         ", 
       RowBox[{"lsg", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "===", "0"}], ",", "payoff", 
          ",", 
          RowBox[{"Extract", "[", 
           RowBox[{"payoff", ",", "pos"}], "]"}]}], "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lsg", "]"}], "===", "1"}], ",", 
         RowBox[{"Flatten", "[", "lsg", "]"}], ",", "True", ",", "lsg"}], 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelSolution", "[", 
     RowBox[{
     "game_", ",", " ", "payoff_List", ",", " ", "prec_", ",", "rattol_", ",",
       "setk_", ",", "silent_", ",", 
      RowBox[{"payold_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"payvec", ",", " ", 
        RowBox[{"pold", "=", "payold"}], ",", "approx", ",", "ratnum"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"payvec", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"Global`PRK", ",", "setk"}], "]"}], ",", 
          RowBox[{"ConvergenceToKernel", "[", 
           RowBox[{"game", ",", " ", "payoff"}], "]"}], ",", 
          RowBox[{"ConvergenceToKernel2", "[", 
           RowBox[{"game", ",", " ", "payoff"}], "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"pold", " ", "=", " ", "payoff"}], ";", "\n", "    ", 
       RowBox[{"approx", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"payvec", ",", " ", "prec"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"silent", ",", "False"}], "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ConvergingQ: \>\"", ",", 
           RowBox[{"N", "[", 
            RowBox[{"pold", ",", "prec"}], "]"}]}], "]"}], ",", "True", ",", 
         "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"ratnum", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{"approx", ",", "rattol"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "payvec", "]"}], "<=", "3"}], ",", " ", "\n", 
         "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"Global`PRK", ",", "setk"}], "]"}], ",", " ", "\n", 
           "            ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"Or", ",", 
                RowBox[{"PreKernelQ", "[", 
                 RowBox[{"game", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"pold", ",", "ratnum"}], "}"}]}], "]"}]}], "]"}], 
              " ", "===", " ", "False"}], ",", " ", "\n", 
             "                  ", 
             RowBox[{"KernelSolution", "[", 
              RowBox[{
              "game", ",", " ", "payvec", ",", " ", "prec", ",", " ", 
               "rattol", ",", "setk", ",", "silent", ",", "ratnum"}], "]"}], 
             ",", "\n", "           ", "True", ",", " ", 
             RowBox[{"Union", "[", 
              RowBox[{"{", 
               RowBox[{"payvec", ",", "ratnum"}], "}"}], "]"}]}], "]"}], ",", 
           "\n", "            ", 
           RowBox[{"SameQ", "[", 
            RowBox[{"Global`KER", ",", "setk"}], "]"}], ",", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"Or", ",", 
                RowBox[{"KernelImputationListQ", "[", 
                 RowBox[{"game", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"pold", ",", "ratnum"}], "}"}]}], "]"}]}], "]"}], 
              " ", "===", " ", "False"}], ",", " ", "\n", 
             "                  ", 
             RowBox[{"KernelSolution", "[", 
              RowBox[{
              "game", ",", " ", "payvec", ",", " ", "prec", ",", " ", 
               "rattol", ",", "setk", ",", "silent", ",", "ratnum"}], "]"}], 
             ",", "\n", "           ", "True", ",", " ", 
             RowBox[{"Union", "[", 
              RowBox[{"{", 
               RowBox[{"payvec", ",", "ratnum"}], "}"}], "]"}]}], "]"}], ",", 
           "True", ",", " ", 
           RowBox[{"Union", "[", 
            RowBox[{"{", 
             RowBox[{"payvec", ",", "ratnum"}], "}"}], "]"}]}], "]"}], ",", 
         "\n", "      ", 
         RowBox[{"{", 
          RowBox[{"pold", ",", "1"}], "}"}]}], "\n", "     ", "]"}]}]}], "\n",
      "    ", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", "\n", "   ", 
   RowBox[{
    RowBox[{
    "Computing", " ", "the", " ", "Kernel", " ", "by", " ", "a", " ", 
     "convergence", " ", "algorithm", " ", "due", " ", "to", " ", "Stearns", 
     " ", 
     RowBox[{"(", "1968", ")"}]}], ",", " ", 
    RowBox[{
    "see", " ", "also", " ", "Algorithm", " ", "8.7", ".3", "\n", "   ", "of",
      " ", "Meinhardt", " ", 
     RowBox[{"(", "2013", ")"}]}]}], " ", "\n", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvergenceToKernel2", "[", 
     RowBox[{"game_", ",", "payoff_List"}], "]"}], " ", ":=", "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "survec", ",", "rsrv", ",", "surpl", ",", "stdel", ",", "pairs", ",", 
        "dps", ",", "prij", ",", "vc", ",", "rlp", ",", "nip", ",", "mn", ",",
         "trQ", ",", "dl", ",", "delta", ",", "idm", ",", "slp", ",", "sps", 
        ",", "pij"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"survec", " ", "=", " ", 
        RowBox[{"MaxSurpluses", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"rsrv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "survec"}]}], ";", "\n", "    ", 
       RowBox[{"survec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"survec", ",", "rsrv"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"surpl", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"List", " ", "->", " ", "Subtract"}]}], "]"}], " ", "&"}],
          " ", "/@", " ", "survec"}]}], ";", "\n", "    ", 
       RowBox[{"stdel", "=", 
        RowBox[{"Min", "[", "surpl", "]"}]}], ";", "\n", "    ", 
       RowBox[{"pairs", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"listIJ", "[", "T", "]"}], ",", 
             RowBox[{"listJI", "[", "T", "]"}]}], "}"}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"dps", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"surpl", ",", "stdel"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"prij", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"pairs", ",", "dps"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], "/@", " ", "T"}]}], ";", 
       "\n", "    ", 
       RowBox[{"rlp", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"vc", ",", "payoff"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"nip", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", "#", "]"}], " ", "-", " ", 
             RowBox[{"v", "[", 
              RowBox[{"{", "#", "}"}], "]"}]}], ")"}], " ", "&"}], "/@", " ", 
          "T"}], " ", "/.", " ", "rlp"}]}], ";", "\n", "    ", 
       RowBox[{"mn", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Negative", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         "nip"}]}], ";", "\n", "    ", 
       RowBox[{"trQ", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", "mn"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"trQ", "==", "True"}], ",", "\n", "            ", 
         RowBox[{
          RowBox[{"slp", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"mn", ",", "True"}], "]"}], " ", "//", " ", 
            "Flatten"}]}], ";", "\n", "            ", 
          RowBox[{"sps", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"pairs", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"slp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "___"}], "}"}]}], 
            "]"}]}], ";", "\n", "            ", 
          RowBox[{"pij", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{"sps", ",", "prij"}], "]"}]}], ";", "\n", "            ", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"pij", ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", 
            RowBox[{"pij", "=", 
             RowBox[{"Last", "[", "prij", "]"}]}], ",", 
            RowBox[{"pij", "=", 
             RowBox[{"Last", "[", "pij", "]"}]}]}], "]"}]}], ",", 
         RowBox[{"pij", "=", 
          RowBox[{"Last", "[", "prij", "]"}]}]}], "]"}], ";", "\n", "    ", 
       RowBox[{"dl", "=", 
        RowBox[{"Last", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nip", "[", 
            RowBox[{"[", "#", "]"}], "]"}], " ", "&"}], "/@", " ", "pij"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"delta", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Less", "[", 
           RowBox[{"dl", ",", 
            RowBox[{"stdel", "/", "2"}]}], "]"}], ",", "dl", ",", 
          RowBox[{"stdel", "/", "2"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"idm", " ", "=", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "T", "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"payoff", " ", "+", " ", 
        RowBox[{"delta", "*", 
         RowBox[{"Extract", "[", 
          RowBox[{"idm", ",", " ", 
           RowBox[{"pij", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", "-", " ", 
        RowBox[{"delta", "*", 
         RowBox[{"Extract", "[", 
          RowBox[{"idm", ",", " ", 
           RowBox[{"pij", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}]}], "\t   ", "\n", 
     "    ", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Computing", " ", "the", " ", 
     RowBox[{"(", 
      RowBox[{"Pre", "-"}], ")"}], "Kernel", " ", "by", " ", "a", " ", 
     "convergence", " ", "algorithm", " ", "due", " ", "to", " ", 
     RowBox[{"U", ".", " ", "Faigle"}]}], ",", " ", 
    RowBox[{
     RowBox[{"W", ".", " ", "Kern"}], " ", "and", " ", 
     RowBox[{"J", ".", " ", "Kuipers"}], " ", 
     RowBox[{"(", "1998", ")"}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvergenceToKernel", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
    "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "survec", ",", " ", "surpl", ",", " ", "deltavec", ",", " ", "soldel", 
        ",", " ", "maxdel", ",", " ", "posmdel", ",", " ", "minpos", ",", " ",
         "solvec", ",", "\n", "      ", "plpair", ",", " ", "extr", ",", " ", 
        "trfij", ",", " ", "numval", ",", " ", "travec", ",", " ", "nwpay", 
        ",", " ", "mp"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"survec", " ", "=", " ", 
        RowBox[{"MaxSurpluses", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"surpl", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"List", " ", "->", " ", "Subtract"}]}], "]"}], " ", "&"}],
          " ", "/@", " ", "survec"}]}], ";", "\n", "    ", 
       RowBox[{"deltavec", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "2"}], " ", "Global`\[Alpha]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "surpl", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"soldel", " ", "=", " ", "\n", "      ", 
        RowBox[{"MapThread", "[", "\n", "        ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Rationalize", "[", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"#1", " ", "==", " ", "#2"}], ",", " ", 
               "Global`\[Alpha]"}], "]"}], "]"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"surpl", ",", " ", "\n", "          ", "deltavec"}], 
           "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"solvec", " ", "=", " ", 
        RowBox[{"Global`\[Alpha]", " ", "/.", " ", "soldel"}]}], ";", "\n", 
       "    ", 
       RowBox[{"maxdel", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"Abs", "[", "solvec", "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"posmdel", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "solvec", "]"}], ",", " ", "maxdel"}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"minpos", " ", "=", " ", 
        RowBox[{"Min", "[", "posmdel", "]"}]}], ";", "\n", "    ", 
       RowBox[{"plpair", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"listIJ", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"extr", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"plpair", ",", " ", "minpos"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"trfij", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"payoff", ",", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", " ", "extr"}], "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"numval", " ", "=", " ", 
        RowBox[{
         RowBox[{"Flatten", "[", "posmdel", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"travec", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"solvec", "[", 
            RowBox[{"[", "numval", "]"}], "]"}]}], ",", " ", 
          RowBox[{"solvec", "[", 
           RowBox[{"[", "numval", "]"}], "]"}]}], "}"}]}], ";", "\n", "    ", 
       
       RowBox[{"nwpay", " ", "=", " ", 
        RowBox[{"trfij", " ", "+", " ", "travec"}]}], ";", "\n", "    ", 
       RowBox[{"mp", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"List", ",", 
          RowBox[{"{", 
           RowBox[{"nwpay", ",", "extr"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Rp", "[", 
        RowBox[{
         RowBox[{"Rp", "[", 
          RowBox[{"payoff", ",", 
           RowBox[{"mp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"mp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"mp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"mp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], "\n", "    ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Rp", "[", 
    RowBox[{"vec_", ",", " ", "nwcom_", ",", " ", "posi_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"vec", ",", " ", "nwcom", ",", " ", "posi"}], "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"238105e3-28ed-4208-af31-d4e02049890d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Auxiliary", " ", "functions", " ", "to", " ", "construct", " ", "the", " ", 
   RowBox[{"(", 
    RowBox[{"n", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ")"}], " ", "initial", 
   " ", "LPs", " ", "for", " ", 
   RowBox[{"KernelCalculation", "[", "]"}]}], " ", "*)"}]], "Code",ExpressionU\
UID->"838d1712-005e-4237-9e80-7c35d49604e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelRat", "[", 
     RowBox[{
     "i_Integer", ",", " ", "j_Integer", ",", " ", "Global`\[Delta]_", ",", 
      " ", 
      RowBox[{"eps_", ":", "0"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "#", "]"}], " ", "+", " ", "Global`\[Delta]"}], " ",
        ">=", " ", 
       RowBox[{"v", "[", "#", "]"}]}], "  ", "&"}], " ", "/@", " ", 
     RowBox[{"TIJsets", "[", 
      RowBox[{"i", ",", " ", "j"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferConstraints", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"TransferConstraints", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TransferConstraints", "[", 
    RowBox[{"game_", ",", " ", "i_Integer", ",", " ", "j_Integer", ",", " ", 
     RowBox[{"eps_", ":", "0"}]}], "]"}], " ", ":=", " ", "\n", "    ", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Core", "[", "game", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DelRat", "[", 
         RowBox[{"i", ",", " ", "j", ",", " ", 
          RowBox[{"-", "Global`\[Delta]"}], ",", " ", "eps"}], "]"}], ",", 
        " ", "\n", "           ", 
        RowBox[{"DelRat", "[", 
         RowBox[{"j", ",", " ", "i", ",", " ", 
          RowBox[{"-", "Global`\[Delta]"}], ",", " ", "eps"}], "]"}], ",", 
        " ", "\n", "           ", "delconst"}], "}"}]}], "]"}], " ", "//", 
    " ", "Flatten"}]}], ";"}]}], "Code",ExpressionUUID->"c32766c1-00a9-498e-\
b9aa-1c36640c5cbc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DeltaLP", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DeltaLP", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaLP", "[", 
     RowBox[{
     "game_", ",", " ", "i_Integer", ",", " ", "j_Integer", ",", " ", 
      RowBox[{"eps_", ":", "0"}], ",", " ", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "DeltaLP", "]"}]}]}], "]"}], " ", ":=", 
    "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"changesolver", ",", "mthd"}], "}"}], ",", "\n", 
      "             ", 
      RowBox[{
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"changesolver", "=", 
        RowBox[{"OptionValue", "[", "CallMaximize", "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"DeltaLP", "[", 
        RowBox[{
        "game", ",", " ", "i", ",", " ", "j", ",", " ", "eps", ",", 
         "changesolver", ",", 
         RowBox[{"Method", "->", "mthd"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaLP", "[", 
     RowBox[{
     "game_", ",", " ", "i_Integer", ",", " ", "j_Integer", ",", " ", 
      RowBox[{"eps_", ":", "0"}], ",", " ", 
      RowBox[{"changesolver_", ":", "False"}], ",", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "DeltaLP", "]"}]}]}], "]"}], " ", ":=", 
    "\n", "   ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "mthd", "}"}], ",", "\n", "        ", 
      RowBox[{
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "        ", 
       
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"changesolver", "==", "False"}], ",", " ", "\n", 
         "                             ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"zf", ",", "res"}], "}"}], "=", 
           RowBox[{"LinearOptimization", "[", 
            RowBox[{
             RowBox[{"-", "Global`\[Delta]"}], ",", " ", 
             RowBox[{"Union", "[", 
              RowBox[{"TransferConstraints", "[", 
               RowBox[{
               "game", ",", " ", "i", ",", " ", "j", ",", " ", "eps"}], "]"}],
               "]"}], ",", " ", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", 
               RowBox[{"{", "Global`\[Delta]", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
              "}"}], ",", " ", 
             RowBox[{"Method", "->", "mthd"}]}], "]"}]}], ";", "\n", 
          "                             ", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"zf", ",", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", 
                   RowBox[{"{", "Global`\[Delta]", "}"}]}], "]"}], ",", 
                 "res"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ",", "\n", 
         "              ", "True", ",", " ", "\n", "                  ", 
         RowBox[{"Chop", "[", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"NMaximize", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Union", "[", 
                 RowBox[{"TransferConstraints", "[", 
                  RowBox[{
                  "game", ",", " ", "i", ",", " ", "j", ",", " ", "eps"}], 
                  "]"}], "]"}], "}"}], ",", "Global`\[Delta]"}], "]"}], ",", 
             " ", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", 
               RowBox[{"{", "Global`\[Delta]", "}"}]}], "]"}], ",", 
             RowBox[{"Method", "->", "mthd"}]}], "]"}], "]"}], "]"}]}], 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"delconst", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Global`\[Delta]", " ", ">=", "  ", "0"}], "}"}]}], 
  ";"}]}], "Code",ExpressionUUID->"87a21ec0-2fb5-440e-998a-3dd90dcef7f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pay", " ", "=", " ", 
    RowBox[{"x", " ", "/@", " ", "T"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Transfer", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Transfer", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transfer", "[", 
     RowBox[{
     "y_List", ",", " ", "T_List", ",", " ", "d_", ",", " ", "i_Integer", ",",
       " ", "j_Integer"}], "]"}], " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "idmat", "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"idmat", " ", "=", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "T", "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", " ", "/@", " ", "T"}], " ", "/.", " ", 
          RowBox[{"Payoff", "[", "y", "]"}]}], ")"}], " ", "-", " ", 
        RowBox[{"d", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"idmat", ",", " ", "i"}], "]"}]}], " ", "+", " ", 
        RowBox[{"d", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"idmat", ",", " ", "j"}], "]"}]}]}]}]}], "\n", "   ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxDeltaij", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"eps_", ":", "0"}], ",", "changesolver_"}], "]"}], " ", ":=", 
    " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"anf", " ", "=", " ", "T"}], ",", " ", "rest", ",", " ", "pi",
         ",", " ", "pj", ",", " ", 
        RowBox[{"erg", " ", "=", " ", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\n", "    ", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "anf", "]"}], " ", ">", " ", "1"}], ",", 
         "\n", "      ", 
         RowBox[{
          RowBox[{"pi", " ", "=", " ", 
           RowBox[{"First", "[", "anf", "]"}]}], ";", "\n", "      ", 
          RowBox[{"rest", " ", "=", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"anf", ",", " ", "1"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "rest", "]"}], " ", ">", " ", "0"}], ",", 
            "\n", "        ", 
            RowBox[{
             RowBox[{"pj", " ", "=", " ", 
              RowBox[{"First", "[", "rest", "]"}]}], ";", "\n", "        ", 
             RowBox[{"erg", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"erg", ",", " ", 
                RowBox[{"DeltaLP", "[", 
                 RowBox[{
                 "game", ",", " ", "pi", ",", " ", "pj", ",", " ", "eps", ",",
                   "changesolver"}], "]"}]}], "]"}]}], ";", "\n", "        ", 
             
             RowBox[{"rest", " ", "=", " ", 
              RowBox[{"Drop", "[", 
               RowBox[{"rest", ",", " ", "1"}], "]"}]}], ";"}]}], "\n", 
           "        ", "]"}], ";", "\n", "      ", 
          RowBox[{"anf", " ", "=", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"anf", ",", " ", "1"}], "]"}]}], ";"}]}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"Return", "[", "erg", "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TijLoop", "[", "game_", "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"anf", " ", "=", " ", "T"}], ",", " ", "rest", ",", " ", "pi", 
       ",", " ", "pj", ",", " ", 
       RowBox[{"menge", " ", "=", " ", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "anf", "]"}], " ", ">", " ", "1"}], ",", "\n",
         "      ", 
        RowBox[{
         RowBox[{"pi", " ", "=", " ", 
          RowBox[{"First", "[", "anf", "]"}]}], ";", "\n", "      ", 
         RowBox[{"rest", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"anf", ",", " ", "1"}], "]"}]}], ";", "\n", "      ", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "rest", "]"}], " ", ">", " ", "0"}], ",", 
           "\n", "        ", 
           RowBox[{
            RowBox[{"pj", " ", "=", " ", 
             RowBox[{"First", "[", "rest", "]"}]}], ";", "\n", "        ", 
            RowBox[{"menge", " ", "=", " ", 
             RowBox[{"Flatten", "[", "\n", "        ", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"menge", ",", " ", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{"TIJsets", "[", 
                    RowBox[{"pi", ",", " ", "pj"}], "]"}], ",", " ", 
                   RowBox[{"TIJsets", "[", 
                    RowBox[{"pj", ",", " ", "pi"}], "]"}]}], "]"}]}], "]"}], 
               ",", " ", "0"}], "]"}]}], ";", "\n", "        ", 
            RowBox[{"rest", " ", "=", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"rest", ",", " ", "1"}], "]"}]}], ";"}]}], "\n", 
          "        ", "]"}], ";", "\n", "      ", 
         RowBox[{"anf", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"anf", ",", " ", "1"}], "]"}]}], ";"}]}], "]"}], ";", "\n",
       "    ", 
      RowBox[{"Return", "[", "menge", "]"}]}]}], "]"}]}], ";"}]}], "Code",Expr\
essionUUID->"9001e4ee-ea2c-4bb0-8e2e-008b28781d15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewIneq", "[", 
     RowBox[{"ineq_", ",", " ", "param_", ",", " ", "liste_"}], "]"}], " ", ":=",
     " ", "\n", "  ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ineq", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lhs_", " ", "<=", " ", "rhs_"}], " ", ":>", " ", "\n", 
         "          ", 
         RowBox[{
          RowBox[{"lhs", " ", "<=", " ", 
           RowBox[{"rhs", " ", "+", " ", 
            RowBox[{"param", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "/;", " ", 
          RowBox[{"rhs", " ", "==", " ", 
           RowBox[{"Min", "[", "liste", "]"}]}]}]}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", 
        RowBox[{"Length", "[", "param", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SortConstraints", "[", 
    RowBox[{"ineq_", ",", " ", "para_"}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pospattern", ",", " ", "rg", ",", "extpos"}], "}"}], ",", " ", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"pospattern", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"ineq", ",", " ", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"ineq", ",", " ", 
            RowBox[{"_.", " ", "+", " ", "para"}], ",", " ", 
            RowBox[{"{", "2", "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"rg", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "pospattern", "]"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"extpos", " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"pospattern", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], " ", "&"}], " ", "/@",
           " ", "rg"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Extract", "[", 
       RowBox[{"ineq", ",", " ", "extpos"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"d504dc15-3d88-4c19-89dc-e6e4635d7ade"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FeasibleConstraints", "[", 
     RowBox[{
     "ineq_", ",", " ", "delta_", ",", "changesolver_", ",", "mthd_"}], "]"}],
     " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newungl", ",", 
        RowBox[{"delexc", " ", "=", " ", 
         RowBox[{"Sort", "[", "delta", "]"}]}], ",", " ", "creatpara", ",", 
        " ", "redpara", ",", " ", "paramet", ",", " ", "nebenbed", ",", " ", 
        "zf", ",", " ", "fineq", ",", " ", 
        RowBox[{"feasbineq", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", "allineq", ",", " ", "varb", ",", 
        " ", "sol", ",", " ", "resl", ",", " ", "setofineq"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"newungl", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"ineq", ",", " ", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"creatpara", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "#", "]"}], " ", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "delexc", "]"}], ",", 
            RowBox[{"Length", "[", "newungl", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"redpara", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "creatpara", "]"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "delexc", "]"}], " ", ">", " ", "0"}], ",", 
         " ", "\n", "      ", 
         RowBox[{
          RowBox[{"paramet", " ", "=", " ", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"creatpara", ",", " ", "1"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"nebenbed", " ", "=", " ", 
           RowBox[{"NewIneq", "[", 
            RowBox[{"newungl", ",", " ", "paramet", ",", " ", "delexc"}], 
            "]"}]}], ";", "\n", "      ", 
          RowBox[{"fineq", " ", "=", " ", 
           RowBox[{"SortConstraints", "[", 
            RowBox[{"nebenbed", ",", " ", 
             RowBox[{"paramet", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", "      ", 
          
          RowBox[{"feasbineq", " ", "=", " ", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"feasbineq", ",", " ", "fineq"}], "]"}], " ", "//", " ", 
            "Flatten"}]}], ";", "\n", "      ", 
          RowBox[{"creatpara", " ", "=", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"creatpara", ",", " ", "1"}], "]"}]}], ";", "\n", 
          "      ", 
          RowBox[{"delexc", " ", "=", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"delexc", ",", " ", "1"}], "]"}]}], ";"}]}], "\n", 
        "      ", "]"}], ";", "\n", "    ", 
       RowBox[{"allineq", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"feasbineq", ",", " ", 
             RowBox[{"Last", "[", "ineq", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"varb", " ", "=", " ", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", "redpara"}], "]"}], 
         " ", "//", " ", "Flatten"}]}], ";", "\n", "    ", 
       RowBox[{"zf", " ", "=", " ", 
        RowBox[{"Total", "[", "redpara", "]"}]}], ";", "\n", "    ", 
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"changesolver", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"LinearOptimization", "[", 
           RowBox[{"zf", ",", " ", "allineq", ",", " ", "varb", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
             "}"}], ",", 
            RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", " ", 
          RowBox[{"(*", "RevisedSimplex", " ", "*)"}], "\n", 
          "                ", "True", ",", " ", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"NMinimize", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"{", "allineq", "}"}], ",", "zf"}], "]"}], ",", " ", 
             "varb", ",", 
             RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], "]"}]}], "]"}]}],
        ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"changesolver", ",", "False"}], "]"}], ",", 
         RowBox[{"sol", "=", 
          RowBox[{"{", 
           RowBox[{"zf", ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"varb", ",", 
                RowBox[{"Last", "[", "sol", "]"}]}], "}"}]}], "]"}]}], 
           "}"}]}], ",", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"resl", " ", "=", " ", 
        RowBox[{
         RowBox[{"x", " ", "/@", " ", "T"}], " ", "/.", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "    ", 
       RowBox[{"setofineq", " ", "=", " ", 
        RowBox[{"allineq", " ", "/.", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"sol", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{"-", 
            RowBox[{"Length", "[", "redpara", "]"}]}]}], "]"}]}]}], ";", "\n",
        "    ", 
       RowBox[{"{", 
        RowBox[{"resl", ",", " ", "setofineq"}], "}"}]}]}], "\n", " ", 
     "]"}]}], ";"}], "\n", "\n"}]], "Code",ExpressionUUID->"4568a1b2-3671-\
4146-9be7-175dbdfc2f73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NewConstraints", "[", 
    RowBox[{"sets_", ",", " ", "constraints_", ",", " ", "del_", ",", " ", 
     RowBox[{"eps_", ":", "0"}]}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Tijsys", ",", " ", "delta", ",", " ", 
       RowBox[{"dij", " ", "=", " ", "del"}], ",", " ", 
       RowBox[{"mengsys", " ", "=", " ", "sets"}], ",", " ", "exccon", ",", 
       " ", 
       RowBox[{"const", " ", "=", " ", "constraints"}]}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dij", "]"}], " ", ">", " ", "0"}], ",", "\n",
         "      ", 
        RowBox[{
         RowBox[{"delta", " ", "=", " ", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"dij", ",", " ", "1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "      ", 
         RowBox[{"Tijsys", " ", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"mengsys", ",", " ", "1"}], "]"}]}], ";", "\n", "      ", 
         RowBox[{"exccon", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
              RowBox[{"x", "[", "#", "]"}]}], " ", "<=", " ", 
             RowBox[{"-", "delta"}]}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Tijsys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "      ", 
         RowBox[{"const", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"const", ",", " ", "exccon"}], "]"}]}], ";", "\n", 
         "      ", 
         RowBox[{"dij", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"dij", ",", " ", "1"}], "]"}]}], ";", "\n", "      ", 
         RowBox[{"mengsys", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"mengsys", ",", " ", "1"}], "]"}]}]}]}], "]"}], ";", " ", 
      "\n", "      ", 
      RowBox[{"Return", "[", "const", "]"}]}]}], "]"}]}], ";"}]], "Code",Expre\
ssionUUID->"4ccdc512-6219-4cdc-80c0-da186116ff4e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Auxiliary", " ", "functions", " ", "to", " ", "verify", " ", 
   "balancedness", " ", "of", " ", "the", " ", "excess", " ", "vector"}], " ",
   "*)"}]], "Code",ExpressionUUID->"0fb30886-19b4-4a6b-a378-e0dc6d09cb42"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckBalancedness", "[", 
    RowBox[{"game_", ",", " ", "pay_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", " ", "balancedQ", "}"}], ",", "\n", "    ", 
     RowBox[{"balancedQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MaxExcessBalanced", "[", 
        RowBox[{"newgame", ",", " ", "pay"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",Expre\
ssionUUID->"9fff01f8-cc2e-41d1-99fa-2650554a889c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssgPay", "[", "payoff_List", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "vars", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"vars", ",", " ", "payoff"}], "}"}]}], "]"}]}]}], "\n", 
     "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxExcess", "[", 
    RowBox[{"mgij_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxExc", "[", 
      RowBox[{"#", ",", " ", "asspay"}], "]"}], " ", "&"}], " ", "/@", " ", 
    "mgij"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinExcess", "[", 
     RowBox[{"mgij_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"MinExc", "[", 
       RowBox[{"#", ",", " ", "asspay"}], "]"}], " ", "&"}], " ", "/@", " ", 
     "mgij"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxExc", "[", 
    RowBox[{"mg_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Max", "[", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
          RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
       "mg"}], ",", " ", "asspay"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinExc", "[", 
     RowBox[{"mg_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Min", "[", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
           RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
        "mg"}], ",", " ", "asspay"}], "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConstPlj", "[", 
     RowBox[{"mngij_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IndCont", "[", 
        RowBox[{"#", ",", " ", "asspay"}], "]"}], " ", "&"}], " ", "/@", " ", 
      "mngij"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndCont", "[", 
     RowBox[{"plj_List", ",", " ", "asspay_List"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "#", "]"}], " ", "-", " ", 
         RowBox[{"v", "[", 
          RowBox[{"{", "#", "}"}], "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"{", 
       RowBox[{"Last", "[", "plj", "]"}], "}"}]}], " ", "/.", " ", 
     "asspay"}]}], ";"}], "   "}]}], "Code",ExpressionUUID->"e56482fe-c1ce-\
4729-833c-27935d507e74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxSurplus", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MaxSurplus", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxSurplus", "[", 
    RowBox[{
    "game_", ",", " ", "pi_", ",", " ", "pj_", ",", " ", "payoff_List"}], 
    "]"}], " ", ":=", " ", "\n", "    ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "payass", "}"}], ",", " ", "\n", "      ", 
     RowBox[{
      RowBox[{"payass", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "3"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", " ", "/@", " ", "T"}], ",", "#"}], "}"}]}], "]"}],
            "&"}], " ", "/@", " ", "payoff"}], ",", " ", "\n", 
         "                     ", 
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "2"}], ",", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "/@", " ", "T"}], ",", "payoff"}], "}"}]}], 
          "]"}], ",", "\n", "                     ", "True", ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The input 'payoff' is not a list.\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", "payass", "]"}], " ", "==", " ", "5"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                 RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@",
               " ", 
              RowBox[{"TIJsets", "[", 
               RowBox[{"pi", ",", "pj"}], "]"}]}], ",", "#"}], "]"}], "]"}], 
          " ", "&"}], "/@", " ", "payass"}], ",", "\n", "            ", 
        RowBox[{
         RowBox[{"Depth", "[", "payass", "]"}], " ", "==", " ", "4"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
               RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", 
            " ", 
            RowBox[{"TIJsets", "[", 
             RowBox[{"pi", ",", "pj"}], "]"}]}], ",", "payass"}], "]"}], 
         "]"}], ",", "\n", "            ", "True", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Wrong data format.\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "\n", "      ", "]"}]}],
   ";"}]}], "Code",ExpressionUUID->"ee356409-9f71-456f-9519-02a5553cc275"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModMaxSurplus", "[", 
     RowBox[{"game_", ",", " ", "sij_List", ",", " ", "payass_List"}], "]"}], 
    " ", ":=", " ", "\n", "\t", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "          ", 
      RowBox[{"Max", "[", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
             RowBox[{"x", "[", "#", "]"}]}], " ", "&"}], ",", " ", "sij"}], 
          "]"}], ",", "payass"}], "]"}], "]"}]}], "\n", "      ", "]"}]}], 
   ";"}], "\n"}]], "Code",ExpressionUUID->"19d2ad31-7a5c-42bd-a458-\
a2cfea42cc71"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AntiSurplus", "[", 
    RowBox[{
    "game_", ",", " ", "pi_", ",", " ", "pj_", ",", " ", "payoff_List"}], 
    "]"}], " ", ":=", " ", "\n", "    ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "payass", "}"}], ",", " ", "\n", "      ", 
     RowBox[{
      RowBox[{"payass", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "3"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", " ", "/@", " ", "T"}], ",", "#"}], "}"}]}], "]"}],
            "&"}], " ", "/@", " ", "payoff"}], ",", " ", "\n", 
         "                     ", 
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "2"}], ",", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", " ", "/@", " ", "T"}], ",", "payoff"}], "}"}]}], 
          "]"}], ",", "\n", "                     ", "True", ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The input 'payoff' is not a list.\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", "payass", "]"}], " ", "==", " ", "5"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                 RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@",
               " ", 
              RowBox[{"TIJsets", "[", 
               RowBox[{"pi", ",", "pj"}], "]"}]}], ",", "#"}], "]"}], "]"}], 
          " ", "&"}], "/@", " ", "payass"}], ",", "\n", "            ", 
        RowBox[{
         RowBox[{"Depth", "[", "payass", "]"}], " ", "==", " ", "4"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
               RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", 
            " ", 
            RowBox[{"TIJsets", "[", 
             RowBox[{"pi", ",", "pj"}], "]"}]}], ",", "payass"}], "]"}], 
         "]"}], ",", "\n", "            ", "True", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Wrong data format.\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "\n", "      ", "]"}]}],
   ";"}]], "Code",ExpressionUUID->"33ea1c53-228a-4a5e-830a-6fec8af88490"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModAntiSurplus", "[", 
    RowBox[{"game_", ",", " ", "sij_List", ",", " ", "payass_List"}], "]"}], 
   " ", ":=", " ", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "          ", 
     RowBox[{"Min", "[", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
            RowBox[{"x", "[", "#", "]"}]}], " ", "&"}], ",", " ", "sij"}], 
         "]"}], ",", "payass"}], "]"}], "]"}]}], "\n", "      ", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"737a6664-f634-4938-807b-dbd8247f6db5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaxSurpluses", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
    "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dir", ",", "pli", ",", "plj", ",", "maxpi", ",", "maxpj", ",", 
        "res"}], "}"}], ",", " ", "\n", "      ", 
      RowBox[{
       RowBox[{"dir", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"listIJ", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"pli", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "dir"}]}], 
       ";", "\n", "      ", 
       RowBox[{"plj", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "dir"}]}], 
       ";", "\n", "      ", 
       RowBox[{"maxpi", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MaxSurplus", "[", 
            RowBox[{"game", ",", "#1", ",", "#2", ",", "payoff"}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"pli", ",", "plj"}], "}"}]}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"maxpj", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MaxSurplus", "[", 
            RowBox[{"game", ",", "#1", ",", "#2", ",", "payoff"}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"plj", ",", "pli"}], "}"}]}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"maxpi", ",", "maxpj"}], "}"}]}], "]"}]}]}], "\n", "     ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModMaxSurpluses", "[", 
     RowBox[{
     "game_", ",", " ", "sij_List", ",", " ", "sji_List", ",", 
      "payoff_List"}], "]"}], " ", ":=", " ", "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"payass", ",", "maxpi", ",", "maxpj"}], "}"}], ",", " ", "\n", 
      "      ", 
      RowBox[{
       RowBox[{"maxpi", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ModMaxSurplus", "[", 
            RowBox[{"game", ",", "#", ",", "payoff"}], "]"}], "&"}], ",", 
          "sij"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"maxpj", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ModMaxSurplus", "[", 
            RowBox[{"game", ",", "#", ",", "payoff"}], "]"}], "&"}], ",", 
          "sji"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"maxpi", ",", "maxpj"}], "}"}]}], "]"}]}]}], "\n", "     ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AntiSurpluses", "[", 
    RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", "\n", 
   "    ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dir", ",", "pli", ",", "plj", ",", "minpi", ",", "minpj", ",", "res"}],
       "}"}], ",", " ", "\n", "      ", 
     RowBox[{
      RowBox[{"dir", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"listIJ", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"pli", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "dir"}]}], 
      ";", "\n", "      ", 
      RowBox[{"plj", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "dir"}]}], 
      ";", "\n", "      ", 
      RowBox[{"minpi", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AntiSurplus", "[", 
           RowBox[{"game", ",", "#1", ",", "#2", ",", "payoff"}], "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"pli", ",", "plj"}], "}"}]}], "]"}]}], ";", "\n", "      ", 
      
      RowBox[{"minpj", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AntiSurplus", "[", 
           RowBox[{"game", ",", "#1", ",", "#2", ",", "payoff"}], "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"plj", ",", "pli"}], "}"}]}], "]"}]}], ";", "\n", "      ", 
      
      RowBox[{"MapThread", "[", 
       RowBox[{"List", ",", 
        RowBox[{"{", 
         RowBox[{"minpi", ",", "minpj"}], "}"}]}], "]"}]}]}], "\n", "     ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"68d7fedd-71c1-41b9-a3e1-\
1834dbb52e94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModAntiSurpluses", "[", 
     RowBox[{
     "game_", ",", "sij_List", ",", " ", "sji_List", ",", " ", 
      "payoff_List"}], "]"}], " ", ":=", " ", "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"payass", ",", "minpi", ",", "minpj"}], "}"}], ",", " ", "\n", 
      "      ", 
      RowBox[{
       RowBox[{"minpi", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ModAntiSurplus", "[", 
            RowBox[{"game", ",", "#", ",", "payass"}], "]"}], "&"}], ",", 
          "sij"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"minpj", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ModAntiSurplus", "[", 
            RowBox[{"game", ",", "#", ",", "payass"}], "]"}], "&"}], ",", 
          "sji"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"minpi", ",", "minpj"}], "}"}]}], "]"}]}]}], "\n", "     ", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllMaxSurpluses", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AllMaxSurpluses", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AllMaxSurpluses", "[", 
    RowBox[{"game_", ",", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AllMaxSurpluses", "]"}]}]}], "]"}], ":=",
    " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispmat", ",", "ausz", ",", "sol", ",", "mgij", ",", "mgji", ",", 
       "ergb"}], "}"}], ",", "\n", "     ", 
     RowBox[{
      RowBox[{"dispmat", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayMatrixForm", "]"}]}], ";", "    ", 
      "\n", "     ", 
      RowBox[{"ausz", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "2"}], ",", 
         RowBox[{"{", "payoff", "}"}], ",", "\n", "                  ", 
         RowBox[{
          RowBox[{"Depth", "[", "payoff", "]"}], "==", "3"}], ",", "payoff", 
         ",", "\n", "                  ", "True", ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The input 'payoff' is not a list.\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "     ", 
      RowBox[{"ergb", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MaxSurpluses", "[", 
          RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
        "ausz"}]}], ";", "\n", "     ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dispmat", " ", "==", " ", "False"}], ",", " ", "ergb", ",", 
        " ", "True", ",", " ", 
        RowBox[{"DisplayResult", "[", "ergb", "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"0c2dac2d-7fe7-47af-8f67-\
014d76f1a0b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllAntiSurpluses", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AllAntiSurpluses", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllAntiSurpluses", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AllAntiSurpluses", "]"}]}]}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dispmat", ",", "ausz", ",", "sol", ",", "mgij", ",", "mgji", ",", 
        "ergb"}], "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"dispmat", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayMatrixForm", "]"}]}], ";", "    ",
        "\n", "     ", 
       RowBox[{"ausz", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], "==", "2"}], ",", 
          RowBox[{"{", "payoff", "}"}], ",", "\n", "                  ", 
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], "==", "3"}], ",", "payoff", 
          ",", "\n", "                  ", "True", ",", " ", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<The input 'payoff' is not a list.\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"ergb", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"AntiSurpluses", "[", 
           RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
         "ausz"}]}], ";", "\n", "     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"dispmat", " ", "==", " ", "False"}], ",", " ", "ergb", ",", 
         " ", "True", ",", " ", 
         RowBox[{"DisplayResult", "[", "ergb", "]"}]}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisplayResult", "[", "payoff_", "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "surpl", ",", "dir", ",", "pli", ",", "plj", ",", "setij", ",", "setji",
        ",", "nwij", ",", "mgij"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"surpl", " ", "=", " ", "payoff"}], ";", " ", "\n", "    ", 
      RowBox[{"setij", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"listIJ", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"setji", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"listJI", "[", "T", "]"}], ",", "2"}], "]"}]}], ";", 
      "\t\t\t\t", "\n", "    ", 
      RowBox[{"nwij", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"setij", ",", "setji"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"mgij", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"Global`sij", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
        "nwij"}]}], ";", "\n", "    ", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"PrependTo", "[", 
        RowBox[{"surpl", ",", "mgij"}], "]"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"511a0cbd-82b4-4ddf-ada1-5fbaab002a79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "check", " ", "for", " ", 
    "kernel", " ", 
    RowBox[{"elements", "."}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KernelImputationQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"KernelImputationQ", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelImputationQ", "[", 
      RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "dimpay", "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"dimpay", " ", "=", " ", 
         RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "    ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], 
          ",", "\n", "         ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
             ")"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"KernelImputQ", "[", 
               RowBox[{"game", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
             " ", "payoff"}], ",", " ", "\n", "                       ", 
            "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
          "\n", "   ", 
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], 
          ",", "\n", "            ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", 
               "2"}]}], " ", ")"}], ",", " ", 
            RowBox[{"KernelImputQ", "[", 
             RowBox[{"game", ",", " ", "payoff"}], "]"}], ",", " ", "\n", 
            "                         ", "True", ",", "  ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", " ", 
          "\n", "   ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelImputQ", "[", 
      RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", "\n",
      "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ub", ",", "lb", ",", "plpr", ",", "rvpr", ",", "asspay", ",", "sij", 
         ",", "sji", ",", "tmij", ",", "tmji", ",", "msrplij", ",", "msrplji",
          ",", "msrij", ",", "msrji", ",", "conj", ",", "coni", ",", "intvij",
          ",", "intvji", ",", "npij", ",", "npji", ",", "orij", ",", "orji", 
         ",", "ntmj", ",", "ntmi", ",", "neq"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"ub", "=", 
         RowBox[{"4", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "7"}], ")"}]}]}]}], ";", "\n", "    ", 
        RowBox[{"lb", "=", 
         RowBox[{"-", "ub"}]}], ";", "\n", "    ", 
        RowBox[{"plpr", " ", "=", " ", 
         RowBox[{"PlayerPairs", "[", "T", "]"}]}], ";", "\n", "    ", 
        RowBox[{"rvpr", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "plpr"}]}], ";", "\n", "    ", 
        RowBox[{"asspay", " ", "=", " ", 
         RowBox[{"AssgPay", "[", "payoff", "]"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sij", ",", "sji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"TIJsets", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
             " ", "plpr"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"TIJsets", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
             " ", "rvpr"}]}], "}"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"msrplij", ",", "msrplji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MaxExcess", "[", 
            RowBox[{"sij", ",", " ", "asspay"}], "]"}], ",", 
           RowBox[{"MaxExcess", "[", 
            RowBox[{"sji", ",", " ", "asspay"}], "]"}]}], "}"}]}], ";", "\n", 
        "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"msrij", ",", "msrji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"msrplij", " ", "-", " ", "msrplji"}], ",", 
           RowBox[{"msrplji", " ", "-", " ", "msrplij"}]}], "}"}]}], ";", 
        "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"conj", ",", "coni"}], "}"}], "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstPlj", "[", 
            RowBox[{"plpr", ",", " ", "asspay"}], "]"}], ",", " ", 
           RowBox[{"ConstPlj", "[", 
            RowBox[{"rvpr", ",", " ", "asspay"}], "]"}]}], "}"}]}], ";", "\n",
         "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmij", ",", "tmji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"msrij", ",", " ", "conj"}], "]"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"msrji", ",", " ", "coni"}], "]"}]}], "}"}]}], ";", "\n", 
        "    ", 
        RowBox[{"intvij", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lb", "<=", " ", "#", " ", "<=", " ", "ub"}], ")"}], " ", 
           "&"}], "/@", " ", "tmij"}]}], ";", "  ", "\n", "    ", 
        RowBox[{"intvji", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lb", "<=", " ", "#", " ", "<=", " ", "ub"}], ")"}], " ", 
           "&"}], "/@", " ", "tmji"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"npij", ",", "npji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NonPositive", "[", "tmij", "]"}], ",", 
           RowBox[{"NonPositive", "[", "tmji", "]"}]}], "}"}]}], ";", "\n", 
        "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"orij", ",", "orji"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Or", ",", 
             RowBox[{"{", 
              RowBox[{"intvij", ",", "npij"}], "}"}]}], "]"}], ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Or", ",", 
             RowBox[{"{", 
              RowBox[{"intvji", ",", "npji"}], "}"}]}], "]"}]}], "}"}]}], ";",
         " ", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ntmj", ",", "ntmi"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Union", "[", "orij", "]"}], ",", 
           RowBox[{"Union", "[", "orji", "]"}]}], "}"}]}], ";", "\n", "    ", 
        
        RowBox[{"neq", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"Join", ",", " ", 
           RowBox[{"{", 
            RowBox[{"ntmj", ",", " ", "ntmi"}], "}"}]}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "neq"}], "]"}]}]}], "\n", " ", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"34ca6dd6-a1da-49c4-98a3-d29129f3daa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplayMessFindKernel", "[", "payoff_List", "]"}], ":=", 
    RowBox[{"(", "\n", "       ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Depth is equal to \>\"", ",", 
        RowBox[{"Depth", "[", "payoff", "]"}]}], "]"}], ";", "\n", "       ", 
      
      RowBox[{
      "Print", "[", "\"\<Usage: FindKernelSolution[game,payoff]\>\"", "]"}], 
      ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<Input format of the variable 'payoff' is not correct.\>\"", "]"}],
       ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<The variable 'payoff' must be a single payoff vector or a list of \
payoffs.\>\"", "]"}]}], "\n", ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplayMess", "[", "payoff_List", "]"}], ":=", 
    RowBox[{"(", "\n", "       ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Depth is equal to \>\"", ",", 
        RowBox[{"Depth", "[", "payoff", "]"}]}], "]"}], ";", "\n", "       ", 
      
      RowBox[{
      "Print", "[", "\"\<Usage: KernelImputationQ[game,payoff]\>\"", "]"}], 
      ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<Input format of the variable 'payoff' is not correct.\>\"", "]"}],
       ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<The variable 'payoff' must be a single payoff vector.\>\"", "]"}],
       ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<Use the function KernelImputationListQ[game,payoff]\>\"", "]"}], 
      ";", "\n", "       ", 
      RowBox[{
      "Print", "[", "\"\<to check a list of payoff vectors.\>\"", "]"}]}], 
     "\n", ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplayMessReclim", "[", "reclimval_", "]"}], ":=", 
    RowBox[{"(", "\n", "       ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Warning:: Recursion limit exceeds threshold value: \>\"", ",", 
        " ", "reclimval"}], "]"}], ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<Use the function KernelImputationListQ[game,payoff]\>\"", "]"}], 
      ";", "\n", "       ", 
      RowBox[{
      "Print", "[", "\"\<to check if the result is a kernel solution.\>\"", 
       "]"}]}], "       ", "\n", "\n", ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelImputationListQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"KernelImputationListQ", "::", "argerr"}], "]"}], ";", 
      "$Failed"}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KernelImputationListQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kerimpQ", ",", "impQ"}], "}"}], ",", "\n", "    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "3"}], ",", 
       " ", "\n", "            ", 
       RowBox[{
        RowBox[{"kerimpQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"KernelImputationQ", "[", 
            RowBox[{"game", ",", " ", "#"}], "]"}], " ", "&"}], "/@", " ", 
          "payoff"}]}], ";", "\n", "            ", 
        RowBox[{"impQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"CheckImputations", "[", 
            RowBox[{"game", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "payoff"}]}], ";", "\n", "            ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"And", ",", 
          RowBox[{"{", 
           RowBox[{"kerimpQ", ",", "impQ"}], "}"}]}], "]"}]}], ",", "\n", 
       "          ", 
       RowBox[{
        RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "2"}], ",", 
       " ", "\n", "            ", 
       RowBox[{
        RowBox[{"kerimpQ", " ", "=", " ", 
         RowBox[{"KernelImputationQ", "[", 
          RowBox[{"game", ",", "payoff"}], "]"}]}], ";", "\n", "            ", 
        RowBox[{"impQ", " ", "=", " ", 
         RowBox[{"CheckImputations", "[", 
          RowBox[{"game", ",", "payoff"}], "]"}]}], ";", "\n", "            ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"{", 
           RowBox[{"kerimpQ", ",", "impQ"}], "}"}]}], "]"}]}], ",", "\n", 
       "          ", "True", ",", " ", 
       RowBox[{"DisplayMessage", "[", "payoff", "]"}]}], "\n", "    ", "\n", 
      "   ", "]"}]}], "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->\
"d96dbaa9-4e00-461a-9d0c-a8ab7f6d5c67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImputationQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ImputationQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationQ", "[", 
    RowBox[{"game_", ",", "payoff_List"}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "   ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "3"}], ",", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{"CheckImputations", "[", 
          RowBox[{"game", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "payoff"}], ",", "\n", "         ", 
       RowBox[{
        RowBox[{"Depth", "[", "payoff", "]"}], " ", "==", " ", "2"}], ",", 
       " ", 
       RowBox[{"CheckImputations", "[", 
        RowBox[{"game", ",", "payoff"}], "]"}], ",", "\n", "         ", 
       "True", ",", " ", 
       RowBox[{"DisplayMessage", "[", "payoff", "]"}]}], "\n", "   ", "]"}]}],
     "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->"d70d077d-6b15-44b9-8c16-\
3f54bf02a006"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CheckImputations", "[", 
     RowBox[{"game_", ",", "payoff_List"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "impQ", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"impQ", " ", "=", " ", 
        RowBox[{
         RowBox[{"TolImputations", "[", "game", "]"}], " ", "/.", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], ",", " ", "payoff"}], "}"}]}], "]"}]}]}], ";", "\n", 
       "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "impQ"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TolImputations", "[", "game_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tolv", ",", "indrat", ",", "eff"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"tolv", "=", 
       RowBox[{"4", "*", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "9"}], ")"}]}]}]}], ";", "\n", "    ", 
      RowBox[{"indrat", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "#", "]"}], " ", "-", " ", 
            RowBox[{"v", "[", 
             RowBox[{"{", "#", "}"}], "]"}]}], ")"}], ">=", 
          RowBox[{"-", "tolv"}]}], " ", "&"}], "/@", " ", "T"}]}], ";", "\n", 
      "    ", 
      RowBox[{"eff", "=", 
       RowBox[{"LessEqual", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"x", "[", "T", "]"}], "-", 
           RowBox[{"v", "[", "T", "]"}]}], "]"}], ",", "tolv"}], "]"}]}], ";",
       "\n", "    ", 
      RowBox[{"Append", "[", 
       RowBox[{"indrat", ",", "eff"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"b5b87aee-d8c7-492d-a21c-4ffdcd626008"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplayMessage", "[", "payoff_List", "]"}], ":=", 
    RowBox[{"(", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Depth is equal to \>\"", ",", 
        RowBox[{"Depth", "[", "payoff", "]"}]}], "]"}], ";", "\n", "       ", 
      
      RowBox[{
      "Print", "[", 
       "\"\<Usage: KernelImputationListQ[game,payoff] and \
PreKernelQ[game,payoff]\>\"", "]"}], ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<Input format of the variable 'payoff' is not correct.\>\"", "]"}],
       ";", "\n", "       ", 
      RowBox[{
      "Print", "[", 
       "\"\<The variable 'payoff' must be a list of payoff vectors or a \
single payoff vector.\>\"", "]"}]}], "\n", "\n", ")"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "User", " ", "interface", " ", "to", " ", "check", " ", "for", " ", 
     RowBox[{"(", "anti", ")"}], " ", "pre"}], "-", 
    RowBox[{"kernel", " ", 
     RowBox[{"element", "."}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"PreKernelQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelQ", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreKernelQ", "]"}]}]}], "]"}], " ", ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rattol", ",", "tolv", ",", "graval", ",", "dimpay"}], "}"}], 
      ",", "\n", "       ", 
      RowBox[{
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", " ", "\n", 
       "       ", 
       RowBox[{"graval", " ", "=", " ", 
        RowBox[{"v", "[", "T", "]"}]}], ";", "\n", "       ", 
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "       ", 
       RowBox[{"tolv", "=", 
        RowBox[{"1.5", "*", "rattol"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",",
          "\n", "                                 ", 
         RowBox[{"Which", "[", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{"And", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Total", "[", "#", "]"}], " ", "-", " ", 
                    "graval"}], "]"}], "<=", "tolv"}], ")"}], " ", "&"}], " ",
                 "/@", " ", "payoff"}], ",", 
               RowBox[{"MaxExcessBalanced", "[", 
                RowBox[{"game", ",", " ", "payoff", ",", 
                 RowBox[{"RationalTol", "->", "rattol"}]}], "]"}]}], "}"}]}], 
            "]"}], ",", "\n", 
           "                                               ", "True", ",", 
           " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "                   ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",",
          "\n", "                              ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", " ", 
           RowBox[{"MapThread", "[", 
            RowBox[{"And", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
                   "graval"}], "]"}], "<=", "tolv"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"MaxExcessBalanced", "[", 
                 RowBox[{"game", ",", " ", "payoff", ",", 
                  RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], "}"}]}], 
              "}"}]}], "]"}], ",", " ", "\n", 
           "                                            ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "      ", "True", ",", " ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", "            ", 
        "]"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AntiPreKernelQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"AntiPreKernelQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AntiPreKernelQ", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AntiPreKernelQ", "]"}]}]}], "]"}], " ", 
   ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rattol", ",", "tolv", ",", "graval", ",", "dimpay"}], "}"}], 
     ",", "\n", "       ", 
     RowBox[{
      RowBox[{"rattol", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", " ", "\n", 
      "       ", 
      RowBox[{"graval", " ", "=", " ", 
       RowBox[{"v", "[", "T", "]"}]}], ";", "\n", "       ", 
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", "\n", "       ", 
      RowBox[{"tolv", "=", 
       RowBox[{"1.5", "*", "rattol"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "2"}], ",", 
        "\n", "                               ", 
        RowBox[{"Which", "[", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], ",", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"Total", "[", "#", "]"}], " ", "-", " ", 
                    "graval"}], "]"}], "<=", " ", "tolv"}], ")"}], " ", "&"}],
                " ", "/@", " ", "payoff"}], ",", 
              RowBox[{"MinExcessBalanced", "[", 
               RowBox[{"game", ",", " ", "payoff", ",", 
                RowBox[{"RationalTol", "->", "rattol"}]}], "]"}]}], "}"}]}], 
           "]"}], ",", "\n", 
          "                                               ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                   ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], " ", "===", " ", "1"}], ",", 
        "\n", "                              ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", "payoff", "]"}], " ", "-", " ", 
                  "graval"}], "]"}], "<=", "tolv"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"MinExcessBalanced", "[", 
                RowBox[{"game", ",", " ", "payoff", ",", 
                 RowBox[{"RationalTol", "->", "rattol"}]}], "]"}], "}"}]}], 
             "}"}]}], "]"}], ",", " ", "\n", 
          "                                            ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "      ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", "            ", 
       "]"}]}]}], "\n", " ", "]"}]}], ";"}]}], "Code",ExpressionUUID->\
"1b6f24b8-4fa4-4316-8e04-f8ac85ad9a4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "User", " ", "interface", " ", "to", " ", "calculate", " ", "kernel", 
      " ", "elements", " ", "of", " ", "a", " ", "Tu"}], "-", "game"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"cf", ".", " ", "Meinhardt"}], " ", 
     RowBox[{
      RowBox[{"(", "2006", ")"}], "."}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KernelCalculation", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"KernelCalculation", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelCalculation", "[", 
      RowBox[{"game_", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "KernelCalculation", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "callm", ",", "changeps", ",", "dispres", ",", " ", "epsi1", ",", " ",
          "fieps", ",", " ", "notzeromono", ",", " ", "firstcrit", ",", 
         "kernres", ",", " ", "epsilon", ",", " ", "zmonoQ", ",", " ", 
         "kernQ", ",", " ", "avcQ", ",", " ", "orggame", ",", " ", "orgval"}],
         "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"Off", "[", 
         RowBox[{"Set", "::", "setraw"}], "]"}], ";", "\n", "  ", 
        RowBox[{"Off", "[", 
         RowBox[{"Set", "::", "write"}], "]"}], ";", "\n", "  ", 
        RowBox[{"callm", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "CallMaximize", "]"}]}], ";", "\n", "  ", 
        RowBox[{"mth", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "  ", 
        RowBox[{"changeps", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "ChangeInternalEps", "]"}]}], ";", "\n", 
        "  ", 
        RowBox[{"dispres", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
        "  ", 
        RowBox[{"epsi1", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", "  ", 
        RowBox[{"notzeromono", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "SetGameToNonZeroMonotonic", "]"}]}], 
        ";", " ", "\n", "   ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "epsi1", "]"}], "==", "1"}], ",", " ", "\n", 
          "    ", 
          RowBox[{
           RowBox[{"ClearProtected", "[", "Global`w", "]"}], ";", "\n", 
           "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Set", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Global`w", "[", "#", "]"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"v", "[", "#", "]"}], "}"}]}], "}"}]}], "]"}], " ", 
             "&"}], " ", "/@", " ", 
            RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
           RowBox[{"SetAttributes", "[", 
            RowBox[{"Global`w", ",", " ", "Protected"}], "]"}], ";", "\n", 
           "    ", 
           RowBox[{"orgval", " ", "=", " ", 
            RowBox[{"Rationalize", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              RowBox[{"Subsets", "[", "T", "]"}]}], "]"}]}], ";", " ", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"ZeroMonotonQ", "[", "]"}], " ", "changes", " ", "the", 
             " ", "coalitional", " ", 
             RowBox[{"values", ".", " ", "orgval"}], " ", "stores", " ", 
             "the", " ", "original", " ", 
             RowBox[{"values", "."}]}], "  ", "*)"}], "\n", "    ", 
           RowBox[{"fieps", "=", " ", 
            RowBox[{
             RowBox[{"FirstCriticalVal", "[", "game", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\n", 
           RowBox[{"(*", "    ", 
            RowBox[{
             RowBox[{"fieps", "=", " ", 
              RowBox[{
               RowBox[{"ThirdCriticalVal", "[", "game", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}], "\n", 
           "    ", 
           RowBox[{"epsilon", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"epsi1", " ", "<", " ", "fieps"}], ",", "fieps", ",", 
              "epsi1"}], "]"}]}], ";", "\n", "    ", 
           RowBox[{"zmonoQ", " ", "=", " ", 
            RowBox[{"ZeroMonotoneQ", "[", "game", "]"}]}], ";", "\n", "    ", 
           
           RowBox[{"orggame", " ", ":=", " ", 
            RowBox[{"DefineGame", "[", 
             RowBox[{"T", ",", "orgval"}], "]"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Reconstruction", " ", "of", " ", "the", " ", "original", " ", 
             RowBox[{"game", "."}]}], " ", "*)"}], "\n", "    ", 
           RowBox[{"kernQ", " ", "=", " ", 
            RowBox[{"CoreQ", "[", "orggame", "]"}]}], ";", "\n", "    ", 
           RowBox[{"avcQ", " ", "=", " ", 
            RowBox[{"AvConvexQ", "[", "orggame", "]"}]}], ";", "\n", "    ", 
           RowBox[{"kernres", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"epsilon", " ", "!=", " ", "0"}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"For", " ", "zero"}], "-", 
                 RowBox[{
                 "monotonic", " ", "games", " ", "with", " ", "an", " ", 
                  "nonempty", " ", "core", " ", "we", " ", "can", " ", "use", 
                  " ", 
                  RowBox[{"KernelPoints", "[", "]"}]}]}], ",", " ", "\n", 
                "                        ", 
                RowBox[{
                 RowBox[{
                 "otherwise", " ", "we", " ", "use", " ", "the", " ", 
                  "function", " ", 
                  RowBox[{
                   RowBox[{"Kernel", "[", "]"}], ".", "\n", 
                   "                        ", 
                   RowBox[{"KernelPoints", "[", "]"}]}], " ", "can", " ", 
                  "run", " ", "into", " ", "infinite", " ", "loops", " ", 
                  "for", " ", "\n", "                        ", "non", " ", 
                  "zero"}], "-", 
                 RowBox[{"monotonic", " ", 
                  RowBox[{
                  "games", ".", "\n", "                        ", "This"}], 
                  " ", "function", " ", "seems", " ", "to", " ", "be", " ", 
                  "stable", " ", "for", " ", "non", " ", "zero"}], "-", 
                 RowBox[{"monotonic", " ", 
                  RowBox[{"games", "."}]}]}]}], " ", "*)"}], " ", "\n", 
              "                 ", 
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"zmonoQ", " ", "||", " ", "kernQ"}], ")"}], " ", "==",
                  " ", "True"}], ",", " ", "\n", "                 ", 
                RowBox[{
                 RowBox[{"DisplayZmQKerQ01", "[", 
                  RowBox[{"zmonoQ", ",", "kernQ"}], "]"}], ";", "\n", 
                 "                 ", 
                 RowBox[{"KernelPoints", "[", 
                  RowBox[{"orggame", ",", " ", 
                   RowBox[{"{", "}"}], ",", "callm", ",", "changeps", ",", 
                   " ", "dispres", ",", " ", 
                   RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                   " ", 
                   RowBox[{"Method", "->", "mth"}], ",", "opts"}], "]"}]}], 
                ",", "\n", "                 ", 
                RowBox[{
                 RowBox[{"DisplayZmQKerQ02", "[", 
                  RowBox[{"zmonoQ", ",", "kernQ"}], "]"}], ";", "\n", 
                 "                 ", 
                 RowBox[{"KernelSubCallZero", "[", 
                  RowBox[{
                  "orggame", ",", " ", "callm", ",", " ", "changeps", ",", 
                   " ", "dispres", ",", " ", 
                   RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                   " ", 
                   RowBox[{
                   "SetGameToNonZeroMonotonic", " ", "->", " ", 
                    "notzeromono"}], ",", " ", 
                   RowBox[{"Method", "->", " ", "mth"}]}], "]"}]}]}], "\n", 
               "                 ", "]"}], ",", "\n", "           ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"zmonoQ", " ", "||", " ", "kernQ"}], ")"}], " ", "==",
                  " ", "False"}], ",", "\n", "              ", 
                RowBox[{
                 RowBox[{"DisplayZmQKerQ02", "[", 
                  RowBox[{"zmonoQ", ",", "kernQ"}], "]"}], ";", "\n", 
                 "              ", 
                 RowBox[{"KernelSubCallZero", "[", 
                  RowBox[{
                  "orggame", ",", " ", "callm", ",", " ", "changeps", ",", 
                   "  ", "dispres", ",", " ", 
                   RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                   " ", 
                   RowBox[{
                   "SetGameToNonZeroMonotonic", " ", "->", " ", 
                    "notzeromono"}], ",", " ", 
                   RowBox[{"Method", "->", " ", "mth"}]}], "]"}]}], ",", "\n",
                 "              ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"kernQ", " ", "==", " ", "False"}], ",", "\n", 
                  "                 ", 
                  RowBox[{
                   RowBox[{"DisplayZmQKerQ03", "[", 
                    RowBox[{"zmonoQ", ",", "kernQ"}], "]"}], ";", "\n", 
                   "                 ", 
                   RowBox[{"KernelSubCallEmpty", "[", 
                    RowBox[{
                    "orggame", ",", "callm", ",", " ", "changeps", ",", "  ", 
                    "dispres", ",", " ", 
                    RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                    " ", 
                    RowBox[{
                    "SetGameToNonZeroMonotonic", " ", "->", " ", 
                    "notzeromono"}], ",", " ", 
                    RowBox[{"Method", "->", " ", "mth"}]}], "]"}]}], ",", 
                  "\n", "                 ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"avcQ", " ", "==", " ", "True"}], ",", " ", "\n", 
                    "                   ", 
                    RowBox[{
                    RowBox[{"DisplayAvcQ", "[", "avcQ", "]"}], ";", "\n", 
                    "                   ", 
                    RowBox[{"KernelSubCall", "[", 
                    RowBox[{
                    "orggame", ",", "callm", ",", " ", "changeps", ",", " ", 
                    "dispres", ",", " ", 
                    RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                    " ", 
                    RowBox[{
                    "SetGameToNonZeroMonotonic", " ", "->", " ", 
                    "notzeromono"}], ",", " ", 
                    RowBox[{"Method", "->", " ", "mth"}]}], "]"}]}], ",", 
                    "\n", "                   ", 
                    RowBox[{
                    RowBox[{"DisplayAvcQ", "[", "avcQ", "]"}], ";", "\n", 
                    "                   ", 
                    RowBox[{"KernelSubCall", "[", 
                    RowBox[{
                    "orggame", ",", "callm", ",", " ", "changeps", ",", " ", 
                    "dispres", ",", " ", 
                    RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                    " ", 
                    RowBox[{
                    "SetGameToNonZeroMonotonic", " ", "->", " ", 
                    "notzeromono"}], ",", " ", 
                    RowBox[{"Method", "->", " ", "mth"}]}], "]"}]}]}], "\n", 
                   "\t\t  ", "]"}]}], "\n", "                ", "]"}]}], "\n",
                "             ", "]"}]}], "\n", "       ", "]"}]}]}], ",", 
          " ", 
          RowBox[{"DisplayRemark", "[", "epsilon", "]"}]}], "\n", "   ", 
         "]"}], ";", "\n", "   ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", "orgval"}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Reconstruction", " ", "of", " ", "the", " ", "original", " ", 
          RowBox[{"game", "."}]}], " ", "*)"}], "\n", "   ", "kernres"}]}], 
      "\n", "  ", "]"}]}], ";"}], "\n", " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayZmQKerQ01", "[", 
      RowBox[{"zmQ_", ",", "coreQ_"}], "]"}], " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "          ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Game is zero-monotone? \>\"", ",", "zmQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Core is nonempty? \>\"", ",", "coreQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{
        "Print", "[", 
         "\"\<Game is either zero-monotonic or has nonempty core\>\"", 
         "]"}]}]}], "\n", "         ", "]"}]}], ";"}], "\n", "         ", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayZmQKerQ02", "[", 
      RowBox[{"zmQ_", ",", "coreQ_"}], "]"}], " ", ":=", " ", "\n", "   ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "          ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Game is zero-monotone? \>\"", ",", "zmQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Core is nonempty? \>\"", ",", "coreQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{
        "Print", "[", "\"\<Game is not zero-monotonic and has empty core\>\"",
          "]"}]}]}], "\n", "          ", "]"}]}], ";"}], "\n", "          ", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayZmQKerQ03", "[", 
      RowBox[{"zmQ_", ",", "coreQ_"}], "]"}], " ", ":=", "\n", "   ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "          ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Game is zero-monotone? \>\"", ",", "zmQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Core is nonempty? \>\"", ",", "coreQ"}], "]"}], ";", 
        "\n", "          ", 
        RowBox[{"Print", "[", "\"\<Core is empty\>\"", "]"}], ";"}]}], "\n", 
      "       ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayAvcQ", "[", "avconQ_", "]"}], " ", ":=", " ", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Game is average-convex? \>\"", ",", "avconQ"}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayRemark", "[", "eps_Real", "]"}], " ", ":=", " ", "\n", 
     "    ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "      ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Depth is equal to \>\"", ",", 
          RowBox[{"Depth", "[", "eps", "]"}]}], "]"}], ";", "\n", "      ", 
        RowBox[{"Print", "[", "\"\<Usage: Kernel[game,options]\>\"", "]"}], 
        ";", "\n", "      ", 
        RowBox[{
        "Print", "[", "\"\<and KernelCalculation[game,options]\>\"", "]"}], 
        ";", "\n", "      ", 
        RowBox[{
        "Print", "[", 
         "\"\<The variable 'eps' has not the correct input format.\>\"", 
         "]"}], ";", "\n", "      ", 
        RowBox[{
        "Print", "[", 
         "\"\<The variable 'eps' must be a rational number and not a \
list.\>\"", "]"}], ";", "\n", "      ", 
        RowBox[{
        "Print", "[", 
         "\"\<Use for instance the function FirstCriticalVal[] to find out \
such a number.\>\"", "]"}]}]}], "\n", "      ", "]"}]}], ";"}], 
   "\n"}]}]], "Code",ExpressionUUID->"37c7e1eb-0a99-4c94-95c6-d3247a8544e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelSubCallEmpty", "[", 
     RowBox[{"game_", ",", "callm_", ",", "changeps_", ",", "dispres_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "KernelCalculation", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "     ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mth", ",", "epsi1", ",", "notzeromono", ",", "critical", ",", 
        "kernres"}], "}"}], ",", "\n", "          ", 
      RowBox[{
       RowBox[{"epsi1", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
       "          ", 
       RowBox[{"notzeromono", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SetGameToNonZeroMonotonic", "]"}]}], ";",
        "\n", "          ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
       "          ", 
       RowBox[{"critical", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"changeps", " ", "==", " ", "False"}], ",", " ", "epsi1", 
          ",", " ", "True", ",", " ", 
          RowBox[{
           RowBox[{"SecondCriticalVal", "[", "game", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
       "          ", 
       RowBox[{"kernres", " ", "=", " ", 
        RowBox[{"KernelPoints", "[", 
         RowBox[{"game", ",", " ", 
          RowBox[{"{", "}"}], ",", " ", "callm", ",", " ", "changeps", ",", 
          "  ", "dispres", ",", " ", 
          RowBox[{"EpsilonValue", " ", "->", " ", "critical"}], ",", " ", 
          RowBox[{
          "SetGameToNonZeroMonotonic", " ", "->", " ", "notzeromono"}], ",", 
          RowBox[{"Method", "->", "mth"}]}], "]"}]}]}]}], "\n", "\n", "\n", 
     " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KernelSubCall", "[", 
    RowBox[{"game_", ",", "callm_", ",", "changeps_", ",", "dispres_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "KernelCalculation", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "     ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mth", ",", "epsi1", ",", "notzeromono", ",", "critical", ",", 
       "kernres"}], "}"}], ",", "\n", "          ", 
     RowBox[{
      RowBox[{"epsi1", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
      "          ", 
      RowBox[{"notzeromono", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SetGameToNonZeroMonotonic", "]"}]}], ";", 
      "\n", "          ", 
      RowBox[{"mth", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", " ", "\n", 
      "          ", 
      RowBox[{"critical", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"changeps", " ", "==", " ", "False"}], ",", " ", "epsi1", 
         ",", " ", "True", ",", " ", 
         RowBox[{
          RowBox[{"FourthCriticalVal", "[", "game", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
      "          ", 
      RowBox[{"kernres", " ", "=", " ", 
       RowBox[{"KernelPoints", "[", 
        RowBox[{"game", ",", " ", 
         RowBox[{"{", "}"}], ",", " ", "callm", ",", " ", "changeps", ",", 
         "  ", "dispres", ",", " ", 
         RowBox[{"EpsilonValue", " ", "->", " ", "critical"}], ",", " ", 
         RowBox[{"SetGameToNonZeroMonotonic", " ", "->", " ", "notzeromono"}],
          ",", 
         RowBox[{"Method", "->", "mth"}]}], "]"}]}]}]}], "\n", "\n", "\n", 
    " ", "]"}]}], ";"}]}], "Code",ExpressionUUID->"d015ed19-4a6a-4222-b86e-\
5b9ff601817a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelSubCallZero", "[", 
     RowBox[{"game_", ",", "callm_", ",", "changeps_", ",", "dispres_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "KernelCalculation", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "     ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mth", ",", "epsi1", ",", "notzeromono", ",", "critical", ",", 
        "kernres", ",", "kernsol"}], "}"}], ",", "\n", "          ", 
      RowBox[{
       RowBox[{"epsi1", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
       "          ", 
       RowBox[{"notzeromono", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SetGameToNonZeroMonotonic", "]"}]}], ";",
        " ", "\n", "          ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", 
       "          ", 
       RowBox[{"critical", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"changeps", " ", "==", " ", "False"}], ",", " ", "epsi1", 
          ",", " ", "True", ",", " ", 
          RowBox[{
           RowBox[{"StarCriticalVal", "[", "game", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
       
       RowBox[{"(*", " ", "\n", 
        RowBox[{
         RowBox[{"The", " ", "function", " ", 
          RowBox[{"KernelPoints", "[", "]"}], " ", "is", " ", "not", " ", 
          "stable", " ", "for", " ", "non", " ", "zero"}], "-", 
         RowBox[{"monotonic", " ", 
          RowBox[{"games", ".", "\n", "We"}], " ", "comment", " ", "the", " ",
           "function", " ", 
          RowBox[{"KernelPoints", "[", "]"}], " ", "out", " ", "and", " ", 
          "rely", " ", "on", " ", "the", " ", "stable", " ", "\n", "function",
           " ", 
          RowBox[{"Kernel", "[", "]"}], " ", "to", " ", "avoid", " ", 
          "infinite", " ", 
          RowBox[{"loops", "."}]}]}], "\n", "*)"}], "\n", 
       RowBox[{"(*", "\n", "          ", 
        RowBox[{"kernres", " ", "=", " ", 
         RowBox[{"KernelPoints", "[", 
          RowBox[{"game", ",", " ", 
           RowBox[{"{", "}"}], ",", " ", "critical"}], "]"}]}], "\n", "*)"}], 
       "\n", "       ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"notzeromono", " ", "==", " ", "False"}], ",", "\n", 
         "             ", 
         RowBox[{
          RowBox[{"kernsol", "=", " ", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"Kernel", "[", 
              RowBox[{"game", ",", " ", 
               RowBox[{"Method", "->", "mth"}], ",", " ", 
               RowBox[{"DisplayAllResults", " ", "->", " ", "True"}], ",", 
               " ", 
               RowBox[{"EpsilonValue", " ", "->", " ", "critical"}]}], "]"}], 
             ",", "3"}], "]"}]}], ";", "\n", "             ", 
          RowBox[{"kernres", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"kernsol", ",", 
             RowBox[{"kernsol", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", "\n", 
         "            ", "True", ",", " ", 
         RowBox[{"KernelPoints", "[", 
          RowBox[{"game", ",", " ", 
           RowBox[{"{", "}"}], ",", " ", "callm", ",", " ", "changeps", ",", 
           " ", "dispres", ",", " ", 
           RowBox[{"EpsilonValue", " ", "->", " ", "critical"}], ",", " ", 
           RowBox[{
           "SetGameToNonZeroMonotonic", " ", "->", " ", "notzeromono"}], ",", 
           
           RowBox[{"Method", "->", "mth"}]}], "]"}]}], "\n", "         ", 
        "]"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}]], "Code",ExpressionUUID->\
"9c434bf2-6b79-447e-872e-e2f4b4e5e1f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\n", 
   RowBox[{
   "Main", " ", "functions", " ", "to", " ", "determine", " ", "kernel", " ", 
    "elements", " ", "according", " ", "to", " ", "the", " ", "algorithm", 
    " ", "\n", "as", " ", "described", " ", "in", " ", "Meinhardt", 
    RowBox[{
     RowBox[{"(", "2006", ")"}], ".", " ", "Recursive"}], " ", 
    RowBox[{"procedure", "."}]}], " ", "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"KernelPoints", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"storepay_", ":", 
       RowBox[{"{", "}"}]}], ",", " ", "callm_", ",", " ", "changeps_", ",", 
      " ", "dispres_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "KernelCalculation", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "epsi1", ",", " ", "notzeromono", ",", " ", "mth", ",", " ", "ruf", 
        ",", " ", "zwerg", ",", " ", 
        RowBox[{"initialpay", " ", "=", " ", "storepay"}], ",", " ", "folg", 
        ",", " ", "rf", ",", " ", "del", ",", " ", "alloc", ",", " ", "po", 
        ",", " ", "newgame", ",", " ", "maxsets", ",", " ", "tijsets", ",", 
        " ", "mengsys", ",", " ", "reslofSt2", ",", " ", "constofSt2", ",", 
        " ", 
        RowBox[{"const", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", "var", ",", " ", "subres", ",", 
        "sol", ",", " ", "reddel", ",", "unpay", ",", " ", "retval", ",", " ",
         "objfunc", ",", " ", "epsilon", ",", " ", "leastgame"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"epsi1", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"notzeromono", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SetGameToNonZeroMonotonic", "]"}]}], ";",
        " ", "\n", "    ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
       RowBox[{"epsilon", " ", "=", " ", "epsi1"}], ";", "\n", "    ", 
       RowBox[{"newgame", " ", "=", " ", 
        RowBox[{"EpsValue", "[", 
         RowBox[{"game", ",", " ", "epsi1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"ruf", " ", "=", " ", 
        RowBox[{"MaxDeltaij", "[", 
         RowBox[{"newgame", ",", " ", "epsi1", ",", "callm"}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"folg", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "T", "]"}], " ", "-", " ", "1"}], ")"}]}],
           ")"}], "/", "2"}]}], ";", "\n", "    ", 
       RowBox[{"rf", "=", 
        RowBox[{"Range", "[", "folg", "]"}]}], ";", "\n", "    ", 
       RowBox[{"zwerg", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"ruf", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "&"}], " ", "/@",
          " ", "rf"}]}], ";", "\n", "    ", 
       RowBox[{"var", " ", "=", " ", 
        RowBox[{"x", " ", "/@", " ", "T"}]}], ";", "\n", "    ", 
       RowBox[{"subres", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", "var", ")"}], " ", "/.", " ", "zwerg"}]}], ";", "\n", 
       "    ", 
       RowBox[{"initialpay", " ", "=", " ", 
        RowBox[{"FlattenAt", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"initialpay", ",", " ", 
            RowBox[{"Union", "[", "subres", "]"}]}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", "initialpay", "]"}], " ", "+", " ", "1"}]}],
          "]"}]}], ";", "\n", "    ", 
       RowBox[{"del", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Global`\[Delta]", " ", "/.", " ", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"ruf", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"-", "2"}]}], "]"}]}], " ", "&"}], " ", "/@", " ", 
         "rf"}]}], ";", "\n", "    ", 
       RowBox[{"del", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Rationalize", "[", 
           RowBox[{"#", ",", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "9"}], ")"}]}]}], "]"}], " ", "&"}], " ", "/@", 
         " ", "del"}]}], ";", "\n", "    ", 
       RowBox[{"tijsets", " ", "=", " ", 
        RowBox[{"TijLoop", "[", "newgame", "]"}]}], ";", "\n", "    ", 
       RowBox[{"po", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"ExcessPayoff", "[", 
               RowBox[{"newgame", ",", " ", "#1"}], "]"}], "]"}], ",", " ", 
             RowBox[{"-", "#2"}]}], "]"}], " ", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"subres", ",", " ", "del"}], "}"}]}], "]"}]}], ";", " ", 
       "\n", "    ", 
       RowBox[{"maxsets", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "#"}], "]"}], " ", 
          "&"}], " ", "/@", " ", "po"}]}], ";", "\n", "    ", 
       RowBox[{"mengsys", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"maxsets", ",", " ", "tijsets"}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"const", " ", "=", " ", 
        RowBox[{"NewConstraints", "[", 
         RowBox[{
         "mengsys", ",", " ", "const", ",", " ", "del", ",", " ", "epsi1"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"objfunc", " ", "=", " ", 
        RowBox[{"Total", "[", "var", "]"}]}], ";", "\n", "    ", 
       RowBox[{"const", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"const", ",", " ", 
            RowBox[{"objfunc", " ", "<=", " ", 
             RowBox[{"v", "[", "T", "]"}]}]}], "]"}], "]"}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"reddel", " ", "=", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"-", 
          RowBox[{"Union", "[", "del", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"reslofSt2", ",", " ", "constofSt2"}], "}"}], " ", "=", " ", 
        
        RowBox[{"FeasibleConstraints", "[", 
         RowBox[{
         "const", ",", " ", "reddel", ",", " ", "callm", ",", " ", "mth"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"initialpay", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"initialpay", ",", "reslofSt2"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"unpay", " ", "=", " ", 
        RowBox[{"Union", "[", "initialpay", "]"}]}], ";", "\n", "    ", 
       RowBox[{"const", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{"Union", "[", "constofSt2", "]"}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"In", " ", "the", " ", "next", " ", "line"}], ",", " ", 
         RowBox[{
          RowBox[{
          "we", " ", "handle", " ", "incorrectly", " ", "specified", " ", 
           "opt"}], "-", 
          RowBox[{"prob", "."}]}]}], "  ", "*)"}], "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"const", ",", " ", "Indeterminate"}], "]"}], ",", "True", 
         ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Warning: OPT-PROB incorrectly specified. Aborting \
Calculation!\>\"", "]"}], ";", "\n", 
          "                                        ", 
          RowBox[{"Return", "[", 
           RowBox[{"Extract", "[", 
            RowBox[{"subres", ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"KernelImputationListQ", "[", 
                RowBox[{"game", ",", " ", "subres"}], "]"}], ",", " ", 
               "True"}], "]"}]}], "]"}], "]"}]}]}], "]"}], ";", "\n", "    ", 
       
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"callm", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"LinearOptimization", "[", 
           RowBox[{
            RowBox[{"-", "objfunc"}], ",", " ", "const", ",", " ", "var", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
             "}"}], ",", 
            RowBox[{"Method", "->", "mth"}]}], "]"}], ",", " ", 
          RowBox[{"(*", " ", "RevisedSimplex", " ", "*)"}], " ", "\n", 
          "                ", "True", ",", " ", 
          RowBox[{"Rationalize", "[", 
           RowBox[{
            RowBox[{"NMaximize", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"{", "const", "}"}], ",", " ", "objfunc"}], "]"}], 
              ",", " ", "var", ",", " ", 
              RowBox[{"Method", "->", "mth"}]}], "]"}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "9"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"callm", ",", "False"}], "]"}], ",", 
         RowBox[{"sol", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"sol", ",", 
            RowBox[{
             RowBox[{"{", "2", "}"}], "->", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"sol", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
           "]"}]}], ",", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"alloc", " ", "=", " ", 
        RowBox[{"var", " ", "/.", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "    ", 
       RowBox[{"retval", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Union", "[", 
           RowBox[{"KernelImputationListQ", "[", 
            RowBox[{"newgame", ",", "subres"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"retval", ",", "True"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"alloc", ",", 
            RowBox[{"Union", "[", "subres", "]"}]}], "}"}], "]"}], ",", 
         "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "alloc", "]"}], "!=", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"alloc", ",", "subres"}], "}"}], ",", "True"}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"retval", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"notzeromono", " ", "==", " ", "False"}], ",", " ", 
          RowBox[{"KernelImputationQ", "[", 
           RowBox[{"newgame", ",", " ", "alloc"}], "]"}], ",", " ", "\n", 
          "                        ", "True", ",", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"PreKernelQ", "[", 
              RowBox[{"newgame", ",", " ", "alloc"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "||", " ", 
            RowBox[{"KernelImputationQ", "[", 
             RowBox[{"newgame", ",", " ", "alloc"}], "]"}]}], ")"}]}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"retval", " ", "==", " ", "True"}], ",", "\n", "      ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<A Kernel solution is: \>\"", ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", "alloc"}], "}"}]}], "]"}]}], "]"}], ";", 
          "\n", "      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"dispres", " ", "==", " ", "False"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"alloc", ",", "unpay"}], "}"}], ",", " ", "True", ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
             "alloc", ",", " ", "objfunc", ",", " ", "const", ",", " ", 
              RowBox[{"del", "-", "epsi1"}], ",", " ", "unpay"}], "}"}]}], 
           "]"}]}], ",", "\n", "      ", 
         RowBox[{
          RowBox[{"MessageKerPoints01", "[", "sol", "]"}], ";", "\n", 
          "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"epsi1", " ", "!=", " ", "0"}], ",", "\n", "         ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<epsi1=\>\"", ",", "epsi1"}], "]"}], ";", "\n", 
             "         ", "MessageKerPoints02", ";", "\n", "         ", 
             RowBox[{"KernelPoints", "[", 
              RowBox[{
              "newgame", ",", " ", "initialpay", ",", "callm", ",", 
               "changeps", ",", "dispres", ",", 
               RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
               RowBox[{
               "SetGameToNonZeroMonotonic", " ", "->", " ", "notzeromono"}], 
               ",", " ", 
               RowBox[{"Method", "->", "mth"}]}], "]"}]}], ",", "\n", 
            "           ", 
            RowBox[{
             RowBox[{"epsilon", " ", "=", " ", 
              RowBox[{
               RowBox[{"FirstCriticalVal", "[", "newgame", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], ";", "\n", 
             "           ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"epsilon", " ", "==", " ", "0"}], ",", "\n", 
               "                ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<eps=\>\"", ",", "epsilon"}], "]"}], ";", "\n", 
                "                ", 
                RowBox[{"epsilon", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"SecondCriticalVal", "[", "newgame", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], ";", "\n", 
                "                ", 
                RowBox[{"leastgame", " ", "=", " ", 
                 RowBox[{"EpsValue", "[", 
                  RowBox[{"newgame", ",", " ", "epsilon"}], "]"}]}], ";", 
                "\n", "                ", 
                RowBox[{"KernelPoints", "[", 
                 RowBox[{
                 "leastgame", ",", " ", "initialpay", ",", "callm", ",", 
                  "changeps", ",", "dispres", ",", 
                  RowBox[{"EpsilonValue", " ", "->", " ", "epsilon"}], ",", 
                  " ", 
                  RowBox[{
                  "SetGameToNonZeroMonotonic", " ", "->", " ", 
                   "notzeromono"}], ",", 
                  RowBox[{"Method", "->", "mth"}]}], "]"}]}], ",", "\n", 
               "           ", 
               RowBox[{
                RowBox[{"leastgame", " ", "=", " ", 
                 RowBox[{"EpsValue", "[", 
                  RowBox[{"newgame", ",", " ", "epsilon"}], "]"}]}], ";", 
                "\n", "           ", 
                RowBox[{"KernelPoints", "[", 
                 RowBox[{
                 "leastgame", ",", " ", "initialpay", ",", "callm", ",", 
                  "changeps", ",", "dispres", ",", 
                  RowBox[{"EpsilonValue", " ", "->", " ", "0"}], ",", " ", 
                  RowBox[{
                  "SetGameToNonZeroMonotonic", " ", "->", " ", 
                   "notzeromono"}], ",", 
                  RowBox[{"Method", "->", "mth"}]}], "]"}]}]}], "\n", 
              "              ", "]"}]}]}], "\n", "         ", "]"}]}]}], "\n",
         "       ", "]"}]}]}], "\n", "    ", "]"}]}], ";"}]}]], "Code",Express\
ionUUID->"c795b4a8-3ba5-43f1-9ddf-adb3b6216d76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MessageKerPoints01", "[", "erg_", "]"}], " ", ":=", " ", "\n", 
    "   ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "         ", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<At least one player outweighs another player.\>\"", 
        "]"}], ";", " ", "\n", "         ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<A further calculation loop is required.\\n\>\"", ",", " ", 
         "erg"}], "]"}], ";"}]}], "\n", "   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MessageKerPoints02", " ", ":=", "\n", "   ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "        ", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Solution is not balanced.\>\"", "]"}], ";", 
       "\n", "        ", 
       RowBox[{
       "Print", "[", "\"\<The solution found may be a Kernel element.\>\"", 
        "]"}], ";", "\n", "        ", 
       RowBox[{
       "Print", "[", 
        "\"\<Check solution with the function KernelImputationQ or \
MaxExcessBalanced.\>\"", "]"}], ";"}]}], "\n", "   ", "]"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"NewKernel", " ", "section", " ", "starts"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Description", " ", "of", " ", "the", " ", "algorithm", " ", "can", " ", 
    "be", " ", "found", " ", "in", " ", "section", " ", "5", " ", "in", " ", 
    "Meinhardt", " ", 
    RowBox[{"(", "2006", ")"}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Kernel", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Kernel", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Kernel", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "Kernel", "]"}]}]}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "chopt", ",", " ", "dispres", ",", " ", "mth", ",", " ", "eps", ",", 
        " ", "kersol", ",", " ", "coreq", ",", "orgval", ",", "callm"}], 
       "}"}], ",", "\n", "       ", 
      RowBox[{
       RowBox[{"dispres", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"eps", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"callm", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "CallMaximize", "]"}]}], ";", "\n", 
       "       ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "       ", 
       RowBox[{"orgval", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}], "]"}]}], ";", " ", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EpsValue", "[", "]"}], " ", "changes", " ", "the", " ", 
         "coalitional", " ", 
         RowBox[{"values", ".", " ", "orgval"}], " ", "store", " ", "the", 
         " ", "original", " ", 
         RowBox[{"values", "."}]}], "  ", "*)"}], "\n", "       ", 
       RowBox[{"kersol", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "eps", "]"}], "==", "1"}], ",", "\n", 
          "         ", 
          RowBox[{
           RowBox[{"coreq", " ", "=", " ", 
            RowBox[{"CoreQ", "[", "game", "]"}]}], ";", "\n", "          ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eps", " ", "==", " ", "0"}], ",", " ", "\n", 
             "             ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"coreq", " ", "==", " ", "False"}], ",", " ", 
               RowBox[{"KernelSubCallFir", "[", 
                RowBox[{"game", ",", "dispres", ",", "callm", ",", "mth"}], 
                "]"}], ",", " ", 
               RowBox[{"KernelSubCallSec", "[", 
                RowBox[{"game", ",", "dispres", ",", "callm", ",", "mth"}], 
                "]"}]}], "\n", "               ", "]"}], ",", " ", 
             RowBox[{"KernelSubCallThir", "[", 
              RowBox[{
              "game", ",", "eps", ",", "dispres", ",", "callm", ",", "mth"}], 
              "]"}]}], "\n", "            ", "]"}]}], ",", " ", 
          RowBox[{"DisplayRemark", "[", "eps", "]"}]}], "    ", "\n", 
         "          ", "]"}]}], ";", "\n", "        ", 
       RowBox[{"DefineGame", "[", 
        RowBox[{"T", ",", "orgval"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Reconstruction", " ", "of", " ", "the", " ", "original", " ", 
         RowBox[{"game", "."}]}], " ", "*)"}], "\n", "        ", 
       RowBox[{"Chop", "[", 
        RowBox[{"Rationalize", "[", 
         RowBox[{"kersol", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "9"}], ")"}]}]}], "]"}], "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KernelSubCallFir", "[", 
    RowBox[{"game_", ",", "dispres_", ",", "callm_", ",", "mthd_"}], "]"}], ":=",
    " ", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "firstcrit", ",", "seccrit", ",", "newgame", ",", "nb", ",", 
       "alldelvar", ",", "dvar", ",", "objfunc", ",", "var", ",", "solut", 
       ",", "kersol", ",", "tra"}], "}"}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"firstcrit", " ", "=", " ", 
       RowBox[{
        RowBox[{"FirstCriticalVal", "[", "game", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\n", "        ", 
      RowBox[{"newgame", " ", "=", " ", 
       RowBox[{"EpsValue", "[", 
        RowBox[{"game", ",", " ", "firstcrit"}], "]"}]}], ";", "\n", 
      "        ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nb", ",", "alldelvar", ",", "dvar"}], "}"}], " ", "=", " ", 
       RowBox[{"AllConstraints", "[", "newgame", "]"}]}], ";", "\n", 
      "        ", 
      RowBox[{"objfunc", "=", " ", 
       RowBox[{"Total", "[", "dvar", "]"}]}], ";", "\n", "        ", 
      RowBox[{"var", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", "alldelvar"}], "]"}]}],
       ";", "\n", "        ", 
      RowBox[{"solut", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"callm", ",", "False"}], "]"}], ",", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{
           RowBox[{"-", "objfunc"}], ",", " ", "nb", ",", " ", "var", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
            "}"}], ",", 
           RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", " ", 
         RowBox[{"(*", "RevisedSimplex", " ", "*)"}], "\n", 
         "                              ", "True", ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"NMaximize", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"{", "nb", "}"}], ",", "objfunc"}], "]"}], ",", "var", 
             ",", 
             RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
      "        ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"callm", ",", "False"}], "]"}], ",", 
        RowBox[{"solut", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"solut", ",", 
           RowBox[{
            RowBox[{"{", "2", "}"}], "->", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", 
                RowBox[{"solut", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}], ",", "True"}], "]"}], ";", "\n", "        ", 
      RowBox[{"kersol", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", " ", "/@", " ", "T"}], ")"}], " ", "/.", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"solut", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}]}], ";", "\n", 
      "        ", 
      RowBox[{"tra", "=", " ", 
       RowBox[{"dvar", " ", "/.", " ", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"solut", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Length", "[", "alldelvar", "]"}]}]}], "]"}]}]}], ";", 
      "\n", "        ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", "kersol", ",", 
        " ", "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "kersol", ",", "objfunc", ",", "nb", ",", "var", ",", "tra"}], 
         "}"}]}], "]"}]}]}], "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->\
"6e3c5d2b-c3f1-4d54-959d-a11d375f6d8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KernelSubCallSec", "[", 
     RowBox[{"game_", ",", "dispres_", ",", "callm_", ",", "mthd_"}], "]"}], ":=",
     " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nb", ",", "alldelvar", ",", "dvar", ",", "objfunc", ",", "var", ",", 
        "solut", ",", "kersol", ",", "tra"}], "}"}], ",", "\n", 
      "             ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nb", ",", "alldelvar", ",", "dvar"}], "}"}], " ", "=", " ", 
        
        RowBox[{"AllConstraints", "[", "game", "]"}]}], ";", " ", "\n", 
       "             ", 
       RowBox[{"objfunc", "=", " ", 
        RowBox[{"Total", "[", "dvar", "]"}]}], ";", "\n", "             ", 
       RowBox[{"var", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", "alldelvar"}], 
         "]"}]}], ";", "\n", "             ", 
       RowBox[{"solut", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"callm", ",", "False"}], "]"}], ",", 
          RowBox[{"LinearOptimization", "[", 
           RowBox[{
            RowBox[{"-", "objfunc"}], ",", " ", "nb", ",", " ", "var", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
             "}"}], ",", 
            RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", "  ", "\n", 
          "                                   ", "True", ",", 
          RowBox[{"Rationalize", "[", 
           RowBox[{
            RowBox[{"NMaximize", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"{", "nb", "}"}], ",", "objfunc"}], "]"}], ",", "var",
               ",", 
              RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"callm", ",", "False"}], "]"}], ",", 
         RowBox[{"solut", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"solut", ",", 
            RowBox[{
             RowBox[{"{", "2", "}"}], "->", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"solut", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
           "]"}]}], ",", "True"}], "]"}], ";", "\n", "             ", 
       RowBox[{"kersol", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", " ", "/@", " ", "T"}], ")"}], " ", "/.", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"solut", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}]}]}], ";", "\n", 
       "             ", 
       RowBox[{"tra", "=", " ", 
        RowBox[{"dvar", " ", "/.", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"solut", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Length", "[", "alldelvar", "]"}]}]}], "]"}]}]}], ";", 
       "\n", "             ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", "kersol", ",", 
         " ", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "kersol", ",", "objfunc", ",", "nb", ",", "var", ",", "tra"}], 
          "}"}]}], "]"}]}]}], "\n", "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KernelSubCallThir", "[", 
    RowBox[{
    "game_", ",", "eps_", ",", "dispres_", ",", "callm_", ",", "mthd_"}], 
    "]"}], ":=", " ", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newgame", ",", "nb", ",", "alldelvar", ",", "dvar", ",", "objfunc", 
       ",", "var", ",", "solut", ",", "kersol", ",", "tra"}], "}"}], ",", 
     "\n", "      ", 
     RowBox[{
      RowBox[{"newgame", " ", "=", " ", 
       RowBox[{"EpsValue", "[", 
        RowBox[{"game", ",", " ", "eps"}], "]"}]}], ";", "\n", "      ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nb", ",", "alldelvar", ",", "dvar"}], "}"}], " ", "=", " ", 
       RowBox[{"AllConstraints", "[", "newgame", "]"}]}], ";", "\n", "      ", 
      RowBox[{"objfunc", "=", " ", 
       RowBox[{"Total", "[", "dvar", "]"}]}], ";", "\n", "      ", 
      RowBox[{"var", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"x", " ", "/@", " ", "T"}], ",", " ", "alldelvar"}], "]"}]}],
       ";", "\n", "      ", 
      RowBox[{"solut", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"callm", ",", "False"}], "]"}], ",", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{
           RowBox[{"-", "objfunc"}], ",", " ", "nb", ",", " ", "var", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
            "}"}], ",", 
           RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", " ", "\n", 
         "                            ", "True", ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"NMaximize", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"{", "nb", "}"}], ",", "objfunc"}], "]"}], ",", "var", 
             ",", 
             RowBox[{"Method", "->", " ", "mthd"}]}], "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"callm", ",", "False"}], "]"}], ",", 
        RowBox[{"solut", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"solut", ",", 
           RowBox[{
            RowBox[{"{", "2", "}"}], "->", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", 
                RowBox[{"solut", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}], ",", "True"}], "]"}], ";", "\n", "      ", 
      RowBox[{"kersol", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", " ", "/@", " ", "T"}], ")"}], " ", "/.", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"solut", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}]}], ";", "\n", "      ", 
      RowBox[{"tra", "=", " ", 
       RowBox[{"dvar", " ", "/.", " ", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"solut", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Length", "[", "alldelvar", "]"}]}]}], "]"}]}]}], ";", 
      "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "False"}], "]"}], ",", " ", "kersol", ",", 
        " ", "True", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "kersol", ",", "objfunc", ",", "nb", ",", "var", ",", "tra"}], 
         "}"}]}], "]"}]}]}], "\n", "\n", "]"}]}], ";"}]}], "Code",ExpressionUU\
ID->"96c7639c-5dc8-48d6-9452-311ea690c06a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Constructing", " ", "one", " ", "large", " ", "LP", " ", "for", " ", 
    RowBox[{"Kernel", "[", "]"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AllConstraints", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AllConstraints", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllConstraints", "[", "game_", "]"}], ":=", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"anf", "=", "T"}], ",", "rest", ",", "pi", ",", "pj", ",", 
         "const", ",", 
         RowBox[{"conset", "=", 
          RowBox[{"{", "}"}]}], ",", "sub", ",", 
         RowBox[{"deltaset", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"deltavar", "=", 
          RowBox[{"{", "}"}]}], ",", "newconst", ",", "constsys"}], "}"}], 
       ",", "\n", "      ", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "anf", "]"}], ">", "1"}], ",", "\n", 
          "      ", 
          RowBox[{
           RowBox[{"pi", "=", 
            RowBox[{"First", "[", "anf", "]"}]}], ";", "\n", "      ", 
           RowBox[{"rest", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"anf", ",", "1"}], "]"}]}], ";", "\n", "      ", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "rest", "]"}], ">", "0"}], ",", 
             RowBox[{
              RowBox[{"pj", "=", 
               RowBox[{"First", "[", "rest", "]"}]}], ";", "\n", "        ", 
              RowBox[{"const", "=", 
               RowBox[{"TransferConstraints", "[", 
                RowBox[{"game", ",", "pi", ",", "pj"}], "]"}]}], ";", "\n", 
              "        ", 
              RowBox[{"sub", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Rule", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", " ", "Global`\[Delta]", " ", "}"}], ",", " ", 
                   
                   RowBox[{"{", 
                    RowBox[{"Global`\[Delta]", "[", 
                    RowBox[{"pi", ",", "pj"}], "]"}], "}"}]}], "}"}]}], 
                "]"}]}], ";", "\n", "        ", 
              RowBox[{"deltavar", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"deltavar", ",", 
                 RowBox[{"{", 
                  RowBox[{"Global`\[Delta]", "[", 
                   RowBox[{"pi", ",", "pj"}], "]"}], "}"}]}], "]"}]}], ";", 
              "\n", "        ", 
              RowBox[{"newconst", "=", 
               RowBox[{"const", "/.", "sub"}]}], ";", "\n", "        ", 
              RowBox[{"conset", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"conset", ",", "newconst"}], "]"}]}], ";", "\n", 
              "        ", 
              RowBox[{"rest", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"rest", ",", "1"}], "]"}]}], ";"}]}], "\n", 
            "        ", "]"}], ";", "\n", "      ", 
           RowBox[{"anf", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"anf", ",", "1"}], "]"}]}], ";"}]}], "]"}], ";", "\n", 
        "    ", 
        RowBox[{"constsys", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "conset", "]"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"{", 
         RowBox[{"constsys", ",", 
          RowBox[{"Flatten", "[", "deltavar", "]"}], ",", 
          RowBox[{"Flatten", "[", "deltavar", "]"}]}], "}"}]}]}], "\n", 
      "    ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"NewKernel", " ", "section", " ", "ends"}], " ", "*)"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Section", " ", "starts", " ", "to", " ", "determine", " ", "a", " ", 
     "Kernel", " ", "Range", " ", "from", " ", "an", " ", 
     RowBox[{"LP", "."}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelVertices", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"KernelVertices", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KernelVertices", "[", 
      RowBox[{"game_", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "KernelVertices", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "callm", ",", " ", "mthd", ",", " ", "sil", ",", " ", "epsval", ",", 
         " ", "fieps", ",", " ", "kerli", ",", " ", "ratkli", ",", " ", "sol",
          ",", " ", "obj", ",", " ", "const", ",", " ", "var", ",", " ", 
         "trans", ",", "kerQ", ",", "posker", ",", "prkQ", ",", "posprk", ",",
          "kl", ",", "pkl"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"callm", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "CallMaximize", "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"mthd", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
        RowBox[{"sil", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
        RowBox[{"epsval", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"fieps", "=", " ", 
         RowBox[{
          RowBox[{"FirstCriticalVal", "[", "game", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"epsval", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"epsval", " ", "<", " ", "fieps"}], ",", " ", "fieps", ",",
            "epsval"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "sol", ",", " ", "obj", ",", " ", "const", ",", " ", "var", ",", 
           " ", "trans"}], "}"}], " ", "=", " ", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"callm", ",", "True"}], "]"}], ",", "  ", 
           RowBox[{"Kernel", "[", 
            RowBox[{"game", ",", " ", 
             RowBox[{"CallMaximize", " ", "->", " ", "True"}], ",", " ", 
             RowBox[{"Method", "->", "mthd"}], ",", " ", 
             RowBox[{"EpsilonValue", " ", "->", " ", "epsval"}], ",", " ", 
             RowBox[{"DisplayAllResults", " ", "->", " ", "True"}]}], "]"}], 
           ",", " ", "\n", "            ", "True", ",", "  ", 
           RowBox[{"Kernel", "[", 
            RowBox[{"game", ",", " ", 
             RowBox[{"CallMaximize", " ", "->", " ", "False"}], ",", " ", 
             RowBox[{"Method", "->", "mthd"}], ",", " ", 
             RowBox[{"EpsilonValue", " ", "->", " ", "epsval"}], ",", " ", 
             RowBox[{"DisplayAllResults", " ", "->", " ", "True"}]}], "]"}]}],
           "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<sol: \>\"", ",", " ", "sol"}], "]"}], ",", "True"}], 
         "]"}], ";", "\n", "    ", 
        RowBox[{"kerli", " ", "=", " ", 
         RowBox[{"DetermineAddVertices", "[", 
          RowBox[{
           RowBox[{"{", "sol", "}"}], ",", " ", "obj", ",", " ", "const", ",",
            " ", "var", ",", " ", "T", ",", " ", "callm", ",", "sil", ",", 
           "mthd"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<kerli: \>\"", ",", " ", "kerli"}], "]"}], ",", " ", 
          "True"}], "]"}], ";", "\n", "    ", 
        RowBox[{"ratkli", " ", "=", " ", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"#", ",", 
              RowBox[{"1.5", "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "12"}], ")"}]}]}]}], "]"}], "&"}], "/@", " ", 
           "kerli"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"kerQ", "=", 
         RowBox[{"KernelImputationListQ", "[", 
          RowBox[{"game", ",", "ratkli"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"prkQ", "=", 
         RowBox[{"PreKernelQ", "[", 
          RowBox[{"game", ",", "ratkli"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"posker", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"kerQ", ",", "True"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"posprk", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"prkQ", ",", "True"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"kl", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{"ratkli", ",", " ", "posker"}], "]"}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"pkl", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{"ratkli", ",", " ", "posprk"}], "]"}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"kl", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"pkl", ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Pre-Kernel Element found!\>\"", "]"}],
              ";", "pkl"}]}], "]"}], ",", "kl"}], "]"}]}]}], "\n", "    ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"4d96c250-a6bb-4b1d-91a9-\
5d958fb682e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetermineAddVertices", "[", 
    RowBox[{
    "sol_", ",", " ", "obj_", ",", " ", "const_", " ", ",", " ", "var_", " ", 
     ",", " ", "T_", ",", " ", "callm_", ",", "sil_", ",", " ", "mth_", ",", 
     " ", 
     RowBox[{"zf_List", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nwzf", ",", "dures", ",", "valzf", ",", "boolzf", ",", "dualvar", ",", 
       "yset", ",", "duyp", ",", "newineq", ",", "nwsol", ",", "prmax", ",", 
       "lngt", ",", "kersolQ", ",", 
       RowBox[{"oldres", "=", "sol"}]}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"nwzf", " ", "=", " ", 
       RowBox[{"Total", "[", "var", "]"}]}], ";", "\n", "    ", 
      RowBox[{"dures", " ", "=", " ", 
       RowBox[{"SolveDual", "[", 
        RowBox[{"nwzf", ",", " ", "const", ",", " ", "var"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"valzf", " ", "=", " ", 
       RowBox[{"First", "[", "dures", "]"}]}], ";", "\n", "    ", 
      RowBox[{"boolzf", " ", "=", " ", 
       RowBox[{"SameQ", "[", 
        RowBox[{"valzf", ",", "zf"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"boolzf", ",", "True"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "oldres", "]"}], ",", " ", "True", ",", " ", 
        "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"dualvar", " ", "=", " ", 
       RowBox[{"Global`y", " ", "/@", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"Last", "[", "dures", "]"}], "]"}]}], "}"}]}], "]"}]}]}],
       ";", "\n", "    ", 
      RowBox[{"yset", " ", "=", " ", 
       RowBox[{"dualvar", " ", "/.", " ", 
        RowBox[{"Last", "[", "dures", "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"duyp", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"yset", ",", " ", "0"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"newineq", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"const", ",", " ", "duyp"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"nwsol", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"callm", ",", "True"}], "]"}], ",", " ", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"NMaximize", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"{", "newineq", "}"}], ",", "nwzf"}], "]"}], ",", "var",
             ",", 
            RowBox[{"Method", "->", "mth"}]}], "]"}], "]"}], ",", "\n", 
         "                    ", "True", ",", " ", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{
           RowBox[{"-", "nwzf"}], ",", " ", "newineq", ",", " ", "var", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PrimalMinimumValue\>\"", ",", "\"\<PrimalMinimizer\>\""}], 
            "}"}], ",", 
           RowBox[{"Method", "->", "mth"}]}], "]"}]}], "]"}]}], ";", " ", 
      "\n", " ", 
      RowBox[{"(*", "   ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<nwsol=\>\"", ",", "nwsol"}], "]"}], ";"}], " ", "*)"}], 
      "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"First", "[", "nwsol", "]"}], ",", "Infinity"}], "]"}], ",",
         " ", 
        RowBox[{"Return", "[", "oldres", "]"}], ",", "\n", "          ", 
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"First", "[", "nwsol", "]"}], ",", 
          RowBox[{"-", "Infinity"}]}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "oldres", "]"}], ",", "  ", "\n", "          ",
         "True", ",", "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<nwsol2=\>\"", ",", "nwsol"}], "]"}], ";"}], "*)"}], 
      "\n", "    ", 
      RowBox[{"prmax", " ", "=", " ", 
       RowBox[{"First", "[", "nwsol", "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sil", ",", "False"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<DualSol: \>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "[", "dures", "]"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Last", "[", "dures", "]"}], ",", "duyp"}], "]"}]}], 
            "}"}]}], "]"}], ";", "\n", "                           ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<PrimalSol: \>\"", ",", "nwsol"}], "]"}], ";"}], ",", 
        "\n", "                ", "True", ",", "True"}], "]"}], ";", "\n", 
      "    ", 
      RowBox[{"lngt", " ", "=", " ", 
       RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"kersolQ", " ", "=", " ", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"var", ",", " ", "lngt"}], "]"}], " ", "/.", " ", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Last", "[", "nwsol", "]"}], ",", " ", "lngt"}], "]"}]}]}], 
      ";", "\n", "    ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"oldres", ",", " ", "kersolQ"}], "]"}], ";", "\n", "    ", 
      RowBox[{"oldres", " ", "=", " ", 
       RowBox[{"Union", "[", "oldres", "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sol", ",", "oldres"}], "]"}], " ", "&&", " ", 
          RowBox[{"Greater", "[", 
           RowBox[{
            RowBox[{"2", "*", "prmax"}], ",", "valzf"}], "]"}]}], ")"}], ",", 
        " ", "oldres", ",", " ", "True", ",", " ", "\n", "      ", 
        RowBox[{"DetermineAddVertices", "[", 
         RowBox[{
         "oldres", ",", " ", "obj", ",", " ", "newineq", ",", " ", "var", ",",
           " ", "T", ",", " ", "callm", ",", " ", "sil", ",", " ", "mth", " ",
           ",", " ", "valzf"}], "]"}]}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"4fdae2dd-787e-48eb-9903-f8bd520559a2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Section", " ", "ends", " ", "to", " ", "determine", " ", "a", " ", 
   "Kernel", " ", "Range", " ", "from", " ", "an", " ", 
   RowBox[{"LP", "."}]}], " ", "*)"}]], "Code",ExpressionUUID->"a604dc40-82c8-\
47a2-a92f-639b1119006b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Section", " ", "starts", " ", "to", " ", "determine", " ", "a", " ", 
     "PreKernel", " ", "solution", " ", "by", " ", "a", " ", "modified", " ", 
     "SDM"}], "-", "Method"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", "\n", "  ", 
   RowBox[{"First", ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "introduce", " ", "the", " ", "user", " ", "interface", " ", 
      "to", " ", "compute", " ", "an", " ", "anti"}], "-", "pre", "-", 
     RowBox[{"kernel", " ", "of", " ", "the", " ", 
      RowBox[{"game", ".", "\n", "  ", "The"}], " ", "anti"}], "-", "pre", 
     "-", 
     RowBox[{
     "kernel", " ", "solution", " ", "is", " ", "just", " ", "a", " ", 
      "reflection", " ", "of", " ", "the", " ", "pre"}], "-", 
     RowBox[{"kernel", " ", 
      RowBox[{"solution", ".", " ", "Instead"}], "\n", "  ", "of", " ", 
      "balancing", " ", "the", " ", "maximum", " ", "excesses", " ", "among", 
      " ", "each", " ", "pair", " ", "of", " ", "player"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "balances", " ", "the", " ", "minimal", "\n", "  ", 
      RowBox[{"excesses", ".", " ", "A"}], " ", "formal", " ", "definition", 
      " ", "of", " ", "the", " ", "anti"}], "-", "pre", "-", 
     RowBox[{"kernel", " ", "can", " ", "be", " ", "found", " ", "in", " ", 
      RowBox[{"Y", ".", " ", "Funaki"}], " ", "and", "\n", "  ", 
      RowBox[{"H", ".", " ", "Meinhardt"}], " ", 
      RowBox[{
       RowBox[{"(", "2006", ")"}], "."}]}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AntiPreKernelSolution", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AntiPreKernelSolution", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AntiPreKernelSolution", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "AntiPreKernelSolution", "]"}]}]}], 
      "]"}], " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"pay", " ", "=", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"v", "[", "T", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
          RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
        RowBox[{"AntiPreKernelSolution", "[", 
         RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"9f7ce2c5-d924-4c14-8e6e-\
5cd4c7759ed4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AntiPreKernelSolution", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "AntiPreKernelSolution", "]"}]}]}], 
     "]"}], " ", ":=", " ", "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "showzf", ",", "rattol", ",", "conjfu", ",", "sil", ",", "anti", ",", 
        "mth", ",", "ext"}], "}"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"showzf", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "ShowObjectiveFunction", "]"}]}], ";", 
       "\n", "      ", 
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"conjfu", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "ConjugateFunction", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "      ", 
       RowBox[{"anti", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "AntiPreKernel", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", " ", "\n", 
       "      ", 
       RowBox[{"ext", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SolutionExact", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"PreKernelSolution", "[", 
        RowBox[{"game", ",", " ", "payoff", ",", " ", 
         RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
         RowBox[{"ConjugateFunction", " ", "->", " ", "conjfu"}], ",", " ", 
         RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
         RowBox[{"ShowObjectiveFunction", " ", "->", " ", "showzf"}], ",", 
         " ", 
         RowBox[{"RationalTol", " ", "->", " ", "rattol"}], ",", " ", 
         RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
         RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], "]"}]}]}], "\n", 
     " ", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", "  ", 
   RowBox[{
    RowBox[{
    "User", " ", "interface", " ", "to", " ", "calculate", " ", "a", " ", 
     "pre"}], "-", 
    RowBox[{
    "kernel", " ", "solution", " ", "by", " ", "a", " ", "mixture", " ", "of",
      " ", "Algorithm", " ", "8.1", ".1", "\n", "  ", "and", " ", "8.2", ".1",
      " ", "of", " ", "Meinhardt", " ", 
     RowBox[{
      RowBox[{"(", "2013", ")"}], ".", "\n", "  ", "The"}], " ", "algorithms",
      " ", "rely", " ", "on", " ", "the", " ", "indirect", " ", "function", 
     " ", 
     RowBox[{"approach", ".", " ", "See"}], " ", "Meseguer"}], "-", 
    RowBox[{"Artola", " ", 
     RowBox[{"(", "1997", ")"}], " ", "and", " ", "Meinhardt", " ", 
     RowBox[{
      RowBox[{"(", "2013", ")"}], ".", "\n", "  ", "The"}], " ", "indirect", 
     " ", "characteristic", " ", "function", " ", "is", " ", "the", " ", 
     "conjugate", " ", 
     RowBox[{"(", 
      RowBox[{"Fenchel", " ", "transform"}], ")"}], " ", "of", " ", "the", 
     " ", "characteristic", " ", 
     RowBox[{"function", ".", "\n", "  ", "See"}], " ", "Martinez"}], "-", 
    RowBox[{"Legaz", " ", 
     RowBox[{
      RowBox[{"(", "1996", ")"}], "."}]}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PreKernelSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"PreKernelSolution", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PreKernelSolution", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pay", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"PreKernelSolution", "[", 
       RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"08a5ec72-265b-4679-a055-\
e3ee414abad3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreKernelSolution", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dimCorQ", ",", " ", "showzf", ",", "rattol", ",", "conjfu", ",", 
        "sil", ",", "anti", ",", "mth", ",", "ext", ",", "allres", ",", 
        "ratres", ",", "res", ",", "detobj", ",", "grad", ",", "conj", ",", 
        "smc", ",", "rclim"}], "}"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{"FindMinimum", "::", "fmgz"}], "]"}], ";", "\n", "      ", 
       RowBox[{"dimCorQ", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "3"}], ",",
           " ", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], ",", 
                RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "True", ",", 
              " ", "False"}], "]"}], "&"}], "/@", " ", "payoff"}], ",", "\n", 
          "                      ", 
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}], ",",
           " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Length", "[", "payoff", "]"}], ",", 
              RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "True", ",", 
            " ", "False"}], "]"}], ",", " ", "\n", "                      ", 
          "True", ",", " ", "False"}], "\n", "                ", "]"}]}], ";",
        "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", "dimCorQ"}], "]"}], "===", "False"}], ",", 
         RowBox[{"WrongDimension", ";", 
          RowBox[{"Return", "[", "]"}]}], ",", "True"}], "]"}], ";", "\n", 
       "      ", 
       RowBox[{"showzf", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "ShowObjectiveFunction", "]"}]}], ";", 
       "\n", "      ", 
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"conjfu", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "ConjugateFunction", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "      ", 
       RowBox[{"anti", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "AntiPreKernel", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "      ", 
       RowBox[{"ext", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SolutionExact", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", "\n",
        "      ", 
       RowBox[{"rclim", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "11"}], ",", 
          "256", ",", "156"}], "]"}]}], ";", "\n", "      ", 
       RowBox[{"allres", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Depth", "[", "payoff", "]"}], ",", "3"}], "]"}], ",", 
          " ", "\n", "                       ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",", 
            
            RowBox[{
             RowBox[{
              RowBox[{"SDMPreKernel", "[", 
               RowBox[{"game", ",", "#", ",", "Infinity", ",", 
                RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
                RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
                RowBox[{"RationalTol", "->", "rattol"}], ",", " ", 
                RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
                RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}], ",", 
                " ", 
                RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], "]"}], 
              " ", "&"}], "/@", " ", "payoff"}]}], "]"}], ",", "\n", 
          "                     ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Depth", "[", "payoff", "]"}], ",", "2"}], "]"}], ",", 
          " ", "\n", "                       ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",", 
            
            RowBox[{"SDMPreKernel", "[", 
             RowBox[{"game", ",", " ", "payoff", ",", "Infinity", ",", " ", 
              RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
              RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
              RowBox[{"RationalTol", "->", "rattol"}], ",", "  ", 
              RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
              RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}], ",", 
              " ", 
              RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], "]"}]}], 
           "]"}], ",", "\n", "                     ", "True", ",", " ", 
          RowBox[{"DisplayMessFindKernel", "[", "payoff", "]"}]}], "\n", 
         "                     ", "]"}]}], ";", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "allres", "]"}], ",", "List"}], "]"}], ",", 
         "True", ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{"Rationalize", "[", 
            RowBox[{
             RowBox[{"N", "[", "payoff", "]"}], ",", "rattol"}], "]"}], "]"}],
           "]"}]}], "]"}], ";", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"NumericQ", "[", "#", "]"}]}], "]"}], " ", "&"}], "/@", 
          " ", "allres"}], ",", "True", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{"Rationalize", "[", 
            RowBox[{
             RowBox[{"N", "[", "payoff", "]"}], ",", "rattol"}], "]"}], "]"}],
           "]"}]}], "]"}], ";", "\n", "      ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"In", " ", "the", " ", "next", " ", "line"}], ",", " ", 
         RowBox[{
          RowBox[{
          "we", " ", "are", " ", "trying", " ", "to", " ", "handle", " ", 
           "the", " ", "exceeded", " ", "depth", " ", "of", " ", 
           "$RecursionLimit", " ", "in", " ", "case", " ", "for", " ", 
           "SolutionExact"}], " ", "->", " ", "False"}]}], "   ", "*)"}], 
       "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"First", "[", "allres", "]"}], "]"}], ",", "ReplaceAll"}],
           "]"}], ",", 
         RowBox[{"allres", "=", 
          RowBox[{
           RowBox[{"allres", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "/.", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Rule", ",", " ", 
               RowBox[{"allres", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", 
               RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}]}], ",", 
         "True"}], "]"}], ";", "\n", "      ", 
       RowBox[{"ratres", " ", "=", " ", 
        RowBox[{"Chop", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"N", "[", "allres", "]"}], ",", "rattol"}], "]"}], "]"}]}],
        ";", "\n", "      ", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "3"}], ",",
           " ", 
          RowBox[{"Union", "[", "ratres", "]"}], ",", "\n", 
          "                  ", 
          RowBox[{
           RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}], ",",
           " ", "ratres", ",", "\n", "                  ", "True", ",", 
          "ratres"}], "\n", "                  ", "]"}]}], ";", "\n", 
       "      ", 
       RowBox[{"detobj", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"showzf", " ", "||", " ", "conjfu"}], ",", "True"}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Depth", "[", "res", "]"}], "===", " ", "3"}], ",", " ", 
            
            RowBox[{
             RowBox[{
              RowBox[{"DetObjFunc", "[", 
               RowBox[{"game", ",", "#", ",", 
                RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
                RowBox[{"Silent", " ", "->", " ", "sil"}]}], "]"}], "&"}], "/@",
              " ", "res"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"DetObjFunc", "[", 
              RowBox[{"game", ",", "res", ",", " ", 
               RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
               RowBox[{"Silent", " ", "->", " ", "sil"}]}], "]"}], "}"}]}], 
           "]"}], ",", "\n", "                    ", "True", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "      ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"grad", ",", "conj"}], "}"}], " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"conjfu", ",", "True"}], "]"}], ",", " ", "\n", 
          "                      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "detobj", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "res", "]"}]}], ",", " ", 
            RowBox[{"FormatConjugateRes", "[", 
             RowBox[{"game", ",", "detobj", ",", " ", 
              RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
              RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], " ", "]"}], 
            " ", ",", "\n", "                            ", 
            RowBox[{
             RowBox[{"Length", "[", "detobj", "]"}], " ", "===", " ", "1"}], 
            ",", " ", 
            RowBox[{"ConvexConjugate", "[", 
             RowBox[{"game", ",", "detobj", ",", " ", 
              RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
              RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], "]"}], ",", 
            "\n", "                            ", "True", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", "\n", 
          "                      ", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "\n", "                         ", 
         "]"}]}], ";", "\n", "      ", 
       RowBox[{"grad", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "grad", "]"}], " ", "===", " ", "3"}], ",", 
          " ", 
          RowBox[{"Union", "[", "grad", "]"}], ",", "\n", 
          "                  ", 
          RowBox[{
           RowBox[{"Depth", "[", "grad", "]"}], " ", "===", " ", "2"}], ",", 
          " ", "grad", ",", "\n", "                  ", "True", ",", "grad"}],
          "\n", "                  ", "]"}]}], ";", "\n", "      ", 
       RowBox[{"detobj", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "conj", "]"}], " ", "===", " ", "0"}], ",", 
          " ", "detobj", ",", " ", "\n", "                   ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "detobj", "]"}], " ", "===", " ", 
             RowBox[{"Length", "[", "res", "]"}]}], ",", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "#1", "}"}], ",", "#2"}], "}"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"detobj", ",", "conj"}], "}"}]}], "]"}], ",", "\n", 
            "                         ", 
            RowBox[{
             RowBox[{"Length", "[", "detobj", "]"}], " ", "===", " ", "1"}], 
            ",", " ", 
            RowBox[{"FlattenAt", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "#1", "}"}], ",", 
                   RowBox[{"{", "#2", "}"}]}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"detobj", ",", "conj"}], "}"}]}], "]"}], ",", "1"}], 
             "]"}], ",", "\n", "                         ", "True", ",", " ", 
            
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", 
              RowBox[{"{", 
               RowBox[{"detobj", ",", "conj"}], "}"}]}], "]"}]}], "\n", 
           "                         ", "]"}]}], "\n", "                 ", 
         "]"}]}], ";", "\n", "      ", 
       RowBox[{"On", "[", 
        RowBox[{"FindMinimum", "::", "fmgz"}], "]"}], ";", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"showzf", ",", "False"}], "]"}], ",", " ", "res", ",", " ", 
         "\n", "                 ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"Depth", "[", "res", "]"}], ",", "3"}], "]"}], " ", "&&",
               " ", 
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"Length", "[", "res", "]"}], ",", "1"}], "]"}]}], 
             ")"}], "===", "True"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Flatten", "[", "res", "]"}], ",", " ", "detobj", ",", 
             "grad"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"res", ",", "detobj", ",", "grad"}], "}"}]}], "]"}]}], 
        "]"}]}]}], "\n", "   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WrongDimension", ":=", 
    RowBox[{"(", 
     RowBox[{
     "Print", "[", "\"\<Payoff vector has not the correct dimension!\>\"", 
      "]"}], ")"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WrongCoordDimension", "[", "T_", "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "      ", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<List of unanimity coordinates of size 2 has not the correct \
length!\>\"", "]"}], ";", "\n", "      ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The correct dimension is: \>\"", ",", " ", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}]}], "]"}], 
      ";"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WrongCoordDimension", "[", 
    RowBox[{"coord_List", ",", "T_"}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "      ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<List of unanimity coordinates of length \>\"", ",", " ", 
        RowBox[{"Length", "[", "coord", "]"}]}], "]"}], ";", "\n", "      ", 
      RowBox[{"Print", "[", "\"\<is not correct!\>\"", "]"}], ";", "\n", 
      "      ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The correct dimension is: \>\"", ",", " ", 
        RowBox[{"2", "^", 
         RowBox[{"Length", "[", "T", "]"}]}]}], "]"}], ";"}]}], "\n", "]"}]}],
   ";"}], "\n"}], "Code",ExpressionUUID->"8866b8af-0933-4d4f-ab6f-\
c459146e26a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FormatConjugateRes", "[", 
     RowBox[{"game_", ",", "detobj_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], ":=",
     " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sil", ",", "cr", ",", "gradv", ",", "cflist"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"ext", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SolutionExact", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"cr", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ConvexConjugate", "[", 
           RowBox[{"game", ",", "#", ",", " ", 
            RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
            RowBox[{"SolutionExact", " ", "->", " ", "False"}]}], "]"}], 
          "&"}], "/@", " ", "detobj"}]}], ";", "\n", "    ", 
       RowBox[{"gradv", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "cr"}]}], 
       ";", "\n", "    ", 
       RowBox[{"cflist", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#", "]"}], " ", "&"}], "/@", " ", "cr"}]}], 
       ";", "\n", "    ", 
       RowBox[{"{", 
        RowBox[{"gradv", ",", "cflist"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", "\n", " ", 
   RowBox[{
    RowBox[{"Based", " ", "on", " ", "Algorithm", " ", 
     RowBox[{"8.1", ".", " ", "and"}], " ", "8.2", " ", "of", " ", 
     "Meinhardt"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "2013", ")"}], "."}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SDMPreKernel", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", 
      RowBox[{"optval_", ":", "Infinity"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "smc", ",", "sil", ",", "anti", ",", "mth", ",", "rattol", ",", "ext", 
        ",", "rl", ",", "obj", ",", "var", ",", "init", ",", "minval", ",", 
        "nwpay", ",", "meff", ",", "matE", ",", "matQ", ",", "vmeff", ",", 
        "ralpv", ",", "alpv", ",", "bvec", ",", "sumexc"}], "}"}], ",", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"anti", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "AntiPreKernel", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"ext", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SolutionExact", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"mth", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
       RowBox[{"rattol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", "    ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"var", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"rl", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{"var", ",", " ", "payoff"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ext", ",", "False"}], "]"}], ",", "\n", "       ", 
         RowBox[{
          RowBox[{"obj", " ", "=", " ", 
           RowBox[{"DetObjFunc", "[", 
            RowBox[{"game", ",", " ", "payoff", ",", " ", 
             RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
             RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
             RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], 
            "]"}]}], ";", "\n", "       ", 
          RowBox[{"obj", " ", "=", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "mth", "]"}], ",", "\"\<GUROBI\>\""}],
               "]"}], ",", 
             RowBox[{"{", "obj", "}"}], ",", " ", "\n", "             ", 
             RowBox[{"SameQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "mth", "]"}], ",", "\"\<MOSEK\>\""}], 
              "]"}], ",", 
             RowBox[{"{", "obj", "}"}], ",", "\n", "             ", 
             RowBox[{"SameQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "mth", "]"}], ",", "\"\<IPOPT\>\""}], 
              "]"}], ",", 
             RowBox[{"{", "obj", "}"}], ",", " ", "\n", "             ", 
             "True", ",", "obj"}], "]"}]}], ";", "\n", "       ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Head", "[", "obj", "]"}], ",", "Plus"}], "]"}], ",", 
            RowBox[{"sumexc", "=", 
             RowBox[{"First", "[", 
              RowBox[{
               RowBox[{"{", "obj", "}"}], " ", "/.", " ", "rl"}], "]"}]}], 
            ",", " ", "\n", "             ", 
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "obj", "]"}], "]"}], ",", "Plus"}], 
             "]"}], ",", "\n", "                        ", 
            RowBox[{
             RowBox[{"sil", "=", "True"}], ";", "\n", 
             "                        ", 
             RowBox[{"sumexc", "=", 
              RowBox[{"First", "[", 
               RowBox[{"obj", " ", "/.", " ", "rl"}], "]"}]}]}], ",", "\n", 
            "             ", "True", ",", 
            RowBox[{"Return", "[", "payoff", "]"}]}], "]"}], ";", "\n", 
          "       ", 
          RowBox[{"init", " ", "=", " ", 
           RowBox[{"rl", " ", "/.", " ", 
            RowBox[{"Rule", " ", "->", " ", "List"}]}]}], ";"}], ",", 
         "      ", "\n", "        ", 
         RowBox[{
          RowBox[{"meff", " ", "=", " ", 
           RowBox[{"Bestcoalij01", "[", 
            RowBox[{"game", ",", " ", "payoff", ",", " ", 
             RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
             RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
             
             RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], 
            "]"}]}], ";", " ", "\n", "        ", 
          RowBox[{"matE", " ", "=", " ", 
           RowBox[{
            RowBox[{"Developer`ToPackedArray", "[", 
             RowBox[{"-", 
              RowBox[{"SetsToVec", "[", 
               RowBox[{"meff", ",", " ", "T", ",", " ", 
                RowBox[{"EffVector", " ", "->", " ", "True"}]}], "]"}]}], 
             "]"}], " ", "//", "N"}]}], ";", "\n", "        ", 
          RowBox[{"matQ", " ", "=", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "matE", "]"}], ".", "matE"}]}], ";", 
          "\n", "        ", 
          RowBox[{"vmeff", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "#", "]"}], " ", "&"}], ",", " ", "#"}], 
              "]"}], " ", "&"}], " ", "/@", " ", "meff"}]}], ";", "\n", 
          "        ", 
          RowBox[{"ralpv", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1.", ",", " ", 
                RowBox[{"-", "1."}]}], "}"}], ".", "#"}], " ", "&"}], " ", "/@",
             " ", "vmeff"}]}], ";", "\n", "        ", 
          RowBox[{"alpv", " ", "=", " ", 
           RowBox[{"Prepend", "[", 
            RowBox[{"ralpv", ",", 
             RowBox[{"v", "[", "T", "]"}]}], "]"}]}], ";", "\n", "        ", 
          RowBox[{"bvec", " ", "=", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "matE", "]"}], ".", "alpv"}]}], ";", 
          "\n", "        ", 
          RowBox[{"sumexc", "=", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{"matE", ".", "payoff"}], "+", "alpv"}], "]"}], "^", 
            "2"}]}], ";"}]}], " ", "\n", "       ", "]"}], ";", "\n", "    ", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"LessEqual", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "sumexc", "]"}], ",", "rattol"}], "]"}], ",", 
         " ", 
         RowBox[{"Return", "[", "payoff", "]"}], ",", "True"}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"minval", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"ext", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"sil", ",", "True"}], "]"}], ",", " ", "\n", 
            "                                           ", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "mth", "]"}], ",", 
                "\"\<GUROBI\>\""}], "]"}], ",", 
              RowBox[{"FindMinimum", "[", 
               RowBox[{"obj", ",", " ", "init", ",", " ", 
                RowBox[{"Method", " ", "->", " ", "GUROBI"}]}], "]"}], ",", 
              "\n", "                                                 ", 
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "mth", "]"}], ",", "\"\<MOSEK\>\""}],
                "]"}], ",", 
              RowBox[{"FindMinimum", "[", 
               RowBox[{"obj", ",", " ", "init", ",", " ", 
                RowBox[{"Method", " ", "->", " ", "MOSEK"}]}], "]"}], ",", 
              "\n", "                                                 ", 
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "mth", "]"}], ",", "\"\<IPOPT\>\""}],
                "]"}], ",", 
              RowBox[{"FindMinimum", "[", 
               RowBox[{"obj", ",", " ", "init", ",", " ", 
                RowBox[{"Method", " ", "->", " ", "IPOPT"}]}], "]"}], ",", 
              " ", "\n", "                                                 ", 
              "True", ",", 
              RowBox[{"FindMinimum", "[", 
               RowBox[{"obj", ",", " ", "init", ",", " ", 
                RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
                RowBox[{"AccuracyGoal", " ", "->", " ", "20"}], ",", " ", 
                RowBox[{"PrecisionGoal", " ", "->", " ", "18"}], ",", " ", 
                RowBox[{"WorkingPrecision", "->", "40"}]}], "]"}]}], "]"}], 
            ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Approximate", " ", "solution"}], " ", "*)"}], " ", "\n",
             "                                           ", 
            RowBox[{"FindMinimum", "[", 
             RowBox[{"obj", ",", " ", "init", ",", " ", 
              RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
              RowBox[{"AccuracyGoal", " ", "->", " ", "20"}], ",", " ", 
              RowBox[{"PrecisionGoal", " ", "->", " ", "18"}], ",", " ", 
              RowBox[{"WorkingPrecision", "->", "40"}], ",", " ", 
              RowBox[{"StepMonitor", " ", ":>", " ", 
               RowBox[{"Print", "[", "init", "]"}]}]}], "]"}]}], "]"}], ",", 
          "\n", "                  ", "True", ",", " ", 
          RowBox[{
           RowBox[{"obj", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"SolveLinEQ", "[", 
            RowBox[{"matQ", ",", "bvec", ",", "var", ",", " ", 
             RowBox[{"Method", " ", "->", " ", "\"\<Automatic\>\""}], ",", 
             " ", 
             RowBox[{"Silent", " ", "->", " ", "sil"}]}], "]"}]}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Try", " ", "to", " ", "find", " ", "an", " ", "exact", " ", 
           "solution"}], " ", "*)"}], "\n", "             ", "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"nwpay", " ", "=", " ", 
        RowBox[{"var", " ", "/.", " ", 
         RowBox[{"minval", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", 
         RowBox[{
          RowBox[{"MessageSDMKer", "[", 
           RowBox[{"obj", ",", "minval", ",", "nwpay", ",", 
            RowBox[{"First", "[", "minval", "]"}], ",", "sumexc"}], "]"}], 
          ";", "\n", "        ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"ext", ",", "False"}], "]"}], ",", " ", 
            RowBox[{"SolveLinEQ", "[", 
             RowBox[{"matQ", ",", "bvec", ",", "var", ",", " ", 
              RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
              RowBox[{"Silent", " ", "->", " ", "False"}]}], "]"}], ",", 
            "True"}], "]"}]}], ",", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"LessEqual", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "sumexc", "]"}], ",", "rattol"}], "]"}], ",", 
         " ", "nwpay", ",", "  ", "\n", "               ", 
         RowBox[{"SDMPreKernel", "[", 
          RowBox[{"game", ",", " ", "nwpay", ",", " ", "sumexc", ",", " ", 
           RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
           RowBox[{"Method", " ", "->", " ", "mth"}], ",", " ", 
           RowBox[{"RationalTol", "->", "rattol"}], ",", 
           RowBox[{"Silent", " ", "->", " ", "sil"}], ",", 
           RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}], ",", 
           RowBox[{"SolutionExact", " ", "->", " ", "ext"}]}], "]"}]}], 
        "]"}]}]}], "\n", "   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MessageSDMKer", "[", 
    RowBox[{
     RowBox[{"zfc_List", ":", 
      RowBox[{"{", "}"}]}], ",", "minw_", ",", "nwaz_", ",", " ", "fucval_", 
     ",", " ", "addexc_"}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The objective function h is: \>\"", ",", "zfc"}], "]"}], 
      ";", "\n", "        ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The local minimum of h is: \>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"minw", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", "\n", 
      "        ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The local minimum of the objective function h is at:\\n \>\"", 
        ",", "nwaz"}], "]"}], ";", "\n", 
      RowBox[{"(*", "        ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<The maximum surpluses are:\\n\>\"", ",", " ", "mexc"}], 
         "]"}], ";"}], "*)"}], "\n", "        ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The value of the original objective function H is:\\n \>\"", ",", 
        
        RowBox[{"{", 
         RowBox[{"addexc", ",", " ", 
          RowBox[{"N", "[", "addexc", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "        ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The difference between the original function H and h is: \>\"", 
        ",", 
        RowBox[{"N", "[", 
         RowBox[{"addexc", " ", "-", " ", "fucval"}], "]"}]}], "]"}], ";"}]}],
     "\n", "  ", "]"}]}], ";"}]}], "Code",ExpressionUUID->"992db07c-728d-46c8-\
b6b5-23a9a54e9f2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solving", " ", "a", " ", "system", " ", "of", " ", "linear", " ", 
    "equations", " ", "to", " ", "find", " ", "an", " ", "exact", " ", 
    RowBox[{"solution", "."}]}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SolveLinEQ", "[", 
      RowBox[{"coefmat_List", ",", "bv_List", ",", "indvar_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], 
     ":=", " ", "\n", "   ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sil", ",", "mth", ",", "foc", ",", "syseq", ",", "rest", ",", "rl", 
         ",", "sol", ",", "coefm"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"sil", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
        RowBox[{"mth", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "    ", 
        RowBox[{"coefm", "=", 
         RowBox[{"Developer`ToPackedArray", "[", "coefmat", "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"MessageSolveLinEQ", "[", 
            RowBox[{"coefm", ",", "bv"}], "]"}], ";"}], ",", " ", "True"}], 
         "]"}], ";", "\n", "    ", 
        RowBox[{"sol", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Det", "[", "coefm", "]"}], " ", "!=", " ", "0"}], ",", 
           " ", "\n", "              ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"LUDecomposition", "[", "coefm", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], " ", "<=", " ", 
              RowBox[{"10", "^", 
               RowBox[{"(", "4", ")"}]}]}], ",", 
             RowBox[{"LinearSolve", "[", 
              RowBox[{"coefm", ",", 
               RowBox[{"-", "bv"}], ",", 
               RowBox[{"Method", " ", "->", " ", "mth"}]}], "]"}], ",", "\n", 
             "                    ", "True", ",", " ", 
             RowBox[{
              RowBox[{"matpr", "=", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"coefm", ",", " ", "30"}], "]"}]}], ";", " ", "\n", 
              "                          ", 
              RowBox[{"bvpr", " ", "=", " ", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"bv", ",", " ", "30"}], "]"}]}], ";", "\n", 
              "                          ", 
              RowBox[{"LeastSquares", "[", 
               RowBox[{"matpr", ",", 
                RowBox[{"-", "bvpr"}], ",", " ", 
                RowBox[{"Tolerance", " ", "->", " ", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "10"}], ")"}]}]}]}], "]"}]}]}], "\n", 
            "                          ", "]"}], ",", " ", "\n", 
           "              ", 
           RowBox[{
            RowBox[{"PseudoInverse", "[", "coefm", "]"}], ".", 
            RowBox[{"(", 
             RowBox[{"-", "bv"}], ")"}]}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"rl", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"indvar", ",", "sol"}], "}"}]}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"{", 
         RowBox[{"rl", ",", 
          RowBox[{"Rationalize", "[", "rl", "]"}]}], "}"}]}]}], "\n", "     ",
       "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MessageSolveLinEQ", "[", 
      RowBox[{"cfmat_", ",", "bvec_"}], "]"}], " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "alpscal", "}"}], ",", "\n", "         ", 
       RowBox[{
        RowBox[{"alpscal", " ", "=", " ", 
         RowBox[{
          RowBox[{"Norm", "[", "bvec", "]"}], "^", "2"}]}], ";", "\n", 
        "         ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The matrix of the objective function is given by:\\n\>\"", ",", 
          " ", "cfmat"}], "]"}], ";", "\n", "         ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Is the matrix singular? \\n\>\"", ",", " ", 
          RowBox[{
           RowBox[{"Det", "[", "cfmat", "]"}], "==", "0"}]}], "]"}], ";", 
        "\n", "         ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The column vector b of the objective function is given by:\\n\>\
\"", ",", " ", "bvec"}], "]"}], ";", "\n", "         ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The scalar alpha of the objective function is given by:\\n\>\"",
           ",", " ", "alpscal"}], "]"}], ";"}]}], "\n", "  ", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"72cdfa6a-9e06-47be-9560-80fe4b56c15a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Trying", " ", "to", " ", "determine", " ", "the", " ", "complete", " ", 
    "solution", " ", "set", " ", "of", " ", "the", " ", "objective", " ", 
    "function", " ", "h", " ", "whenever", " ", "the", " ", "coefficient", 
    " ", "matrix", " ", "is", " ", "singular"}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DetSolSet", "[", 
      RowBox[{
      "dfconjugate_List", ",", " ", "objf_", ",", " ", "xvar_List", ",", " ", 
       "pvar_List"}], "]"}], ":=", " ", "\n", "       ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "objdf", ",", "orgmat", ",", "orgrest", ",", "bgvec", ",", "partsol", 
         ",", "sparts", ",", "cgmat", ",", "gensol", ",", "solvecs", ",", 
         "unsol", ",", "mpres"}], "}"}], ",", "\n", "         ", 
       RowBox[{
        RowBox[{"objdf", " ", "=", " ", 
         RowBox[{"Developer`ToPackedArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"objf", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], " ",
             "&"}], "/@", " ", "xvar"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"orgmat", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"#", ",", " ", "xvar"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "objdf"}]}], ";", "\n", "         ", 
        RowBox[{"orgrest", " ", "=", " ", 
         RowBox[{
          RowBox[{"objf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], " ", 
           RowBox[{"xvar", ".", "orgmat", ".", "xvar"}]}]}]}], ";", "\n", 
        "         ", 
        RowBox[{"bgvec", " ", "=", "  ", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"orgrest", ",", "xvar"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"partsol", "=", 
         RowBox[{
          RowBox[{"PseudoInverse", "[", "orgmat", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"-", "bgvec"}], ")"}]}]}], ";", "\n", "         ", 
        RowBox[{"sparts", "=", 
         RowBox[{"Total", "[", "partsol", "]"}]}], ";", "\n", "         ", 
        RowBox[{"cgmat", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"#", ",", " ", "pvar"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "dfconjugate"}]}], ";", "\n", "         ", 
        RowBox[{"gensol", " ", "=", " ", 
         RowBox[{"Developer`ToPackedArray", "[", 
          RowBox[{
           RowBox[{"NullSpace", "[", "cgmat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"solvecs", " ", "=", " ", 
         RowBox[{"partsol", " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "pvar", "]"}], "]"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"PseudoInverse", "[", "orgmat", "]"}], ".", 
              "orgmat"}]}], ")"}], "gensol"}]}]}], ";", "\n", "         ", 
        RowBox[{"unsol", " ", "=", " ", 
         RowBox[{"Union", "[", "solvecs", "]"}]}], ";", "\n", "         ", 
        RowBox[{"unsol", " ", "=", " ", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"unsol", ",", "partsol"}], "]"}]}], ";", "\n", "         ", 
        
        RowBox[{"unsol", " ", "=", " ", 
         RowBox[{"CheckGenRes", "[", 
          RowBox[{"unsol", ",", "partsol", ",", "sparts"}], "]"}]}], ";", 
        "\n", "         ", 
        RowBox[{"mpres", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "unsol", "]"}], "===", "1"}], ",", 
           RowBox[{"unsol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "unsol"}], "]"}]}], ";", 
        "\n", "         ", "mpres"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CheckGenRes", "[", 
      RowBox[{"vecli_List", ",", "pvec_List", ",", 
       RowBox[{"psum_", "?", "NumberQ"}]}], "]"}], ":=", "\n", "        ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sumuns", ",", "cksum", ",", "psck", ",", "extps", ",", "res"}], 
        "}"}], ",", "\n", "        ", 
       RowBox[{
        RowBox[{"sumuns", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "vecli", "]"}], ">", "1"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            "vecli"}], ",", "\n", "                  ", "True", ",", 
           RowBox[{"Total", "[", "vecli", "]"}]}], "]"}]}], ";", "\n", 
        "         ", 
        RowBox[{"cksum", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sumuns", "]"}], ">", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Equal", "[", 
              RowBox[{"psum", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
            "sumuns"}], ",", "\n", "                  ", "True", ",", " ", 
           RowBox[{"Equal", "[", 
            RowBox[{"psum", ",", "sumuns"}], "]"}]}], "]"}]}], ";", "\n", 
        "         ", 
        RowBox[{"psck", " ", "=", " ", 
         RowBox[{"Position", "[", 
          RowBox[{"cksum", ",", "True"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"extps", " ", "=", " ", 
         RowBox[{"Extract", "[", 
          RowBox[{"vecli", ",", "psck"}], "]"}]}], ";", "\n", "         ", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "extps", "]"}], "===", "0"}], ",", "pvec", 
           ",", "extps"}], "]"}]}], ";", "\n", "         ", "res"}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n"}]}]], "Code",ExpressionUUID->"eb9c1dd8-a0f8-\
4024-8876-45a6b88ca9ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", "  ", 
   RowBox[{
   "Constructing", " ", "for", " ", "a", " ", "particular", " ", "payoff", 
    " ", "vector", " ", "and", " ", "\n", "  ", "from", " ", "the", " ", 
    "induced", " ", "set", " ", "of", " ", "most", " ", "effective", " ", 
    "an", " ", "objective", " ", 
    RowBox[{"function", "."}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DetObjFunc", "[", 
      RowBox[{"game_", ",", " ", "payoff_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "PreKernelSolution", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", "   ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "anti", ",", " ", "smc", ",", " ", "sil", ",", " ", "bestc", ",", " ",
          "maxsl", ",", " ", "crlist", ",", " ", "eqs", ",", " ", "eff", ",", 
         " ", "obj"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"sil", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
        RowBox[{"anti", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "AntiPreKernel", "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"smc", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"bestc", " ", "=", " ", 
         RowBox[{"Bestcoalij01", "[", 
          RowBox[{"game", ",", " ", "payoff", ",", " ", 
           RowBox[{"AntiPreKernel", " ", "->", " ", "anti"}], ",", " ", 
           RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}]}], 
        ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"PrintMostEff", "[", 
           RowBox[{"payoff", ",", " ", "bestc"}], "]"}], ",", "  ", "True"}], 
         "]"}], ";", "\n", "    ", 
        RowBox[{"maxsl", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
                 RowBox[{"x", "[", "#", "]"}]}], ")"}], " ", "&"}], ",", " ", 
              "#"}], "]"}], " ", "&"}], ",", " ", "bestc"}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"crlist", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
          " ", 
          RowBox[{"Developer`ToPackedArray", "[", "maxsl", "]"}]}]}], ";", 
        "\n", 
        RowBox[{"(*", " ", "\n", "   ", 
         RowBox[{
          RowBox[{
          "the", " ", "sum", " ", "of", " ", "the", " ", "quadratic", " ", 
           "differences", " ", "of", " ", "\n", "   ", "max", " ", 
           "surpluses", " ", "for", " ", "each", " ", "pair", " ", "of", " ", 
           "players", " ", "i"}], ",", 
          RowBox[{"j", " ", "in", " ", 
           RowBox[{"T", "."}]}]}], " ", "\n", "*)"}], "\n", "    ", 
        RowBox[{"eqs", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subtract", "[", 
                RowBox[{"#1", ",", " ", "#2"}], "]"}], "^", "2"}], " ", "&"}],
              ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Developer`ToPackedArray", "[", "crlist", "]"}]}]}], ";", 
        "\n", "    ", 
        RowBox[{"obj", " ", "=", " ", 
         RowBox[{"Total", "[", "eqs", "]"}]}], ";", "\n", 
        RowBox[{"(*", " ", "efficiency", " ", "*)"}], "\n", "    ", 
        RowBox[{"eff", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
              "T"}], "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "T", "]"}]}], ")"}], "^", "2"}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"Meinhardt", " ", 
          RowBox[{"(", "2013", ")"}], " ", "formula", " ", "7.7"}], " ", 
         "*)"}], "\n", "    ", 
        RowBox[{
         RowBox[{"First", "[", "obj", "]"}], " ", "+", " ", "eff"}]}]}], " ", 
      "\n", "    ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "\n", "  ", 
    RowBox[{
    "Next", " ", "we", " ", "define", " ", "the", " ", "user", " ", 
     "interface", " ", "to", " ", "compute", " ", "the", " ", "most", "\n", 
     "  ", "effective", " ", "coalitions", " ", "to", " ", "balance", " ", 
     "the", " ", "maximum", " ", 
     RowBox[{"surpluses", "."}]}], "\n", "*)"}]}]}]], "Code",ExpressionUUID->\
"4dda1500-0f13-42e9-a8f0-d4718bfefe07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrintMostEff", "[", 
     RowBox[{"payoff_List", ",", " ", "meffc_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "       ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<A set of most effective coalitions at payoff \>\"", ",", " ", 
         "payoff", ",", " ", "\"\< is: \\n\>\"", ",", "  ", "meffc"}], "]"}], 
       ";"}]}], " ", "\n", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "compute", " ", "the", " ", 
    "set", " ", "of", " ", "significant", " ", "coalitions", " ", "at", " ", 
    "a", " ", 
    RowBox[{"proposal", " ", "'"}], 
    RowBox[{
     RowBox[{"payoff", "'"}], "."}]}], "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BestCoalitions", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BestCoalitions", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BestCoalitions", "[", 
     RowBox[{"game_", ",", "payoff_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BestCoalitions", "]"}]}]}], "]"}], ":=",
     " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "dimpay", "}"}], ",", " ", "\n", "       ", 
      RowBox[{
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
       "      ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
         "\n", "                        ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Bestcoalij01", "[", 
              RowBox[{"game", ",", "#", ",", "opts"}], "]"}], "&"}], "/@", 
            " ", "payoff"}], ",", "\n", 
           "                                     ", "True", ",", " ", 
           "WrongDimension"}], "]"}], ",", "\n", "                    ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
         "\n", "                        ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", 
           RowBox[{"Bestcoalij01", "[", 
            RowBox[{"game", ",", "payoff", ",", "opts"}], "]"}], ",", " ", 
           "\n", "                                     ", "True", ",", " ", 
           "WrongDimension"}], "]"}], ",", "\n", "                    ", 
         "True", ",", " ", "WrongDimension"}], "\n", 
        "                                   ", "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", "   ", 
   RowBox[{"Here", ",", " ", 
    RowBox[{
    "we", " ", "select", " ", "the", " ", "set", " ", "of", " ", "most", " ", 
     "effective", " ", "coalitions", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "payoff"}], " ", "which", " ",
      "induces", "\n", "   ", "the", " ", "maximum", " ", 
     RowBox[{"surpluses", "."}]}]}], "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"listIJ", "[", "T_List", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"i", " ", "+", " ", "1"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listJI", "[", "T_List", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"j", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Bestcoalij01", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BestCoalitions", "]"}]}]}], "]"}], " ", 
   ":=", "  ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "anti", ",", " ", "maxsurp", ",", " ", "allc", ",", "plvec", ",", "sij",
        ",", "sji", ",", "plj", ",", "pli", ",", "amax", ",", "ramax", ",", 
       "exc", ",", "exvec", ",", "intcoal", ",", "payass", ",", "selcij", ",",
        "selcji", ",", "sigcoal"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"anti", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "AntiPreKernel", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"allc", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "AllCoalitions", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"maxsurp", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "MaximumSurpluses", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"plvec", " ", "=", " ", 
       RowBox[{"Developer`ToPackedArray", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"listIJ", "[", "T", "]"}], ",", "2"}], "]"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"pli", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], " ", "&"}], "/@", " ", "plvec"}]}],
       ";", "\n", "    ", 
      RowBox[{"plj", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "plvec"}]}], 
      ";", "\n", "    ", 
      RowBox[{"sij", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"pli", ",", "plj"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"sji", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TIJsets", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"plj", ",", "pli"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"payass", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", " ", "/@", " ", "T"}], ",", "payoff"}], "}"}]}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"anti", ",", "False"}], "]"}], ",", 
        RowBox[{"amax", " ", "=", " ", 
         RowBox[{"ModMaxSurpluses", "[", 
          RowBox[{"game", ",", "sij", ",", "sji", ",", "payass"}], "]"}]}], 
        ",", 
        RowBox[{"amax", "=", 
         RowBox[{"ModAntiSurpluses", "[", 
          RowBox[{"game", ",", "sij", ",", "sji", ",", "payass"}], "]"}]}]}], 
       "]"}], ";", "\n", "    ", 
      RowBox[{"sij", "=", 
       RowBox[{"Developer`ToPackedArray", "[", "sij", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"sji", "=", 
       RowBox[{"Developer`ToPackedArray", "[", "sji", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"amax", "=", 
       RowBox[{"Developer`ToPackedArray", "[", "amax", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"exc", " ", "=", " ", 
       RowBox[{"First", "[", 
        RowBox[{"ExcessPayoff", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"exvec", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"exc", ",", " ", "1"}], "]"}], ",", " ", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"intcoal", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "1"}], "]"}], ",", 
         " ", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"ramax", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Reverse", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        "amax"}]}], ";", "\n", "    ", 
      RowBox[{"ramax", "=", 
       RowBox[{"Developer`ToPackedArray", "[", "ramax", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"selcij", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SelCoal", "[", 
           RowBox[{
           "#1", ",", " ", "intcoal", ",", " ", "exvec", ",", " ", "#2", ",", 
            " ", "opts"}], "]"}], " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"sij", ",", " ", "amax"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"selcji", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SelCoal", "[", 
           RowBox[{
           "#1", ",", " ", "intcoal", ",", " ", "exvec", ",", " ", "#2", ",", 
            " ", "opts"}], "]"}], " ", "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"sji", ",", " ", "ramax"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"sigcoal", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"allc", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "[", "#1", "]"}], ",", " ", 
              RowBox[{"Flatten", "[", "#2", "]"}]}], "}"}], " ", "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"selcij", ",", " ", "selcji"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"selcij", ",", " ", "selcji"}], "}"}]}], "]"}]}], ";", "\n",
       "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"maxsurp", ",", "False"}], "]"}], ",", " ", "sigcoal", ",", 
        RowBox[{"{", 
         RowBox[{"sigcoal", ",", "amax"}], "}"}]}], "]"}]}]}], "\n", "    ", 
    "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"ab96982d-af5b-4cbf-a471-\
b2115d440d78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SelCoal", "[", 
     RowBox[{
     "setsij_List", ",", " ", "coal_List", ",", " ", "redexc_List", ",", " ", 
      "maxexc_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BestCoalitions", "]"}]}]}], "]"}], " ",
     ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allc", ",", " ", "smc", ",", " ", "detpos", ",", " ", "extval", ",", 
        " ", "poscoal", ",", " ", "extcoal"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"allc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "AllCoalitions", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "The", " ", "subsequent", " ", "two", " ", "lines", " ", "consume", 
          " ", "80", "%", " ", "of", " ", "the", " ", "computation", " ", 
          "time", " ", "of", " ", "an", " ", "pre"}], "-", 
         RowBox[{"kernel", " ", 
          RowBox[{
           RowBox[{"element", "!!"}], "!"}]}]}], " ", "*)"}], "\n", "    ", 
       RowBox[{"detpos", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"List", ",", 
          RowBox[{"{", 
           RowBox[{"coal", ",", "redexc"}], "}"}]}], "]"}]}], ";", " ", "\n", 
       "    ", 
       RowBox[{"extval", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], " ", "&"}], "/@", " ", 
            RowBox[{"Cases", "[", 
             RowBox[{"detpos", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "___"}], "}"}]}], "]"}]}], " ", "&"}], "/@", 
          " ", "setsij"}], " ", "//", " ", "Flatten"}]}], ";", "\n", "    ", 
       RowBox[{"poscoal", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"extval", ",", " ", 
          RowBox[{"First", "[", "maxexc", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"extcoal", " ", "=", " ", 
        RowBox[{"Extract", "[", 
         RowBox[{"setsij", ",", " ", "poscoal"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "  ", 
        RowBox[{
         RowBox[{"Taking", " ", "the", " ", "coalition", " ", "with", " ", 
          RowBox[{"smallest", "/", "largest"}], " ", 
          RowBox[{"(", 
           RowBox[{"First", "/", "Last"}], ")"}], " ", "cardinality", " ", 
          "if", " ", "extcoal"}], " ", ">", " ", "1"}], " ", "*)"}], "\n", 
       "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "extcoal", "]"}], " ", "===", " ", "1"}], 
         ",", " ", "extcoal", ",", " ", "\n", "     ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"allc", " ", "===", " ", "True"}], ",", " ", "extcoal", 
           ",", " ", "True", ",", "\n", "       ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"smc", " ", "===", " ", "True"}], ",", " ", 
             RowBox[{"First", "[", "extcoal", "]"}], ",", " ", "\n", 
             "             ", 
             RowBox[{"smc", " ", "===", " ", "False"}], ",", " ", 
             RowBox[{"Last", "[", "extcoal", "]"}], ",", " ", "\n", 
             "             ", "True", ",", "  ", 
             RowBox[{"First", "[", "extcoal", "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n", "\n"}]], "Code",Express\
ionUUID->"7b9bf2ed-57d4-4f17-9fdf-4f83da43f096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{"Next", ",", " ", 
    RowBox[{
    "we", " ", "construct", " ", "an", " ", "equivalence", " ", "matrix", " ",
      "from", " ", "the", " ", "set", " ", "of", " ", "most", " ", 
     "effective", " ", "coalitions", " ", "\n", "as", " ", "described", " ", 
     "in", " ", "Meinhardt", " ", 
     RowBox[{
      RowBox[{"(", "2013", ")"}], "."}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "compute", " ", "an", " ", 
    "equivalence", " ", "matrix", " ", "and", " ", "its", " ", "intermediate",
     " ", 
    RowBox[{"results", "."}]}], "  ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImputationToMatrix", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ImputationToMatrix", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ImputationToMatrix", "[", 
      RowBox[{"game_", ",", " ", "payoff_List", ",", "  ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "BestCoalToMatrix", "]"}]}]}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "dimpay", "}"}], ",", " ", "\n", "       ", 
       RowBox[{
        RowBox[{"dimpay", " ", "=", " ", 
         RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
             ")"}], " ", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ImputToMatrixMain", "[", 
                RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
               " ", "payoff"}], " ", "//", "Union"}], ",", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", 
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", 
               "2"}]}], " ", ")"}], ",", " ", 
            RowBox[{"ImputToMatrixMain", "[", 
             RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], "]"}], 
            ",", " ", "\n", "                                     ", "True", 
            ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
         "                                   ", "]"}]}]}], "\n", "      ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"7227dd09-27f4-42fe-8944-\
dd6b142c31aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImputToMatrixMain", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BestCoalToMatrix", "]"}]}]}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "meff", "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"meff", " ", "=", " ", 
        RowBox[{"BestCoalitions", "[", 
         RowBox[{"game", ",", " ", "payoff", ",", " ", "opts"}], "]"}]}], ";",
        " ", "\n", "     ", 
       RowBox[{"BestCoalToMatrix", "[", 
        RowBox[{"meff", ",", " ", "T", ",", " ", "opts"}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BestCoalToMatrix", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BestCoalToMatrix", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BestCoalToMatrix", "[", 
     RowBox[{"coal_List", ",", " ", "T_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "BestCoalToMatrix", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allsol", ",", "dismat", ",", "zrv", ",", " ", "pscoal", ",", " ", 
        "replzr", ",", " ", "vecij", ",", " ", "allmij", ",", " ", "detQij", 
        ",", " ", "sumQij", ",", " ", "detsum", ",", " ", "mQ", ",", "\n", 
        "      ", "detq"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"allsol", " ", "=", "  ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"dismat", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayMatrixForm", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"vecij", " ", "=", " ", 
        RowBox[{"SetsToVec", "[", 
         RowBox[{"coal", ",", "T", ",", 
          RowBox[{"EffVector", " ", "->", " ", "False"}]}], "]"}]}], ";", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"Tensor", " ", "Product"}], " ", "*)"}], "\n", "    ", 
       RowBox[{"allmij", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "#", ",", "#"}], "]"}], " ", "&"}], "/@", 
         " ", "vecij"}]}], ";", "\n", "    ", 
       RowBox[{"detQij", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "allmij"}]}], ";", "\n", "    ", 
       RowBox[{"sumQij", " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"allmij", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "allmij", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"detsum", " ", "=", " ", 
        RowBox[{"Det", "[", "sumQij", "]"}]}], ";", "\n", "    ", 
       RowBox[{"mQ", " ", "=", " ", 
        RowBox[{
         RowBox[{"2", "*", "sumQij"}], " ", "+", " ", "2"}]}], " ", ";", " ", 
       "\n", "    ", 
       RowBox[{"detq", " ", "=", " ", 
        RowBox[{"Det", "[", "mQ", "]"}]}], ";", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"allsol", " ", "===", " ", "False"}], ",", 
         "                         ", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"dismat", " ", "===", " ", "False"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mQ", ",", " ", "detq"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"sumQij", ",", " ", "detsum"}], "}"}]}], "}"}], ",", 
           " ", "\n", "        ", "True", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mQ", ",", " ", 
               RowBox[{"MatrixForm", "[", "mQ", "]"}], ",", " ", "detq"}], 
              "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "sumQij", ",", " ", "detsum", ",", " ", "\n", "            ", 
               RowBox[{"MatrixForm", "[", "sumQij", "]"}]}], "}"}]}], "}"}]}],
           "]"}], ",", "   ", "True", ",", " ", "\n", "      ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"dismat", " ", "===", " ", "False"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mQ", ",", " ", "detq"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"sumQij", ",", " ", "detsum"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"allmij", ",", " ", "detQij"}], "}"}]}], "}"}], ",", 
           " ", "\n", "         ", "True", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mQ", ",", " ", 
               RowBox[{"MatrixForm", "[", "mQ", "]"}], ",", " ", "detq"}], 
              "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"sumQij", " ", ",", " ", 
               RowBox[{"MatrixForm", "[", "sumQij", "]"}], ",", " ", "\n", 
               "            ", "detsum"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"allmij", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"MatrixForm", "[", "#", "]"}], " ", "&"}], " ", "/@",
                 " ", "allmij"}], ",", " ", "detQij"}], "}"}]}], "}"}]}], 
          "]"}]}], "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "compute", " ", "a", " ", 
    "strength", " ", 
    RowBox[{"matrix", ".", " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "Meinhardt", " ", "2013"}], ")"}]}]}], "  ", "*)"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationToVec", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ImputationToVec", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationToVec", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", "  ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "ImputationToVec", "]"}]}]}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "dimpay", "}"}], ",", "  ", "\n", "       ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], " ", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ImputToVecMain", "[", 
              RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
             " ", "payoff"}], " ", "//", "Union"}], ",", " ", "\n", 
          "                                     ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"ImputToVecMain", "[", 
           RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], "]"}], 
          ",", "  ", "\n", "                                     ", "True", 
          ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
       "                                   ", "]"}]}]}], "\n", "      ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"fb9219c4-b127-4392-bcd1-\
f438de0452bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImputToVecMain", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ImputationToVec", "]"}]}]}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allr", ",", " ", "fav", ",", " ", "meff", ",", " ", "stsv", ",", " ", 
        "skew"}], "}"}], ",", "  ", "\n", "     ", 
      RowBox[{
       RowBox[{"allr", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"fav", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "InFavor", "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"meff", " ", "=", " ", 
        RowBox[{"BestCoalitions", "[", 
         RowBox[{"game", ",", " ", "payoff", ",", " ", "opts"}], "]"}]}], ";",
        " ", "\n", "     ", 
       RowBox[{"stsv", " ", "=", " ", 
        RowBox[{"SetsToVec", "[", 
         RowBox[{"meff", ",", " ", "T", ",", " ", "opts"}], "]"}]}], ";", 
       "\n", "     ", 
       RowBox[{"skew", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"allr", " ", "||", " ", "fav"}], ")"}], "===", " ", 
           "False"}], ",", " ", "True", ",", " ", "\n", 
          "                        ", 
          RowBox[{
           RowBox[{"onesT", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", 
           "   ", "\n", "                        ", 
           RowBox[{"stsv", ".", "onesT"}]}]}], "\n", 
         "                         ", "]"}]}], ";", " ", "\n", "      ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"allr", " ", "===", " ", "True"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"stsv", ",", " ", "skew"}], "}"}], ",", "\n", 
         "                     ", "True", ",", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fav", " ", "===", " ", "False"}], ",", " ", "stsv", ",", 
           " ", "skew"}], "]"}]}], " ", "\n", "                   ", 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetsToVec", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SetsToVec", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetsToVec", "[", 
     RowBox[{"mg_List", ",", " ", "T_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "SetsToVec", "]"}]}]}], "]"}], " ", ":=",
     " ", "\n", "    ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "effvec", ",", " ", "zrv", ",", " ", "pscoal", ",", " ", "replzr", ",",
         "coasts", ",", " ", "onesoft"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"effvec", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EffVector", "]"}]}], ";", "\n", "    ", 
       RowBox[{"zrv", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"pscoal", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Developer`ToPackedArray", "[", "mg", "]"}]}]}], ";", "\n", 
       "    ", 
       RowBox[{"replzr", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"zrv", ",", " ", "1", ",", " ", "#"}], "]"}], " ", 
             "&"}], ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "pscoal"}]}], ";", "\n", "    ", 
       RowBox[{"coasts", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Subtract", "[", 
              RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
            "#"}], "]"}], " ", "&"}], " ", "/@", " ", "replzr"}]}], ";", "\n",
        "    ", 
       RowBox[{"onesoft", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"1", " ", "&"}], ",", " ", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"effvec", ",", "True"}], "]"}], ",", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{"coasts", ",", "onesoft"}], "]"}], ",", " ", "coasts"}], 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "\n", 
   RowBox[{
    RowBox[{
    "Replicates", " ", "from", " ", "the", " ", "difference", " ", "of", " ", 
     "unanimity", " ", "coordinates", " ", "the", "\n", "set", " ", "of", " ", 
     RowBox[{"best", "/", "most"}], " ", "effective", " ", 
     RowBox[{"coalitions", ".", " ", "The"}], " ", "input", " ", "is", " ", 
     "a", " ", "\n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Binom", 
        RowBox[{"(", 
         RowBox[{"n", ",", "2"}], ")"}], " ", "x", " ", 
        RowBox[{"2", "^", "n"}]}], " ", "-", " ", "1"}], ")"}]}], "-", 
    RowBox[{"matrix", "."}]}], " ", "\n", " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "determine", " ", "an", " ", 
    "equivalence", " ", "class", " ", "from", " ", "an", " ", 
    RowBox[{"imputation", "."}]}], "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationToEqClass", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ImputationToEqClass", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImputationToEqClass", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "ImputationToEqClass", "]"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "dimpay", "}"}], ",", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], " ", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"EqClassMain", "[", 
              RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
             " ", "payoff"}], " ", "//", "Union"}], ",", "\n", 
          "                                     ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"EqClassMain", "[", 
           RowBox[{"game", ",", " ", "payoff", ",", " ", "opts"}], "]"}], ",",
           " ", "\n", "                                     ", "True", ",", 
          " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
       "                                   ", "]"}]}]}], "\n", "      ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"3737f0bb-abb7-49de-bfaa-\
225b8f727ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EqClassMain", "[", 
     RowBox[{"game_", ",", " ", "payoff_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ImputationToEqClass", "]"}]}]}], "]"}],
     ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unmatQ", ",", " ", "unm"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"unmatQ", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "BargUnanMat", "]"}]}], ";", "   ", "\n", 
       "    ", 
       RowBox[{"unm", " ", "=", " ", 
        RowBox[{"BargainUnanMatrix", "[", 
         RowBox[{"game", ",", "payoff", ",", " ", 
          RowBox[{"EffVector", " ", "->", " ", "False"}]}], "]"}]}], ";", " ",
        "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"unmatQ", " ", "===", " ", "False"}], ",", " ", 
         RowBox[{"DetEqClass", "[", 
          RowBox[{"unm", ",", " ", "T"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DetEqClass", "[", 
            RowBox[{"unm", ",", " ", "T"}], "]"}], ",", " ", "unm"}], "}"}]}],
         "]"}]}]}], " ", "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DetEqClass", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DetEqClass", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetEqClass", "[", 
     RowBox[{"mat_List", ",", "T_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "     ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "mat", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", " ", 
            RowBox[{
             RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"Length", "[", "T", "]"}]}], "-", "1"}]}], "}"}]}], ",", 
        " ", "\n", "                                  ", 
        RowBox[{"FuncDetEqClass", "[", 
         RowBox[{"mat", ",", " ", "T"}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"WrongMatDimension", "[", "T", "]"}]}], "]"}]}], "\n", "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WrongMatDimension", "[", "T_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<The unanimity matrix has not the correct dimension!\>\"", "]"}], 
       ";", "\n", "      ", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The correct dimension is: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{
             RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"Length", "[", "T", "]"}]}], "-", "1"}]}], "}"}]}], 
        "]"}], ";"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FuncDetEqClass", "[", 
     RowBox[{"mat_List", ",", " ", "T_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gb", ",", " ", "clmat"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"gb", " ", "=", " ", 
        RowBox[{"GameBasis", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"clmat", " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{"mat", ".", 
          RowBox[{"Inverse", "[", "gb", "]"}]}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{
         RowBox[{"FindEqClass", "[", 
          RowBox[{"#", ",", " ", "T"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "clmat"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindEqClass", "[", 
     RowBox[{"dir_List", ",", " ", "T_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pwmg", ",", " ", "lhs", ",", " ", "rhs"}], "}"}], ",", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"pwmg", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "1"}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"lhs", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"dir", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"rhs", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"dir", ",", " ", "1"}], "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Extract", "[", 
        RowBox[{"pwmg", ",", " ", 
         RowBox[{"{", 
          RowBox[{"lhs", ",", " ", "rhs"}], "}"}]}], "]"}]}]}], "\n", "]"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BargainUnanMatrix", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BargainUnanMatrix", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BargainUnanMatrix", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "BargainUnanMatrix", "]"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"effvec", ",", "meff", ",", "detunan", ",", "onesv"}], "}"}], 
     ",", "   ", "\n", "    ", 
     RowBox[{
      RowBox[{"effvec", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "EffVector", "]"}]}], ";", "   ", "\n", 
      "    ", 
      RowBox[{"meff", " ", "=", " ", 
       RowBox[{"BestCoalitions", "[", 
        RowBox[{"game", ",", " ", "payoff", ",", " ", 
         RowBox[{"EffVector", " ", "->", " ", "effvec"}]}], "]"}]}], ";", " ",
       "\n", "    ", 
      RowBox[{"detunan", "=", 
       RowBox[{"DetUnanMat", "[", 
        RowBox[{"meff", ",", " ", "T"}], "]"}]}], ";", " ", "\n", "    ", 
      RowBox[{"onesv", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"Length", "[", "T", "]"}]}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"effvec", "==", "True"}], ",", " ", 
        RowBox[{"Prepend", "[", 
         RowBox[{"detunan", ",", "onesv"}], "]"}], ",", " ", "detunan"}], 
       "]"}]}]}], "\n", "]"}]}], ";"}]}], "Code",ExpressionUUID->"b1e30025-\
93a9-4cf6-8d6b-f336644d46f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetUnanMat", "[", 
    RowBox[{"bsccoal_List", ",", " ", "T_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "powers", "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"powers", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "1"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"DetDircSetIJ", "[", 
         RowBox[{"#", ",", " ", "powers"}], "]"}], " ", "&"}], " ", "/@", " ",
        "bsccoal"}]}]}], "\n", " ", "]"}]}], ";"}]], "Code",ExpressionUUID->\
"f9587ace-5f15-4f85-81f0-129604e05cc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetDircSetIJ", "[", 
     RowBox[{"bsccoal_List", ",", " ", "coal_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lvec", ",", " ", "rvec"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"lvec", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SubSetQ", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"bsccoal", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", "1", ",", 
            " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ", "coal"}]}], ";", 
       "\n", "    ", 
       RowBox[{"rvec", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SubSetQ", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"bsccoal", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", 
            RowBox[{"-", "1"}], ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@",
          " ", "coal"}]}], ";", "\n", "    ", 
       RowBox[{"lvec", " ", "+", " ", "rvec"}]}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "User", " ", "interface", " ", "to", " ", "compute", " ", "the", " ", 
     "value", " ", "of", " ", "excesses"}], ",", " ", 
    RowBox[{"that", " ", "is"}], ",", " ", 
    RowBox[{"function", " ", 
     RowBox[{"h", ".", " ", 
      RowBox[{"(", 
       RowBox[{"Meinhardt", ",", " ", "2013"}], ")"}]}]}]}], "  ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ValueExcess", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ValueExcess", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ValueExcess", "[", "excli_List", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "subexc", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"subexc", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subtract", "[", 
               RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
             RowBox[{"Outer", "[", 
              RowBox[{"List", ",", " ", "#"}], "]"}]}], "]"}], " ", "&"}], 
          " ", "/@", " ", 
          RowBox[{"excli", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Total", "[", 
        RowBox[{"subexc", "^", "2"}], "]"}]}]}], " ", "\n", "    ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ValueExcess", "[", 
    RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "dimpay", "}"}], ",", " ", "\n", "       ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], " ", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ValueExcessList", "[", 
             RowBox[{"game", ",", "#"}], "]"}], "&"}], "/@", " ", "payoff"}], 
          ",", "\n", "                                     ", "True", ",", 
          " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"ValueExcessList", "[", 
           RowBox[{"game", ",", "payoff"}], "]"}], ",", " ", "\n", 
          "                                     ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
       "                                   ", "]"}]}]}], "\n", "      ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"c3e16a17-7fe6-4d63-8d0c-\
a629c9c3f773"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ValueExcessList", "[", 
     RowBox[{"game_", ",", " ", "payoff_List"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subexc", ",", " ", "excli"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"excli", " ", "=", " ", 
        RowBox[{"MaxSurpluses", "[", 
         RowBox[{"game", ",", " ", "payoff"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"subexc", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subtract", "[", 
               RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
             RowBox[{"Outer", "[", 
              RowBox[{"List", ",", " ", "#"}], "]"}]}], "]"}], " ", "&"}], 
          " ", "/@", " ", "excli"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Total", "[", 
        RowBox[{"subexc", "^", "2"}], "]"}]}]}], " ", "\n", "    ", "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "User", " ", "interface", " ", "to", " ", "compute", " ", "an", " ", 
    "optimal", " ", "step", " ", 
    RowBox[{"size", "."}]}], "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OptStepSize", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"OptStepSize", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptStepSize", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", "  ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "OptStepSize", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sil", ",", "smc", ",", "dimpay"}], "}"}], ",", "\n", 
      "       ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "  ", "\n", 
       "       ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", 
       "      ", "\n", "       ", 
       RowBox[{"dimpay", " ", "=", " ", 
        RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
       "      ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
         "\n", "                        ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
            ")"}], " ", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"DirectionOfImprovement", "[", 
                RowBox[{"game", ",", "#", ",", " ", 
                 RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
                 RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
                 RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", " ", "payoff"}], 
            " ", "//", "Union"}], ",", "\n", 
           "                                     ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "                    ", 
         RowBox[{
          RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
         "\n", "                        ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "dimpay", "]"}], "===", 
              RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}],
             " ", ")"}], ",", " ", 
           RowBox[{
            RowBox[{"DirectionOfImprovement", "[", 
             RowBox[{"game", ",", "payoff", ",", " ", 
              RowBox[{"CalcStepSize", " ", "->", " ", "True"}], ",", " ", 
              RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
              RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}],
             "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", 
           "                                     ", "True", ",", " ", 
           RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
         "                    ", "True", ",", " ", 
         RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
        "                                   ", "]"}]}]}], "\n", "      ", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Based", " ", "on", " ", "Algorithm", " ", "8.2", ".1", " ", "of", " ", 
    "Meinhardt", " ", 
    RowBox[{"(", "2013", ")"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "User", " ", "interface", " ", "to", " ", "compute", " ", "a", " ", 
     "pre"}], "-", 
    RowBox[{"kernel", " ", 
     RowBox[{"element", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PreKernel", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"PreKernel", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PreKernel", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "PreKernel", "]"}]}]}], "]"}], " ", ":=",
    " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pay", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
        RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
      RowBox[{"PreKernel", "[", 
       RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"79487d0a-f0ff-445a-b9f6-\
c3b8570ed4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PreKernel", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "PreKernel", "]"}]}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimpay", ",", "rclim"}], "}"}], ",", " ", "\n", "      ", 
     RowBox[{
      RowBox[{"dimpay", " ", "=", " ", 
       RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", "      ", 
      RowBox[{"rclim", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "11"}], ",", 
         "256", ",", "156"}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", "\n",
         "                       ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
           ")"}], ",", " ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"PreKernelAlg2", "[", 
                RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], "/@",
               " ", "payoff"}], " ", "//", "Union"}]}], "]"}], ",", "\n", 
          "                                     ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", 
        RowBox[{
         RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", "\n",
         "                        ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "dimpay", "]"}], "===", 
             RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", "2"}]}], 
           " ", ")"}], ",", " ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], ",", 
            
            RowBox[{"PreKernelAlg2", "[", 
             RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], "]"}]}],
            "]"}], ",", " ", "\n", "                                     ", 
          "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
        "                    ", "True", ",", " ", 
        RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
       "                                   ", "]"}]}]}], "\n", "      ", 
    "]"}]}], ";"}]], "Code",ExpressionUUID->"0a4ebb26-bd8f-4758-b499-\
b47e981c7af2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PreKernelAlg2", "[", 
    RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "PreKernel", "]"}]}]}], "]"}], " ", ":=",
    " ", "\n", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sil", ",", " ", "smc", ",", " ", "meff", ",", " ", "matE", ",", " ", 
       "vlis", ",", " ", "alpv", ",", "err", ",", "xvec"}], "}"}], ",", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"sil", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "  ", 
      RowBox[{"smc", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"meff", " ", "=", " ", 
       RowBox[{"Bestcoalij01", "[", 
        RowBox[{"game", ",", " ", "payoff", ",", " ", 
         RowBox[{"MaximumSurpluses", " ", "->", " ", "False"}], ",", " ", 
         RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"matE", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"SetsToVec", "[", 
         RowBox[{"meff", ",", " ", "T", ",", " ", 
          RowBox[{"EffVector", " ", "->", " ", "True"}]}], "]"}]}]}], ";", 
      "\n", "  ", 
      RowBox[{"vlis", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "#1", "]"}], " ", "&"}], ",", " ", 
           RowBox[{"{", "#", "}"}]}], "]"}], " ", "&"}], "/@", " ", 
        "meff"}]}], ";", "\n", "  ", 
      RowBox[{"alpv", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"List", " ", "->", " ", "Subtract"}]}], "]"}], " ", "&"}], 
        " ", "/@", " ", "vlis"}]}], ";", "\n", "  ", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"alpv", ",", 
        RowBox[{"v", "[", "T", "]"}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"err", "=", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"matE", ".", "payoff"}], "+", "alpv"}], "]"}], "^", "2"}]}],
       ";", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{"err", ",", 
          RowBox[{"1.5", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}]}], "]"}], ",", 
        RowBox[{"Return", "[", "payoff", "]"}], ",", "     ", "\n", "     ", 
        RowBox[{
         RowBox[{"xvec", "=", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"PseudoInverse", "[", "matE", "]"}], ".", "alpv"}]}]}], 
         ";", "\n", "               ", 
         RowBox[{"PreKernelAlg2", "[", 
          RowBox[{"game", ",", "xvec", ",", "opts"}], "]"}]}]}], "]"}]}]}], 
    "   ", "\n", "  ", "]"}]}], ";"}]], "Code",ExpressionUUID->"0dcde3f5-a61a-\
4c58-b142-bcb0f4a7f9dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Based", " ", "on", " ", "Algorithm", " ", "8.3", ".1", " ", "of", " ", 
    "Meinhardt", " ", 
    RowBox[{"(", "2013", ")"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "User", " ", "interface", " ", "to", " ", "compute", " ", "a", " ", 
     "pre"}], "-", 
    RowBox[{"kernel", " ", 
     RowBox[{"element", "."}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelElement", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PreKernelElement", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelElement", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "PreKernelElement", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "pay", "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"pay", " ", "=", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"v", "[", "T", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}], "/", 
          RowBox[{"Length", "[", "T", "]"}]}]}], ";", "\n", "  ", 
        RowBox[{"PreKernelElement", "[", 
         RowBox[{"game", ",", "pay", ",", "opts"}], "]"}]}]}], "\n", " ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PreKernelElement", "[", 
      RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "PreKernelElement", "]"}]}]}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimpay", ",", "rclim"}], "}"}], ",", " ", "\n", "      ", 
       RowBox[{
        RowBox[{"dimpay", " ", "=", " ", 
         RowBox[{"Dimensions", "[", "payoff", "]"}]}], ";", " ", "\n", 
        "      ", 
        RowBox[{"rclim", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "11"}], ",", 
           "256", ",", "156"}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "2"}], ",", " ", 
          "\n", "                       ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", "3"}]}], 
             ")"}], ",", " ", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], 
              ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"FuncPreKernelElement", "[", 
                  RowBox[{"game", ",", "#", ",", " ", "opts"}], "]"}], "&"}], 
                "/@", " ", "payoff"}], " ", "//", "Union"}]}], "]"}], ",", 
            "\n", "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", 
          RowBox[{
           RowBox[{"Length", "[", "dimpay", "]"}], "===", "1"}], ",", " ", 
          "\n", "                        ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "dimpay", "]"}], "===", 
               RowBox[{"Length", "[", "T", "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Depth", "[", "payoff", "]"}], " ", "===", " ", 
               "2"}]}], " ", ")"}], ",", " ", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"$RecursionLimit", " ", "=", " ", "rclim"}], "}"}], 
              ",", 
              RowBox[{"FuncPreKernelElement", "[", 
               RowBox[{"game", ",", " ", "payoff", ",", "  ", "opts"}], 
               "]"}]}], "]"}], ",", " ", "\n", 
            "                                     ", "True", ",", " ", 
            RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "]"}], ",", "\n", 
          "                    ", "True", ",", " ", 
          RowBox[{"PrintRemark", "[", "payoff", "]"}]}], "\n", 
         "                                   ", "]"}]}]}], "\n", "      ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Main", " ", "Functions"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncPreKernelElement", "[", 
      RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "PreKernelElement", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sil", ",", " ", "rattol", ",", "smc", ",", " ", "optst", ",", " ", 
         "doi", ",", " ", "mex", ",", " ", "optstep", ",", " ", "itpay", ",", 
         "tol", ",", "brc", ",", "pinv"}], "}"}], ",", "\n", "     ", 
       RowBox[{
        RowBox[{"sil", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "     ", 
        RowBox[{"rattol", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "RationalTol", "]"}]}], ";", "\n", 
        "     ", 
        RowBox[{"smc", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", 
        "     ", "\n", "     ", 
        RowBox[{"optst", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "CalcStepSize", "]"}]}], ";", "\n", 
        "     ", 
        RowBox[{"pinv", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "PseudoInv", "]"}]}], ";", "\n", "     ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"optstep", ",", " ", "doi", ",", "mex"}], "}"}], " ", "=", 
         " ", 
         RowBox[{"Developer`ToPackedArray", "[", 
          RowBox[{"DirectionOfImprovement", "[", 
           RowBox[{"game", ",", " ", "payoff", ",", " ", 
            RowBox[{"MaximumSurpluses", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"CalcStepSize", " ", "->", " ", "optst"}], ",", " ", 
            RowBox[{"PseudoInv", "->", "pinv"}], ",", 
            RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
            RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}], 
          "]"}]}], ";", "\n", "     ", 
        RowBox[{"itpay", " ", "=", "  ", 
         RowBox[{"payoff", " ", "+", " ", 
          RowBox[{"optstep", "*", "doi"}]}]}], ";", "\n", "     ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", "\n", 
          "                 ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<doi=\>\"", ",", " ", "doi"}], "]"}], ";", "\n", 
           "                 ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<optstep=\>\"", ",", " ", "optstep"}], "]"}], ";", 
           "\n", "                 ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<itpay=\>\"", ",", " ", "itpay"}], "]"}], ";"}], ",", 
          " ", "\n", "             ", "True"}], "]"}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "itpay", "]"}], "!=", "2"}], ",", 
          RowBox[{"Return", "[", "payoff", "]"}], ",", "True"}], "]"}], ";", 
        "\n", "    ", 
        RowBox[{"tol", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"1.5", "*", "rattol"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "T", "]"}], "}"}]}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"brc", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LessEqual", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Abs", "[", "doi", "]"}], ",", "tol"}], "}"}]}], 
            "]"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"brc", ",", "True"}], "]"}], ",", " ", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"itpay", ",", "rattol"}], "]"}], ",", " ", 
          RowBox[{"FuncPreKernelElement", "[", 
           RowBox[{"game", ",", " ", 
            RowBox[{"Rationalize", "[", 
             RowBox[{"itpay", ",", "rattol"}], "]"}], ",", " ", 
            RowBox[{"CalcStepSize", " ", "->", " ", "optst"}], ",", " ", 
            RowBox[{"Silent", " ", "->", " ", "sil"}], ",", " ", 
            RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}]}],
          "]"}]}]}], " ", "\n", "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->\
"7e262891-30c6-451f-b459-bf408f0985c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DirectionOfImprovement", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DirectionOfImprovement", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirectionOfImprovement", "[", 
     RowBox[{"game_", ",", " ", "payoff_List", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "DirectionOfImprovement", "]"}]}]}], 
     "]"}], " ", ":=", " ", "\n", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sil", ",", " ", "smc", ",", " ", "optst", ",", " ", "meff", ",", " ", 
        "matE", ",", " ", "matQ", ",", " ", "matP", ",", " ", "varpay", ",", 
        " ", "mex", ",", " ", "mopt", ",", "submex", ",", " ", "setpay", ",", 
        " ", "grmex", ",", " ", "doi", ",", " ", "optstep", ",", "pinv"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"sil", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "  ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SmallestCardinality", "]"}]}], ";", "\n",
        "  ", 
       RowBox[{"optst", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "CalcStepSize", "]"}]}], ";", "\n", "  ", 
       
       RowBox[{"pinv", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "PseudoInv", "]"}]}], ";", "\n", "  ", 
       RowBox[{"mopt", "=", " ", 
        RowBox[{"OptionValue", "[", "MaximumSurpluses", "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"meff", ",", " ", "mex"}], "}"}], " ", "=", " ", 
        RowBox[{"Bestcoalij01", "[", 
         RowBox[{"game", ",", " ", "payoff", ",", " ", 
          RowBox[{"MaximumSurpluses", " ", "->", " ", "True"}], ",", " ", 
          RowBox[{"SmallestCardinality", " ", "->", " ", "smc"}]}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"matE", " ", "=", " ", 
        RowBox[{
         RowBox[{"Developer`ToPackedArray", "[", 
          RowBox[{"-", 
           RowBox[{"SetsToVec", "[", 
            RowBox[{"meff", ",", " ", "T", ",", " ", 
             RowBox[{"EffVector", " ", "->", " ", "True"}]}], "]"}]}], "]"}], 
         " ", "//", " ", "N"}]}], ";", "\n", "  ", 
       RowBox[{"submex", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1.", ",", " ", 
             RowBox[{"-", "1."}]}], "}"}], ".", "#"}], " ", "&"}], " ", "/@", 
         " ", "mex"}]}], ";", "\n", "  ", 
       RowBox[{"varpay", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "  ", 
       RowBox[{"setpay", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{"varpay", ",", " ", "payoff"}], "}"}]}], "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"grmex", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}], 
           "]"}]}], " ", "/.", " ", "setpay"}]}], ";", "\n", "  ", 
       RowBox[{"PrependTo", "[", 
        RowBox[{"submex", ",", " ", "grmex"}], "]"}], ";", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<submex=\>\"", ",", " ", "submex"}], "]"}], ",", 
         "True"}], "]"}], ";", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"pinv", ",", "False"}], "]"}], ",", "\n", "     ", 
         RowBox[{
          RowBox[{"doi", " ", "=", " ", 
           RowBox[{"LeastSquares", "[", 
            RowBox[{"matE", ",", 
             RowBox[{"-", "submex"}], ",", 
             RowBox[{"Tolerance", " ", "->", " ", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "10"}], ")"}]}]}]}], "]"}]}], ";"}], ",", "\n", 
         "     ", 
         RowBox[{"doi", " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"PseudoInverse", "[", "matE", "]"}], ".", 
            "submex"}]}]}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"optstep", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"optst", ",", "True"}], "]"}], ",", " ", 
          RowBox[{"DelStar", "[", 
           RowBox[{"doi", ",", " ", "matE", ",", " ", "submex"}], "]"}], ",", 
          " ", "1"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"mopt", ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"optstep", ",", "doi"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"optstep", ",", "doi", ",", "mex"}], "}"}]}], "]"}]}]}], 
     "\n", "  ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DelStar", "[", 
    RowBox[{"doi_List", ",", " ", "matE_List", ",", " ", "smex_List"}], "]"}],
    ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edvec", ",", "nrsq", ",", "tol"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"edvec", " ", "=", " ", 
       RowBox[{"matE", ".", "doi"}]}], ";", " ", "\n", "  ", 
      RowBox[{"nrsq", " ", "=", 
       RowBox[{
        RowBox[{"Norm", "[", "edvec", "]"}], "^", "2"}]}], ";", "\n", "  ", 
      RowBox[{"tol", "=", 
       RowBox[{"1.5", "*", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "12"}], ")"}]}]}]}], ";", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"LessEqual", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "nrsq", "]"}], ",", "tol"}], "]"}], ",", " ", 
        "0", ",", " ", 
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"smex", ".", "edvec"}]}], "/", "nrsq"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"0afea1c1-8933-4c78-9d64-\
cca76aa2a775"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\n", "   ", 
   RowBox[{
    RowBox[{
     RowBox[{"The", " ", "convex", " ", "conjugate", " ", 
      RowBox[{"h", "^", 
       RowBox[{"{", "*", "}"}]}], " ", "of", " ", "the", " ", "convex", " ", 
      "objective", " ", "function", " ", "h", " ", "that", " ", 
      "characterizes", "\n", "   ", "a", " ", "pre"}], "-", 
     RowBox[{
     "kernel", " ", "solution", " ", "can", " ", "be", " ", "specified", " ", 
      "by", " ", "the", " ", "function", " ", 
      RowBox[{
       RowBox[{"ConvexConjugate", "[", "]"}], ".", "\n", "   ", "The"}], " ", 
      "convex", " ", "function", " ", "can", " ", "be", " ", "obtained", " ", 
      "by", " ", "the", " ", "function", " ", 
      RowBox[{"PreKernelSolution", "[", "]"}], " ", "\n", "   ", "by", " ", 
      "invoking", " ", "the", " ", "option", " ", "ShowObjectiveFunction"}]}],
     " ", "->", " ", 
    RowBox[{
     RowBox[{"True", ".", "\n", "   ", "See"}], " ", "the", " ", 
     "Rockafellar", " ", "book", " ", "for", " ", "the", " ", "mathematical", 
     " ", 
     RowBox[{"details", "."}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ConvexConjugate", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ConvexConjugate", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConvexConjugate", "[", 
      RowBox[{"game_", ",", " ", "confunc_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "ConvexConjugate", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sil", ",", " ", "cfunc", ",", " ", "var", ",", " ", "norvar", ",", 
         " ", "zerovec", ",", " ", "inprod", ",", " ", "funchst", ",", " ", 
         "gradx", ",", " ", "detsys", ",", " ", "sol", ",", "coefm", ",", 
         "solset", ",", " ", "sol1", ",", " ", "cgate", ",", "\n", "      ", 
         "dpcgate", ",", " ", "detsol", ",", " ", "rlz", ",", " ", "gradpv"}],
         "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"sil", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
        RowBox[{"cfunc", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "confunc", "]"}], "===", " ", "List"}], ",", 
           " ", 
           RowBox[{"Flatten", "[", "confunc", "]"}], ",", 
           RowBox[{"{", "confunc", "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"cfunc", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "cfunc", "]"}], "===", "1"}], ",", "cfunc",
            ",", "\n", "              ", 
           RowBox[{
            RowBox[{"ConjugateMessage01", "[", "cfunc", "]"}], ";", " ", 
            RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"var", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
        ";", "\n", "    ", 
        RowBox[{"norvar", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Global`p", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "T"}]}], ";", "\n", "    ", 
        RowBox[{"zerovec", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
         "    ", 
        RowBox[{"inprod", " ", "=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "[", 
              RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"norvar", ",", " ", "var"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\n", "    ", 
        RowBox[{"funchst", " ", "=", " ", 
         RowBox[{
          RowBox[{"inprod", " ", "-", " ", "cfunc"}], " ", "//", " ", 
          "Simplify"}]}], ";", "\n", "    ", 
        RowBox[{"gradx", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"funchst", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "var"}]}], ";", "\n", "    ", 
        RowBox[{"coefm", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"#", ",", "var"}], "]"}], " ", "&"}], "/@", " ", 
          "gradx"}]}], ";", "\n", "    ", 
        RowBox[{"detsys", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Equal", ",", " ", 
           RowBox[{"{", 
            RowBox[{"gradx", ",", " ", "zerovec"}], "}"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"sol", " ", "=", " ", 
         RowBox[{"Solve", "[", 
          RowBox[{"detsys", ",", " ", "var"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"sol1", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sol", "]"}], "===", "0"}], ",", " ", 
           RowBox[{"SolSys", "[", 
            RowBox[{"detsys", ",", "var"}], "]"}], ",", "sol"}], "]"}]}], ";",
         "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "sol1", "]"}], "===", "0"}], ",", 
          "MessageConjugate", ",", " ", "True"}], "]"}], ";", "\n", "    ", 
        RowBox[{"cgate", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sol1", "]"}], "===", "0"}], ",", 
           "funchst", ",", 
           RowBox[{
            RowBox[{"funchst", " ", "/.", " ", "sol1"}], " ", "//", " ", 
            "Simplify"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"dpcgate", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sol1", "]"}], "===", "0"}], ",", 
           "funchst", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"cgate", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#"}], "]"}], " ", 
             "&"}], " ", "/@", " ", "norvar"}]}], "]"}]}], ";", "\n", "    ", 
        
        RowBox[{"solset", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sol", "]"}], "===", "0"}], ",", " ", 
           RowBox[{"DetSolSet", "[", 
            RowBox[{
            "dpcgate", ",", "cfunc", ",", " ", "var", ",", " ", "norvar"}], 
            "]"}], ",", " ", "dpcgate"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"rlz", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", " ", 
           RowBox[{"{", 
            RowBox[{"norvar", ",", " ", "zerovec"}], "}"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{"gradpv", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sol1", "]"}], "===", "0"}], ",", 
           "funchst", ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sol", "]"}], "!=", "0"}], ",", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{"dpcgate", " ", "/.", " ", "rlz"}], "]"}], ",", " ", 
             "solset"}], "]"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", "True", ",", "\n", 
          "          ", "True", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sol", "]"}], "===", "0"}], ",", 
            RowBox[{"ConjugateMessage02", "[", "gradpv", "]"}], ",", "True"}],
            "]"}]}], "]"}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"sil", ",", "False"}], "]"}], ",", " ", 
          RowBox[{"ConjugateMessage03", "[", 
           RowBox[{
           "cfunc", ",", " ", "cgate", ",", " ", "gradpv", ",", "sol"}], 
           "]"}], ",", "True"}], "]"}], ";", "\n", "    ", 
        RowBox[{"{", 
         RowBox[{"gradpv", ",", " ", 
          RowBox[{"Flatten", "[", "cgate", "]"}]}], "}"}]}]}], "\n", "    ", 
      "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"54663961-27c7-4e28-8f3d-\
07c46982f4e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VetoRichPlayers", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"VetoRichPlayers", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"VetoRichPlayers", "[", "game_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "swi", "}"}], ",", "\n", "    ", 
    RowBox[{
     RowBox[{"swi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"Coalitions", ",", "1"}], "]"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", "i"}], "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"Coalitions", ",", "1"}], "]"}]}], ",", "False"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "  ", 
     "\n", "    ", 
     RowBox[{"Extract", "[", 
      RowBox[{"T", ",", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"v", "[", "#", "]"}], "==", "0"}], " ", "&"}], "/@", 
             " ", 
             RowBox[{"swi", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ",", 
         "True"}], "]"}]}], "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MessageConjugate", " ", ":=", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<Warning: The system of linear equations to determine the conjugate \
of h has no solution.\>\"", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolSys", "[", 
     RowBox[{"eqsys_List", ",", "var_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "redsol", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"redsol", " ", "=", " ", 
        RowBox[{"Reduce", "[", 
         RowBox[{"eqsys", ",", "var"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"redsol", " ", "=", " ", 
        RowBox[{"redsol", " ", "/.", " ", 
         RowBox[{"Equal", " ", "->", " ", "Rule"}]}]}], ";", "\n", "    ", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", "redsol"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateMessage01", "[", "hstfunc_", "]"}], " ", ":=", "\n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Wrong Dimension of the argument 'confunc'!\>\"", 
      "]"}], ";", "\n", "  ", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<The Length of argument 'confunc' must be 1 and not \>\"", ",", " ", 
       RowBox[{"Length", "[", "hstfunc", "]"}]}], "]"}]}], ")"}]}], 
  ";"}]}], "Code",ExpressionUUID->"fb68304b-7ff7-443a-a333-61caf0034891"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateMessage02", "[", "gradp_List", "]"}], ":=", "\n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<A sub-gradient of the conjugate h^{*} at the zero vector is: \\n\>\
\"", ",", " ", "gradp"}], "]"}], ";", "\n", "  ", 
     RowBox[{
     "Print", "[", 
      "\"\<The sub-gradient may not coincide with the solution of the \
objective function h,\>\"", "]"}], ";", "\n", "  ", 
     RowBox[{
     "Print", "[", "\"\<which must be a pre-kernel solution.\>\"", "]"}], ";",
      "\n", "  ", 
     RowBox[{
     "Print", "[", "\"\<This result may be another pre-kernel solution!\>\"", 
      "]"}], ";", "\n", "  ", 
     RowBox[{
     "Print", "[", 
      "\"\<The conjugate h^{*} is not differential at the zero vector and the \
solution is not a unique vector!\>\"", "]"}], ";", "\n", "  ", 
     RowBox[{
     "Print", "[", "\"\<The pre-kernel solution may not be a singleton!\>\"", 
      "]"}]}], "\n", ")"}]}], ";"}]], "Code",ExpressionUUID->"efbe7288-f3a5-\
42a6-9056-6e2821e19538"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateMessage03", "[", 
     RowBox[{
     "hfunc_", ",", " ", "hstfunc_", ",", " ", "gradhst_", ",", "sol_"}], 
     "]"}], ":=", " ", "\n", "    ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "sol", "]"}], "===", "0"}], ",", 
      RowBox[{"ConjugateMessage03Case1", "[", 
       RowBox[{"hfunc", ",", " ", "hstfunc", ",", " ", "gradhst"}], "]"}], 
      ",", 
      RowBox[{"ConjugateMessage03Case2", "[", 
       RowBox[{"hfunc", ",", " ", "hstfunc", ",", " ", "gradhst"}], "]"}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateMessage03Case1", "[", 
     RowBox[{"hfunc_", ",", " ", "hstfunc_", ",", " ", "gradhst_"}], "]"}], 
    " ", ":=", " ", "\n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The convex input function h\\n\>\"", ",", " ", "hfunc", ",", " ", 
        "\"\<\\n must be an objective function that determines a kernel \
solution.\>\""}], "]"}], ";", "\n", "  ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The conjugate function h^{*} of the convex function h is given by \
\\n\>\"", ",", " ", "hstfunc"}], "]"}], ";", "\n", "  ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The solution\\n\>\"", ",", " ", "gradhst", ",", " ", 
        "\"\<\\n found for h^{*} at the zero vector is a subgradient of \
h^{*}.\>\""}], "]"}], ";", "\n", "  ", 
      RowBox[{
      "Print", "[", 
       "\"\<Thus, the conjugate h^{*} is not differentiable at the zero \
vector.\>\"", "]"}], ";", "\n", "  ", 
      RowBox[{
      "Print", "[", 
       "\"\<Hence, the pre-kernel solution is not a singleton!\>\"", "]"}], 
      ";", "\n", "  ", 
      RowBox[{
      "Print", "[", 
       "\"\<The subgradient found, could be a pre-kernel solution of the \
game.\>\"", "]"}]}], ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateMessage03Case2", "[", 
     RowBox[{"hfunc_", ",", " ", "hstfunc_", ",", " ", "gradhst_"}], "]"}], 
    " ", ":=", " ", "\n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The convex input function h\\n\>\"", ",", " ", "hfunc", ",", " ", 
        "\"\<\\n must be an objective function that determines a kernel \
solution.\>\""}], "]"}], ";", "\n", "  ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The conjugate function h^{*} of the convex function h is given by \
\\n\>\"", ",", " ", "hstfunc"}], "]"}], ";", "\n", "  ", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The solution\\n\>\"", ",", " ", "gradhst", ",", " ", 
        "\"\<\\n found for h^{*} at the zero vector is a gradient of h^{*}.\>\
\""}], "]"}], ";", "\n", "  ", 
      RowBox[{
      "Print", "[", 
       "\"\<Then the conjugate h^{*} is differentiable at the zero \
vector.\>\"", "]"}], ";", "\n", "  ", 
      RowBox[{
      "Print", "[", 
       "\"\<The gradient must be a pre-kernel solution of the game.\>\"", 
       "]"}]}], ")"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Section", " ", "ends", " ", "to", " ", "determine", " ", "a", " ", 
     "PreKernel", " ", "solution", " ", "by", " ", "a", " ", "modified", " ", 
     "SDM"}], "-", "Method"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Kernel", " ", "section", " ", "ends"}], " ", "*)"}]}]}], "Code",Ex\
pressionUUID->"a1263af0-0d00-44c1-a64b-0d53aced4ec1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Start", " ", "mathlink", " ", "section"}], " ", "*)"}], "\n", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "If", " ", "you", " ", "have", " ", "not", " ", "installed", " ", 
    "cddmathlink", " ", "then", " ", "you", " ", "should", " ", "deactivate", 
    " ", 
    RowBox[{"the", " ", "\\\n", "functions"}], " ", "AllVertices", " ", "and",
     " ", "all", " ", "functions", " ", "starting", " ", 
    RowBox[{"with", " ", "'"}], 
    RowBox[{
     RowBox[{"Cdd", "'"}], "."}]}], " ", "*)"}], "\t\t", "\n", "\t\t", "\n", 
  "\t\t", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AllVertices0", "[", 
      RowBox[{"m_Integer", ",", " ", "d_Integer", ",", " ", "a_List"}], "]"}],
      " ", ":=", " ", 
     RowBox[{"ExternalCall", "[", 
      RowBox[{"cddml", ",", 
       RowBox[{"CallPacket", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "d", ",", "a"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllVertices", "[", 
      RowBox[{"m_Integer", ",", " ", "d_Integer", ",", " ", "a_String"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"ExternalCall", "[", 
      RowBox[{"cddmlgmp", ",", 
       RowBox[{"CallPacket", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "d", ",", "a"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllVertices2", "[", 
      RowBox[{"m_Integer", ",", " ", "d_Integer", ",", " ", "a_String"}], 
      "]"}], " ", ":=", 
     RowBox[{"ExternalCall", "[", 
      RowBox[{"cddml2", ",", 
       RowBox[{"CallPacket", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "d", ",", "a"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllVerticesWithAdjacency2", "[", 
      RowBox[{"m_Integer", ",", " ", "d_Integer", ",", " ", "a_String"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"ExternalCall", "[", 
      RowBox[{"cddmlgmp", ",", 
       RowBox[{"CallPacket", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "d", ",", "a"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesCore", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"CddVerticesCore", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesCore", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "CddVerticesCore", "]"}]}]}], "]"}], 
     " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ratexact", ",", "liste", ",", "mat", ",", "values", ",", "extmat", 
         ",", "string1", ",", "m", ",", "d1", ",", "vert1", ",", "linearity1",
          ",", "incidences1"}], "}"}], ",", "\n", "      ", 
       RowBox[{
        RowBox[{"ratexact", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", " ", "\n",
         "      ", 
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">=", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
         "      ", 
        RowBox[{"mat", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
            " ", "liste"}], ",", "1"}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"mat", ",", " ", 
          RowBox[{"-", 
           RowBox[{"Last", "[", "mat", "]"}]}]}], "]"}], ";", "\n", "      ", 
        
        RowBox[{"values", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"Rest", "[", "Coalitions", "]"}]}]}], ";", "\n", "      ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"values", ",", " ", 
          RowBox[{"-", 
           RowBox[{"Last", "[", "values", "]"}]}]}], "]"}], ";", "\n", 
        "      ", 
        RowBox[{"extmat", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Prepend", ",", 
           RowBox[{"{", 
            RowBox[{"mat", ",", 
             RowBox[{"-", "values"}]}], "}"}]}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"string1", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "\t    ", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "d1"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "\t    ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "incidences1"}],
           "}"}], "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
           RowBox[{"AllVertices0", "[", 
            RowBox[{"m", ",", "d1", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"N", "[", "extmat", "]"}], "]"}]}], "]"}], ",", " ", 
           "\n", "                                                       ", 
           "True", ",", 
           RowBox[{"AllVertices", "[", 
            RowBox[{"m", ",", "d1", ",", "string1"}], "]"}]}], "]"}]}], ";", 
        "\n", "      ", 
        RowBox[{"vert1", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Length", "[", "vert", "]"}], ",", "1"}], "]"}], ",", 
           " ", "vert1", ",", " ", 
           RowBox[{"Sort", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
        "      ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], ",", "1"}], "]"}], " ", 
           "&"}], ",", "  ", "vert1"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesImputationSet", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"CddVerticesImputationSet", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesImputationSet", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "CddVerticesReasonableSet", "]"}]}]}], 
      "]"}], " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ratexact", ",", "liste", ",", " ", "zwmat", ",", " ", "finmat", ",", 
         " ", "bvec", ",", " ", "extmat", ",", " ", "string1", ",", " ", "m", 
         ",", " ", "d1", ",", " ", "vert1", ",", " ", "linearity1", ",", " ", 
         "incidences1", ",", " ", "sortlist"}], "}"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{"ratexact", " ", "=", "  ", 
         RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", "\n", 
        "   ", 
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", 
             "0"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{"zwmat", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
            " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"finmat", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"zwmat", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"bvec", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"{", "#", "}"}], "]"}], "&"}], "/@", "T"}], ",", " ", 
           RowBox[{"v", "[", "T", "]"}]}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"extmat", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Prepend", ",", " ", 
           RowBox[{"{", 
            RowBox[{"finmat", ",", " ", 
             RowBox[{"-", "bvec"}]}], "}"}]}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"string1", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
         RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "   ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vert1", ",", " ", "linearity1"}], "}"}], ",", " ", 
           "incidences1"}], "}"}], " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
           RowBox[{"AllVertices0", "[", 
            RowBox[{"m", ",", " ", "d1", ",", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{"N", "[", "extmat", "]"}], "]"}]}], "]"}], ",", "\n", 
           "                                                      ", "True", 
           ",", 
           RowBox[{"AllVertices", "[", 
            RowBox[{"m", ",", " ", "d1", ",", " ", "string1"}], "]"}]}], 
          "]"}]}], ";", "\n", "    ", 
        RowBox[{"sortlist", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Sort", "[", "vert1", "]"}], ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "\n", 
           "                                ", "True", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"ToExpression", "[", "vert1", "]"}], "]"}], ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", " ", "1"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "sortlist"}]}]}], "\n", "   ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesReasonableSet", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"CddVerticesReasonableSet", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CddVerticesReasonableSet", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "CddVerticesReasonableSet", "]"}]}]}], 
      "]"}], " ", ":=", " ", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "propcont", ",", "ratexact", ",", "liste", ",", " ", "zwmat", ",", 
         " ", "finmat", ",", " ", "bvec", ",", " ", "extmat", ",", " ", 
         "string1", ",", " ", "m", ",", " ", "d1", ",", " ", "vert1", ",", 
         " ", "linearity1", ",", " ", "incidences1", ",", " ", "sortlist"}], 
        "}"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{"ratexact", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", "\n", 
        "   ", 
        RowBox[{"propcont", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "ProperContribution", "]"}]}], ";", "\n",
         "   ", 
        RowBox[{"liste", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", 
             "0"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{"zwmat", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
            " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"finmat", " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"zwmat", ",", " ", 
              RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
            RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}]}], ";", "\n", 
        "   ", 
        RowBox[{"bvec", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"propcont", ",", "False"}], "]"}], ",", 
           RowBox[{"Rationalize", "[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ReasonableOutcome", "[", "game", "]"}], ",", " ", 
              RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}], ",", "\n", 
           "           ", "True", ",", 
           RowBox[{"Rationalize", "[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ProperAmount", "[", "game", "]"}], ",", " ", 
              RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
        "\n", "   ", 
        RowBox[{"extmat", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Prepend", ",", " ", 
           RowBox[{"{", 
            RowBox[{"finmat", ",", " ", "bvec"}], "}"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
         RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "   ", 
        RowBox[{"string1", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vert1", ",", " ", "linearity1"}], "}"}], ",", " ", 
           "incidences1"}], "}"}], " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
           RowBox[{"AllVertices0", "[", 
            RowBox[{"m", ",", " ", "d1", ",", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{"N", "[", "extmat", "]"}], "]"}]}], "]"}], ",", "\n", 
           "                                                      ", "True", 
           ",", 
           RowBox[{"AllVertices", "[", 
            RowBox[{"m", ",", " ", "d1", ",", " ", "string1"}], "]"}]}], 
          "]"}]}], ";", "\n", "   ", 
        RowBox[{"sortlist", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Sort", "[", "vert1", "]"}], ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "\n", 
           "                                ", "True", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"ToExpression", "[", "vert1", "]"}], "]"}], ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}]}], ";", "\n",
         "   ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Length", "[", "sortlist", "]"}], ",", "1"}], "]"}], ",", 
          
          RowBox[{"Print", "[", "\"\<Upper Set is a unique point.\>\"", "]"}],
           ",", "True", ",", "True"}], "]"}], ";", "\n", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", " ", "1"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "sortlist"}]}]}], "\n", "   ", "]"}]}], ";"}], "\n"}]}]], "Code",Expr\
essionUUID->"ed2fd808-ae77-43fb-bbf4-14fa6536544c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CddVerticesLowerSet", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddVerticesLowerSet", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddVerticesLowerSet", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "CddVerticesLowerSet", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ratexact", ",", "liste", ",", " ", "zwmat", ",", " ", "finmat", ",", 
       " ", "bvec", ",", " ", "smc", ",", " ", "extmat", ",", " ", "string1", 
       ",", " ", "m", ",", " ", "d1", ",", " ", "vert1", ",", " ", 
       "linearity1", ",", " ", "incidences1", ",", " ", "sortlist"}], "}"}], 
     ",", "\n", "   ", 
     RowBox[{
      RowBox[{"ratexact", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", "\n", "   ", 
      RowBox[{"liste", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", "0"}],
           "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"zwmat", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
          " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"finmat", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"zwmat", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
          RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}]}], ";", "\n", "   ", 
      
      RowBox[{"smc", " ", "=", " ", 
       RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"bvec", " ", "=", " ", 
       RowBox[{"Rationalize", "[", 
        RowBox[{"Append", "[", 
         RowBox[{"smc", ",", " ", 
          RowBox[{"-", 
           RowBox[{"v", "[", "T", "]"}]}]}], "]"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"extmat", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Prepend", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "finmat"}], ",", " ", "bvec"}], "}"}]}], "]"}]}], ";",
       "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
       RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "   ", 
      RowBox[{"string1", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vert1", ",", " ", "linearity1"}], "}"}], ",", " ", 
         "incidences1"}], "}"}], "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
         RowBox[{"AllVertices0", "[", 
          RowBox[{"m", ",", " ", "d1", ",", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"N", "[", "extmat", "]"}], "]"}]}], "]"}], ",", "\n", 
         "                                                      ", "True", 
         ",", 
         RowBox[{"AllVertices", "[", 
          RowBox[{"m", ",", " ", "d1", ",", " ", "string1"}], "]"}]}], 
        "]"}]}], ";", "\n", "   ", 
      RowBox[{"sortlist", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ratexact", ",", "False"}], "]"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Sort", "[", "vert1", "]"}], ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "\n", 
         "                                ", "True", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"ToExpression", "[", "vert1", "]"}], "]"}], ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Length", "[", "sortlist", "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Lower Set is a unique point.\>\"", "]"}], 
         ";"}], ",", "True", ",", "True"}], "]"}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"#", ",", " ", "1"}], "]"}], " ", "&"}], " ", "/@", " ", 
       "sortlist"}]}]}], "\n", "   ", "]"}]}], ";"}], "\n"}], "Code",Expressio\
nUUID->"f89257d8-b8dc-4641-870d-999823904dcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpVerticesCore", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpVerticesCore", "::", "argerr"}], "]"}], ";", "$Failed"}],
     ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpVerticesCore", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "CddGmpVerticesCore", "]"}]}]}], "]"}], 
   " ", ":=", " ", "\n", "   ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ratexact", ",", "withinc", ",", "liste", ",", "mat", ",", "values", 
       ",", "extmat", ",", "string1", ",", "string2", ",", "m", ",", "d1", 
       ",", "vert1", ",", "vertlist1", ",", "linearity1", ",", "incidences1", 
       ",", "sortlist"}], "}"}], ",", "\n", "        ", 
     RowBox[{
      RowBox[{"ratexact", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", " ", "\n", 
      "        ", 
      RowBox[{"withinc", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "WithIncidences", "]"}]}], ";", " ", "\n", 
      "\t      ", 
      RowBox[{"liste", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">=", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\t      ", 
      RowBox[{"mat", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
          " ", "liste"}], ",", "1"}], "]"}]}], ";", "\n", "        ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"mat", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Last", "[", "mat", "]"}]}]}], "]"}], ";", "\n", "        ", 
      
      RowBox[{"values", " ", "=", " ", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", 
         RowBox[{"Rest", "[", "Coalitions", "]"}]}], "]"}]}], ";", "\n", 
      "        ", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"values", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Last", "[", "values", "]"}]}]}], "]"}], ";", "\n", 
      "        ", 
      RowBox[{"extmat", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Prepend", ",", 
         RowBox[{"{", 
          RowBox[{"mat", ",", 
           RowBox[{"-", "values"}]}], "}"}]}], "]"}]}], ";", "\n", "        ", 
      RowBox[{"string1", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "        ", 
      
      RowBox[{"string2", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"N", "[", "extmat", "]"}], ",", "InputForm"}], "]"}]}], ";", 
      "\n", "\t      ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "d1"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "\t      ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "incidences1"}], 
        "}"}], "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ratexact", ",", "True"}], "]"}], ",", " ", 
         RowBox[{"AllVertices", "[", 
          RowBox[{"m", ",", "d1", ",", "string1"}], "]"}], ",", "\n", 
         "                                            ", 
         RowBox[{"AllVertices2", "[", 
          RowBox[{"m", ",", "d1", ",", "string2"}], "]"}]}], "]"}]}], ";", 
      "\n", "        ", 
      RowBox[{"vert1", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Length", "[", "vert1", "]"}], ",", "1"}], "]"}], ",", " ",
          "vert1", ",", " ", 
         RowBox[{"Sort", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
      "        ", 
      RowBox[{"vertlist1", " ", "=", "  ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#", "]"}], ",", "1"}], "]"}], " ", 
          "&"}], ",", "  ", "vert1"}], "]"}]}], ";", "\n", "        ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"withinc", " ", "==", " ", "False"}], ")"}], " ", "&&", " ", 
         RowBox[{"(", 
          RowBox[{"ratexact", " ", "==", " ", "False"}], ")"}]}], ",", " ", 
        RowBox[{"Chop", "[", 
         RowBox[{"vertlist1", ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "12"}], ")"}]}]}], "]"}], ",", "\n", 
        "              ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"withinc", " ", "==", " ", "False"}], ")"}], " ", "&&", " ", 
         RowBox[{"(", 
          RowBox[{"ratexact", " ", "==", " ", "True"}], ")"}]}], ",", "  ", 
        "vertlist1", ",", "\n", "              ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"withinc", " ", "==", " ", "True"}], ")"}], " ", "&&", " ", 
         
         RowBox[{"(", 
          RowBox[{"ratexact", " ", "==", " ", "False"}], ")"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"vertlist1", ",", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "12"}], ")"}]}]}], "]"}], ",", " ", 
          "incidences1"}], "}"}], ",", "\n", "              ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"withinc", " ", "==", " ", "True"}], ")"}], " ", "&&", " ", 
         
         RowBox[{"(", 
          RowBox[{"ratexact", " ", "==", " ", "True"}], ")"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"vertlist1", ",", "incidences1"}], "}"}], ",", "\n", 
        "              ", "True", ",", " ", "vertlist1"}], "\n", 
       "              ", "]"}]}]}], "\n", "]"}]}], ";"}]}], "Code",ExpressionU\
UID->"f8282c3e-bee0-4f6a-8c5c-a9c827ae8d50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpPlotCore", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpPlotCore", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotCore", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "CddGmpPlotCore", "]"}]}]}], "]"}], " ",
     ":=", " ", "\n", "   ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ratexact", ",", "liste", ",", "mat", ",", "values", ",", "extmat", 
        ",", "string1", ",", "m1", ",", "d1", ",", "vert1", ",", "vertlist1", 
        ",", "linearity1", ",", "sortlist1", ",", "ecdlist1", ",", "eadlist1",
         ",", "icdlist1", ",", "iadlist1"}], "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"ratexact", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "RationalExact", "]"}]}], ";", " ", "\n", 
       "     ", 
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", ">=", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"mat", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", "liste"}], ",", "1"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"mat", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Last", "[", "mat", "]"}]}]}], "]"}], ";", "\n", "     ", 
       RowBox[{"values", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"Rest", "[", "Coalitions", "]"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"values", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Last", "[", "values", "]"}]}]}], "]"}], ";", "\n", "     ", 
       RowBox[{"extmat", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Prepend", ",", 
          RowBox[{"{", 
           RowBox[{"mat", ",", 
            RowBox[{"-", "values"}]}], "}"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"string1", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m1", ",", "d1"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "\t   ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "ecdlist1", ",", 
          "eadlist1", ",", "icdlist1", ",", "iadlist1"}], "}"}], " ", "=", 
        " ", 
        RowBox[{"AllVerticesWithAdjacency2", "[", 
         RowBox[{"m1", ",", "d1", ",", "string1"}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"vertlist1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", " ", 
          RowBox[{"ToExpression", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vertlist1", ",", "linearity1"}], "}"}], ",", "ecdlist1", 
         ",", "eadlist1", ",", "icdlist1", ",", "iadlist1", ",", "extmat"}], 
        "}"}]}]}], "\n", " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpPlotImputationSet", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpPlotImputationSet", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotImputationSet", "[", "game_", "]"}], " ", ":=", " ", 
    "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "liste", ",", " ", "zwmat", ",", " ", "finmat", ",", " ", "bvec", ",", 
        " ", "extmat", ",", " ", "m", ",", " ", "d1", ",", " ", "vert1", ",", 
        " ", "string1", ",", " ", "vertlist1", ",", " ", "linearity1", ",", 
        " ", "sortlist", ",", " ", "ecdlist1", ",", "eadlist1", ",", 
        "icdlist1", ",", "iadlist1"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", 
            "0"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"zwmat", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"finmat", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"zwmat", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
          RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"bvec", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"{", "#", "}"}], "]"}], "&"}], "/@", "T"}], ",", " ", 
           RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       
       RowBox[{"extmat", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Prepend", ",", " ", 
          RowBox[{"{", 
           RowBox[{"finmat", ",", " ", 
            RowBox[{"-", "bvec"}]}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
        RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"string1", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "ecdlist1", ",", 
          "eadlist1", ",", "icdlist1", ",", "iadlist1"}], "}"}], " ", "=", 
        " ", 
        RowBox[{"AllVerticesWithAdjacency2", "[", 
         RowBox[{"m", ",", "d1", ",", "string1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vert1", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Sort", "[", "vert1", "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vertlist1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", " ", 
          RowBox[{"ToExpression", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vertlist1", ",", "linearity1"}], "}"}], ",", "ecdlist1", 
         ",", "eadlist1", ",", "icdlist1", ",", "iadlist1", ",", "extmat"}], 
        "}"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpImputationVertices", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpImputationVertices", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpImputationVertices", "[", "game_", "]"}], " ", ":=", " ", 
    "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "liste", ",", "zwmat", ",", "finmat", ",", "bvec", ",", "extmat", ",", 
        "m", ",", "d1", ",", "vert1", ",", "string1", ",", "linearity1", ",", 
        "sortlist", ",", "ecdlist1", ",", "eadlist1", ",", "icdlist1", ",", 
        "iadlist1"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", 
            "0"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"zwmat", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"finmat", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"zwmat", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
          RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"bvec", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"{", "#", "}"}], "]"}], "&"}], "/@", "T"}], ",", " ", 
           RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}]}], ";", "\n", "    ", 
       
       RowBox[{"extmat", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Prepend", ",", " ", 
          RowBox[{"{", 
           RowBox[{"finmat", ",", " ", 
            RowBox[{"-", "bvec"}]}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
        RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"string1", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "ecdlist1", ",", 
          "eadlist1", ",", "icdlist1", ",", "iadlist1"}], "}"}], " ", "=", 
        " ", 
        RowBox[{"AllVerticesWithAdjacency2", "[", 
         RowBox[{"m", ",", "d1", ",", "string1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vert1", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Sort", "[", "vert1", "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", " ", 
         RowBox[{"ToExpression", "[", "vert1", "]"}]}], "]"}]}]}], "\n", 
     "     ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpPlotReasonableSet", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpPlotReasonableSet", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpPlotReasonableSet", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "CddGmpPlotReasonableSet", "]"}]}]}], 
    "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "propcont", ",", "liste", ",", " ", "zwmat", ",", " ", "finmat", ",", 
       " ", "reasout", ",", "propout", ",", "bvec", ",", " ", "extmat", ",", 
       " ", "m", ",", " ", "d1", ",", " ", "vert1", ",", " ", "vertlist1", 
       ",", " ", "string1", ",", " ", "linearity1", ",", " ", "incidences1", 
       ",", " ", "sortlist", ",", "ecdlist1", ",", "eadlist1", ",", 
       "icdlist1", ",", "iadlist1"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"propcont", " ", "=", "  ", 
       RowBox[{"OptionValue", "[", "ProperContribution", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"liste", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", "0"}],
           "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"zwmat", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
          " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"finmat", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"zwmat", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
          RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"reasout", " ", "=", " ", 
       RowBox[{"ReasonableOutcome", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"propout", " ", "=", " ", 
       RowBox[{"ProperAmount", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"reasout", ",", "propout"}], "]"}], ",", 
        RowBox[{
        "Print", "[", "\"\<Reasonable set coincides with the Upper set!\>\"", 
         "]"}], ",", "True", ",", "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"bvec", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"propcont", ",", "False"}], "]"}], ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"reasout", ",", " ", 
            RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}], ",", "\n", 
         "                 ", "True", ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"propout", ",", " ", 
            RowBox[{"v", "[", "T", "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"extmat", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Prepend", ",", " ", 
         RowBox[{"{", 
          RowBox[{"finmat", ",", " ", "bvec"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
       RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "    ", 
      RowBox[{"string1", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "ecdlist1", ",", 
         "eadlist1", ",", "icdlist1", ",", "iadlist1"}], "}"}], " ", "=", " ", 
       RowBox[{"AllVerticesWithAdjacency2", "[", 
        RowBox[{"m", ",", "d1", ",", "string1"}], "]"}]}], ";", "\n", "    ", 
      
      RowBox[{"vert1", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Sort", "[", "vert1", "]"}], ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"vertlist1", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", " ", 
         RowBox[{"ToExpression", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Length", "[", "vertlist1", "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Upper Set is a unique point.\>\"", "]"}], 
         ";"}], ",", "True", ",", "True"}], "]"}], ";", "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vertlist1", ",", "linearity1"}], "}"}], ",", "ecdlist1", 
        ",", "eadlist1", ",", "icdlist1", ",", "iadlist1", ",", "extmat"}], 
       "}"}]}]}], "\n", "    ", "]"}]}], ";"}]}], "Code",ExpressionUUID->\
"812c1ab0-7e87-421a-ba37-d896fa0be9fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CddGmpPlotLowerSet", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CddGmpPlotLowerSet", "::", "argerr"}], "]"}], ";", "$Failed"}],
     ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CddGmpPlotLowerSet", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "CddGmpPlotLowerSet", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "liste", ",", " ", "zwmat", ",", " ", "finmat", ",", " ", "bvec", ",", 
        " ", "smc", ",", " ", "extmat", ",", " ", "m", ",", " ", "d1", ",", 
        " ", "vert1", ",", " ", "vertlist1", ",", " ", "string1", ",", " ", 
        "linearity1", ",", " ", "incidences1", ",", " ", "sortlist", ",", 
        "ecdlist1", ",", "eadlist1", ",", "icdlist1", ",", "iadlist1"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"liste", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", " ", ">=", " ", "j"}], ",", " ", "1", ",", " ", 
            "0"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"zwmat", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Permutations", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", "liste"}], ",", " ", "1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"finmat", " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"zwmat", ",", " ", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Last", "[", "zwmat", "]"}]}], "]"}]}]}], ";", "\n", 
       "    ", 
       RowBox[{"smc", " ", "=", " ", 
        RowBox[{"SmallestContributionVector", "[", "game", "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"smc", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], "]"}], 
         ",", " ", 
         RowBox[{
         "Print", "[", 
          "\"\<The Lower Set coincides with the Imputation Set!\>\"", "]"}], 
         ",", "\n", "                ", "True", ",", "True"}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"bvec", " ", "=", " ", 
        RowBox[{"Rationalize", "[", 
         RowBox[{"Append", "[", 
          RowBox[{"smc", ",", " ", 
           RowBox[{"-", 
            RowBox[{"v", "[", "T", "]"}]}]}], "]"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"extmat", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Prepend", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "finmat"}], ",", " ", "bvec"}], "}"}]}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "d1"}], "}"}], " ", "=", " ", 
        RowBox[{"Dimensions", "[", "extmat", "]"}]}], ";", "\n", "    ", 
       RowBox[{"string1", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"extmat", ",", "InputForm"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vert1", ",", "linearity1"}], "}"}], ",", "ecdlist1", ",", 
          "eadlist1", ",", "icdlist1", ",", "iadlist1"}], "}"}], " ", "=", 
        " ", 
        RowBox[{"AllVerticesWithAdjacency2", "[", 
         RowBox[{"m", ",", "d1", ",", "string1"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vert1", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Sort", "[", "vert1", "]"}], ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"vertlist1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", " ", 
          RowBox[{"ToExpression", "[", "vert1", "]"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Length", "[", "vertlist1", "]"}], ",", "1"}], "]"}], ",", 
         
         RowBox[{
          RowBox[{"Print", "[", "\"\<Lower Set is a unique point.\>\"", "]"}],
           ";"}], ",", "True", ",", "True"}], "]"}], ";", "\n", "    ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vertlist1", ",", "linearity1"}], "}"}], ",", "ecdlist1", 
         ",", "eadlist1", ",", "icdlist1", ",", "iadlist1", ",", "extmat"}], 
        "}"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BaryCenter", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"BaryCenter", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BaryCenter", "[", "game_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "crv", "}"}], ",", "\n", "     ", 
     RowBox[{
      RowBox[{"crv", "=", 
       RowBox[{"CddGmpVerticesCore", "[", "game", "]"}]}], ";", "\n", "     ", 
      RowBox[{
       RowBox[{"Total", "[", "crv", "]"}], "/", 
       RowBox[{"Length", "[", "crv", "]"}]}]}]}], "\n", "\t\t   ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"10fb3392-7171-43ae-89c2-dc1a4d1bd39d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AnimationKernelProperty2d", "[", 
    RowBox[{"game_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "AnimationKernelProperty2d", "]"}]}]}], 
    "]"}], " ", ":=", " ", "\n", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "uppval", ",", "lowval", ",", "stpsize", ",", "detlow", ",", "manip", 
       ",", "fs"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"fs", "  ", "=", "  ", 
       RowBox[{"OptionValue", "[", "FigureSize", "]"}]}], ";", "\n", "    ", 
      RowBox[{"uppval", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "UpperCritVal", "]"}]}], ";", "\n", "    ", 
      RowBox[{"lowval", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "LowerCritVal", "]"}]}], ";", "\n", "    ", 
      RowBox[{"stpsize", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "IncSize", "]"}]}], ";", "\n", "    ", 
      RowBox[{"manip", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "UseManipulate", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"detlow", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lowval", "==", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"First", "[", 
          RowBox[{"EpsCore", "[", "game", "]"}], "]"}], ",", " ", 
         RowBox[{"lowval", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"manip", ",", "False"}], "]"}], ",", "\n", "             ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StrongEpsCore2d", "[", 
           RowBox[{"game", ",", " ", 
            RowBox[{"FigureSize", " ", "->", " ", "fs"}], ",", " ", 
            RowBox[{"EpsilonValue", " ", "->", " ", "t"}], ",", 
            RowBox[{"Labeling", " ", "->", " ", "False"}]}], "]"}], ",", " ", 
          
          RowBox[{"{", 
           RowBox[{"t", ",", " ", 
            RowBox[{"uppval", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", "detlow", ",", " ", 
            RowBox[{"stpsize", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", "\n", 
        "             ", 
        RowBox[{
         RowBox[{"SetOptions", "[", 
          RowBox[{"StrongEpsCore2d", ",", " ", 
           RowBox[{"FigureSize", " ", "->", " ", "fs"}]}], "]"}], ";", "\n", 
         "             ", 
         RowBox[{"Manipulate", "[", 
          RowBox[{
           RowBox[{"StrongEpsCore2d", "[", 
            RowBox[{"game", ",", " ", 
             RowBox[{"EpsilonValue", " ", "->", " ", "t"}], ",", " ", 
             RowBox[{"Labeling", " ", "->", " ", "False"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t", ",", " ", 
               RowBox[{"uppval", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Epsilon\>\""}], 
              "}"}], ",", " ", "detlow", ",", " ", 
             RowBox[{"uppval", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"stpsize", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], " ", "\n",
        "      ", "]"}]}]}], "\n", "    ", "]"}]}], ";"}]], "Code",ExpressionU\
UID->"73c52b40-1e48-4b51-a9af-80f4fba605c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StrongEpsCore2d", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"StrongEpsCore2d", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrongEpsCore2d", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "StrongEpsCore2d", "]"}]}]}], "]"}], 
    " ", ":=", " ", "\n", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fs", ",", "lab", ",", "oldvls", ",", "epsval", ",", "epsvls", ",", 
        "newgame", ",", "vertlist", ",", "vert", ",", "cvh", ",", "mv", ",", 
        "vpts", ",", "lgd", ",", "origgame", ",", "gr1", ",", "gr2", ",", 
        "gr2b", ",", "gr", ",", "grli"}], "}"}], ",", "\n", "     ", 
      RowBox[{
       RowBox[{"fs", "  ", "=", "  ", 
        RowBox[{"OptionValue", "[", "FigureSize", "]"}]}], ";", "\n", "     ", 
       RowBox[{"epsval", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "EpsilonValue", "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"lab", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Labeling", "]"}]}], ";", "\n", "     ", 
       RowBox[{"oldvls", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"gr1", "=", 
        RowBox[{"FilledCoreV6", "[", 
         RowBox[{"game", ",", 
          RowBox[{"DisplayLegend", " ", "->", " ", "False"}], ",", 
          RowBox[{"Silent", " ", "->", " ", "True"}]}], "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"epsvls", " ", "=", " ", 
        RowBox[{"EpsValue", "[", 
         RowBox[{"game", ",", " ", "epsval"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"epsvls", " ", "=", " ", 
        RowBox[{"Prepend", "[", 
         RowBox[{"epsvls", ",", "0"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"epsvls", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"epsvls", ",", 
          RowBox[{"Last", "[", "oldvls", "]"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"newgame", "=", " ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", "epsvls"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"vertlist", "=", 
        RowBox[{"CddGmpVerticesCore", "[", "newgame", "]"}]}], ";", "\n", 
       "     ", 
       RowBox[{"vert", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Vec3DToSimplex", "[", "#", "]"}], " ", "&"}], " ", "/@", 
         " ", "vertlist"}]}], ";", "\n", "     ", 
       RowBox[{"cvh", "=", " ", 
        RowBox[{"ConvexHull", "[", "vert", "]"}]}], ";", "\n", "     ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"cvh", ",", 
         RowBox[{"First", "[", "cvh", "]"}]}], "]"}], ";", "\n", "     ", 
       RowBox[{"mv", "=", 
        RowBox[{"Mean", "[", "vert", "]"}]}], ";", "\n", "     ", 
       RowBox[{"vpts", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", "#", "]"}], " ", "&"}], "/@", " ", "vert"}]}],
        ";", "\n", "     ", 
       RowBox[{"lgd", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lab", ",", "True"}], "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"#1", ",", 
               RowBox[{
                RowBox[{"1.15", "*", "#2"}], "-", 
                RowBox[{"0.15", "*", "mv"}]}]}], "]"}], " ", "&"}], ",", " ", 
            
            RowBox[{"{", 
             RowBox[{"vertlist", ",", "vert"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"gr2", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", " ", 
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{"vert", ",", " ", 
             RowBox[{"Line", "[", "cvh", "]"}]}], "]"}]}], "}"}], "]"}]}], 
       ";", "\n", "     ", 
       RowBox[{"gr2b", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"lgd", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Brown", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}], ",", "vpts"}], "}"}],
              ",", "lgd"}], "}"}], "]"}]}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"origgame", "=", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", "oldvls"}], "]"}]}], ";", "\n", "     ", 
       RowBox[{"grli", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"gr1", ",", "gr2", ",", "gr2b"}], "}"}], "]"}]}], ";", "\n",
        "     ", 
       RowBox[{"gr", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"grli", ",", 
          RowBox[{"ImageSize", " ", "->", " ", "fs"}], ",", 
          RowBox[{"PlotLabel", " ", "->", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<eps=\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", "epsval", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
       ";", "\n", "     ", 
       RowBox[{"Return", "[", "gr", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FilledCoreV6", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"FilledCoreV6", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FilledCoreV6", "[", 
     RowBox[{"game_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "FilledCoreV6", "]"}]}]}], "]"}], " ", ":=",
     " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dlg", ",", "fs", ",", "sil", ",", "prim", ",", "vertlist", ",", 
        "impext", ",", "solv", ",", "vert", ",", "mv1", ",", "mv2", ",", 
        "imp", ",", "clm", ",", "lgd1", ",", "lgd2", ",", "vpts", ",", "ipts",
         ",", "spts", ",", "redead", ",", "rg", ",", "impred", ",", "dltr", 
        ",", "cvh", ",", "tric", ",", "crdli", ",", "trpts", ",", "gr0", ",", 
        "gr0b", ",", "gr1", ",", "gr1b", ",", "gr2", ",", "gr3", ",", "grli", 
        ",", "gr"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"dlg", "  ", "=", " ", 
        RowBox[{"OptionValue", "[", "DisplayLegend", "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"fs", "  ", "=", "  ", 
        RowBox[{"OptionValue", "[", "FigureSize", "]"}]}], ";", "\n", "    ", 
       
       RowBox[{"sil", "  ", "=", " ", 
        RowBox[{"OptionValue", "[", "Silent", "]"}]}], ";", "\n", "    ", 
       RowBox[{"prim", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "PreImpSet", "]"}]}], ";", "\t ", "\n", 
       "    ", 
       RowBox[{"vertlist", "=", 
        RowBox[{"CddGmpVerticesCore", "[", "game", "]"}]}], ";", "\n", "    ", 
       RowBox[{"impext", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"prim", ",", "True"}], "]"}], ",", 
          RowBox[{"Permutations", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "[", "T", "]"}], ",", "0", ",", "0"}], "}"}], "]"}],
           ",", 
          RowBox[{"CddGmpImputationVertices", "[", "game", "]"}]}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"solv", " ", "=", "  ", 
        RowBox[{"PointSol", "[", "game", "]"}]}], ";", "\n", "    ", 
       RowBox[{"vert", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vertlist", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\n", "                      ", 
          
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"sil", ",", "False"}], "]"}], ",", 
             RowBox[{"Print", "[", "\"\<Core is empty\>\"", "]"}], ",", 
             "True"}], "]"}], ";", 
           RowBox[{"{", "}"}]}], ",", "\n", "                    ", 
          RowBox[{
           RowBox[{
            RowBox[{"Vec3DToSimplex", "[", "#", "]"}], " ", "&"}], " ", "/@", 
           " ", "vertlist"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"imp", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Vec3DToSimplex", "[", "#", "]"}], " ", "&"}], " ", "/@", 
         " ", "impext"}]}], ";", "\n", "    ", 
       RowBox[{"mv1", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Mean", "[", "vert", "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"mv2", " ", "=", " ", 
        RowBox[{"Mean", "[", "imp", "]"}]}], ";", "\n", "    ", 
       RowBox[{"lgd1", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"#1", ",", 
               RowBox[{
                RowBox[{"1.15", "*", "#2"}], "-", 
                RowBox[{"0.15", "*", "mv1"}]}]}], "]"}], " ", "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"vertlist", ",", "vert"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"lgd2", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"#1", ",", 
             RowBox[{
              RowBox[{"1.1", "*", "#2"}], "-", 
              RowBox[{"0.1", "*", "mv2"}]}]}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"impext", ",", "imp"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"vpts", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Point", "[", "#", "]"}], " ", "&"}], "/@", " ", 
           "vert"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"ipts", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", "#", "]"}], " ", "&"}], "/@", " ", "imp"}]}], 
       ";", "\n", "    ", 
       RowBox[{"spts", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", "#", "]"}], " ", "&"}], "/@", " ", "solv"}]}],
        ";", "\n", "    ", 
       RowBox[{"redead", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{"T", ",", "#"}], "]"}], " ", "&"}], "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"rg", " ", "=", " ", 
        RowBox[{"Range", "[", "3", "]"}]}], ";", "\n", "    ", 
       RowBox[{"impred", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Append", ",", 
          RowBox[{"{", 
           RowBox[{"redead", ",", "rg"}], "}"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"trpts", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", "\n", "                  ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Length", "[", "vert", "]"}], ",", "1"}], "]"}], ",", 
            "vert", ","}], "*)"}], "\n", "                  ", "True", ",", 
          " ", 
          RowBox[{
           RowBox[{"dltr", " ", "=", " ", 
            RowBox[{"DelaunayTriangulation", "[", "vert", "]"}]}], ";", "\n", 
           "                        ", 
           RowBox[{"cvh", "=", " ", 
            RowBox[{"ConvexHull", "[", "vert", "]"}]}], ";", "\n", 
           "                        ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cvh", ",", 
             RowBox[{"First", "[", "cvh", "]"}]}], "]"}], ";", "\n", 
           "\t                ", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], " ", "&"}], " ", "/@",
             " ", "dltr"}]}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"gr0", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", " ", 
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{"imp", ",", " ", 
             RowBox[{"Line", "[", "impred", "]"}]}], "]"}]}], "}"}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"gr0b", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"PointSize", "[", "0.015", "]"}], ",", "ipts"}], "}"}], 
           ",", "lgd2"}], "}"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"gr1", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"GreaterEqual", "[", 
           RowBox[{"$VersionNumber", ",", "10."}], "]"}], ",", "\n", 
          "\t      ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"vert", ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", "\n", "           ", 
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Length", "[", "vert", "]"}], ",", "1"}], "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"PointSize", "[", "0.018", "]"}], ",", 
               RowBox[{"Point", "[", "vert", "]"}]}], "}"}], "]"}], ",", "\n",
             "           ", "True", ",", " ", 
            RowBox[{"ConvexHullMesh", "[", "vert", "]"}]}], "]"}], ",", "\n", 
          "\t   ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"vert", ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", " ", 
               RowBox[{"GraphicsComplex", "[", 
                RowBox[{"vert", ",", 
                 RowBox[{"Polygon", "[", "trpts", "]"}]}], "]"}]}], "}"}], 
             "]"}]}], "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"gr1b", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}], ",", "vpts"}], "}"}],
              ",", "lgd1"}], "}"}], "]"}]}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"gr2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"vert", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", " ", 
             RowBox[{"GraphicsComplex", "[", 
              RowBox[{"vert", ",", " ", 
               RowBox[{"Line", "[", "cvh", "]"}]}], "]"}]}], "}"}], "]"}]}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"clm", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"LightRed", ",", "Green", ",", "Blue", ",", "Red"}], "}"}]}],
        ";", "\n", "    ", 
       RowBox[{"gr3", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"#1", ",", 
               RowBox[{"PointSize", "[", "0.018", "]"}], ",", "#2"}], "}"}], 
             "]"}], " ", "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"clm", ",", "spts"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"grli", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
          "gr0", ",", "gr0b", ",", "gr1", ",", "gr1b", ",", "gr2", ",", 
           "gr3"}], "}"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"gr", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{"grli", ",", 
          RowBox[{"ImageSize", " ", "->", " ", "fs"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"gr", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"dlg", ",", "True"}], "]"}], ",", " ", 
          RowBox[{"ShowLegend", "[", 
           RowBox[{"gr", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{"Blue", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "0.005"}], 
                    "]"}]}], "}"}], "]"}], ",", " ", 
                  "\"\<Shapley Value\>\""}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{"Green", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "0.005"}], 
                    "]"}]}], "}"}], "]"}], ",", " ", "\"\<Nucleolus\>\""}], 
                 "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{"LightRed", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "0.005"}], 
                    "]"}]}], "}"}], "]"}], ",", " ", "\"\<Kernel\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{"Red", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "0.005"}], 
                    "]"}]}], "}"}], "]"}], ",", " ", "\"\<Pre-Kernel\>\""}], 
                 "}"}]}], "}"}], ",", " ", 
              RowBox[{"LegendShadow", " ", "->", " ", "None"}], ",", " ", 
              RowBox[{"LegendTextSpace", " ", "->", " ", "5"}], ",", 
              RowBox[{"LegendPosition", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{"1.1", ",", " ", 
                 RowBox[{"-", ".4"}]}], "}"}]}], ",", 
              RowBox[{"LegendSize", "->", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.25"}], "}"}]}]}], "}"}]}], "]"}], ",", 
          "gr"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"Return", "[", "gr", "]"}], ";"}]}], "\n", "    ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PointSol", "[", "game_", "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kr", ",", "nc", ",", "shv", ",", "prk"}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{
      RowBox[{"kr", "=", 
       RowBox[{"Kernel", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"nc", "=", 
       RowBox[{"ModifiedNucleolus", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"shv", " ", "=", " ", 
       RowBox[{"ShapleyValue", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"prk", " ", "=", " ", 
       RowBox[{"PreKernelSolution", "[", "game", "]"}]}], ";", "\n", "    ", 
      RowBox[{"nc", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"nc", ",", "ker"}], "]"}], ",", "nc", ",", "kr"}], "]"}]}], 
      ";", "\n", "    ", 
      RowBox[{
       RowBox[{
        RowBox[{"Vec3DToSimplex", "[", "#", "]"}], " ", "&"}], "/@", " ", 
       RowBox[{"{", 
        RowBox[{"kr", ",", "nc", ",", "shv", ",", "prk"}], "}"}]}]}]}], "\n", 
    "]"}]}], ";"}], "\n"}], "Code",ExpressionUUID->"45cfa203-d876-4e5f-83b6-\
1743e20d7335"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Function", " ", 
   RowBox[{"FilledCore", "[", "]"}], " ", "is", " ", 
   RowBox[{"deprecated", ".", " ", "Use"}], " ", "TuGames", " ", "Version", 
   " ", "1.8", " ", "if", " ", "you", " ", "need", " ", "this", " ", 
   RowBox[{"function", "."}]}], " ", "*)"}]], "Code",ExpressionUUID->\
"95540355-b927-4745-a786-c59527808504"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vec3DToSimplex", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"x2_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"x3_", "?", "NumberQ"}]}], "}"}], "]"}], " ", ":=", " ", "\n", 
    "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", " ", "-", " ", "x1"}], ")"}], " ", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ",", " ", 
        RowBox[{"x3", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x1", " ", "+", " ", "x2"}], ")"}], "/", "2"}]}]}], 
       "}"}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Borrowed", " ", "from", "\n", 
     RowBox[{"https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "3506982"}], "/", "projecting"}], "-", "points", "-", "from", "-", 
     RowBox[{"4", "d"}], "-", "space", "-", "into", "-", 
     RowBox[{"3", "d"}], "-", "space", "-", "in", "-", "mathematica"}]}], " ",
    "\n", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vec4DToSimplex", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"x2_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"x3_", "?", "NumberQ"}], ",", " ", 
       RowBox[{"x4_", "?", "NumberQ"}]}], "}"}], "]"}], " ", ":=", " ", "\n", 
    "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", " ", "+", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{"x3", " ", "+", " ", "x4"}], ")"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x3", "/", "2"}], " ", "+", " ", 
           RowBox[{"x4", "/", "6"}]}], ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "6", "]"}], " ", "*", " ", 
         RowBox[{"x4", "/", "3"}]}]}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"End", " ", "mathlink", " ", "section"}], " ", "*)"}]}]}], "Code",E\
xpressionUUID->"3b8f24d3-b7f9-46f9-96e6-94155d097736"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "section", " ", "adjusted", " ", "worth", " ", "vector", " ", "starts"}], 
   " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedWorthVectors", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AdjustedWorthVectors", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedWorthVectors", "[", 
      RowBox[{"game_", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "permliste", "}"}], ",", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "k", "]"}], "==", "1"}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"permliste", " ", "=", " ", 
           RowBox[{"Permutations", "[", "T", "]"}]}], ";", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"SubCall1", "[", 
                 RowBox[{"#", ",", " ", "i", ",", " ", "k"}], "]"}], ",", " ",
                 "\n", "          ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"v", ",", " ", 
                    RowBox[{"PlayerIJoin", "[", 
                    RowBox[{"#", ",", " ", "i"}], "]"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"v", ",", " ", 
                    RowBox[{"PDeltaI", "[", 
                    RowBox[{"#", ",", " ", "i"}], "]"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "          ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"SubCall2", "[", 
                   RowBox[{"#", ",", " ", "i", ",", " ", "k"}], "]"}], ",", 
                  " ", 
                  RowBox[{"UtopiaPayoff", "[", 
                   RowBox[{"game", ",", " ", "i"}], "]"}], ",", "\n", 
                  "             ", 
                  RowBox[{
                   RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"v", ",", " ", 
                    RowBox[{"PDeltaI", "[", 
                    RowBox[{"#", ",", " ", "i"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
                   RowBox[{"UtopiaSum", "[", 
                    RowBox[{"game", ",", " ", 
                    RowBox[{"DeltaJSet", "[", 
                    RowBox[{"#", ",", " ", "k"}], "]"}]}], "]"}]}]}], "]"}]}],
                "\n", "             ", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", "/@", " ", "permliste"}]}], ",", " ", "\n", 
         "         ", 
         RowBox[{"DisplayRem", "[", "k", "]"}]}], "\n", "    ", "]"}]}], "\n",
       "   ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayRem", "[", "k_Integer", "]"}], ":=", 
     RowBox[{"(", "\n", "         ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Depth is equal to \>\"", ",", 
         RowBox[{"Depth", "[", "k", "]"}]}], "]"}], ";", "\n", "         ", 
       RowBox[{
       "Print", "[", 
        "\"\<Usage: AdjustedWorthVectors[game,k] and kCover[game,k]\>\"", 
        "]"}], ";", "\n", "         ", 
       RowBox[{
       "Print", "[", 
        "\"\<The varibale 'k' has not the correct input format.\>\"", "]"}], 
       ";", "\n", "         ", 
       RowBox[{
       "Print", "[", 
        "\"\<The variable 'k' must be a natural number and not a list.\>\"", 
        "]"}]}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SubCall1", "[", 
      RowBox[{"permele_", ",", " ", "player_", ",", " ", "k_Integer"}], "]"}],
      " ", ":=", " ", 
     RowBox[{
      RowBox[{"permele", "[", 
       RowBox[{"[", "player", "]"}], "]"}], " ", "<", " ", "k"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SubCall2", "[", 
      RowBox[{"permele_", ",", " ", "player_", ",", " ", "k_Integer"}], "]"}],
      " ", ":=", " ", 
     RowBox[{
      RowBox[{"permele", "[", 
       RowBox[{"[", "player", "]"}], "]"}], " ", ">", " ", "k"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PDeltaI", "[", 
      RowBox[{"list_", ",", " ", "player_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"thresh", ",", " ", "newlist", ",", " ", 
         RowBox[{"genlist", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "retval"}], "}"}], ",", "\n", 
       "    ", 
       RowBox[{
        RowBox[{"thresh", " ", "=", " ", 
         RowBox[{"list", "[", 
          RowBox[{"[", "player", "]"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"newlist", " ", "=", " ", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"list", ",", " ", 
           RowBox[{"list", "[", 
            RowBox[{"[", "player", "]"}], "]"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"retval", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", " ", "<", " ", "thresh"}], ",", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"genlist", ",", " ", "#"}], "]"}], ",", " ", 
             RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
          "newlist"}]}], ";", "\n", "    ", 
        RowBox[{"pdel", "=", 
         RowBox[{"List", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Flatten", "[", "retval", "]"}], "]"}], "]"}]}], ";", "\n",
         "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "pdel", "]"}], "==", "2"}], ",", 
          RowBox[{"Union", "[", "pdel", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "pdel"}]}], "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PlayerIJoin", "[", 
      RowBox[{"list_", ",", " ", "player_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "pl", "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"pl", "=", 
         RowBox[{"List", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"PDeltaI", "[", 
               RowBox[{"list", ",", " ", "player"}], "]"}], ",", " ", 
              "player"}], "]"}], "]"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "pl", "]"}], "==", "2"}], ",", 
          RowBox[{"Union", "[", "upl", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "pl"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DeltaJSet", "[", 
      RowBox[{"list_", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"genlist", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "pos", ",", " ", "retval"}], "}"}], 
       ",", "\n", "    ", 
       RowBox[{
        RowBox[{"pos", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", " ", ">", " ", "k"}], ",", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"genlist", ",", " ", "#"}], "]"}], ",", " ", 
              RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
           "list"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"retval", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"list", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
            " ", "pos"}], "]"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "retval", "]"}], "==", "2"}], ",", 
          RowBox[{"Union", "[", "retval", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
           "retval"}]}], "]"}]}]}], "\n", "    ", "]"}]}], ";"}], 
   "\n"}]}]], "Code",ExpressionUUID->"94753b7e-a6f3-41ea-924b-cd9a21a76c33"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "section", " ", "adjusted", " ", "worth", " ", "vector", " ", "ends"}], " ",
   "*)"}]], "Code",ExpressionUUID->"77b78ca1-776d-4522-b1a0-155cbefa3307"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"section", " ", "general", " ", "k"}], "-", 
   RowBox[{"convex", " ", "functions", " ", "starts"}]}], " ", "*)"}]], "Code",\
ExpressionUUID->"5e4d8c42-d50b-424f-be4d-055a6a9d1b6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Nuc1convex", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Nuc1convex", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Nuc1convex", "[", 
     RowBox[{"game_", " ", "/;", " ", 
      RowBox[{"OneConvexQ", "[", "game", "]"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"UpperVector", "[", "game", "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], " ", "/", " ", 
      RowBox[{"Length", "[", "T", "]"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OneConvexQ", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "z0", "}"}], ",", "\n", "\t\t\t ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"kConvexity", "[", "game", "]"}], "]"}], ",", "1"}], 
          "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}], ",", "\n", "\t\t\t    ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Game is not 1-convex! No solution can be retrieved!\>\"", 
           "]"}], ";", 
          RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";"}]}], "\n", 
     "\n", "\t\t ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EANSCValue", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"EANSCValue", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EANSCValue", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"UpperVector", "[", "game", "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], " ", "/", " ", 
      RowBox[{"Length", "[", "T", "]"}]}]}]}], ";"}], " "}]}], "Code",Expressi\
onUUID->"31de8367-d1e6-4031-a60f-e20eb33d6de3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UtopiaPayoff", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UtopiaPayoff", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaPayoff", "[", "i_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
      RowBox[{"v", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"T", ",", "i"}], "]"}], "]"}]}], " ", "/;", "\n", "    ", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Gap", "[", "game", "]"}], "]"}], " ", ">", " ", "0"}], " ", "&&",
       " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", ">", " ", 
       "0"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaPayoff", "[", 
     RowBox[{"game_", ",", " ", "i_"}], "]"}], " ", ":=", "\n", "    ", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
      RowBox[{"v", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"T", ",", " ", "i"}], "]"}], "]"}]}], " ", "/;", "\n", 
     "        ", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Gap", "[", "game", "]"}], "]"}], " ", ">", " ", "0"}], " ", "&&",
       " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", ">=", " ", 
       "0"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperPayoff", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UpperPayoff", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperPayoff", "[", "i_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
     RowBox[{"v", "[", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"T", ",", "i"}], "]"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperPayoff", "[", 
     RowBox[{"game_", ",", " ", "i_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
     RowBox[{"v", "[", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"T", ",", "i"}], "]"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UtopiaSum", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UtopiaSum", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaSum", "[", 
     RowBox[{"game_", ",", " ", "S_List"}], "]"}], ":=", "  ", 
    RowBox[{"Plus", "  ", "@@", " ", 
     RowBox[{"UtopiaPayoff", " ", "/@", " ", "S"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UtopiaVector", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UtopiaVector", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UtopiaVector", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"UtopiaPayoff", "[", 
       RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", "T"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperVector", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UpperVector", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UpperVector", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"UpperPayoff", "[", 
       RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", "T"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSum", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UpperSum", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperSum", "[", 
    RowBox[{"game_", ",", " ", "S_List"}], "]"}], ":=", "  ", 
   RowBox[{"Plus", "  ", "@@", " ", 
    RowBox[{"UpperPayoff", " ", "/@", " ", "S"}]}]}], ";"}]}], "Code",Expressi\
onUUID->"b0738eca-1eb1-49ba-845f-6d97c9bb945c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Gap", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Gap", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gap", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"UpperSum", "[", 
         RowBox[{"game", ",", "#"}], "]"}], " ", "-", " ", 
        RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
     "Coalitions"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SemiConvexQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"SemiConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SemiConvexQ", "[", "game_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pup", ",", "si", ",", "lsq"}], "}"}], ",", "\n", "      ", 
    RowBox[{
     RowBox[{"pup", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"GreaterEqual", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"UpperVector", "[", "game", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"{", "#", "}"}], "]"}], "&"}], "/@", "T"}]}], "}"}]}], 
       "]"}]}], ";", "\n", "      ", 
     RowBox[{"si", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"Coalitions", ",", "1"}], "]"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", "i"}], "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"Coalitions", ",", "1"}], "]"}]}], ",", "True"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
     "      ", 
     RowBox[{"lsq", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"UpperPayoff", "[", 
             RowBox[{"game", ",", "i"}], "]"}], " ", "<=", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"UpperSum", "[", 
               RowBox[{"game", ",", "#"}], "]"}], " ", "-", " ", 
              RowBox[{"v", "[", "#", "]"}]}], ")"}]}], " ", "&"}], "/@", " ", 
          
          RowBox[{"si", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}]}], ";", "\n",
      "      ", 
     RowBox[{"Apply", "[", 
      RowBox[{"And", ",", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Apply", ",", 
         RowBox[{"{", 
          RowBox[{"pup", ",", "lsq"}], "}"}]}], "]"}]}], "]"}]}]}], "\n", 
   "]"}]}]}], "Code",ExpressionUUID->"d10f7a35-f5c7-472a-b6d6-40cfe40a304c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generalized", " ", "Gap", " ", "Function"}], " ", "*)"}], "\n", 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GenConcession", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GenConcession", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenConcession", "[", "game_", "]"}], ":=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"Min", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"GenUpperSum", "[", 
              RowBox[{"game", ",", "#"}], "]"}], " ", "-", " ", 
             RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], "  ", "/@", 
          " ", 
          RowBox[{"W", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUtopiaPayoff", "[", 
      RowBox[{"game_", ",", " ", "i_"}], "]"}], " ", ":=", "\n", "    ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
       RowBox[{"v", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"T", ",", " ", "i"}], "]"}], "]"}]}], " ", "/;", "\n", 
      "        ", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"GenGap", "[", "game", "]"}], "]"}], " ", ">", " ", "0"}], 
       " ", "&&", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"GenGap", "[", "game", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", ">=", " ", 
        "0"}]}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperPayoff", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GenUpperPayoff", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperPayoff", "[", "i_", "]"}], ":=", " ", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
          RowBox[{"v", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "i"}], "]"}], "]"}]}], ")"}], " ", "&"}], "/@", 
       " ", "Coalitions"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperPayoff", "[", 
      RowBox[{"game_", ",", " ", "i_"}], "]"}], ":=", " ", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "-", " ", 
          RowBox[{"v", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "i"}], "]"}], "]"}]}], ")"}], " ", "&"}], "/@", 
       " ", "Coalitions"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperSum", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GenUpperSum", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperSum", "[", 
      RowBox[{"game_", ",", " ", "S_List"}], "]"}], ":=", "  ", 
     RowBox[{"Plus", "  ", "@@", " ", 
      RowBox[{"GenUpperPayoff", " ", "/@", " ", "S"}]}]}], ";"}], "\n", "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"GenGap", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"GenGap", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenGap", "[", "game_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GenUpperSum", "[", 
          RowBox[{"game", ",", "#"}], "]"}], " ", "-", " ", 
         RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], " ", "/@", " ", 
      "Coalitions"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperVector", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"UpperVector", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GenUpperVector", "[", "game_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"GenUpperPayoff", "[", 
        RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
      "T"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vkS", "[", 
      RowBox[{"game_", ",", "S_List"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"UpperSum", "[", 
       RowBox[{"game", ",", "S"}], "]"}], " ", "-", " ", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kCover", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"kCover", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kCover", "[", 
      RowBox[{"game_", ",", "k_Integer"}], "]"}], ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "k", "]"}], "==", "1"}], ",", "\n", "       ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], " ", "<", " ", "k"}], ",", 
            " ", 
            RowBox[{"v", "[", "#", "]"}], ",", " ", 
            RowBox[{"vkS", "[", 
             RowBox[{"game", ",", "#"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
          " ", "Coalitions"}], "]"}], ",", "\n", "       ", 
       RowBox[{"DisplayRem", "[", "k", "]"}]}], "\n", "  ", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kConvexity", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"kConvexity", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"kConvexity", "[", "game_", "]"}], ":=", "\n", "\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kcov", ",", "clv", ",", "grQ", ",", "cvQ"}], "}"}], ",", 
       "\n", "\t  ", 
       RowBox[{
        RowBox[{"kcov", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"kCover", "[", 
            RowBox[{"ExpGame", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
          "T"}]}], ";", "\n", "\t  ", 
        RowBox[{"clv", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "\t  ", 
        RowBox[{"grQ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", " ", ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"GreaterEqual", ",", 
               RowBox[{"{", 
                RowBox[{"#", ",", "clv"}], "}"}]}], "]"}], " ", "&"}], "/@", 
            " ", "kcov"}], ")"}]}]}], ";", "\n", "\t  ", 
        RowBox[{"cvQ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ConvexQ", "[", 
            RowBox[{"DefineGame", "[", 
             RowBox[{"T", ",", "#"}], "]"}], "]"}], " ", "&"}], "/@", " ", 
          "kcov"}]}], ";", "\n", "\t  ", 
        RowBox[{"DefineGame", "[", 
         RowBox[{"T", ",", " ", "clv"}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Redefine", " ", "the", " ", "original", " ", 
          RowBox[{"game", "."}]}], "*)"}], "\n", "\t  ", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "*", 
           RowBox[{"MapThread", "[", 
            RowBox[{"And", ",", 
             RowBox[{"{", 
              RowBox[{"cvQ", ",", "grQ"}], "}"}]}], "]"}]}], " ", "/.", " ", 
          RowBox[{"True", " ", "->", " ", "1"}]}], " ", "/.", " ", 
         RowBox[{"False", " ", "->", " ", "0"}]}]}]}], "\n", "  ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffVector", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AdjustedEffVector", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffVector", "[", 
      RowBox[{"game_", ",", "i_Integer"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"UpperVector", "[", "game", "]"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Gap", "[", "game", "]"}], "]"}], " ", 
       RowBox[{"Extract", "[", 
        RowBox[{
         RowBox[{"Permutations", "[", "\n", "                      ", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"0", " ", "j"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "T", "]"}], "-", "1"}]}], "}"}]}], 
             "]"}], ",", "1"}], "]"}], "]"}], ",", "i"}], "\n", "]"}]}]}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffUpperVectors", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"AdjustedEffUpperVectors", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AdjustedEffUpperVectors", "[", "game_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"AdjustedEffVector", "[", 
        RowBox[{"game", ",", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
      "T"}]}], ";"}]}]}]], "Code",ExpressionUUID->"b70c448e-1861-4bae-836c-\
ae3d6981ad60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Concession", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"Concession", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Concession", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Min", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"UpperSum", "[", 
             RowBox[{"game", ",", "#"}], "]"}], " ", "-", " ", 
            RowBox[{"v", "[", "#", "]"}]}], ")"}], " ", "&"}], "  ", "/@", 
         " ", 
         RowBox[{"W", "[", "i", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisagreeConvex", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"DisagreeConvex", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DisagreeConvex", "[", "game_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"UpperPayoff", "[", "#", "]"}], "-", 
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"Gap", "[", "game", "]"}], ",", 
        RowBox[{"#", "+", "1"}]}], "]"}]}], " ", "&"}], " ", "/@", " ", 
    "T"}]}], ";"}]}], "Code",ExpressionUUID->"c8eccfe5-e1be-451c-8917-\
c2582140eeba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Disagreement", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"Disagreement", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Disagreement", "[", "game_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"UpperVector", "[", "game", "]"}], " ", "-", " ", 
    RowBox[{"Concession", "[", "game", "]"}]}]}], ";"}]}], "Code",ExpressionUU\
ID->"d94c6429-ef25-4b3d-8efb-60c5418d28be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TauVal", "[", "game_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"UpperVector", "[", "game", "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"Gap", "[", "game", "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], " ", 
        RowBox[{"Concession", "[", "game", "]"}]}], ")"}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"Concession", "[", "game", "]"}], "]"}]}]}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TauValue", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"TauValue", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TauValue", "[", "game_", "]"}], ":=", " ", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", 
       RowBox[{"Gap", "[", "game", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Tau", "[", "game", "]"}], ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Last", "[", 
       RowBox[{"Gap", "[", "game", "]"}], "]"}], ">", "0"}], ",", 
     RowBox[{"TauVal", "[", "game", "]"}], ",", "\n", "\t\t        ", "True", 
     ",", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Game is not quasi-balanced!\>\"", "]"}], ";", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tau", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"UpperVector", "[", "game", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Chi", "-", "Value"}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "a", " ", "generalized", " ", "Tau"}], "-", 
     RowBox[{"Value", "."}]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChiVal", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "sc", "}"}], ",", "\n", "\t\t      ", 
      RowBox[{
       RowBox[{"sc", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"GenConcession", "[", "game", "]"}], "]"}]}], ";", "\n", 
       "\t\t\t       ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"sc", ",", "0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Game is not essential!\>\"", "]"}], ";", 
          
          RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t\t  ", 
         RowBox[{
          RowBox[{"GenUpperVector", "[", "game", "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Extract", "[", 
              RowBox[{
               RowBox[{"GenGap", "[", "game", "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], " ", 
             RowBox[{"GenConcession", "[", "game", "]"}]}], ")"}], "/", 
           "sc"}]}]}], "]"}]}]}], "\n", "\t\t\t ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChiValue", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ChiValue", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChiValue", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"GenGap", "[", "game", "]"}], "]"}], "==", "0"}], ",", 
      RowBox[{"Chi", "[", "game", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"GenGap", "[", "game", "]"}], "]"}], ">", "0"}], ",", 
      RowBox[{"ChiVal", "[", "game", "]"}], ",", "\n", "\t\t        ", "True",
       ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Game is not essential!\>\"", "]"}], ";", 
       RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChiValue", "[", "game_", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "[", 
       RowBox[{"GenGap", "[", "game", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Chi", "[", "game", "]"}], ",", 
     RowBox[{"ChiVal", "[", "game", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Chi", "[", "game_", "]"}], ":=", " ", 
   RowBox[{"GenUpperVector", "[", "game", "]"}]}], ";"}]}], "Code",ExpressionU\
UID->"f34649a0-fc4f-49cf-89de-4ac5afd01aa7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GatelyValue", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"GatelyValue", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GatelyValue", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dess", ",", "d", ",", "uv", ",", "vi"}], "}"}], ",", "\n", 
      "\t\t\t  ", 
      RowBox[{
       RowBox[{"vi", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "T"}]}], ";", "\n", "\t\t\t  ", 
       RowBox[{"dess", " ", "=", " ", 
        RowBox[{
         RowBox[{"v", "[", "T", "]"}], " ", "-", " ", 
         RowBox[{"Total", "[", "vi", "]"}]}]}], ";", "\n", 
       "                          ", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Plus", "  ", "@@", " ", 
            RowBox[{"UpperPayoff", " ", "/@", " ", "T"}]}], " ", "-", 
           RowBox[{"v", "[", "T", "]"}]}], ")"}], "/", "dess"}]}], ";", "\n", 
       "\t\t\t  ", 
       RowBox[{"uv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"UpperPayoff", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "T"}]}], ";", "\n", "\t\t\t  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"EssentialQ", "[", "game", "]"}], ",", "True"}], "]"}], 
         ",", "\n", "\t\t\t     ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"d", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<Divison by Zero! No Gately Point can be retrieved!\>\"", 
             "]"}], ";", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"uv", "+", 
              RowBox[{"d", "*", "vi"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"d", "+", "1"}], ")"}]}]}], "]"}], ",", "\n", 
         "\t\t\t     ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Game is not essential, Gately Point does not exist!\>\"", 
           "]"}], ";", 
          RowBox[{"{", "}"}]}]}], "]"}]}]}], "\n", "\t\t    ", "]"}]}], ";"}],
   "\n"}], "\n"}], "Code",ExpressionUUID->"a51e6c3c-61d1-479f-b759-\
c127cfcf166d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"section", " ", "general", " ", "k"}], "-", 
   RowBox[{"convex", " ", "functions", " ", "ends"}]}], " ", "*)"}]], "Code",E\
xpressionUUID->"f135113f-5b0a-4900-834c-b7488e57f441"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Some", " ", "Proportional", " ", "Division", " ", "Rules"}], "  ",
    "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PDValue", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PDValue", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PDValue", "[", "game_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vi", ",", "trQ"}], "}"}], ",", "\n", "\t\t      ", 
       RowBox[{
        RowBox[{"vi", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
          "T"}]}], ";", "\n", "\t\t      ", 
        RowBox[{"trQ", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Greater", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ",
             "vi"}]}], "]"}]}], ";", "\n", "\t              ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"trQ", ",", "True"}], "]"}], ",", "\n", "\t\t        ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"vi", "/", 
             RowBox[{"Total", "[", "vi", "]"}]}], ")"}], "*", 
           RowBox[{"v", "[", "T", "]"}]}], ",", "\n", "\t\t          ", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Game is not individually positive! No PD-Value \
computed!\>\"", "]"}], ";", 
           RowBox[{"{", "}"}]}]}], "]"}]}]}], "\n", "\t\t    ", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EPSDValue", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"EPSDValue", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EPSDValue", "[", "game_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vi", ",", "trQ"}], "}"}], ",", "\n", "\t\t      ", 
       RowBox[{
        RowBox[{"vi", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"{", "#", "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
          "T"}]}], ";", "\n", "\t\t      ", 
        RowBox[{"trQ", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Greater", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ",
             "vi"}]}], "]"}]}], ";", "\n", "\t\t      ", 
        RowBox[{"Svi", "=", 
         RowBox[{"Total", "[", "vi", "]"}]}], ";", "\n", "\t              ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"trQ", ",", "True"}], "]"}], ",", "\n", "\t\t         ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"Length", "[", "T", "]"}]}], ")"}], "*", "Svi"}], " ", 
           "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vi", "/", "Svi"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v", "[", "T", "]"}], "-", "Svi"}], ")"}]}]}], ",", 
          "\n", "\t\t          ", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Game is not individually positive! No EPSD-Value computed!\>\
\"", "]"}], ";", 
           RowBox[{"{", "}"}]}]}], "]"}]}]}], "\n", "\t\t    ", "]"}]}], 
    ";"}], "\n"}]}]], "Code",ExpressionUUID->"5b11ed02-93fe-434b-9601-\
e3de56072381"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"section", " ", "miscellaneous", " ", "functions", " ", "starts"}],
    " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DuttaRay", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"DuttaRay", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DuttaRay", "[", 
      RowBox[{"game_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "DuttaRay", "]"}]}]}], "]"}], " ", ":=",
      " ", "\n", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ConvexQ", "[", "game", "]"}], ",", " ", 
       RowBox[{"DuttaRayMain", "[", 
        RowBox[{"game", ",", "opts"}], "]"}], ",", " ", "\n", "  ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Warning: Game is not convex!\>\"", "]"}], 
        ";", " ", 
        RowBox[{"{", "}"}]}]}], "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->\
"06574d9a-f0e2-486f-ae88-94dd9b4ce787"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DuttaRayMain", "[", 
    RowBox[{"game_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "DuttaRay", "]"}]}]}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dp", ",", "rap", ",", "vrs", ",", " ", "vN", ",", " ", "objf", ",", 
       " ", "cr", ",", " ", "prob", ",", " ", "sol"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"dp", "=", 
       RowBox[{"OptionValue", "[", "DigitPrecision", "]"}]}], ";", "\n", "  ", 
      RowBox[{"rap", "=", 
       RowBox[{"OptionValue", "[", "RationalApproximate", "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"mthd", "=", 
       RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", 
      "\t\t\t\t\t\t\t      ", "\n", "  ", 
      RowBox[{"vrs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
      ";", "\n", "  ", 
      RowBox[{"vN", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "T", "]"}], "/", 
          RowBox[{"Length", "[", "T", "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"objf", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"Subtract", ",", " ", 
           RowBox[{"{", 
            RowBox[{"vrs", ",", " ", "vN"}], "}"}]}], "]"}], "^", "2"}], 
        "]"}]}], ";", "\n", "  ", 
      RowBox[{"cr", " ", "=", " ", 
       RowBox[{"Core", "[", "game", "]"}]}], ";", "\n", "  ", 
      RowBox[{"prob", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"{", "cr", "}"}], ",", " ", "objf"}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<GUROBI\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "GUROBI"}]}], "]"}], ",", "\n", 
         "        ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Gurobi\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "GUROBI"}]}], "]"}], ",", "\n", 
         "        ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<MOSEK\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "MOSEK"}]}], "]"}], ",", "\n", 
         "        ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Mosek\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "MOSEK"}]}], "]"}], ",", "\n", 
         "        ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<IPOPT\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "IPOPT"}]}], "]"}], ",", "\n", 
         "        ", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Ipopt\>\""}], 
          "]"}], ",", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", " ", 
           RowBox[{"Method", " ", "->", " ", "IPOPT"}]}], "]"}], ",", "\n", 
         "        ", "True", ",", " ", 
         RowBox[{"NMinimize", "[", 
          RowBox[{"prob", ",", " ", "vrs", ",", 
           RowBox[{"WorkingPrecision", " ", "->", " ", "dp"}], ",", 
           RowBox[{"Method", " ", "->", " ", "mthd"}]}], "]"}]}], "\n", 
        "       ", "]"}]}], ";", "\n", "  ", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"rap", ",", "True"}], "]"}], ",", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"sol", ",", " ", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}]}], "]"}], ",", "sol"}], "]"}]}], ";",
       "\n", "  ", 
      RowBox[{
       RowBox[{"vrs", " ", "/.", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"sol", ",", " ", 
          RowBox[{"{", "__Rule", "}"}], ",", " ", "\[Infinity]"}], "]"}]}], 
       " ", "//", " ", "Flatten"}]}]}], "\n", "  ", "]"}]}], ";"}]], "Code",Ex\
pressionUUID->"0f91cb27-2fa8-4072-8362-761ce14435d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LorenzSolution", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"LorenzSolution", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LorenzSolution", "[", 
     RowBox[{"game_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "LorenzSolution", "]"}]}]}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dp", ",", "rap", ",", "vrs", ",", " ", "vN", ",", " ", "objf", ",", 
        " ", "cr", ",", " ", "prob", ",", " ", "sol"}], "}"}], ",", "\n", 
      "  ", 
      RowBox[{
       RowBox[{"dp", "=", 
        RowBox[{"OptionValue", "[", "DigitPrecision", "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"rap", "=", 
        RowBox[{"OptionValue", "[", "RationalApproximate", "]"}]}], ";", "\n",
        "  ", 
       RowBox[{"mthd", "=", 
        RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", "\n", "  ", 
       RowBox[{"vrs", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "  ", 
       RowBox[{"vN", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "T", "]"}], "/", 
           RowBox[{"Length", "[", "T", "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"objf", " ", "=", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Subtract", ",", " ", 
            RowBox[{"{", 
             RowBox[{"vrs", ",", " ", "vN"}], "}"}]}], "]"}], "^", "2"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"cr", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CoreQ", "[", "game", "]"}], ",", 
          RowBox[{"Core", "[", "game", "]"}], ",", 
          RowBox[{
           RowBox[{"{", "}"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"prob", " ", "=", " ", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"{", "cr", "}"}], ",", " ", "objf"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<GUROBI\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "GUROBI"}]}], "]"}], ",", "\n", 
          "        ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Gurobi\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "GUROBI"}]}], "]"}], ",", "\n", 
          "        ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<MOSEK\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "MOSEK"}]}], "]"}], ",", "\n", 
          "        ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Mosek\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "MOSEK"}]}], "]"}], ",", "\n", 
          "        ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<IPOPT\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "IPOPT"}]}], "]"}], ",", "\n", 
          "        ", 
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "mthd", "]"}], ",", "\"\<Ipopt\>\""}], 
           "]"}], ",", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", " ", 
            RowBox[{"Method", " ", "->", " ", "IPOPT"}]}], "]"}], ",", "\n", 
          "        ", "True", ",", " ", 
          RowBox[{"NMinimize", "[", 
           RowBox[{"prob", ",", " ", "vrs", ",", 
            RowBox[{"WorkingPrecision", " ", "->", " ", "dp"}], ",", 
            RowBox[{"Method", " ", "->", " ", "mthd"}]}], "]"}]}], "\n", 
         "       ", "]"}]}], ";", " ", "\n", "  ", 
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"rap", ",", "True"}], "]"}], ",", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"sol", ",", " ", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], "]"}], ",", "sol"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{
        RowBox[{"vrs", " ", "/.", " ", 
         RowBox[{"Cases", "[", 
          RowBox[{"sol", ",", " ", 
           RowBox[{"{", "__Rule", "}"}], ",", " ", "\[Infinity]"}], "]"}]}], 
        " ", "//", " ", "Flatten"}]}]}], "\n", "  ", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MargValue", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MargValue", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MargValue", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"perm", ",", "list"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"list", " ", "=", " ", "T"}], ";", "\n", "  ", 
       RowBox[{"perm", " ", "=", " ", 
        RowBox[{"Permutations", "[", "list", "]"}]}], ";", "\n", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"Subtract", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"v", ",", 
               RowBox[{"pred", "[", "#", "]"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"v", ",", 
               RowBox[{"mengen", "[", "#", "]"}]}], "]"}]}], "}"}]}], "]"}], 
         " ", "&"}], " ", "/@", " ", "perm"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pred", "[", "list_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"post", ",", "vorg", ",", "ober"}], "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"post", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"list", ",", "#"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "T"}], "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"vorg", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"list", ",", 
            RowBox[{
             RowBox[{"post", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "-", "1"}]}], "]"}], " ", "&"}],
          " ", "/@", " ", "T"}]}], ";", "\n", "\t        ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"FlattenAt", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"List", ",", 
                RowBox[{"{", 
                 RowBox[{"vorg", ",", "T"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "1"}], "}"}]}], "]"}], ",", "#"}], "]"}], 
          "]"}], " ", "&"}], " ", "/@", " ", "T"}]}]}], "\n", "\t\t", "]"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mengen", "[", "list_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "post", "}"}], ",", "\n", "                ", 
      RowBox[{
       RowBox[{"post", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"list", ",", "#"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "T"}], "]"}]}], ";", "\n", "                ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"list", ",", 
            RowBox[{
             RowBox[{"post", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "-", "1"}]}], "]"}], "]"}], " ",
          "&"}], " ", "/@", " ", "T"}]}]}], "\n", "\t", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoreElementsQ", "[", "args___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"CoreElementsQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CoreElementsQ", "[", 
    RowBox[{"game_", ",", "payoffs_List"}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "  ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "payoffs", "]"}], " ", "==", " ", "3"}], ",", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{"InCoreQ", "[", 
          RowBox[{"#", ",", "game"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "payoffs"}], ",", "\n", "        ", 
       RowBox[{
        RowBox[{"Depth", "[", "payoffs", "]"}], " ", "==", " ", "2"}], ",", 
       " ", 
       RowBox[{"InCoreQ", "[", 
        RowBox[{"payoffs", ",", "game"}], "]"}], ",", "\n", "        ", 
       "True", ",", " ", 
       RowBox[{"DisplayUsageRem", "[", "payoffs", "]"}]}], "\n", "    ", 
      "]"}]}], "\n", "   ", "]"}]}], ";"}]}], "Code",ExpressionUUID->\
"0968ae30-2cba-48a4-be54-a4c5517a7c28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "Balanced", " ", "Inequality", " ", "of", " ", "a", " ", 
     "Game", " ", "must", " ", "be", " ", "satisfied", " ", "for", " ", "all",
      " ", "balanced", " ", "systems", " ", "to", "\n", "   ", "indicate", 
     " ", "that", " ", "the", " ", "core", " ", "is", " ", "non"}], "-", 
    RowBox[{
     RowBox[{"empty", ".", "\n", "   ", "\n", "   ", "This"}], " ", 
     "function", " ", "checks", " ", "only", " ", "if", " ", "a", " ", 
     "balanced", " ", "system", " ", "satisfies", " ", "the", " ", "\n", 
     "   ", "Balanced", " ", "Inequality", " ", "of", " ", "a", " ", 
     RowBox[{"Game", "."}]}]}], "\n", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BalancedInequalityQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"BalancedInequalityQ", "::", "argerr"}], "]"}], ";", 
       "$Failed"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BalancedInequalityQ", "[", 
      RowBox[{"game_", ",", " ", "coll_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bcQ", ",", " ", "vS", ",", " ", "cf", ",", " ", "inQ"}], 
        "}"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bcQ", ",", " ", "cf"}], "}"}], " ", "=", " ", 
         RowBox[{"BalancedSystemQ", "[", 
          RowBox[{"coll", ",", " ", "T"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"vS", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
          "coll"}]}], ";", "\n", "   ", 
        RowBox[{"inQ", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"bcQ", ",", " ", "True"}], "]"}], ",", " ", 
           RowBox[{"LessEqual", "[", 
            RowBox[{
             RowBox[{"vS", ".", "cf"}], ",", " ", 
             RowBox[{"v", "[", "T", "]"}]}], "]"}], ",", " ", "\n", 
           "             ", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<Collection of Sets is not balanced!!\>\"", 
             "]"}], ";", " ", "False"}]}], "]"}]}], ";", " ", "\n", "   ", 
        RowBox[{"Return", "[", "inQ", "]"}], ";"}]}], "\n", "   ", "]"}]}], 
    ";"}]}]}]], "Code",ExpressionUUID->"d9a989e5-3de3-478e-a7cc-08d6c274acf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{
    "An", " ", "imputation", " ", "x", " ", "is", " ", "in", " ", "the", " ", 
     "core", " ", "iff", " ", "x"}], " ", "=", 
    RowBox[{"<", " ", 
     RowBox[{"dual", " ", 
      RowBox[{"v", "."}]}]}]}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BelongToCoreQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"BelongToCoreQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BelongToCoreQ", "[", 
      RowBox[{"game_", ",", " ", "payoffs_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "    ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "payoffs", "]"}], " ", "==", " ", "3"}], ",", 
         " ", 
         RowBox[{"PayList", "[", 
          RowBox[{"game", ",", " ", "payoffs"}], "]"}], ",", "  ", "\n", 
         "          ", 
         RowBox[{
          RowBox[{"Depth", "[", "payoffs", "]"}], " ", "==", " ", "2"}], ",", 
         " ", 
         RowBox[{"PaySole", "[", 
          RowBox[{"game", ",", " ", "payoffs"}], "]"}], ",", "\n", 
         "          ", "True", ",", 
         RowBox[{"DisplayUsageRem", "[", "payoffs", "]"}]}], "\n", "       ", 
        "]"}]}], "\n", "     ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DisplayUsageRem", "[", "payoffs_List", "]"}], " ", ":=", " ", 
     RowBox[{"(", "      ", "\n", "       ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Depth is equal to \>\"", ",", 
         RowBox[{"Depth", "[", "payoffs", "]"}]}], "]"}], ";", "\n", 
       "       ", 
       RowBox[{
       "Print", "[", 
        "\"\<Usage: BelongToCoreQ[game,payoffs] and \
CoreElementsQ[game,payoffs]\>\"", "]"}], ";", "\n", "       ", 
       RowBox[{
       "Print", "[", 
        "\"\<Input format of the variable 'payoffs' is not correct.\>\"", 
        "]"}], ";", "\n", "       ", 
       RowBox[{
       "Print", "[", 
        "\"\<The variable 'payoffs' must be a list of payoff vectors or a \
single payoff vector.\>\"", "]"}]}], ")"}]}], ";"}]}]}]], "Code",ExpressionUUI\
D->"e4911f38-a965-4139-af11-eeb96101e110"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PayList", "[", 
     RowBox[{"game_", ",", " ", "list_"}], "]"}], " ", ":=", " ", "\n", "  ", 
    
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "totsumS", ",", " ", "imp", ",", " ", "assalloc", ",", " ", "ducoal", 
        ",", " ", "ins", ",", " ", "trueli", ",", " ", "wahrQ"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"totsumS", " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", " ", "\n", "    ", 
       RowBox[{"imp", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"assalloc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", " ", 
            RowBox[{"{", 
             RowBox[{"imp", ",", " ", "#"}], "}"}]}], "]"}], " ", "&"}], " ", 
         "/@", "  ", "list"}]}], ";", "\n", "    ", 
       RowBox[{"ins", " ", "=", " ", 
        RowBox[{
         RowBox[{"totsumS", " ", "/.", " ", "assalloc"}], " ", "//", " ", 
         "Rationalize"}]}], ";", "\n", "    ", 
       RowBox[{"ducoal", " ", "=", " ", 
        RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "    ", 
       RowBox[{"trueli", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"LessEqual", ",", " ", 
            RowBox[{"{", 
             RowBox[{"#", ",", " ", "ducoal"}], "}"}]}], "]"}], " ", "&"}], 
         " ", "/@", " ", "ins"}]}], ";", "\n", "    ", 
       RowBox[{"wahrQ", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"And", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ", 
         "trueli"}]}], ";", "\n", "    ", "wahrQ"}]}], "\n", "    ", "]"}]}], 
   ";"}], "\n"}]], "Code",ExpressionUUID->"2d34101d-9a3b-4c2e-a99d-\
fd99067a2aec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PaySole", "[", 
     RowBox[{"game_", ",", " ", "payoff_"}], "]"}], " ", ":=", " ", "\n", 
    "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "totsumS", ",", " ", "imp", ",", " ", "assalloc", ",", " ", "ducoal", 
        ",", " ", "ins", ",", " ", "trueli", ",", " ", "wahrQ"}], "}"}], ",", 
      "\n", "    ", 
      RowBox[{
       RowBox[{"totsumS", " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "Coalitions"}]}], ";", " ", "\n", "    ", 
       RowBox[{"imp", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", "T"}]}], 
       ";", "\n", "    ", 
       RowBox[{"assalloc", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{"imp", ",", " ", "payoff"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"ins", " ", "=", " ", 
        RowBox[{
         RowBox[{"totsumS", " ", "/.", " ", "assalloc"}], " ", "//", " ", 
         "Rationalize"}]}], ";", "\n", "    ", 
       RowBox[{"ducoal", " ", "=", " ", 
        RowBox[{"DualGame", "[", "game", "]"}]}], ";", "\n", "    ", 
       RowBox[{"trueli", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"LessEqual", ",", " ", 
          RowBox[{"{", 
           RowBox[{"ins", ",", " ", "ducoal"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"wahrQ", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", " ", "trueli"}], "]"}]}], " ", ";", "\n", "    ",
        "wahrQ"}]}], "\n", "    ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exzess", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", "#", "]"}], "-", 
        RowBox[{"x", "[", "#", "]"}]}], ")"}], "&"}], " ", "/@", " ", 
     "Coalitions"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GameBasis", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"GameBasis", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GameBasis", "[", "T_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mgsys", ",", "gb"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"mgsys", " ", "=", " ", 
        RowBox[{"Developer`ToPackedArray", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "T", "]"}], ",", " ", "1"}], "]"}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"gb", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"SubSetQ", "[", 
               RowBox[{
                RowBox[{"mgsys", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "]"}], ",", 
              " ", "1", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ", 
           "mgsys"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "mgsys", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "    ", 
       RowBox[{"Transpose", "[", "gb", "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CharacteristicValues", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CharacteristicValues", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CharacteristicValues", "[", 
    RowBox[{"coord_List", ",", "T_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "      ", 
     RowBox[{"Which", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "coord", "]"}], " ", "===", " ", 
        RowBox[{"2", "^", 
         RowBox[{"Length", "[", "T", "]"}]}]}], " ", ",", " ", 
       RowBox[{"DetWorth", "[", 
        RowBox[{"coord", ",", "T"}], "]"}], " ", ",", "\n", 
       "                    ", "True", ",", " ", 
       RowBox[{"WrongCoordDimension", "[", 
        RowBox[{"coord", ",", " ", "T"}], "]"}]}], "]"}]}], "\n", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"713613e4-5baa-4f40-af67-d4153499aea8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetWorth", "[", 
     RowBox[{"coord_List", ",", " ", "T_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tugb", ",", " ", "cval"}], "}"}], ",", "\n", 
      "                 ", 
      RowBox[{
       RowBox[{"tugb", " ", "=", " ", 
        RowBox[{"GameBasis", "[", "T", "]"}]}], " ", ";", "\n", 
       "                 ", 
       RowBox[{"cval", " ", "=", " ", 
        RowBox[{"tugb", ".", 
         RowBox[{"Drop", "[", 
          RowBox[{"coord", ",", "1"}], "]"}]}]}], ";", "\n", 
       "                 ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"cval", ",", "0"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordS", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CoordS", "::", "argerr"}], "]"}], ";", "$Failed"}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordS", "[", 
     RowBox[{"game_", ",", "S_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "liste", ",", "upper", ",", "iterat", ",", "mult", ",", "koeffient", 
        ",", "value"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"liste", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Length", "[", "#", "]"}], ")"}], "&"}], " ", "/@", " ", 
         RowBox[{"Subsets", "[", "S", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"upper", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Length", "[", "S", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "liste", "]"}], "}"}]}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"iterat", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Subtract", ",", 
          RowBox[{"{", 
           RowBox[{"upper", ",", "liste"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"mult", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "liste", "]"}], "}"}]}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"koeffient", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Power", ",", 
          RowBox[{"{", 
           RowBox[{"mult", ",", "iterat"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"value", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"v", "[", "#", "]"}], ")"}], "&"}], " ", "/@", " ", 
         RowBox[{"Subsets", "[", "S", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"Total", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"{", 
           RowBox[{"koeffient", ",", "value"}], "}"}]}], "]"}], "]"}]}]}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UnanimityCoordinates", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UnanimityCoordinates", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnanimityCoordinates", "[", "game_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CoordS", "[", 
        RowBox[{"game", ",", "#"}], "]"}], ")"}], "&"}], " ", "/@", " ", 
     "Coalitions"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HarsanyiDividends", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"HarsanyiDividends", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HarsanyiDividends", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gb", ",", "valvec", ",", "unc"}], "}"}], ",", "\n", 
      "                  ", 
      RowBox[{
       RowBox[{"gb", " ", "=", " ", 
        RowBox[{"GameBasis", "[", "T", "]"}]}], ";", "\n", 
       "                  ", 
       RowBox[{"valvec", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "#", "]"}], " ", "&"}], "/@", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", 
       "                  ", 
       RowBox[{"unc", " ", "=", " ", 
        RowBox[{
         RowBox[{"Inverse", "[", "gb", "]"}], ".", 
         RowBox[{"Drop", "[", 
          RowBox[{"valvec", ",", "1"}], "]"}]}]}], ";", "\n", 
       "                  ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"unc", ",", "0"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UnanConvexQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"UnanConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UnanConvexQ", "[", 
    RowBox[{"coord_List", ",", "T_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "UnanConvexQ", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "z0", "}"}], ",", "\n", "                 ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "coord", "]"}], " ", "!=", " ", 
        RowBox[{"2", "^", 
         RowBox[{"Length", "[", "T", "]"}]}]}], " ", ",", " ", 
       RowBox[{
        RowBox[{"WrongCoordDimension", "[", 
         RowBox[{"coord", ",", " ", "T"}], "]"}], ";"}], ",", "\n", 
       "                               ", 
       RowBox[{
        RowBox[{"UnanSize2NonNegQ", "[", 
         RowBox[{"coord", ",", "T"}], "]"}], " ", "===", " ", "True"}], ",", 
       " ", 
       RowBox[{"UnanConvexIffCondQ", "[", 
        RowBox[{"coord", ",", "T", ",", "opts"}], "]"}], ",", "\n", 
       "                                ", "True", ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Game is not convex!\>\"", "]"}], ";", " ", 
        "\n", "                                      ", 
        RowBox[{
        "Print", "[", 
         "\"\<Negative input values of size 1 or 2 are detected!\>\"", "]"}], 
        ";", "\n", "                                      ", 
        RowBox[{"Return", "[", "\"\<False\>\"", "]"}], ";"}]}], 
      "               ", "\n", "  ", "]"}]}], "\n", "]"}]}], 
  ";"}], "\n"}], "Code",ExpressionUUID->"a934f7a9-ba43-4d68-b14e-\
1e99dcdf1ad5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnanConvexIffCondQ", "[", 
    RowBox[{"coord_List", ",", " ", "T_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "UnanConvexQ", "]"}]}]}], "]"}], " ", ":=",
    " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", " ", "discrd", ",", " ", "npr", ",", "plpairs", ",", 
       " ", "ineq", ",", " ", "lam", ",", " ", "rlcrd", ",", " ", "nneg", ",",
        "pwsets", ",", "rtnneg", ",", "trq", ",", " ", "trfl"}], "}"}], ",", 
     "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"discrd", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayCoord", "]"}]}], ";", "\n", "    ", 
      RowBox[{"npr", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "NumericalPrec", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"pwsets", " ", "=", " ", 
       RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"plpairs", " ", "=", " ", 
       RowBox[{"PlayerPairs", "[", "T", "]"}]}], ";", "\n", "    ", 
      RowBox[{"ineq", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"DetInEq", "[", 
          RowBox[{"#", ",", " ", "T"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "plpairs"}]}], ";", "\n", "    ", 
      RowBox[{"lam", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "pwsets"}]}], ";", "\n", "    ", 
      RowBox[{"rlcrd", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"lam", ",", " ", "coord"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"nneg", " ", "=", " ", 
       RowBox[{"ineq", " ", "/.", " ", "rlcrd"}]}], ";", "\n", "    ", 
      RowBox[{"rtnneg", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"npr", " ", "!=", "  ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "12"}], ")"}]}]}], ",", " ", 
         RowBox[{"Chop", "[", 
          RowBox[{"nneg", ",", "npr"}], "]"}], ",", " ", 
         RowBox[{"Chop", "[", 
          RowBox[{"nneg", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"trq", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"NonNegative", "[", "rtnneg", "]"}], "]"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"trfl", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "trq"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dispres", " ", "===", " ", "True"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"trfl", ",", " ", "rtnneg"}], "}"}], ",", "\n", 
        "                  ", 
        RowBox[{"discrd", " ", "===", " ", "True"}], ",", "  ", "rtnneg", ",",
         "\n", "                  ", "True", ",", " ", "trfl"}], "\n", "   ", 
       "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->"e7307193-\
97b4-4258-97e6-d110853b0339"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetInEq", "[", 
     RowBox[{"spij_List", ",", " ", "T_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "pwset", "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"pwset", " ", "=", " ", 
        RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"InEqCond", "[", 
            RowBox[{"spij", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", 
          " ", "pwset"}], ",", " ", "0"}], "]"}]}]}], "\n", " ", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"InEqCond", "[", 
    RowBox[{"splij_List", ",", " ", "submg_List"}], "]"}], " ", ":=", " ", 
   "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mgsys", ",", " ", "incij", ",", " ", "trps", ",", " ", "extset", ",", 
       " ", "uncoord"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"mgsys", " ", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", "submg", "]"}], ",", " ", 
           RowBox[{"{", "_", "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"incij", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SubSetQ", "[", 
          RowBox[{"splij", ",", " ", "#"}], "]"}], " ", "&"}], " ", "/@", " ",
         "mgsys"}]}], ";", "\n", "    ", 
      RowBox[{"trps", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"incij", ",", " ", "True"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"extset", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"mgsys", ",", " ", "trps"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"uncoord", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        "extset"}]}], ";", "\n", "    ", 
      RowBox[{"Total", "[", "uncoord", "]"}]}]}], "\n", " ", "]"}]}], 
  ";"}]}], "Code",ExpressionUUID->"dd1be964-4951-4a2f-8b76-e05639b84034"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"See", " ", "Solano", " ", "and", " ", "Rafels"}], ",", " ", 
    "1996"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"UnanAvConvexQ", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"UnanAvConvexQ", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"UnanAvConvexQ", "[", 
      RowBox[{"coord_List", ",", "T_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "UnanAvConvexQ", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "                 ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "coord", "]"}], " ", "!=", " ", 
          RowBox[{"2", "^", 
           RowBox[{"Length", "[", "T", "]"}]}]}], " ", ",", " ", 
         RowBox[{
          RowBox[{"WrongCoordDimension", "[", 
           RowBox[{"coord", ",", " ", "T"}], "]"}], ";"}], ",", "\n", 
         "                              ", "True", ",", " ", 
         RowBox[{"UnanAvConvexIffCondQ", "[", 
          RowBox[{"coord", ",", "T", ",", "opts"}], "]"}]}], "\n", "  ", 
        "]"}]}], "\n", "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"e1b3e213-\
a22d-435d-a0e8-d81d41210d44"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnanSize2NonNegQ", "[", 
    RowBox[{"coord_List", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"no", ",", "tkno"}], "}"}], ",", "\n", "               ", 
     RowBox[{
      RowBox[{"no", " ", "=", " ", 
       RowBox[{
        RowBox[{"Length", "[", "T", "]"}], " ", "+", " ", "1", " ", "+", " ", 
        
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}]}]}], ";", 
      "                ", "\n", "               ", 
      RowBox[{"tkno", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"coord", ",", "no"}], "]"}]}], ";", "\n", "               ", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"NonNegative", "[", "tkno", "]"}], "]"}], " ", "===", " ", 
       RowBox[{"{", "True", "}"}]}]}]}], "\n", "]"}]}], ";"}]], "Code",Express\
ionUUID->"5dd8b4f5-b88f-42fd-bb0b-f9ccad089d3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnanAvConvexIffCondQ", "[", 
    RowBox[{"coord_List", ",", " ", "T_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "UnanAvConvexQ", "]"}]}]}], "]"}], " ", ":=",
    " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dispres", ",", " ", "discrd", ",", " ", "npr", ",", " ", "pwsets", ",",
        " ", "setsgr2", ",", " ", "nneg", ",", "rtnneg", ",", " ", "trq", ",",
        "trfl"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"dispres", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayAllResults", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"discrd", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DisplayCoord", "]"}]}], ";", "\n", "    ", 
      RowBox[{"npr", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "NumericalPrec", "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"pwsets", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Subsets", "[", "T", "]"}], ",", "1"}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"nneg", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"UnanInEquality", "[", 
          RowBox[{"#", ",", " ", "coord"}], "]"}], " ", "&"}], " ", "/@", " ",
         "pwsets"}]}], ";", "\n", "    ", 
      RowBox[{"rtnneg", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"npr", " ", "!=", "  ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "12"}], ")"}]}]}], ",", " ", 
         RowBox[{"Chop", "[", 
          RowBox[{"nneg", ",", "npr"}], "]"}], ",", " ", 
         RowBox[{"Chop", "[", 
          RowBox[{"nneg", ",", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}], "]"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"trq", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"NonNegative", "[", "rtnneg", "]"}], "]"}], "]"}]}], ";", 
      "\n", "    ", 
      RowBox[{"trfl", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", "trq"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"dispres", ",", "True"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"trfl", ",", " ", "rtnneg"}], "}"}], ",", "\n", "          ", 
        RowBox[{"SameQ", "[", 
         RowBox[{"discrd", ",", "True"}], "]"}], ",", " ", "rtnneg", ",", 
        "\n", "                  ", "True", ",", " ", "trfl"}], "\n", "    ", 
       "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",ExpressionUUID->"72e6b4f5-\
e23b-4569-b66a-be06ab1b2111"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnanInEquality", "[", 
     RowBox[{"coal_List", ",", " ", "coord_List"}], "]"}], " ", ":=", " ", 
    "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Sc", ",", "obmg", ",", "sysob", ",", "sysin", ",", "pos", ",", "pos2",
         ",", "extc", ",", "intc", ",", "lgtc", ",", "inlam", ",", "mltun", 
        ",", "addcrd", ",", "lam", ",", "rlcrd"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"Sc", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"T", ",", "coal"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"obmg", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"OberMenge", "[", 
           RowBox[{"coal", ",", "T"}], "]"}], ",", "1"}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"sysob", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Subsets", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "obmg"}]}], ";", "\n", "    ", 
       RowBox[{"sysin", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"#", ",", "Sc"}], "]"}], " ", "&"}], ",", "#"}], "]"}], 
          " ", "&"}], " ", "/@", " ", "sysob"}]}], ";", "\n", "    ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "__", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
         "sysin"}]}], ";", "\n", "    ", 
       RowBox[{"pos2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
         "pos"}]}], ";", "\n", "    ", 
       RowBox[{"extc", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"sysob", ",", "pos2"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"intc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"#1", ",", " ", "coal"}], "]"}], " ", "&"}], ",", " ", 
            "#"}], "]"}], " ", "&"}], " ", "/@", " ", "extc"}]}], ";", "\n", 
       "    ", 
       RowBox[{"lgtc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], " ", "&"}], ",", " ", "#"}], 
           "]"}], " ", "&"}], " ", "/@", " ", "intc"}]}], ";", "\n", "    ", 
       RowBox[{"inlam", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Global`\[Lambda]", "[", "#", "]"}], " ", "&"}], ",", 
            "#"}], "]"}], " ", "&"}], " ", "/@", " ", "extc"}]}], ";", "\n", 
       "    ", 
       RowBox[{"mltun", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Times", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lgtc", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"inlam", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "inlam", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "    ", 
       RowBox[{"addcrd", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "mltun"}]}], ";", "\n", "    ", 
       RowBox[{"lam", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Global`\[Lambda]", "[", "#", "]"}], " ", "&"}], " ", "/@", 
         " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "    ", 
       RowBox[{"rlcrd", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", " ", 
          RowBox[{"{", 
           RowBox[{"lam", ",", " ", "coord"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "  ", "/.", " ", "rlcrd"}], ")"}], " ", "&"}], " ", "/@",
         " ", "addcrd"}]}]}], "\n", "]"}]}], ";"}], "\n"}]], "Code",Expression\
UUID->"8dfcedbe-61bb-40a7-a076-872b2d90e5d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"See", " ", "Meinhardt"}], ",", " ", "2009"}], " ", "*)"}], "\n", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DetQuasiAvConvex", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"DetQuasiAvConvex", "::", "argerr"}], "]"}], ";", "$Failed"}],
       ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetQuasiAvConvex", "[", "game_", "]"}], ":=", " ", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uncrd", ",", " ", "lnsi2", ",", " ", "lnT", ",", " ", "anfpt", ",", 
         " ", "endpt", ",", " ", "tkcd", ",", " ", "avccrd"}], "}"}], ",", 
       "\n", "  ", 
       RowBox[{
        RowBox[{"uncrd", " ", "=", " ", 
         RowBox[{"HarsanyiDividends", "[", "game", "]"}]}], ";", "\n", "  ", 
        RowBox[{"lnsi2", " ", "=", " ", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"Length", "[", "T", "]"}], ",", " ", "2"}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"lnT", " ", "=", " ", 
         RowBox[{"Length", "[", "T", "]"}]}], ";", "\n", "  ", 
        RowBox[{"anfpt", " ", "=", " ", 
         RowBox[{"lnT", " ", "+", " ", "2"}]}], ";", "\n", "  ", 
        RowBox[{"endpt", " ", "=", " ", 
         RowBox[{"anfpt", " ", "+", " ", "lnsi2", " ", "-", " ", "1"}]}], ";",
         "\n", "  ", 
        RowBox[{"tkcd", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"uncrd", ",", " ", 
           RowBox[{"{", 
            RowBox[{"anfpt", ",", " ", "endpt"}], "}"}]}], "]"}]}], ";", "\n",
         "  ", 
        RowBox[{"avccrd", " ", "=", " ", 
         RowBox[{"DetUCoord", "[", 
          RowBox[{"tkcd", ",", " ", "T"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"CharacteristicValues", "[", 
         RowBox[{"avccrd", ",", " ", "T"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetUCoord", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"DetUCoord", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DetUCoord", "[", 
      RowBox[{"coord_List", ",", "T_"}], "]"}], ":=", "\n", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "z0", "}"}], ",", "\n", "     ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Binomial", "[", 
            RowBox[{
             RowBox[{"Length", "[", "T", "]"}], ",", "2"}], "]"}], "}"}], " ",
           "!=", " ", 
          RowBox[{"Dimensions", "[", "coord", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"WrongCoordDimension", "[", "T", "]"}], ";"}], ",", "\n", 
         "                    ", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"NonNegative", "[", "coord", "]"}], "]"}], " ", "===", " ", 
          RowBox[{"{", "True", "}"}]}], ",", "  ", 
         RowBox[{"AvCcoord", "[", 
          RowBox[{"coord", ",", "T"}], "]"}], " ", ",", " ", "\n", 
         "                    ", "True", ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Input error! \\n Negative values are not allowed!\>\"", "]"}],
           ";"}]}], "\n", "       ", "]"}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AvCcoord", "[", 
      RowBox[{"coord_List", ",", " ", "T_"}], "]"}], " ", ":=", " ", "\n", 
     "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uncrd", ",", " ", "pwsts", ",", " ", "setsgr2", ",", " ", "mincrd", 
         ",", " ", "zvec", ",", " ", "apz"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"uncrd", " ", "=", " ", "coord"}], ";", "\n", "    ", 
        RowBox[{"pwsts", " ", "=", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}], ";", "\n", "    ", 
        RowBox[{"setsgr2", " ", "=", " ", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], " ", ">=", " ", "3"}], ",",
                " ", "#", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
            "pwsts"}], ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"mincrd", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MinCoordLarger2", "[", 
            RowBox[{"coord", ",", " ", "#", ",", " ", "T"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "setsgr2"}]}], ";", "\n", "    ", 
        RowBox[{"zvec", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "T", "]"}], " ", "+", " ", "1"}]}], 
            "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"apz", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"PrependTo", "[", 
           RowBox[{"uncrd", ",", " ", "zvec"}], "]"}], "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"apz", ",", " ", "mincrd"}], "]"}], "]"}]}]}], "\n", "    ",
       "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PlayerPairs", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"PlayerPairs", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PlayerPairs", "[", "T_List", "]"}], " ", ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", ",", "ijpair", ",", " ", "crdpr01"}], "}"}], ",", "\n",
        "    ", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Length", "[", "T", "]"}]}], "]"}], " ", "&"}], "/@", 
          " ", "T"}]}], ";", "\n", "    ", 
        RowBox[{"ijpair", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", " ", ">=", " ", "#2"}], ",", " ", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], " ", "&"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"T", ",", "#"}], "}"}]}], "]"}], " ", "&"}], "/@", " ", 
          "mat"}]}], ";", "\n", "    ", 
        RowBox[{"crdpr01", " ", "=", " ", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", 
            "ijpair"}], ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"Sort", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Join", ",", " ", "crdpr01"}], "]"}], "]"}]}]}], "\n", 
      "    ", "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"0ad4f7d8-370e-4737-\
a8b1-72f167b61ef3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MinCoordLarger2", "[", 
    RowBox[{"coord_List", ",", " ", "setsgr2_", ",", " ", "T_"}], "]"}], " ", 
   ":=", " ", "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plp", ",", " ", "plpsets", ",", " ", "plpsys", ",", " ", "pos", ",", 
       " ", "crdsys", ",", " ", "lamsys", ",", " ", "crdeq2", ",", " ", 
       "rlcdr", ",", " ", "inscrd"}], "}"}], ",", "\n", "    ", 
     RowBox[{
      RowBox[{"plp", " ", "=", " ", 
       RowBox[{"PlayerPairs", "[", "setsgr2", "]"}]}], ";", "\n", "    ", 
      RowBox[{"pos", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"plp", ",", " ", "#"}], "]"}], " ", "&"}], ",", " ", 
         "setsgr2"}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"plpsets", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"plp", ",", " ", 
              RowBox[{"First", "[", "#", "]"}]}], "]"}], " ", "&"}], ",", " ",
            "#"}], "]"}], " ", "&"}], " ", "/@", " ", "pos"}]}], ";", "\n", 
      "    ", 
      RowBox[{"crdsys", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]", "[", "#", "]"}], " ", "&"}], ",", " ", "#"}],
           "]"}], " ", "&"}], " ", "/@", " ", "plpsets"}]}], ";", "\n", 
      "    ", 
      RowBox[{"lamsys", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Total", "[", "#", "]"}], ")"}], "/", 
            RowBox[{"Length", "[", "#", "]"}]}], "-", "1"}], ")"}], " ", 
         "&"}], " ", "/@", " ", "crdsys"}]}], ";", "\n", "    ", 
      RowBox[{"crdeq2", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"PlayerPairs", "[", "T", "]"}]}]}], ";", "\n", "    ", 
      RowBox[{"rlcdr", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"crdeq2", ",", " ", "coord"}], "}"}]}], "]"}]}], ";", "\n", 
      "    ", 
      RowBox[{"inscrd", " ", "=", " ", 
       RowBox[{"lamsys", " ", "/.", " ", "rlcdr"}]}], ";", "\n", "    ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", 
         RowBox[{"Length", "[", "setsgr2", "]"}], "]"}], ",", " ", 
        RowBox[{"Min", "[", "inscrd", "]"}], ",", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"-", "inscrd"}], "]"}]}], "]"}]}]}], "\n", "    ", "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"15d0bf75-e750-4e5c-a764-93ea7293d214"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MinUnanimityCoordinates", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"MinUnanimityCoordinates", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinUnanimityCoordinates", "[", "game_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"anz", ",", "sepset"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"anz", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Length", "[", "#", "]"}], ")"}], "&"}], " ", "/@", " ", 
         RowBox[{"Subsets", "[", "T", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"sepset", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", "T", "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{"anz", ",", "#"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
          " ", "T"}]}], ";", "\n", "\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CoordS", "[", 
              RowBox[{"game", ",", "#"}], "]"}], ")"}], "&"}], " ", "/@", " ", 
           RowBox[{"sepset", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
     "\t\t", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StrictlyConvexUnanConditionQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"StrictlyConvexUnanConditionQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrictlyConvexUnanConditionQ", "[", "game_", "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "unanc", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"unanc", "=", 
        RowBox[{"EvalSumMinCoord", "[", "game", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Positive", "[", "unanc", "]"}]}], "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvexUnanConditionQ", "[", "args___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ConvexUnanConditionQ", "::", "argerr"}], "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvexUnanConditionQ", "[", "game_", "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "unanc", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"unanc", "=", 
       RowBox[{"EvalSumMinCoord", "[", "game", "]"}]}], ";", "\n", "  ", 
      RowBox[{"Apply", "[", 
       RowBox[{"And", ",", 
        RowBox[{"NonNegative", "[", "unanc", "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"9c127223-45aa-444b-9489-\
58ad4db40d7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConvexUnanIffCoord", "[", "game_", "]"}], " ", ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pij", ",", " ", "dems", ",", " ", "tog", ",", " ", "lams", ",", " ", 
       "unc"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"pij", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", ">=", "  ", "j"}], ",", " ", 
           RowBox[{"{", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "j"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"dems", " ", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", " ", 
             RowBox[{"{", "}"}]}], "]"}], " ", "&"}], " ", "/@", " ", "pij"}],
          ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"tog", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"Join", ",", " ", "dems"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"lams", " ", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SubSetQ", "[", 
              RowBox[{
               RowBox[{"tog", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "#"}], "]"}], ",", 
             " ", "1", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Subsets", "[", "T", "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "tog", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "  ", 
      RowBox[{"unc", " ", "=", " ", 
       RowBox[{"UnanimityCoordinates", "[", "game", "]"}]}], ";", "\n", "  ", 
      
      RowBox[{"lams", ".", "unc"}]}]}], "\n", "  ", "]"}]}], ";"}]], "Code",Ex\
pressionUUID->"6b33c57f-6d9c-413d-9070-0665a42ff6a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cor", ".", " ", "2.1"}], " ", "in", " ", 
    RowBox[{"C", ".", " ", "Rafels"}], " ", "and", " ", 
    RowBox[{"N", ".", " ", "Ybern"}], " ", 
    RowBox[{"(", "1995", ")"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EvalSumMinCoord", "[", "args___", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"EvalSumMinCoord", "::", "argerr"}], "]"}], ";", "$Failed"}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EvalSumMinCoord", "[", "game_", "]"}], ":=", "\n", "  ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "smallestcoord", ",", "alphak", ",", "post", ",", "rg", ",", 
         "firstneg", ",", "s0", ",", "restmin", ",", "alltrueQ", ",", "fac", 
         ",", "retval", ",", "singleQ"}], "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"smallestcoord", "=", 
         RowBox[{"MinUnanimityCoordinates", "[", "game", "]"}]}], ";", "\n", 
        "    ", 
        RowBox[{"alphak", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"smallestcoord", ",", "1"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"post", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"NonNegative", "[", "#", "]"}], "&"}], "/@", " ", 
          "alphak"}]}], ";", "\n", "    ", 
        RowBox[{"alltrueQ", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"And", ",", "post"}], "]"}]}], ";", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"alltrueQ", " ", "==", " ", "False"}], ",", "\n", "      ", 
          
          RowBox[{
           RowBox[{"firstneg", "=", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"post", ",", "False"}], "]"}], "]"}], ",", "1"}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "      ", 
           RowBox[{"s0", "=", 
            RowBox[{"firstneg", " ", "+", " ", "1"}]}], ";", "\n", "      ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"s0", ">", 
              RowBox[{
               RowBox[{"Length", "[", "T", "]"}], "-", "2"}]}], ",", "\n", 
             "        ", 
             RowBox[{
              RowBox[{"DisplaySize", "[", 
               RowBox[{"game", ",", "s0"}], "]"}], ";", "\n", "        ", 
              "smallestcoord"}], ",", "\n", "        ", 
             RowBox[{
              RowBox[{"rg", "=", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "alphak", "]"}], "]"}]}], ";", "\n", 
              "        ", 
              RowBox[{"restmin", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"alphak", ",", "#"}], "]"}], " ", "&"}], " ", "/@", 
                " ", "rg"}]}], ";", "\n", "        ", 
              RowBox[{"fac", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "!"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "!"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", "j"}], ")"}], "!"}]}], ")"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "0", ",", "k"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "T", "]"}], "-", "2"}]}], "}"}]}], 
                "]"}]}], ";", "\n", "        ", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
               
               RowBox[{"MapThread", "[", 
                RowBox[{"Times", ",", 
                 RowBox[{"{", 
                  RowBox[{"fac", ",", "restmin"}], "}"}]}], "]"}]}]}]}], "\n",
             "        ", "]"}]}], ",", "\n", "          ", 
          RowBox[{
           RowBox[{"singleQ", "=", 
            RowBox[{"NonNegative", "[", 
             RowBox[{"Take", "[", 
              RowBox[{"smallestcoord", ",", "1"}], "]"}], "]"}]}], ";", "\n", 
           "          ", 
           RowBox[{"alltrueQ", "=", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", 
               RowBox[{"{", 
                RowBox[{"alltrueQ", ",", "singleQ"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "          ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"alltrueQ", " ", "==", " ", "True"}], ",", "\n", 
             "            ", 
             RowBox[{"PrintMessageFirst", ";", "smallestcoord"}], ",", "\n", 
             "               ", 
             RowBox[{"PrintMessageSec", ";", "smallestcoord"}]}], "]"}]}]}], 
         " ", "\n", "         ", "]"}]}]}], " ", "\n", "       ", "]"}]}], 
    ";"}], "\n"}]}]], "Code",ExpressionUUID->"0562d767-6bc0-453f-bc0e-\
ceb965e86fdb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisplaySize", "[", 
     RowBox[{"game_", ",", " ", "s0_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\n", "      ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Minimum coalition size with negative unanimity coordinate is \
equal to \>\"", ",", " ", "s0"}], "]"}], ";", "\n", "      ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Coalition size of T-2 is \>\"", ",", " ", 
        RowBox[{
         RowBox[{"Length", "[", "T", "]"}], " ", "-", " ", "2"}]}], "]"}], 
      ";", "\n", "      ", 
      RowBox[{"Print", "[", 
       RowBox[{"s0", ",", " ", "\"\< greater than \>\"", ",", " ", 
        RowBox[{
         RowBox[{"Length", "[", "T", "]"}], " ", "-", " ", "2"}]}], "]"}], 
      ";", "\n", "      ", 
      RowBox[{
      "Print", "[", 
       "\"\<No sum of minimum unanimity coordinates can be evaluated.\>\"", 
       "]"}], ";", "\n", "      ", 
      RowBox[{
      "Print", "[", "\"\<The minimum unanimity coordinates are:\>\"", "]"}]}],
      "\n", "      ", ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMessageFirst", ":=", 
    RowBox[{"(", "\n", "      ", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<No negative unanimity coordinates found.\>\"", "]"}],
       ";", "\n", "      ", 
      RowBox[{"Print", "[", "\"\<Game is convex.\>\"", "]"}], ";", "\n", 
      "      ", 
      RowBox[{
      "Print", "[", "\"\<The minimum unanimity coordinates are:\>\"", "]"}]}],
      ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMessageSec", ":=", 
    RowBox[{"(", "\n", "      ", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<No negative unanimity coordinates found.\>\"", "]"}],
       ";", "\n", "      ", 
      RowBox[{
      "Print", "[", "\"\<The minimum unanimity coordinates are:\>\"", "]"}]}],
      ")"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Global`Co", ",", "coal"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "Global`sij", "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Protect", "[", "x", "]"}], ";"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SameQ", "[", 
      RowBox[{"Global`$ParaMode", ",", "\"\<False\>\""}], "]"}], ",", "\n", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<===================================================\>\"", "]"}], 
      ";", "\n", 
      RowBox[{"Print", "[", "\"\<Package 'TuGames' loaded\>\"", "]"}], ";", 
      "\n", 
      RowBox[{
      "Print", "[", 
       "\"\<===================================================\>\"", "]"}], 
      ";"}], ",", "\n", "   ", "True"}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], "\n", "\n", "\n", "\n", "\n", "\n", "\n", 
  "\n"}], "\n"}], "Code",ExpressionUUID->"c4a8017d-c354-4abd-a2d6-\
6108505e946e"]
},
WindowSize->{606., 583.5},
WindowMargins->{{144, Automatic}, {Automatic, 90.75}},
TaggingRules-><|"CodeFormatter" -> <|"ToolbarState" -> False|>|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"43f13eec-8a28-478f-9efd-d725a0987985"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 30146, 648, 3853, "Code",ExpressionUUID->"e2e3f6e7-c21a-429e-8df6-96e60704b36d"],
Cell[30707, 670, 28054, 536, 4513, "Code",ExpressionUUID->"75831a7b-c20e-4707-97e5-4c0fe20aa269"],
Cell[58764, 1208, 503, 11, 70, "Code",ExpressionUUID->"3c085f4e-36ef-4b6d-9ce6-27d846de35c4"],
Cell[59270, 1221, 3415, 73, 70, "Code",ExpressionUUID->"d6d4a740-1a52-4a1a-bb97-1c6898484fc8"],
Cell[62688, 1296, 2289, 57, 70, "Code",ExpressionUUID->"0bdec12d-1e77-4060-8d94-9046322980fc"],
Cell[64980, 1355, 2362, 54, 70, "Code",ExpressionUUID->"73f67a6c-e9ee-4279-8d67-29f79289bbdf"],
Cell[67345, 1411, 3171, 74, 70, "Code",ExpressionUUID->"fa555de0-d1e2-4117-b41e-edf182b17225"],
Cell[70519, 1487, 4110, 105, 70, "Code",ExpressionUUID->"108c5838-a73b-4104-b02b-010b7a43d0c2"],
Cell[74632, 1594, 6100, 107, 70, "Code",ExpressionUUID->"3d35268e-e77c-442f-9cb4-ef00cf997681"],
Cell[80735, 1703, 766, 12, 70, "Code",ExpressionUUID->"53a2684a-139e-4be4-9a6c-506832165df3"],
Cell[81504, 1717, 5422, 113, 70, "Code",ExpressionUUID->"bdbe042a-8b5c-4473-9053-7f125a0ff9d1"],
Cell[86929, 1832, 578, 10, 70, "Code",ExpressionUUID->"9a7082b4-118f-45e9-af27-9dedf070ef36"],
Cell[87510, 1844, 4990, 115, 70, "Code",ExpressionUUID->"81038ea6-02d8-41f9-946e-606538aa2b15"],
Cell[92503, 1961, 1064, 19, 70, "Code",ExpressionUUID->"cc9b798e-635a-4bcd-adfd-1e1f573bbdc5"],
Cell[93570, 1982, 6363, 121, 70, "Code",ExpressionUUID->"23b6f545-d1aa-4d8f-b511-ce76f94ab0d9"],
Cell[99936, 2105, 1130, 24, 70, "Code",ExpressionUUID->"2df5efc6-d4ae-4fc4-a69f-3c233a775a96"],
Cell[101069, 2131, 384, 7, 70, "Code",ExpressionUUID->"e8d77a57-2d3e-4062-9544-6f4c44847ce2"],
Cell[101456, 2140, 1753, 35, 70, "Code",ExpressionUUID->"1676886d-5bf2-473d-bce1-11f19cf7458b"],
Cell[103212, 2177, 454, 8, 70, "Code",ExpressionUUID->"ebcdd842-e889-48c8-b5ec-7f9e80397be2"],
Cell[103669, 2187, 4165, 91, 70, "Code",ExpressionUUID->"cf28abac-de0f-466c-bfa6-f55a0134a14a"],
Cell[107837, 2280, 16045, 389, 70, "Code",ExpressionUUID->"9fe8a44b-b931-43ce-be87-5d7e463b1bce"],
Cell[123885, 2671, 4776, 118, 70, "Code",ExpressionUUID->"c0f8162a-b1fb-4815-b4ab-556f2e2abf27"],
Cell[128664, 2791, 2249, 53, 70, "Code",ExpressionUUID->"0b1f0f67-5e5b-48dd-aae5-a8b1fe8cb060"],
Cell[130916, 2846, 526, 10, 70, "Code",ExpressionUUID->"6569f484-d3a5-4398-aaa3-d640c44a3f4a"],
Cell[131445, 2858, 902, 17, 70, "Code",ExpressionUUID->"5a0b555f-317d-40aa-851b-34b8ba4aac58"],
Cell[132350, 2877, 2160, 44, 70, "Code",ExpressionUUID->"c34d6dbf-2f00-4a56-8ddb-78c660b4bc50"],
Cell[134513, 2923, 5709, 115, 70, "Code",ExpressionUUID->"16cc5d20-7219-4957-b3dc-e54941c9e0e9"],
Cell[140225, 3040, 41994, 987, 70, "Code",ExpressionUUID->"7b56b875-2f26-47cf-9df6-0e6aa51bfff5"],
Cell[182222, 4029, 19231, 552, 70, "Code",ExpressionUUID->"0b50b529-3377-4c30-8320-1bc582f13667"],
Cell[201456, 4583, 9111, 258, 70, "Code",ExpressionUUID->"70712ff2-aafc-441a-b863-af3c9721e658"],
Cell[210570, 4843, 5136, 122, 70, "Code",ExpressionUUID->"339c68f7-943c-4df5-85f5-76664362d941"],
Cell[215709, 4967, 5417, 126, 70, "Code",ExpressionUUID->"6b51f19e-8c87-4b7c-bbcf-10b8b2aa6ac3"],
Cell[221129, 5095, 2754, 76, 70, "Code",ExpressionUUID->"cdd03c25-891f-473d-8ebd-6ed2d8734cca"],
Cell[223886, 5173, 1601, 48, 70, "Code",ExpressionUUID->"cda092e4-de03-4224-a941-b911e47c1903"],
Cell[225490, 5223, 4824, 136, 70, "Code",ExpressionUUID->"44133fd2-d80a-4b55-9d35-e7630b65bd5c"],
Cell[230317, 5361, 5206, 134, 70, "Code",ExpressionUUID->"f7dd71a9-63d2-446f-b662-77b35ec5c2d8"],
Cell[235526, 5497, 1668, 42, 70, "Code",ExpressionUUID->"ab499cd4-4ba9-420a-a7da-8c161d875b1e"],
Cell[237197, 5541, 1676, 47, 70, "Code",ExpressionUUID->"5cb69abe-8dc4-415f-8f46-a59310f98b46"],
Cell[238876, 5590, 9893, 271, 70, "Code",ExpressionUUID->"e4004a02-4193-4c26-85fe-5b4a732d2714"],
Cell[248772, 5863, 15507, 438, 70, "Code",ExpressionUUID->"8adb159a-622b-4470-a09c-48984e2ae637"],
Cell[264282, 6303, 1427, 39, 70, "Code",ExpressionUUID->"b905172d-ae4d-42fb-b080-650c42319116"],
Cell[265712, 6344, 2525, 72, 70, "Code",ExpressionUUID->"1292c54b-68c9-4814-9517-317f4de76b9c"],
Cell[268240, 6418, 7600, 212, 70, "Code",ExpressionUUID->"63d33d44-2c7f-45cb-8b80-d04349601a63"],
Cell[275843, 6632, 959, 25, 70, "Code",ExpressionUUID->"48924db7-1547-4b7b-9325-6b3ba8fc4dcb"],
Cell[276805, 6659, 8821, 225, 70, "Code",ExpressionUUID->"92f7bf40-e90f-448b-b6b4-888135286328"],
Cell[285629, 6886, 1591, 45, 70, "Code",ExpressionUUID->"2f6fedbd-7168-4a33-94e3-590c13afa2af"],
Cell[287223, 6933, 7029, 186, 70, "Code",ExpressionUUID->"9272cc3e-8bf5-4e9c-a68e-edce6ce98c08"],
Cell[294255, 7121, 1134, 31, 70, "Code",ExpressionUUID->"0de00bac-a053-427f-aba8-38c92cb6633c"],
Cell[295392, 7154, 692, 19, 70, "Code",ExpressionUUID->"2b35da1e-c2b5-4010-a04d-83573dcced5f"],
Cell[296087, 7175, 2932, 72, 70, "Code",ExpressionUUID->"dec06a10-edb9-410a-b173-84b234b854ad"],
Cell[299022, 7249, 3252, 88, 70, "Code",ExpressionUUID->"628fe5bf-9baf-4a78-9830-a19c19a20bac"],
Cell[302277, 7339, 23327, 589, 70, "Code",ExpressionUUID->"a1872e6d-1e4d-4e70-98bb-2068ba0b37e3"],
Cell[325607, 7930, 4185, 112, 70, "Code",ExpressionUUID->"41379b9f-2c63-4c41-89a8-2225085fa645"],
Cell[329795, 8044, 5269, 146, 70, "Code",ExpressionUUID->"864b7245-441b-468e-b28b-9087f68f7caa"],
Cell[335067, 8192, 13945, 388, 70, "Code",ExpressionUUID->"2317ca69-9d38-4767-b98e-19b9b274c5ba"],
Cell[349015, 8582, 2478, 79, 70, "Code",ExpressionUUID->"50d6f918-bee8-4d69-84b7-ed879715ac45"],
Cell[351496, 8663, 4040, 116, 70, "Code",ExpressionUUID->"f72b00d6-7e7a-469d-9f55-4289cccb92cc"],
Cell[355539, 8781, 4568, 119, 70, "Code",ExpressionUUID->"761ed972-28b7-456e-897d-6d5ecb1bbf32"],
Cell[360110, 8902, 2176, 59, 70, "Code",ExpressionUUID->"487236b8-96d6-466a-9093-d2ddec7a1ddf"],
Cell[362289, 8963, 7066, 181, 70, "Code",ExpressionUUID->"10a94b82-42fe-45ff-b7c1-34abbc1a527e"],
Cell[369358, 9146, 2526, 70, 70, "Code",ExpressionUUID->"19a00cbc-f8ea-413e-8664-ee8c9d6cf3a4"],
Cell[371887, 9218, 4408, 119, 70, "Code",ExpressionUUID->"2b49989c-5229-41a9-9be2-d60c66471437"],
Cell[376298, 9339, 713, 21, 70, "Code",ExpressionUUID->"99e0f071-14f8-492a-8954-bb1b612ae199"],
Cell[377014, 9362, 17202, 444, 70, "Code",ExpressionUUID->"19be2abb-36cb-4c57-801e-6633958414c3"],
Cell[394219, 9808, 14489, 362, 70, "Code",ExpressionUUID->"647abac8-3a42-4e19-87b3-5478797b953c"],
Cell[408711, 10172, 5067, 136, 70, "Code",ExpressionUUID->"f3a950cd-49b7-4c76-8cc3-8c9ed4dc602d"],
Cell[413781, 10310, 37737, 934, 70, "Code",ExpressionUUID->"9e095473-09c4-4295-8a55-a1f9b7e2755f"],
Cell[451521, 11246, 12626, 334, 70, "Code",ExpressionUUID->"8562ef98-5ebf-44c0-b11d-a5c954988de3"],
Cell[464150, 11582, 9444, 258, 70, "Code",ExpressionUUID->"d26ab3d9-c547-40f2-aff8-51410fb218f9"],
Cell[473597, 11842, 3744, 95, 70, "Code",ExpressionUUID->"f808b022-13f3-4eda-991d-3c5aa0c3c972"],
Cell[477344, 11939, 7053, 176, 70, "Code",ExpressionUUID->"e0f0f23b-3764-4660-aa62-fd0e931e35d8"],
Cell[484400, 12117, 1317, 35, 70, "Code",ExpressionUUID->"0222d264-cdba-4334-b624-d476c583f690"],
Cell[485720, 12154, 1444, 37, 70, "Code",ExpressionUUID->"ef1dc5e6-6989-4241-b674-a184b6d2d1e3"],
Cell[487167, 12193, 6112, 146, 70, "Code",ExpressionUUID->"543200a7-c39e-4363-95f6-48dbebffd990"],
Cell[493282, 12341, 1704, 43, 70, "Code",ExpressionUUID->"8b6603cb-b921-40d6-a69a-0fec1731d217"],
Cell[494989, 12386, 4370, 110, 70, "Code",ExpressionUUID->"1b3595c1-3023-4269-b2ab-e0db6e7cb3a1"],
Cell[499362, 12498, 4316, 115, 70, "Code",ExpressionUUID->"b55cc732-2e2f-4df5-b5a4-3fb479a5a8eb"],
Cell[503681, 12615, 1325, 35, 70, "Code",ExpressionUUID->"d599c46a-8ec2-4b5a-a16c-89519a83ead0"],
Cell[505009, 12652, 1335, 35, 70, "Code",ExpressionUUID->"5b9c9e19-b64f-4795-87fa-7ac7576861f5"],
Cell[506347, 12689, 5179, 134, 70, "Code",ExpressionUUID->"baa19dd6-0867-4096-aa85-1ecd87a44ddc"],
Cell[511529, 12825, 7615, 203, 70, "Code",ExpressionUUID->"c583ab63-2ebc-4b31-b559-7551adde5acd"],
Cell[519147, 13030, 10457, 255, 70, "Code",ExpressionUUID->"429ef056-4c90-4118-b0c0-8d5b60d7c01a"],
Cell[529607, 13287, 6296, 155, 70, "Code",ExpressionUUID->"1505b78e-263f-4a9c-ab26-229f91476c1b"],
Cell[535906, 13444, 3095, 83, 70, "Code",ExpressionUUID->"0cf3a3b7-3552-423b-9db9-e36138a619c1"],
Cell[539004, 13529, 358, 8, 70, "Code",ExpressionUUID->"a90bd914-54cd-4f18-bf86-e44089bc501f"],
Cell[539365, 13539, 6523, 155, 70, "Code",ExpressionUUID->"6e4c64ec-c9b8-4895-ba6c-2aaa93529a08"],
Cell[545891, 13696, 12806, 313, 70, "Code",ExpressionUUID->"132f7b2d-347e-4037-b5c7-dfb1b0da72dd"],
Cell[558700, 14011, 11358, 286, 70, "Code",ExpressionUUID->"49a85250-9160-46c5-959a-f3c38e4a33a2"],
Cell[570061, 14299, 4865, 128, 70, "Code",ExpressionUUID->"9abb74e5-587a-4811-829a-c9782e3e6121"],
Cell[574929, 14429, 14024, 360, 70, "Code",ExpressionUUID->"04223c01-d782-4be5-a94f-d70305a282c3"],
Cell[588956, 14791, 364, 8, 70, "Code",ExpressionUUID->"ef4b079a-935d-40d9-b541-9332594d1309"],
Cell[589323, 14801, 4637, 106, 70, "Code",ExpressionUUID->"ce29e377-8036-4f3b-a758-1bf51f864706"],
Cell[593963, 14909, 4811, 115, 70, "Code",ExpressionUUID->"008986f3-ef26-4771-a649-77c5fd8a06b1"],
Cell[598777, 15026, 5786, 141, 70, "Code",ExpressionUUID->"e3424da4-7040-4aa4-b0e9-f07d50e60344"],
Cell[604566, 15169, 227, 4, 70, "Code",ExpressionUUID->"741ad6b3-05a0-4bf6-ad81-9e24cc29cfa4"],
Cell[604796, 15175, 14533, 358, 70, "Code",ExpressionUUID->"04239c8a-3389-4727-8e01-0ebff7eafda0"],
Cell[619332, 15535, 4768, 125, 70, "Code",ExpressionUUID->"91307f89-4c84-4b28-bd3f-d6f877cf0225"],
Cell[624103, 15662, 4673, 116, 70, "Code",ExpressionUUID->"4a3bb002-a9a1-427f-89e2-68e03ada13a7"],
Cell[628779, 15780, 8061, 202, 70, "Code",ExpressionUUID->"6dbd7a7b-4128-4004-b687-36d5a740f698"],
Cell[636843, 15984, 8716, 234, 70, "Code",ExpressionUUID->"944d406e-5c64-48eb-a55b-0a5d736a0b29"],
Cell[645562, 16220, 5210, 126, 70, "Code",ExpressionUUID->"df85226a-1a85-4e56-9040-660dc45fb297"],
Cell[650775, 16348, 1714, 45, 70, "Code",ExpressionUUID->"3e293388-6ce7-4c45-9889-350c47db7813"],
Cell[652492, 16395, 5654, 134, 70, "Code",ExpressionUUID->"8c49a355-d7fe-4df7-a562-4fe442c2a64f"],
Cell[658149, 16531, 5773, 126, 70, "Code",ExpressionUUID->"54c0cea2-b5c2-4c78-b761-305e285e6a5f"],
Cell[663925, 16659, 4952, 114, 70, "Code",ExpressionUUID->"d785282d-62df-4f5b-84ac-7ea35456bf18"],
Cell[668880, 16775, 3188, 76, 70, "Code",ExpressionUUID->"75c4dddc-0a18-4f50-bde0-4ecf9c0dded8"],
Cell[672071, 16853, 14543, 368, 70, "Code",ExpressionUUID->"f5d3071b-c77d-40fd-a777-548585c16783"],
Cell[686617, 17223, 224, 5, 70, "Code",ExpressionUUID->"deefb92b-f8f7-4259-b4c1-94d303cb6d39"],
Cell[686844, 17230, 2951, 72, 70, "Code",ExpressionUUID->"f80b0591-a3ca-4dfd-8820-5950fd3fdd18"],
Cell[689798, 17304, 2682, 69, 70, "Code",ExpressionUUID->"6cb0ceef-ffab-47aa-8639-158f253eeb6b"],
Cell[692483, 17375, 4543, 114, 70, "Code",ExpressionUUID->"97783a9c-cee4-4a6c-b2fc-c1415e815e82"],
Cell[697029, 17491, 4473, 115, 70, "Code",ExpressionUUID->"26dec2af-7dfd-45d3-8bf3-14fd86bd12ce"],
Cell[701505, 17608, 197, 4, 70, "Code",ExpressionUUID->"f18f3d42-e143-407b-88a9-277e68ddd631"],
Cell[701705, 17614, 1773, 51, 70, "Code",ExpressionUUID->"b4379036-7914-4d4e-9006-2e64b3fd3608"],
Cell[703481, 17667, 2964, 87, 70, "Code",ExpressionUUID->"27f51043-fa61-4b80-bde2-b3ef0fc5c65e"],
Cell[706448, 17756, 7751, 181, 70, "Code",ExpressionUUID->"6131d3be-ce73-4f5f-b0b8-0f3f07000a27"],
Cell[714202, 17939, 23979, 579, 70, "Code",ExpressionUUID->"238105e3-28ed-4208-af31-d4e02049890d"],
Cell[738184, 18520, 434, 11, 70, "Code",ExpressionUUID->"838d1712-005e-4237-9e80-7c35d49604e8"],
Cell[738621, 18533, 1705, 46, 70, "Code",ExpressionUUID->"c32766c1-00a9-498e-b9aa-1c36640c5cbc"],
Cell[740329, 18581, 4514, 117, 70, "Code",ExpressionUUID->"87a21ec0-2fb5-440e-998a-3dd90dcef7f0"],
Cell[744846, 18700, 5662, 144, 70, "Code",ExpressionUUID->"9001e4ee-ea2c-4bb0-8e2e-008b28781d15"],
Cell[750511, 18846, 2316, 62, 70, "Code",ExpressionUUID->"d504dc15-3d88-4c19-89dc-e6e4635d7ade"],
Cell[752830, 18910, 5987, 144, 70, "Code",ExpressionUUID->"4568a1b2-3671-4146-9be7-175dbdfc2f73"],
Cell[758820, 19056, 2171, 52, 70, "Code",ExpressionUUID->"4ccdc512-6219-4cdc-80c0-da186116ff4e"],
Cell[760994, 19110, 264, 5, 70, "Code",ExpressionUUID->"0fb30886-19b4-4a6b-a378-e0dc6d09cb42"],
Cell[761261, 19117, 528, 13, 70, "Code",ExpressionUUID->"9fff01f8-cc2e-41d1-99fa-2650554a889c"],
Cell[761792, 19132, 3106, 94, 70, "Code",ExpressionUUID->"e56482fe-c1ce-4729-833c-27935d507e74"],
Cell[764901, 19228, 3181, 83, 70, "Code",ExpressionUUID->"ee356409-9f71-456f-9519-02a5553cc275"],
Cell[768085, 19313, 757, 21, 70, "Code",ExpressionUUID->"19d2ad31-7a5c-42bd-a458-a2cfea42cc71"],
Cell[768845, 19336, 2945, 75, 70, "Code",ExpressionUUID->"33ea1c53-228a-4a5e-830a-6fec8af88490"],
Cell[771793, 19413, 719, 19, 70, "Code",ExpressionUUID->"737a6664-f634-4938-807b-dbd8247f6db5"],
Cell[772515, 19434, 4872, 138, 70, "Code",ExpressionUUID->"68d7fedd-71c1-41b9-a3e1-1834dbb52e94"],
Cell[777390, 19574, 3105, 84, 70, "Code",ExpressionUUID->"0c2dac2d-7fe7-47af-8f67-014d76f1a0b3"],
Cell[780498, 19660, 3388, 89, 70, "Code",ExpressionUUID->"511a0cbd-82b4-4ddf-ada1-5fbaab002a79"],
Cell[783889, 19751, 8366, 211, 70, "Code",ExpressionUUID->"34ca6dd6-a1da-49c4-98a3-d29129f3daa3"],
Cell[792258, 19964, 4692, 124, 70, "Code",ExpressionUUID->"d96dbaa9-4e00-461a-9d0c-a8ab7f6d5c67"],
Cell[796953, 20090, 1221, 34, 70, "Code",ExpressionUUID->"d70d077d-6b15-44b9-8c16-3f54bf02a006"],
Cell[798177, 20126, 2049, 59, 70, "Code",ExpressionUUID->"b5b87aee-d8c7-492d-a21c-4ffdcd626008"],
Cell[800229, 20187, 9265, 228, 70, "Code",ExpressionUUID->"1b6f24b8-4fa4-4316-8e04-f8ac85ad9a4f"],
Cell[809497, 20417, 16332, 362, 70, "Code",ExpressionUUID->"37c7e1eb-0a99-4c94-95c6-d3247a8544e6"],
Cell[825832, 20781, 3745, 88, 70, "Code",ExpressionUUID->"d015ed19-4a6a-4222-b86e-5b9ff601817a"],
Cell[829580, 20871, 3815, 86, 70, "Code",ExpressionUUID->"9c434bf2-6b79-447e-872e-e2f4b4e5e1f8"],
Cell[833398, 20959, 16626, 388, 70, "Code",ExpressionUUID->"c795b4a8-3ba5-43f1-9ddf-adb3b6216d76"],
Cell[850027, 21349, 9403, 236, 70, "Code",ExpressionUUID->"6e3c5d2b-c3f1-4d54-959d-a11d375f6d8a"],
Cell[859433, 21587, 7669, 197, 70, "Code",ExpressionUUID->"96c7639c-5dc8-48d6-9452-311ea690c06a"],
Cell[867105, 21786, 10047, 238, 70, "Code",ExpressionUUID->"4d96c250-a6bb-4b1d-91a9-5d958fb682e0"],
Cell[877155, 22026, 6321, 149, 70, "Code",ExpressionUUID->"4fdae2dd-787e-48eb-9903-f8bd520559a2"],
Cell[883479, 22177, 278, 6, 70, "Code",ExpressionUUID->"a604dc40-82c8-47a2-a92f-639b1119006b"],
Cell[883760, 22185, 2749, 64, 70, "Code",ExpressionUUID->"9f7ce2c5-d924-4c14-8e6e-5cd4c7759ed4"],
Cell[886512, 22251, 4389, 104, 70, "Code",ExpressionUUID->"08a5ec72-265b-4679-a055-e3ee414abad3"],
Cell[890904, 22357, 16687, 394, 70, "Code",ExpressionUUID->"8866b8af-0933-4d4f-ab6f-c459146e26a8"],
Cell[907594, 22753, 15935, 363, 70, "Code",ExpressionUUID->"992db07c-728d-46c8-b6b5-23a9a54e9f2a"],
Cell[923532, 23118, 4959, 117, 70, "Code",ExpressionUUID->"72cdfa6a-9e06-47be-9560-80fe4b56c15a"],
Cell[928494, 23237, 6188, 146, 70, "Code",ExpressionUUID->"eb9c1dd8-a0f8-4024-8876-45a6b88ca9ab"],
Cell[934685, 23385, 4926, 115, 70, "Code",ExpressionUUID->"4dda1500-0f13-42e9-a8f0-d4718bfefe07"],
Cell[939614, 23502, 11227, 292, 70, "Code",ExpressionUUID->"ab96982d-af5b-4cbf-a471-b2115d440d78"],
Cell[950844, 23796, 3617, 85, 70, "Code",ExpressionUUID->"7b9bf2ed-57d4-4f17-9fdf-4f83da43f096"],
Cell[954464, 23883, 3629, 86, 70, "Code",ExpressionUUID->"7227dd09-27f4-42fe-8944-dd6b142c31aa"],
Cell[958096, 23971, 8715, 215, 70, "Code",ExpressionUUID->"fb9219c4-b127-4392-bcd1-f438de0452bc"],
Cell[966814, 24188, 8616, 215, 70, "Code",ExpressionUUID->"3737f0bb-abb7-49de-bfaa-225b8f727ed0"],
Cell[975433, 24405, 6844, 187, 70, "Code",ExpressionUUID->"b1e30025-93a9-4cf6-8d6b-f336644d46f7"],
Cell[982280, 24594, 693, 19, 70, "Code",ExpressionUUID->"f9587ace-5f15-4f85-81f0-129604e05cc2"],
Cell[982976, 24615, 5079, 133, 70, "Code",ExpressionUUID->"c3e16a17-7fe6-4d63-8d0c-a629c9c3f773"],
Cell[988058, 24750, 6415, 164, 70, "Code",ExpressionUUID->"79487d0a-f0ff-445a-b9f6-c3b8570ed4dd"],
Cell[994476, 24916, 3152, 77, 70, "Code",ExpressionUUID->"0a4ebb26-bd8f-4758-b499-b47e981c7af2"],
Cell[997631, 24995, 2966, 76, 70, "Code",ExpressionUUID->"0dcde3f5-a61a-4c58-b142-bcb0f4a7f9dc"],
Cell[1000600, 25073, 9341, 222, 70, "Code",ExpressionUUID->"7e262891-30c6-451f-b459-bf408f0985c7"],
Cell[1009944, 25297, 6298, 159, 70, "Code",ExpressionUUID->"0afea1c1-8933-4c78-9d64-cca76aa2a775"],
Cell[1016245, 25458, 8775, 212, 70, "Code",ExpressionUUID->"54663961-27c7-4e28-8f3d-07c46982f4e2"],
Cell[1025023, 25672, 3292, 93, 70, "Code",ExpressionUUID->"fb68304b-7ff7-443a-a333-61caf0034891"],
Cell[1028318, 25767, 1083, 27, 70, "Code",ExpressionUUID->"efbe7288-f3a5-42a6-9056-6e2821e19538"],
Cell[1029404, 25796, 3533, 91, 70, "Code",ExpressionUUID->"a1263af0-0d00-44c1-a64b-0d53aced4ec1"],
Cell[1032940, 25889, 17200, 431, 70, "Code",ExpressionUUID->"ed2fd808-ae77-43fb-bbf4-14fa6536544c"],
Cell[1050143, 26322, 5113, 129, 70, "Code",ExpressionUUID->"f89257d8-b8dc-4641-870d-999823904dcc"],
Cell[1055259, 26453, 6278, 163, 70, "Code",ExpressionUUID->"f8282c3e-bee0-4f6a-8c5c-a9c827ae8d50"],
Cell[1061540, 26618, 17176, 430, 70, "Code",ExpressionUUID->"812c1ab0-7e87-421a-ba37-d896fa0be9fb"],
Cell[1078719, 27050, 5963, 154, 70, "Code",ExpressionUUID->"10fb3392-7171-43ae-89c2-dc1a4d1bd39d"],
Cell[1084685, 27206, 3351, 77, 70, "Code",ExpressionUUID->"73c52b40-1e48-4b51-a9af-80f4fba605c9"],
Cell[1088039, 27285, 21130, 524, 70, "Code",ExpressionUUID->"45cfa203-d876-4e5f-83b6-1743e20d7335"],
Cell[1109172, 27811, 374, 7, 70, "Code",ExpressionUUID->"95540355-b927-4745-a786-c59527808504"],
Cell[1109549, 27820, 2522, 73, 70, "Code",ExpressionUUID->"3b8f24d3-b7f9-46f9-96e6-94155d097736"],
Cell[1112074, 27895, 8967, 227, 70, "Code",ExpressionUUID->"94753b7e-a6f3-41ea-924b-cd9a21a76c33"],
Cell[1121044, 28124, 199, 4, 70, "Code",ExpressionUUID->"77b78ca1-776d-4522-b1a0-155cbefa3307"],
Cell[1121246, 28130, 238, 5, 70, "Code",ExpressionUUID->"5e4d8c42-d50b-424f-be4d-055a6a9d1b6c"],
Cell[1121487, 28137, 2211, 66, 70, "Code",ExpressionUUID->"31de8367-d1e6-4031-a60f-e20eb33d6de3"],
Cell[1123701, 28205, 4496, 143, 70, "Code",ExpressionUUID->"b0738eca-1eb1-49ba-845f-6d97c9bb945c"],
Cell[1128200, 28350, 3255, 97, 70, "Code",ExpressionUUID->"d10f7a35-f5c7-472a-b6d6-40cfe40a304c"],
Cell[1131458, 28449, 10121, 292, 70, "Code",ExpressionUUID->"b70c448e-1861-4bae-836c-ae3d6981ad60"],
Cell[1141582, 28743, 1626, 52, 70, "Code",ExpressionUUID->"c8eccfe5-e1be-451c-8917-c2582140eeba"],
Cell[1143211, 28797, 559, 16, 70, "Code",ExpressionUUID->"d94c6429-ef25-4b3d-8efb-60c5418d28be"],
Cell[1143773, 28815, 4430, 128, 70, "Code",ExpressionUUID->"f34649a0-fc4f-49cf-89de-4ac5afd01aa7"],
Cell[1148206, 28945, 2562, 74, 70, "Code",ExpressionUUID->"a51e6c3c-61d1-479f-b759-c127cfcf166d"],
Cell[1150771, 29021, 236, 5, 70, "Code",ExpressionUUID->"f135113f-5b0a-4900-834c-b7488e57f441"],
Cell[1151010, 29028, 3824, 108, 70, "Code",ExpressionUUID->"5b11ed02-93fe-434b-9601-e3de56072381"],
Cell[1154837, 29138, 1063, 30, 70, "Code",ExpressionUUID->"06574d9a-f0e2-486f-ae88-94dd9b4ce787"],
Cell[1155903, 29170, 5058, 126, 70, "Code",ExpressionUUID->"0f91cb27-2fa8-4072-8362-761ce14435d0"],
Cell[1160964, 29298, 10317, 278, 70, "Code",ExpressionUUID->"0968ae30-2cba-48a4-be54-a4c5517a7c28"],
Cell[1171284, 29578, 2486, 59, 70, "Code",ExpressionUUID->"d9a989e5-3de3-478e-a7cc-08d6c274acf3"],
Cell[1173773, 29639, 2367, 63, 70, "Code",ExpressionUUID->"e4911f38-a965-4139-af11-eeb96101e110"],
Cell[1176143, 29704, 2071, 54, 70, "Code",ExpressionUUID->"2d34101d-9a3b-4c2e-a99d-fd99067a2aec"],
Cell[1178217, 29760, 4594, 127, 70, "Code",ExpressionUUID->"713613e4-5baa-4f40-af67-d4153499aea8"],
Cell[1182814, 29889, 6549, 185, 70, "Code",ExpressionUUID->"a934f7a9-ba43-4d68-b14e-1e99dcdf1ad5"],
Cell[1189366, 30076, 3298, 80, 70, "Code",ExpressionUUID->"e7307193-97b4-4258-97e6-d110853b0339"],
Cell[1192667, 30158, 2205, 58, 70, "Code",ExpressionUUID->"dd1be964-4951-4a2f-8b76-e05639b84034"],
Cell[1194875, 30218, 1412, 37, 70, "Code",ExpressionUUID->"e1b3e213-a22d-435d-a0e8-d81d41210d44"],
Cell[1196290, 30257, 982, 25, 70, "Code",ExpressionUUID->"5dd8b4f5-b88f-42fd-bb0b-f9ccad089d3f"],
Cell[1197275, 30284, 2737, 68, 70, "Code",ExpressionUUID->"72e6b4f5-e23b-4569-b66a-be06ab1b2111"],
Cell[1200015, 30354, 4710, 125, 70, "Code",ExpressionUUID->"8dfcedbe-61bb-40a7-a076-872b2d90e5d8"],
Cell[1204728, 30481, 7488, 197, 70, "Code",ExpressionUUID->"0ad4f7d8-370e-4737-a8b1-72f167b61ef3"],
Cell[1212219, 30680, 2847, 73, 70, "Code",ExpressionUUID->"15d0bf75-e750-4e5c-a764-93ea7293d214"],
Cell[1215069, 30755, 3143, 90, 70, "Code",ExpressionUUID->"9c127223-45aa-444b-9489-58ad4db40d7e"],
Cell[1218215, 30847, 2299, 61, 70, "Code",ExpressionUUID->"6b33c57f-6d9c-413d-9070-0665a42ff6a5"],
Cell[1220517, 30910, 5394, 132, 70, "Code",ExpressionUUID->"0562d767-6bc0-453f-bc0e-ceb965e86fdb"],
Cell[1225914, 31044, 3032, 85, 70, "Code",ExpressionUUID->"c4a8017d-c354-4abd-a2d6-6108505e946e"]
}
]
*)

(* End of internal cache information *)

